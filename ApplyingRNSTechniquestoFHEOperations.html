<!DOCTYPE html> 
<html lang='en-US' xml:lang='en-US'> 
<head><title>Applying RNS Techniques to FHE Operations</title> 
<meta charset='utf-8' /> 
<meta content='TeX4ht (https://tug.org/tex4ht/)' name='generator' /> 
<meta content='width=device-width,initial-scale=1' name='viewport' /> 
<link href='index.css' rel='stylesheet' type='text/css' /> 
<meta content='index.tex' name='src' /> 
 <script async='async' id='MathJax-script' src='https://cdn.jsdelivr.net/npm/mathjax@3/es5/mml-chtml.js' type='text/javascript'></script>  
</head><body>
   <!-- l. 851 --><div class='crosslinks'><p class='noindent'>[<a href='DecomposingMultiplicationtextsfDecompMulttextsubscriptRNS.html'>prev</a>] [<a href='DecomposingMultiplicationtextsfDecompMulttextsubscriptRNS.html#tailDecomposingMultiplicationtextsfDecompMulttextsubscriptRNS.html'>prev-tail</a>] [<a href='#tailApplyingRNSTechniquestoFHEOperations.html'>tail</a>] [<a href='RNSvariantFHESchemes.html#ApplyingRNSTechniquestoFHEOperations.html'>up</a>] </p></div>
   <h4 class='subsectionHead' id='applying-rns-techniques-to-fhe-operations'><span class='titlemark'>D-5.10   </span> <a id='x153-236000D-5.10'></a>Applying RNS Techniques to FHE Operations</h4>
<!-- l. 854 --><p class='noindent'>This subsection will explain how the RNS primitives we have learned so far are used to handle FHE
operations for RNS-based ciphertexts in BFV, CKKS, and BGV.
   
</p>
   <h5 class='subsubsectionHead' id='addition-and-multiplication-of-polynomials'><span class='titlemark'>D-5.10.1   </span> <a id='x153-237000D-5.10.1'></a>Addition and Multiplication of Polynomials</h5>
<!-- l. 860 --><p class='noindent'>In BFV, CKKS, and BGV, ciphertext-to-plaintext addition, ciphertext-to-ciphertext addition,
and ciphertext-to-plaintext multiplication are performed by only involving modulo additions
and multiplications among polynomial coefficients. Therefore, we can represent each
polynomial coefficient as an RNS residue vector and compute coefficient-wise additions and
multiplications by using RNS-based addition and multiplication of residues as explained in
Summary <a href='ApplicationNumberResidueSystemRNS.html#application-number-residue-system-rns'>A-13.1<!-- tex4ht:ref: subsec:crt-application  --></a> (<a href='ApplicationNumberResidueSystemRNS.html#application-number-residue-system-rns'><span class='ts1-lmr10-x-x-109'>§</span>A-13.1<!-- tex4ht:ref: subsec:crt-application  --></a>). For example, suppose we have the following two polynomials
<!-- l. 860 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>P</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup></math> and
<!-- l. 860 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>P</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup></math>:
</p><!-- l. 862 --><p class='indent'>   <!-- l. 862 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>P</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo><munderover accent='false' accentunder='false'><mrow> <mi class='MathClass-op'>∑</mi><mo> ⁡<!-- FUNCTION APPLICATION --></mo>
  </mrow><mrow><mi>a</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>0</mn></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></munderover><msubsup><mrow><mi>c</mi></mrow><mrow><mi>a</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msubsup><mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>X</mi></mrow><mrow><mi>a</mi></mrow></msup> <mo class='MathClass-rel' stretchy='false'>∈</mo><msub><mrow><mstyle mathvariant='script'><mi>R</mi></mstyle></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mi>n</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>q</mi><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msub></mrow></math>
</p><!-- l. 864 --><p class='indent'>   <!-- l. 864 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>P</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo><munderover accent='false' accentunder='false'><mrow> <mi class='MathClass-op'>∑</mi><mo> ⁡<!-- FUNCTION APPLICATION --></mo>
  </mrow><mrow><mi>b</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>0</mn></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></munderover><msubsup><mrow><mi>c</mi></mrow><mrow><mi>b</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msubsup><mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>X</mi></mrow><mrow><mi>b</mi></mrow></msup> <mo class='MathClass-rel' stretchy='false'>∈</mo><msub><mrow><mstyle mathvariant='script'><mi>R</mi></mstyle></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mi>n</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>q</mi><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msub></mrow></math>
</p><!-- l. 866 --><p class='indent'>   <!-- l. 866 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 868 --><p class='indent'>   In the RNS-variant FHE schemes, we express each polynomial’s each coefficient as an RNS residue
vector as follows:
</p><!-- l. 870 --><p class='indent'>   <!-- l. 870 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msubsup><mrow><mi>c</mi></mrow><mrow><mi>a</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msubsup> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>(</mo><msubsup><mrow><mi>c</mi></mrow><mrow><mi>a</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mn>1</mn></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msubsup><mo class='MathClass-punc' stretchy='false'>,</mo><msubsup><mrow><mi>c</mi></mrow><mrow><mi>a</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mn>2</mn></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msubsup><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace><mo class='MathClass-punc' stretchy='false'>,</mo><msubsup><mrow><mi>c</mi></mrow><mrow><mi>a</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>k</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msubsup><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>∈</mo> <msub><mrow><mi>ℤ</mi></mrow><mrow><msub><mrow><mi>q</mi></mrow><mrow><mn>1</mn></mrow></msub></mrow></msub> <mo class='MathClass-bin' stretchy='false'>×</mo> <msub><mrow><mi>ℤ</mi></mrow><mrow><msub><mrow><mi>q</mi></mrow><mrow><mn>2</mn></mrow></msub></mrow></msub> <mo class='MathClass-bin' stretchy='false'>×</mo><mo class='MathClass-rel' stretchy='false'>⋯</mo> <mo class='MathClass-bin' stretchy='false'>×</mo> <msub><mrow><mi>ℤ</mi></mrow><mrow><msub><mrow><mi>q</mi></mrow><mrow><mi>k</mi></mrow></msub></mrow></msub></mrow></math> <span id='textcolor259'>#
for <!-- l. 870 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>a</mi> <mo class='MathClass-rel' stretchy='false'>∈</mo><mo class='MathClass-open' stretchy='false'>[</mo><mn>0</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mi>n</mi> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>]</mo></mrow></math></span>
</p><!-- l. 872 --><p class='indent'>   <!-- l. 872 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msubsup><mrow><mi>c</mi></mrow><mrow><mi>b</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msubsup> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>(</mo><msubsup><mrow><mi>c</mi></mrow><mrow><mi>b</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mn>1</mn></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msubsup><mo class='MathClass-punc' stretchy='false'>,</mo><msubsup><mrow><mi>c</mi></mrow><mrow><mi>b</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mn>2</mn></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msubsup><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace><mo class='MathClass-punc' stretchy='false'>,</mo><msubsup><mrow><mi>c</mi></mrow><mrow><mi>b</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>k</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msubsup><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>∈</mo> <msub><mrow><mi>ℤ</mi></mrow><mrow><msub><mrow><mi>q</mi></mrow><mrow><mn>1</mn></mrow></msub></mrow></msub> <mo class='MathClass-bin' stretchy='false'>×</mo> <msub><mrow><mi>ℤ</mi></mrow><mrow><msub><mrow><mi>q</mi></mrow><mrow><mn>2</mn></mrow></msub></mrow></msub> <mo class='MathClass-bin' stretchy='false'>×</mo><mo class='MathClass-rel' stretchy='false'>⋯</mo> <mo class='MathClass-bin' stretchy='false'>×</mo> <msub><mrow><mi>ℤ</mi></mrow><mrow><msub><mrow><mi>q</mi></mrow><mrow><mi>k</mi></mrow></msub></mrow></msub></mrow></math> <span id='textcolor260'>#
for <!-- l. 872 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>b</mi> <mo class='MathClass-rel' stretchy='false'>∈</mo><mo class='MathClass-open' stretchy='false'>[</mo><mn>0</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mi>n</mi> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>]</mo></mrow></math></span>
</p><!-- l. 874 --><p class='indent'>   <!-- l. 874 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 876 --><p class='indent'>   Given the above RNS setup, when we add or multiply two polynomials, each coefficient-to-coefficient
addition is computed as element-wise additions of two RNS residue vectors as follows:
</p><!-- l. 878 --><p class='indent'>   <!-- l. 878 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msubsup><mrow><mi>c</mi></mrow><mrow><mi>a</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msubsup><mo class='MathClass-bin' stretchy='false'>+</mo> <msubsup><mrow><mi>c</mi></mrow><mrow><mi>b</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msubsup> <mo class='MathClass-rel' stretchy='false'>≡</mo><munderover accent='false' accentunder='false'><mrow><mi class='MathClass-op'>∑</mi><mo> ⁡<!-- FUNCTION APPLICATION --></mo>
  </mrow><mrow><mi>i</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>1</mn></mrow><mrow><mi>k</mi></mrow></munderover><mo class='MathClass-open' stretchy='false'>(</mo><msubsup><mrow><mi>c</mi></mrow><mrow><mi>a</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>i</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msubsup><mo class='MathClass-bin' stretchy='false'>+</mo> <msubsup><mrow><mi>c</mi></mrow><mrow><mi>b</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>i</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msubsup><mo class='MathClass-close' stretchy='false'>)</mo><msub><mrow><mi>y</mi></mrow><mrow><mi>i</mi></mrow></msub><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow></msub><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi>q</mi></mrow></math> <span id='textcolor261'>#
where <!-- l. 878 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>y</mi></mrow><mrow><mi>i</mi></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo> <mstyle displaystyle='true'><mfrac><mrow> <mi>q</mi>
</mrow><mrow><msub><mrow><mi>q</mi></mrow><mrow><mi>i</mi></mrow></msub></mrow></mfrac></mstyle></mrow></math>,
<!-- l. 878 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-rel' stretchy='false'>|</mo><msubsup><mrow><mi>y</mi></mrow><mrow><mi>i</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msubsup><msub><mrow><mo class='MathClass-rel' stretchy='false'>|</mo></mrow><mrow><msub><mrow><mi>q</mi></mrow><mrow><mi>i</mi></mrow></msub></mrow></msub></mrow></math></span>
</p><!-- l. 880 --><p class='indent'>   <!-- l. 880 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-rel' stretchy='false'>⟺</mo><mo class='MathClass-open' stretchy='false'>(</mo><msubsup><mrow><mi>c</mi></mrow><mrow><mi>a</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mn>1</mn></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msubsup><mo class='MathClass-bin' stretchy='false'>+</mo> <msubsup><mrow><mi>c</mi></mrow><mrow><mi>b</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mn>1</mn></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msubsup><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><msubsup><mrow><mi>c</mi></mrow><mrow><mi>a</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mn>2</mn></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msubsup><mo class='MathClass-bin' stretchy='false'>+</mo> <msubsup><mrow><mi>c</mi></mrow><mrow><mi>b</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mn>2</mn></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msubsup><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><msubsup><mrow><mi>c</mi></mrow><mrow><mi>a</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>k</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msubsup><mo class='MathClass-bin' stretchy='false'>+</mo> <msubsup><mrow><mi>c</mi></mrow><mrow><mi>b</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>k</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msubsup><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>∈</mo> <msub><mrow><mi>ℤ</mi></mrow><mrow><msub><mrow><mi>q</mi></mrow><mrow><mn>1</mn></mrow></msub></mrow></msub> <mo class='MathClass-bin' stretchy='false'>×</mo> <msub><mrow><mi>ℤ</mi></mrow><mrow><msub><mrow><mi>q</mi></mrow><mrow><mn>2</mn></mrow></msub></mrow></msub> <mo class='MathClass-bin' stretchy='false'>×</mo><mo class='MathClass-rel' stretchy='false'>⋯</mo> <mo class='MathClass-bin' stretchy='false'>×</mo> <msub><mrow><mi>ℤ</mi></mrow><mrow><msub><mrow><mi>q</mi></mrow><mrow><mi>k</mi></mrow></msub></mrow></msub></mrow></math>
</p><!-- l. 882 --><p class='indent'>   <!-- l. 882 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 884 --><p class='indent'>   Similarly, each coefficient-to-coefficient multiplication is computed as element-wise multiplications of
two RNS residue vectors as follows:
</p><!-- l. 886 --><p class='indent'>   <!-- l. 886 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msubsup><mrow><mi>c</mi></mrow><mrow><mi>a</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msubsup><mo class='MathClass-bin' stretchy='false'>⋅</mo><msubsup><mrow><mi>c</mi></mrow><mrow><mi>b</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msubsup> <mo class='MathClass-rel' stretchy='false'>≡</mo><munderover accent='false' accentunder='false'><mrow><mi class='MathClass-op'>∑</mi><mo> ⁡<!-- FUNCTION APPLICATION --></mo>
  </mrow><mrow><mi>i</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>1</mn></mrow><mrow><mi>k</mi></mrow></munderover><mo class='MathClass-open' stretchy='false'>(</mo><msubsup><mrow><mi>c</mi></mrow><mrow><mi>a</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>i</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msubsup><mo class='MathClass-bin' stretchy='false'>⋅</mo><msubsup><mrow><mi>c</mi></mrow><mrow><mi>b</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>i</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msubsup><mo class='MathClass-close' stretchy='false'>)</mo><msub><mrow><mi>y</mi></mrow><mrow><mi>i</mi></mrow></msub><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow></msub><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi>q</mi></mrow></math>
</p><!-- l. 888 --><p class='indent'>   <!-- l. 888 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-rel' stretchy='false'>⟺</mo><mo class='MathClass-open' stretchy='false'>(</mo><msubsup><mrow><mi>c</mi></mrow><mrow><mi>a</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mn>1</mn></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msubsup><mo class='MathClass-bin' stretchy='false'>⋅</mo><msubsup><mrow><mi>c</mi></mrow><mrow><mi>b</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mn>1</mn></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msubsup><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><msubsup><mrow><mi>c</mi></mrow><mrow><mi>a</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mn>2</mn></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msubsup><mo class='MathClass-bin' stretchy='false'>⋅</mo><msubsup><mrow><mi>c</mi></mrow><mrow><mi>b</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mn>2</mn></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msubsup><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><msubsup><mrow><mi>c</mi></mrow><mrow><mi>a</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>k</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msubsup><mo class='MathClass-bin' stretchy='false'>⋅</mo><msubsup><mrow><mi>c</mi></mrow><mrow><mi>b</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>k</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msubsup><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>∈</mo> <msub><mrow><mi>ℤ</mi></mrow><mrow><msub><mrow><mi>q</mi></mrow><mrow><mn>1</mn></mrow></msub></mrow></msub> <mo class='MathClass-bin' stretchy='false'>×</mo> <msub><mrow><mi>ℤ</mi></mrow><mrow><msub><mrow><mi>q</mi></mrow><mrow><mn>2</mn></mrow></msub></mrow></msub> <mo class='MathClass-bin' stretchy='false'>×</mo><mo class='MathClass-rel' stretchy='false'>⋯</mo> <mo class='MathClass-bin' stretchy='false'>×</mo> <msub><mrow><mi>ℤ</mi></mrow><mrow><msub><mrow><mi>q</mi></mrow><mrow><mi>k</mi></mrow></msub></mrow></msub></mrow></math>
</p><!-- l. 890 --><p class='indent'>   <!-- l. 890 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
                                                                                         
                                                                                         
</p><!-- l. 892 --><p class='indent'>   Using the above isomorphism, we can efficiently compute ciphertext-to-plaintext addition,
ciphertext-to-ciphertext addition, and ciphertext-to-plaintext multiplication of big polynomial coefficients
(e.g., 1000 bits big) based on small RNS residues (e.g., 30 bits each).
   
</p>
   <h5 class='subsubsectionHead' id='key-switching'><span class='titlemark'>D-5.10.2   </span> <a id='x153-238000D-5.10.2'></a>Key Switching</h5>
<!-- l. 898 --><p class='noindent'>In BFV or CKKS, an RNS-based ciphertext’s key-switching operation from
<!-- l. 898 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>S</mi> <mo class='MathClass-rel' stretchy='false'>→</mo><msup><mrow><mi>S</mi></mrow><mrow><mi>′</mi></mrow></msup></mrow></math> is
performed by computing the following formula in RNS vectors:
</p><!-- l. 900 --><p class='indent'>   <!-- l. 900 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖱𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><msup><mrow><mi>S</mi></mrow><mrow><mi>′</mi></mrow></msup><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mi mathvariant='normal'>Δ</mi><mi>M</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo> <mi>B</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mstyle mathvariant='bold'><mo class='MathClass-open' stretchy='false'>⟨</mo></mstyle><msup><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖣𝖾𝖼𝗈𝗆𝗉</mtext></mstyle></mrow><mrow><mi>β</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>l</mi></mrow></msup><mo class='MathClass-open' stretchy='false'>(</mo><mi>A</mi><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><msubsup><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖱𝖫𝖾𝗏</mtext></mstyle></mrow><mrow><msup><mrow><mi>S</mi></mrow><mrow><mi>′</mi></mrow></msup><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow><mrow><mi>β</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>l</mi></mrow></msubsup><mo class='MathClass-open' stretchy='false'>(</mo><mi>S</mi><mo class='MathClass-close' stretchy='false'>)</mo><mstyle mathvariant='bold'><mo class='MathClass-close' stretchy='false'>⟩</mo></mstyle></mrow></math>
</p><!-- l. 903 --><p class='indent'>   <!-- l. 903 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 905 --><p class='indent'>   In the above formula, the computation of <!-- l. 905 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mstyle mathvariant='bold'><mo class='MathClass-open' stretchy='false'>⟨</mo></mstyle><msup><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖣𝖾𝖼𝗈𝗆𝗉</mtext></mstyle></mrow><mrow><mi>β</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>l</mi></mrow></msup><mo class='MathClass-open' stretchy='false'>(</mo><mi>A</mi><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><msubsup><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖱𝖫𝖾𝗏</mtext></mstyle></mrow><mrow><msup><mrow><mi>S</mi></mrow><mrow><mi>′</mi></mrow></msup><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow><mrow><mi>β</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>l</mi></mrow></msubsup><mo class='MathClass-open' stretchy='false'>(</mo><mi>S</mi><mo class='MathClass-close' stretchy='false'>)</mo><mstyle mathvariant='bold'><mo class='MathClass-close' stretchy='false'>⟩</mo></mstyle></mrow></math>
can be performed by using <!-- l. 905 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖣𝖾𝖼𝗈𝗆𝗉𝖬𝗎𝗅𝗍<msub><mrow></mrow><mtext>𝖱𝖭𝖲</mtext></msub></mtext></mstyle></math>
(Summary <a href='DecomposingMultiplicationtextsfDecompMulttextsubscriptRNS.html#decomposing-multiplication-decompmult-rns'>D-5.9<!-- tex4ht:ref: subsec:rns-decompmult  --></a> in <a href='DecomposingMultiplicationtextsfDecompMulttextsubscriptRNS.html#decomposing-multiplication-decompmult-rns'><span class='ts1-lmr10-x-x-109'>§</span>D-5.9<!-- tex4ht:ref: subsec:rns-decompmult  --></a>), after which <!-- l. 905 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>B</mi></math>
can be added to it by using regular RNS-based addition.
</p><!-- l. 907 --><p class='indent'>   <!-- l. 907 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 909 --><p class='indent'>   Similarly, in the case of the BGV, an RNS-based key-switching operation on a ciphertext from
<!-- l. 909 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>S</mi> <mo class='MathClass-rel' stretchy='false'>→</mo><msup><mrow><mi>S</mi></mrow><mrow><mi>′</mi></mrow></msup></mrow></math> is
performed by computing the following in RNS vectors:
</p><!-- l. 911 --><p class='indent'>   <!-- l. 911 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖱𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><msup><mrow><mi>S</mi></mrow><mrow><mi>′</mi></mrow></msup><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mi>M</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo> <mi>B</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mstyle mathvariant='bold'><mo class='MathClass-open' stretchy='false'>⟨</mo></mstyle><msup><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖣𝖾𝖼𝗈𝗆𝗉</mtext></mstyle></mrow><mrow><mi>β</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>l</mi></mrow></msup><mo class='MathClass-open' stretchy='false'>(</mo><mi>A</mi><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><msubsup><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖱𝖫𝖾𝗏</mtext></mstyle></mrow><mrow><msup><mrow><mi>S</mi></mrow><mrow><mi>′</mi></mrow></msup><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow><mrow><mi>β</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>l</mi></mrow></msubsup><mo class='MathClass-open' stretchy='false'>(</mo><mi>S</mi><mo class='MathClass-close' stretchy='false'>)</mo><mstyle mathvariant='bold'><mo class='MathClass-close' stretchy='false'>⟩</mo></mstyle></mrow></math>
   
</p>
   <h5 class='subsubsectionHead' id='input-slot-rotation'><span class='titlemark'>D-5.10.3   </span> <a id='x153-239000D-5.10.3'></a>Input Slot Rotation</h5>
<!-- l. 917 --><p class='noindent'>In BFV or CKKS, an RNS-based ciphertext’s input slot rotation is performed by computing the following
formulas in RNS vectors:
</p><!-- l. 919 --><p class='indent'>   <!-- l. 919 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 922 --><p class='indent'>
   </p><dl class='enumerate-enumitem'><dt class='enumerate-enumitem'>
1. </dt><dd class='enumerate-enumitem'><!-- l. 922 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖱𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mi>S</mi><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>X</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>h</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mstyle mathvariant='bold'><mo class='MathClass-open' stretchy='false'>(</mo></mstyle><mi mathvariant='normal'>Δ</mi><mi>M</mi><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>X</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>h</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mstyle mathvariant='bold'><mo class='MathClass-close' stretchy='false'>)</mo></mstyle> <mo class='MathClass-rel' stretchy='false'>=</mo> <mstyle mathvariant='bold'><mo class='MathClass-open' stretchy='false'>(</mo></mstyle><mi>A</mi><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>X</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>h</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>,
   <!-- l. 922 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>B</mi><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>X</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>h</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mstyle mathvariant='bold'><mo class='MathClass-close' stretchy='false'>)</mo></mstyle></mrow></math>
   <span id='textcolor262'># where <!-- l. 922 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>h</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo> <msup><mrow><mn>5</mn></mrow><mrow><mi>h</mi></mrow></msup><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mn>2</mn><mi>n</mi></mrow></math></span>
   </dd><dt class='enumerate-enumitem'>
2. </dt><dd class='enumerate-enumitem'>Key-switch <!-- l. 924 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖱𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mi>S</mi><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>X</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>h</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mstyle mathvariant='bold'><mo class='MathClass-open' stretchy='false'>(</mo></mstyle><mi mathvariant='normal'>Δ</mi><mi>M</mi><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>X</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>h</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mstyle mathvariant='bold'><mo class='MathClass-close' stretchy='false'>)</mo></mstyle></mrow></math>
   to <!-- l. 924 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖱𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mi>S</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mstyle mathvariant='bold'><mo class='MathClass-open' stretchy='false'>(</mo></mstyle><mi mathvariant='normal'>Δ</mi><mi>M</mi><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>X</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>h</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mstyle mathvariant='bold'><mo class='MathClass-close' stretchy='false'>)</mo></mstyle></mrow></math></dd></dl>
<!-- l. 927 --><p class='indent'>   <!-- l. 927 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 929 --><p class='indent'>   Step 1 is equivalent to re-positioning the coefficients within each polynomial and flipping their signs whenever they cross
the boundary of the <!-- l. 929 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>n</mi></math>-th
degree term. This step can be done with RNS-based coefficients by moving around each set of RNS
residue vectors as a whole whenever the coefficient they represent is re-positioned to a new degree term,
and flipping the signs of the residues in the same RNS vector altogether whenever their representing
coefficient’s sign is to be flipped. Step 2’s RNS-based key switching can be done in the same way as
                                                                                         
                                                                                         
explained in the previous subsection (<a href='#key-switching'><span class='ts1-lmr10-x-x-109'>§</span>D-5.10.2<!-- tex4ht:ref: subsec:rns-decompmult  --></a>).
</p><!-- l. 931 --><p class='indent'>   <!-- l. 931 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 933 --><p class='indent'>   Similarly, in BGV, an RNS-based ciphertext’s input slot rotation is performed by computing the
following formulas in RNS vectors:
</p><!-- l. 935 --><p class='indent'>   <!-- l. 935 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 938 --><p class='indent'>
   </p><dl class='enumerate-enumitem'><dt class='enumerate-enumitem'>
1. </dt><dd class='enumerate-enumitem'><!-- l. 938 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖱𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mi>S</mi><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>X</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>h</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mstyle mathvariant='bold'><mo class='MathClass-open' stretchy='false'>(</mo></mstyle><mi>M</mi><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>X</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>h</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mstyle mathvariant='bold'><mo class='MathClass-close' stretchy='false'>)</mo></mstyle> <mo class='MathClass-rel' stretchy='false'>=</mo> <mstyle mathvariant='bold'><mo class='MathClass-open' stretchy='false'>(</mo></mstyle><mi>A</mi><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>X</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>h</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>,
   <!-- l. 938 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>B</mi><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>X</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>h</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mstyle mathvariant='bold'><mo class='MathClass-close' stretchy='false'>)</mo></mstyle></mrow></math>
   <span id='textcolor263'># where <!-- l. 938 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>h</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo> <msup><mrow><mn>5</mn></mrow><mrow><mi>h</mi></mrow></msup><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mn>2</mn><mi>n</mi></mrow></math></span>
   </dd><dt class='enumerate-enumitem'>
2. </dt><dd class='enumerate-enumitem'>Key-switch <!-- l. 940 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖱𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mi>S</mi><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>X</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>h</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mstyle mathvariant='bold'><mo class='MathClass-open' stretchy='false'>(</mo></mstyle><mi>M</mi><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>X</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>h</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mstyle mathvariant='bold'><mo class='MathClass-close' stretchy='false'>)</mo></mstyle></mrow></math>
   to <!-- l. 940 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖱𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mi>S</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mstyle mathvariant='bold'><mo class='MathClass-open' stretchy='false'>(</mo></mstyle><mi>M</mi><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>X</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>h</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mstyle mathvariant='bold'><mo class='MathClass-close' stretchy='false'>)</mo></mstyle></mrow></math></dd></dl>
<!-- l. 943 --><p class='indent'>   <!-- l. 943 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 945 --><p class='indent'>   We can compute the above formulas in RNS by using the same strategy explained for BFV or
CKKS.
   
</p>
   <h5 class='subsubsectionHead' id='bfvs-ciphertexttociphertext-multiplication'><span class='titlemark'>D-5.10.4   </span> <a id='x153-240000D-5.10.4'></a>BFV’s Ciphertext-to-Ciphertext Multiplication</h5>
<!-- l. 953 --><p class='noindent'>BFV’s ciphertext-to-ciphertext multiplication (Summary <a href='CiphertexttoCiphertextMultiplication.html#summary1'>D-2.7.5<!-- tex4ht:ref: subsubsec:bfv-mult-cipher-summary  --></a> in <a href='CiphertexttoCiphertextMultiplication.html#summary1'><span class='ts1-lmr10-x-x-109'>§</span>D-2.7.5<!-- tex4ht:ref: subsubsec:bfv-mult-cipher-summary  --></a>) comprises <span class='rm-lmss-10x-x-109'>ModRaise</span>
<!-- l. 953 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>→</mo></mrow></math> polynomial
multiplication <!-- l. 953 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>→</mo></mrow></math>
relinearization <!-- l. 953 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>→</mo></mrow></math>
rescaling, where the order of relinearization and rescaling can be swapped. In RNS-based ciphertext-to-ciphertext
multiplication, we will swap the order of these two steps. The procedure is as follows: (1) <span class='rm-lmss-10x-x-109'>ModRaise</span><sub><span class='rm-lmss-10x-x-109'>RNS</span></sub>
from <!-- l. 953 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>q</mi> <mo class='MathClass-rel' stretchy='false'>→</mo><mi mathvariant='italic'>𝑞𝑏</mi></mrow></math>;
(2) polynomial multiplication; (3) constant multiplication by
<!-- l. 953 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>t</mi></math>; (4) <span class='rm-lmss-10x-x-109'>ModSwitch </span>from
<!-- l. 953 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi mathvariant='italic'>𝑞𝑏</mi> <mo class='MathClass-rel' stretchy='false'>→</mo><mi>b</mi></mrow></math>; (5) <span class='rm-lmss-10x-x-109'>FastBConvEx </span>from
<!-- l. 954 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>b</mi> <mo class='MathClass-rel' stretchy='false'>→</mo><mi>q</mi></mrow></math>; and (6) relinearization.
Among these, step <!-- l. 954 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mn>3</mn> <mo class='MathClass-rel' stretchy='false'>∼</mo><mn>5</mn></mrow></math>
corresponds to the rescaling operation. We will explain how each of these steps works.
</p><!-- l. 956 --><p class='indent'>   <!-- l. 956 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 959 --><p class='indent'>
   </p><dl class='enumerate-enumitem'><dt class='enumerate-enumitem'>
1. </dt><dd class='enumerate-enumitem'><span class='underline'><span class='rm-lmssbx-10x-x-109'>ModRaise</span><sub><span class='rm-lmssbx-10x-x-109'>RNS</span></sub></span> <span class='rm-lmbx-10x-x-109'>from </span><!-- l. 960 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>q</mi> <mo class='MathClass-rel' stretchy='false'>→</mo><mi mathvariant='italic'>𝑞𝑏</mi><msub><mrow><mi>b</mi></mrow><mrow><mi>α</mi></mrow></msub></mrow></math><span class='rm-lmbx-10x-x-109'>:</span>
   <!-- l. 962 --><p class='noindent'>Let <!-- l. 962 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>b</mi></math>
   be a new RNS base where <!-- l. 962 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>b</mi> <mo class='MathClass-rel' stretchy='false'>&gt;</mo> <mi mathvariant='normal'>Δ</mi></mrow></math>
   so that <!-- l. 962 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi mathvariant='italic'>𝑞𝑏</mi></mrow></math>
   is large enough to prevent a multiplied scaled plaintext in ciphertexts (i.e., <!-- l. 962 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi mathvariant='normal'>Δ</mi></mrow><mrow><mn>2</mn></mrow></msup><msup><mrow><mi>M</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup><msup><mrow><mi>M</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup></mrow></math>)
   from exceeding its allowed limit (Summary <a href='EncryptionandDecryption1.html#encryption-and-decryption1'>D-2.3<!-- tex4ht:ref: subsec:bfv-enc-dec  --></a> in <a href='EncryptionandDecryption1.html#encryption-and-decryption1'><span class='ts1-lmr10-x-x-109'>§</span>D-2.3<!-- tex4ht:ref: subsec:bfv-enc-dec  --></a>) during ciphertext-to-ciphertext
   multiplication. <!-- l. 962 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>b</mi></mrow><mrow><mi>α</mi></mrow></msub></math>
   is also added for exact fast base conversion to be performed later. Specifically, we mod-raise the
                                                                                         
                                                                                         
   modulus of each polynomial coefficient of ciphertexts <!-- l. 963 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>A</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup><mo class='MathClass-punc' stretchy='false'>,</mo><msup><mrow><mi>B</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
   and <!-- l. 963 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>A</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup><mo class='MathClass-punc' stretchy='false'>,</mo><msup><mrow><mi>B</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
   as follows:
   </p><!-- l. 979 --><p class='noindent'><!-- l. 979 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>Â</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup><mo class='MathClass-punc' stretchy='false'>,</mo><msup><mrow><mover accent='true'><mrow><mi>B</mi></mrow><mo accent='true'>^</mo></mover></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>A</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msubsup><mrow><mi>U</mi></mrow><mrow><mi>A</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msubsup><mi>q</mi><mo class='MathClass-punc' stretchy='false'>,</mo><msup><mrow><mi>B</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msubsup><mrow><mi>U</mi></mrow><mrow><mi>B</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msubsup><mi>q</mi><mo class='MathClass-close' stretchy='false'>)</mo><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi mathvariant='italic'>𝑞𝑏</mi><msub><mrow><mi>b</mi></mrow><mrow><mi>α</mi></mrow></msub></mrow></math>
   </p><!-- l. 981 --><p class='noindent'><!-- l. 981 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>Â</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup><mo class='MathClass-punc' stretchy='false'>,</mo><msup><mrow><mover accent='true'><mrow><mi>B</mi></mrow><mo accent='true'>^</mo></mover></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>A</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msubsup><mrow><mi>U</mi></mrow><mrow><mi>A</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msubsup><mi>q</mi><mo class='MathClass-punc' stretchy='false'>,</mo><msup><mrow><mi>B</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msubsup><mrow><mi>U</mi></mrow><mrow><mi>B</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msubsup><mi>q</mi><mo class='MathClass-close' stretchy='false'>)</mo><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi mathvariant='italic'>𝑞𝑏</mi><msub><mrow><mi>b</mi></mrow><mrow><mi>α</mi></mrow></msub></mrow></math>
   </p><!-- l. 983 --><p class='noindent'><!-- l. 983 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
   </p><!-- l. 985 --><p class='noindent'>, where each coefficient of <!-- l. 985 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msubsup><mrow><mi>U</mi></mrow><mrow><mi>A</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msubsup><mo class='MathClass-punc' stretchy='false'>,</mo><msubsup><mrow><mi>U</mi></mrow><mrow><mi>B</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msubsup><mo class='MathClass-punc' stretchy='false'>,</mo><msubsup><mrow><mi>U</mi></mrow><mrow><mi>A</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msubsup><mo class='MathClass-punc' stretchy='false'>,</mo><msubsup><mrow><mi>U</mi></mrow><mrow><mi>B</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msubsup></mrow></math>
   is either <!-- l. 985 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>{</mo><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>0</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>}</mo></mrow></math>.
   Decrypting these two (noisy) ciphertexts with the private key <!-- l. 985 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>S</mi></math>
   would give the following outputs:
   </p><!-- l. 987 --><p class='noindent'><!-- l. 987 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>Â</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup><mo class='MathClass-bin' stretchy='false'>⋅</mo><mi>S</mi> <mo class='MathClass-bin' stretchy='false'>+</mo><msup><mrow> <mover accent='true'><mrow><mi>B</mi></mrow><mo accent='true'>^</mo></mover></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'>mod</mo><mspace width='0.2em'></mspace> <mi mathvariant='italic'>𝑞𝑏</mi><msub><mrow><mi>b</mi></mrow><mrow><mi>α</mi></mrow></msub></mrow></math>
   </p><!-- l. 989 --><p class='noindent'><!-- l. 989 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>A</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msubsup><mrow><mi>U</mi></mrow><mrow><mi>A</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msubsup><mi>q</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mi>S</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>B</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msubsup><mrow><mi>U</mi></mrow><mrow><mi>B</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msubsup><mi>q</mi><mo class='MathClass-close' stretchy='false'>)</mo><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi mathvariant='italic'>𝑞𝑏</mi><msub><mrow><mi>b</mi></mrow><mrow><mi>α</mi></mrow></msub></mrow></math>
   </p><!-- l. 991 --><p class='noindent'><!-- l. 991 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo> <msup><mrow><mi>A</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup><mo class='MathClass-bin' stretchy='false'>⋅</mo><mi>S</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>B</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msubsup><mrow><mi>U</mi></mrow><mrow><mi>A</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msubsup><mi>q</mi> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mi>S</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msubsup><mrow><mi>U</mi></mrow><mrow><mi>B</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msubsup><mi>q</mi><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi mathvariant='italic'>𝑞𝑏</mi><msub><mrow><mi>b</mi></mrow><mrow><mi>α</mi></mrow></msub></mrow></math>
   </p><!-- l. 993 --><p class='noindent'><!-- l. 993 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo> <mi mathvariant='normal'>Δ</mi><msup><mrow><mi>M</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>E</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msubsup><mrow><mi>U</mi></mrow><mrow><mi>A</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msubsup><mi>q</mi> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mi>S</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msubsup><mrow><mi>U</mi></mrow><mrow><mi>B</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msubsup><mi>q</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>K</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup><mi>q</mi><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi mathvariant='italic'>𝑞𝑏</mi><msub><mrow><mi>b</mi></mrow><mrow><mi>α</mi></mrow></msub></mrow></math>
   <span id='textcolor264'># where <!-- l. 993 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>K</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup><mi>q</mi></mrow></math>
   is the <!-- l. 993 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>q</mi></math>-overflows
   of the decryption process</span>
   </p><!-- l. 995 --><p class='noindent'><!-- l. 995 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
   </p><!-- l. 997 --><p class='noindent'><!-- l. 997 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>Â</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup><mo class='MathClass-bin' stretchy='false'>⋅</mo><mi>S</mi> <mo class='MathClass-bin' stretchy='false'>+</mo><msup><mrow> <mover accent='true'><mrow><mi>B</mi></mrow><mo accent='true'>^</mo></mover></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'>mod</mo><mspace width='0.2em'></mspace> <mi mathvariant='italic'>𝑞𝑏</mi><msub><mrow><mi>b</mi></mrow><mrow><mi>α</mi></mrow></msub></mrow></math>
   </p><!-- l. 999 --><p class='noindent'><!-- l. 999 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>A</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msubsup><mrow><mi>U</mi></mrow><mrow><mi>A</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msubsup><mi>q</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mi>S</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>B</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msubsup><mrow><mi>U</mi></mrow><mrow><mi>B</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msubsup><mi>q</mi><mo class='MathClass-close' stretchy='false'>)</mo><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi mathvariant='italic'>𝑞𝑏</mi><msub><mrow><mi>b</mi></mrow><mrow><mi>α</mi></mrow></msub></mrow></math>
   </p><!-- l. 1001 --><p class='noindent'><!-- l. 1001 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo> <msup><mrow><mi>A</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup><mo class='MathClass-bin' stretchy='false'>⋅</mo><mi>S</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>B</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msubsup><mrow><mi>U</mi></mrow><mrow><mi>A</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msubsup><mi>q</mi> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mi>S</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msubsup><mrow><mi>U</mi></mrow><mrow><mi>B</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msubsup><mi>q</mi><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi mathvariant='italic'>𝑞𝑏</mi><msub><mrow><mi>b</mi></mrow><mrow><mi>α</mi></mrow></msub></mrow></math>
   </p><!-- l. 1003 --><p class='noindent'><!-- l. 1003 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo> <mi mathvariant='normal'>Δ</mi><msup><mrow><mi>M</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>E</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msubsup><mrow><mi>U</mi></mrow><mrow><mi>A</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msubsup><mi>q</mi> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mi>S</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msubsup><mrow><mi>U</mi></mrow><mrow><mi>B</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msubsup><mi>q</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>K</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup><mi>q</mi><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi mathvariant='italic'>𝑞𝑏</mi><msub><mrow><mi>b</mi></mrow><mrow><mi>α</mi></mrow></msub></mrow></math>
   </p><!-- l. 1006 --><p class='noindent'><!-- l. 1006 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
   </p></dd><dt class='enumerate-enumitem'>
2. </dt><dd class='enumerate-enumitem'><span class='underline'><span class='rm-lmbx-10x-x-109'>Polynomial Multiplication:</span></span>
   <!-- l. 1010 --><p class='noindent'>Compute <!-- l. 1010 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mover accent='true'><mrow><mi>B</mi></mrow><mo accent='true'>^</mo></mover></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup><msup><mrow><mover accent='true'><mrow><mi>B</mi></mrow><mo accent='true'>^</mo></mover></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup><mo class='MathClass-punc' stretchy='false'>,</mo><msup><mrow><mi>Â</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup><msup><mrow><mover accent='true'><mrow><mi>B</mi></mrow><mo accent='true'>^</mo></mover></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo><msup><mrow> <mi>Â</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup><msup><mrow><mi>B</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup><mo class='MathClass-punc' stretchy='false'>,</mo><msup><mrow><mi>Â</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup><msup><mrow><mi>Â</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi mathvariant='italic'>𝑞𝑏</mi><msub><mrow><mi>b</mi></mrow><mrow><mi>α</mi></mrow></msub></mrow></math>,
   whose decryption relation is as follows:
   </p><!-- l. 1012 --><p class='noindent'><!-- l. 1012 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mover accent='true'><mrow><mi>B</mi></mrow><mo accent='true'>^</mo></mover></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup><msup><mrow><mover accent='true'><mrow><mi>B</mi></mrow><mo accent='true'>^</mo></mover></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>Â</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup><msup><mrow><mover accent='true'><mrow><mi>B</mi></mrow><mo accent='true'>^</mo></mover></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo><msup><mrow> <mi>Â</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup><msup><mrow><mi>B</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mi>S</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>Â</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup><msup><mrow><mi>Â</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>S</mi></mrow><mrow><mn>2</mn></mrow></msup><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi mathvariant='italic'>𝑞𝑏</mi><msub><mrow><mi>b</mi></mrow><mrow><mi>α</mi></mrow></msub></mrow></math>
   </p><!-- l. 1014 --><p class='noindent'><!-- l. 1014 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>Â</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup><mo class='MathClass-bin' stretchy='false'>⋅</mo><mi>S</mi> <mo class='MathClass-bin' stretchy='false'>+</mo><msup><mrow> <mover accent='true'><mrow><mi>B</mi></mrow><mo accent='true'>^</mo></mover></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>Â</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup><mo class='MathClass-bin' stretchy='false'>⋅</mo><mi>S</mi> <mo class='MathClass-bin' stretchy='false'>+</mo><msup><mrow> <mover accent='true'><mrow><mi>B</mi></mrow><mo accent='true'>^</mo></mover></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi mathvariant='italic'>𝑞𝑏</mi><msub><mrow><mi>b</mi></mrow><mrow><mi>α</mi></mrow></msub></mrow></math>
   </p><!-- l. 1016 --><p class='noindent'><!-- l. 1016 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>(</mo><mi mathvariant='normal'>Δ</mi><msup><mrow><mi>M</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo><msup><mrow><mi>E</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo><msubsup><mrow><mi>U</mi></mrow><mrow><mi>A</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msubsup><mi>q</mi><mo class='MathClass-bin' stretchy='false'>⋅</mo><mi>S</mi><mo class='MathClass-bin' stretchy='false'>+</mo><msubsup><mrow><mi>U</mi></mrow><mrow><mi>B</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msubsup><mi>q</mi><mo class='MathClass-bin' stretchy='false'>+</mo><msup><mrow><mi>K</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup><mi>q</mi><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-bin' stretchy='false'>⋅</mo><mo class='MathClass-open' stretchy='false'>(</mo><mi mathvariant='normal'>Δ</mi><msup><mrow><mi>M</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo><msup><mrow><mi>E</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo><msubsup><mrow><mi>U</mi></mrow><mrow><mi>A</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msubsup><mi>q</mi><mo class='MathClass-bin' stretchy='false'>⋅</mo><mi>S</mi><mo class='MathClass-bin' stretchy='false'>+</mo><msubsup><mrow><mi>U</mi></mrow><mrow><mi>B</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msubsup><mi>q</mi><mo class='MathClass-bin' stretchy='false'>+</mo><msup><mrow><mi>K</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup><mi>q</mi><mo class='MathClass-close' stretchy='false'>)</mo><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'>mod</mo><mspace width='0.2em'></mspace><mi mathvariant='italic'>𝑞𝑏</mi><msub><mrow><mi>b</mi></mrow><mrow><mi>α</mi></mrow></msub></mrow></math>
   </p><!-- l. 1018 --><p class='noindent'><!-- l. 1018 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
   </p></dd><dt class='enumerate-enumitem'>
3. </dt><dd class='enumerate-enumitem'><span class='underline'><span class='rm-lmbx-10x-x-109'>Constant Multiplication</span></span> <span class='rm-lmbx-10x-x-109'>by </span><!-- l. 1020 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mstyle mathvariant='bold'><mi>𝐭</mi></mstyle></math><span class='rm-lmbx-10x-x-109'>:</span>
   <!-- l. 1022 --><p class='noindent'>Step <!-- l. 1022 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mn>3</mn> <mo class='MathClass-rel' stretchy='false'>∼</mo><mn>5</mn></mrow></math>
   are equivalent to rescaling the plaintext’s scaling factor from <!-- l. 1022 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi mathvariant='normal'>Δ</mi></mrow><mrow><mn>2</mn></mrow></msup> <mo class='MathClass-rel' stretchy='false'>→</mo><mi mathvariant='normal'>Δ</mi></mrow></math>
   as well as switching the ciphertext’s modulus from <!-- l. 1022 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi mathvariant='italic'>𝑞𝑏</mi><msub><mrow><mi>b</mi></mrow><mrow><mi>α</mi></mrow></msub></mrow></math>
   to <!-- l. 1022 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>q</mi></math>.
   In this step, we multiply <!-- l. 1023 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>t</mi></math>
   to each coefficient of the resulting polynomials from the previous step as follows:
   </p><!-- l. 1025 --><p class='noindent'><!-- l. 1025 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><mi>t</mi> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mover accent='true'><mrow><mi>B</mi></mrow><mo accent='true'>^</mo></mover></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup><msup><mrow><mover accent='true'><mrow><mi>B</mi></mrow><mo accent='true'>^</mo></mover></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><mi>t</mi> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>Â</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup><msup><mrow><mover accent='true'><mrow><mi>B</mi></mrow><mo accent='true'>^</mo></mover></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <mi>t</mi> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>Â</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup><msup><mrow><mi>B</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><mi>t</mi> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>Â</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup><msup><mrow><mi>Â</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi mathvariant='italic'>𝑞𝑏</mi><msub><mrow><mi>b</mi></mrow><mrow><mi>α</mi></mrow></msub></mrow></math>
   </p><!-- l. 1027 --><p class='noindent'><!-- l. 1027 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
   </p><!-- l. 1029 --><p class='noindent'>, which is equivalent to a ciphertext encrypting the following plaintext:
   </p><!-- l. 1031 --><p class='noindent'><!-- l. 1031 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>t</mi><mo class='MathClass-bin' stretchy='false'>⋅</mo><mo class='MathClass-open' stretchy='false'>(</mo><mi mathvariant='normal'>Δ</mi><msup><mrow><mi>M</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo><msup><mrow><mi>E</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo><msubsup><mrow><mi>U</mi></mrow><mrow><mi>A</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msubsup><mi>q</mi><mo class='MathClass-bin' stretchy='false'>⋅</mo><mi>S</mi><mo class='MathClass-bin' stretchy='false'>+</mo><msubsup><mrow><mi>U</mi></mrow><mrow><mi>B</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msubsup><mi>q</mi><mo class='MathClass-bin' stretchy='false'>+</mo><msup><mrow><mi>K</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup><mi>q</mi><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-bin' stretchy='false'>⋅</mo><mo class='MathClass-open' stretchy='false'>(</mo><mi mathvariant='normal'>Δ</mi><msup><mrow><mi>M</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo><msup><mrow><mi>E</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo><msubsup><mrow><mi>U</mi></mrow><mrow><mi>A</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msubsup><mi>q</mi><mo class='MathClass-bin' stretchy='false'>⋅</mo><mi>S</mi><mo class='MathClass-bin' stretchy='false'>+</mo><msubsup><mrow><mi>U</mi></mrow><mrow><mi>B</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msubsup><mi>q</mi><mo class='MathClass-bin' stretchy='false'>+</mo><msup><mrow><mi>K</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup><mi>q</mi><mo class='MathClass-close' stretchy='false'>)</mo><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'>mod</mo><mspace width='0.2em'></mspace><mi mathvariant='italic'>𝑞𝑏</mi><msub><mrow><mi>b</mi></mrow><mrow><mi>α</mi></mrow></msub></mrow></math>
   </p><!-- l. 1033 --><p class='noindent'><!-- l. 1033 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
   </p></dd><dt class='enumerate-enumitem'>
                                                                                         
                                                                                         
4. </dt><dd class='enumerate-enumitem'><span class='underline'><span class='rm-lmssbx-10x-x-109'>ModSwitch</span><sub><span class='rm-lmssbx-10x-x-109'>RNS</span></sub></span> <span class='rm-lmbx-10x-x-109'>from </span><!-- l. 1049 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi mathvariant='italic'>𝑞𝑏</mi><msub><mrow><mi>b</mi></mrow><mrow><mi>α</mi></mrow></msub> <mo class='MathClass-rel' stretchy='false'>→</mo><mi>b</mi><msub><mrow><mi>b</mi></mrow><mrow><mi>α</mi></mrow></msub></mrow></math><span class='rm-lmbx-10x-x-109'>:</span>
   <!-- l. 1051 --><p class='noindent'>We switch the modulus of the ciphertext from <!-- l. 1051 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi mathvariant='italic'>𝑞𝑏</mi></mrow></math>
   to <!-- l. 1051 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>b</mi></math>
   by using <span class='rm-lmss-10x-x-109'>ModSwitch</span><sub><span class='rm-lmss-10x-x-109'>RNS</span></sub> as follows:
   </p><!-- l. 1061 --><p class='noindent'><!-- l. 1061 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mrow><mo fence='true' form='prefix'>(</mo><mrow><mrow><mo fence='true' form='prefix'>⌈</mo><mrow><mstyle displaystyle='true'><mfrac><mrow><mi>t</mi> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mover accent='true'><mrow><mi>B</mi></mrow><mo accent='true'>^</mo></mover></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup><msup><mrow><mover accent='true'><mrow><mi>B</mi></mrow><mo accent='true'>^</mo></mover></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup>
      </mrow><mrow><mi>q</mi>       </mrow></mfrac></mstyle></mrow><mo fence='true' form='postfix'>⌋</mo></mrow><mo class='MathClass-punc' stretchy='false'>,</mo> <mrow><mo fence='true' form='prefix'>⌈</mo><mrow><mstyle displaystyle='true'><mfrac><mrow><mi>t</mi> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>Â</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup><msup><mrow><mover accent='true'><mrow><mi>B</mi></mrow><mo accent='true'>^</mo></mover></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <mi>t</mi> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>Â</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup><msup><mrow><mi>B</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup>
             </mrow><mrow><mi>q</mi>               </mrow></mfrac></mstyle></mrow><mo fence='true' form='postfix'>⌋</mo></mrow><mo class='MathClass-punc' stretchy='false'>,</mo> <mrow><mo fence='true' form='prefix'>⌈</mo><mrow><mstyle displaystyle='true'><mfrac><mrow><mi>t</mi> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>Â</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup><msup><mrow><mi>Â</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup>
     </mrow><mrow><mi>q</mi>       </mrow></mfrac></mstyle></mrow><mo fence='true' form='postfix'>⌋</mo></mrow></mrow><mo fence='true' form='postfix'>)</mo></mrow><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi>b</mi><msub><mrow><mi>b</mi></mrow><mrow><mi>α</mi></mrow></msub></mrow></math>
   </p><!-- l. 1063 --><p class='noindent'><!-- l. 1063 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
   </p><!-- l. 1065 --><p class='noindent'>, which is (almost, considering the rounding error) equivalent to a ciphertext encrypting the
   following plaintext:
   </p><!-- l. 1067 --><p class='noindent'><!-- l. 1067 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mrow><mo fence='true' form='prefix'>⌈</mo><mrow><mstyle displaystyle='true'><mfrac><mrow><mi>t</mi> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mo class='MathClass-open' stretchy='false'>(</mo><mi mathvariant='normal'>Δ</mi><msup><mrow><mi>M</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>E</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msubsup><mrow><mi>U</mi></mrow><mrow><mi>A</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msubsup><mi>q</mi> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mi>S</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msubsup><mrow><mi>U</mi></mrow><mrow><mi>B</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msubsup><mi>q</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>K</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup><mi>q</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mo class='MathClass-open' stretchy='false'>(</mo><mi mathvariant='normal'>Δ</mi><msup><mrow><mi>M</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>E</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msubsup><mrow><mi>U</mi></mrow><mrow><mi>A</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msubsup><mi>q</mi> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mi>S</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msubsup><mrow><mi>U</mi></mrow><mrow><mi>B</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msubsup><mi>q</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>K</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup><mi>q</mi><mo class='MathClass-close' stretchy='false'>)</mo>
                                                              </mrow><mrow><mi>q</mi>                                                     </mrow></mfrac></mstyle></mrow><mo fence='true' form='postfix'>⌋</mo></mrow><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'>mod</mo><mspace width='0.2em'></mspace><mi>b</mi><msub><mrow><mi>b</mi></mrow><mrow><mi>α</mi></mrow></msub></mrow></math>
   </p><!-- l. 1069 --><p class='noindent'><!-- l. 1069 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
   </p><!-- l. 1071 --><p class='noindent'><!-- l. 1071 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo> <mrow><mo fence='true' form='prefix'>⌈</mo><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>M</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <mstyle displaystyle='true'><mfrac><mrow> <mi>t</mi>
</mrow><mrow><mi>q</mi></mrow></mfrac></mstyle> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>E</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msubsup><mrow><mi>U</mi></mrow><mrow><mi>A</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msubsup><mi>t</mi> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mi>S</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msubsup><mrow><mi>U</mi></mrow><mrow><mi>B</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msubsup><mi>t</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>K</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup><mi>t</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>𝜖</mi></mrow><mrow><mi>d</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mo class='MathClass-open' stretchy='false'>(</mo><mi mathvariant='normal'>Δ</mi><msup><mrow><mi>M</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>E</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msubsup><mrow><mi>U</mi></mrow><mrow><mi>A</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msubsup><mi>q</mi> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mi>S</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msubsup><mrow><mi>U</mi></mrow><mrow><mi>B</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msubsup><mi>q</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>K</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup><mi>q</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mo fence='true' form='postfix'>⌋</mo></mrow><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'>mod</mo><mspace width='0.2em'></mspace><mi>b</mi><msub><mrow><mi>b</mi></mrow><mrow><mi>α</mi></mrow></msub></mrow></math>
   </p><!-- l. 1073 --><p class='noindent'><span id='textcolor265'># where <!-- l. 1073 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>𝜖</mi></mrow><mrow><mi>d</mi></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo> <mstyle displaystyle='true'><mfrac><mrow> <mi>t</mi>
</mrow><mrow><mi>q</mi></mrow></mfrac></mstyle> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mi mathvariant='normal'>Δ</mi><msup><mrow><mi>M</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup><mo class='MathClass-bin' stretchy='false'>−</mo><msup><mrow><mi>M</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup></mrow></math>
   is a rounding error caused by treating <!-- l. 1073 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mstyle displaystyle='true'><mfrac><mrow><mi>q</mi>
</mrow><mrow><mi>t</mi></mrow></mfrac></mstyle> <mo class='MathClass-rel' stretchy='false'>≈</mo> <mrow><mo fence='true' form='prefix'>⌊</mo><mrow><mstyle displaystyle='true'><mfrac><mrow><mi>q</mi>
</mrow><mrow><mi>t</mi></mrow></mfrac></mstyle></mrow><mo fence='true' form='postfix'>⌋</mo></mrow> <mo class='MathClass-rel' stretchy='false'>=</mo> <mi mathvariant='normal'>Δ</mi></mrow></math></span>
   </p><!-- l. 1077 --><p class='noindent'><!-- l. 1077 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
   </p></dd><dt class='enumerate-enumitem'>
5. </dt><dd class='enumerate-enumitem'><span class='underline'><span class='rm-lmssbx-10x-x-109'>FastBConvEx</span><sub><span class='rm-lmssbx-10x-x-109'>RNS</span></sub></span> <span class='rm-lmbx-10x-x-109'>from </span><!-- l. 1100 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>b</mi> <mo class='MathClass-rel' stretchy='false'>→</mo><mi>q</mi></mrow></math><span class='rm-lmbx-10x-x-109'>:</span>
   <!-- l. 1102 --><p class='noindent'>We exactly convert the base of the ciphertext from <!-- l. 1102 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>b</mi><msub><mrow><mi>b</mi></mrow><mrow><mi>α</mi></mrow></msub> <mo class='MathClass-rel' stretchy='false'>→</mo><mi>q</mi></mrow></math>
   as follows:
   </p><!-- l. 1104 --><p class='noindent'><!-- l. 1104 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mrow><mo fence='true' form='prefix'>(</mo><mrow><mrow><mo fence='true' form='prefix'>⌈</mo><mrow><mstyle displaystyle='true'><mfrac><mrow><mi>t</mi> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mover accent='true'><mrow><mi>B</mi></mrow><mo accent='true'>^</mo></mover></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup><msup><mrow><mover accent='true'><mrow><mi>B</mi></mrow><mo accent='true'>^</mo></mover></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup>
      </mrow><mrow><mi>q</mi>       </mrow></mfrac></mstyle></mrow><mo fence='true' form='postfix'>⌋</mo></mrow><mo class='MathClass-punc' stretchy='false'>,</mo> <mrow><mo fence='true' form='prefix'>⌈</mo><mrow><mstyle displaystyle='true'><mfrac><mrow><mi>t</mi> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>Â</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup><msup><mrow><mover accent='true'><mrow><mi>B</mi></mrow><mo accent='true'>^</mo></mover></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <mi>t</mi> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>Â</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup><msup><mrow><mi>B</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup>
             </mrow><mrow><mi>q</mi>               </mrow></mfrac></mstyle></mrow><mo fence='true' form='postfix'>⌋</mo></mrow><mo class='MathClass-punc' stretchy='false'>,</mo> <mrow><mo fence='true' form='prefix'>⌈</mo><mrow><mstyle displaystyle='true'><mfrac><mrow><mi>t</mi> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>Â</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup><msup><mrow><mi>Â</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup>
     </mrow><mrow><mi>q</mi>       </mrow></mfrac></mstyle></mrow><mo fence='true' form='postfix'>⌋</mo></mrow></mrow><mo fence='true' form='postfix'>)</mo></mrow><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi>q</mi></mrow></math>
   </p><!-- l. 1106 --><p class='noindent'><!-- l. 1106 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
   </p><!-- l. 1108 --><p class='noindent'>, which is equivalent to a ciphertext encrypting the following plaintext:
   </p><!-- l. 1111 --><p class='noindent'><!-- l. 1111 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo> <mrow><mo fence='true' form='prefix'>⌈</mo><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>M</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <mstyle displaystyle='true'><mfrac><mrow> <mi>t</mi>
</mrow><mrow><mi>q</mi></mrow></mfrac></mstyle> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>E</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msubsup><mrow><mi>U</mi></mrow><mrow><mi>A</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msubsup><mi>t</mi> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mi>S</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msubsup><mrow><mi>U</mi></mrow><mrow><mi>B</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msubsup><mi>t</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>K</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup><mi>t</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>𝜖</mi></mrow><mrow><mi>d</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mo class='MathClass-open' stretchy='false'>(</mo><mi mathvariant='normal'>Δ</mi><msup><mrow><mi>M</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>E</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msubsup><mrow><mi>U</mi></mrow><mrow><mi>A</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msubsup><mi>q</mi> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mi>S</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msubsup><mrow><mi>U</mi></mrow><mrow><mi>B</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msubsup><mi>q</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>K</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup><mi>q</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mo fence='true' form='postfix'>⌋</mo></mrow><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'>mod</mo><mspace width='0.2em'></mspace><mi>q</mi></mrow></math>
   </p><!-- l. 1113 --><p class='noindent'><!-- l. 1113 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo> <mstyle mathsize='1.61em'><mrow><mo fence='true' form='prefix'>⌈</mo><mrow></mrow><mo fence='true' form='postfix'></mo></mrow></mstyle><mi mathvariant='normal'>Δ</mi><msup><mrow><mi>M</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup><msup><mrow><mi>M</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <mstyle displaystyle='true'><mfrac><mrow> <mi>t</mi>
</mrow><mrow><mi>q</mi></mrow></mfrac></mstyle> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mi mathvariant='normal'>Δ</mi><msup><mrow><mi>M</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup><msup><mrow><mi>E</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msubsup><mrow><mi>U</mi></mrow><mrow><mi>A</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msubsup><mi>t</mi><mi mathvariant='normal'>Δ</mi><msup><mrow><mi>M</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup><mo class='MathClass-bin' stretchy='false'>⋅</mo><mi>S</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msubsup><mrow><mi>U</mi></mrow><mrow><mi>B</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msubsup><mi>t</mi><mi mathvariant='normal'>Δ</mi><msup><mrow><mi>M</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>M</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup><msup><mrow><mi>E</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <mstyle displaystyle='true'><mfrac><mrow> <mi>t</mi>
</mrow><mrow><mi>q</mi></mrow></mfrac></mstyle> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>E</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup><msup><mrow><mi>E</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup></mrow></math>
   </p><!-- l. 1115 --><p class='noindent'>  <!-- l. 1115 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-bin' stretchy='false'>+</mo><msubsup><mrow><mi>U</mi></mrow><mrow><mi>A</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msubsup><msup><mrow><mi>E</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup><mi>t</mi><mo class='MathClass-bin' stretchy='false'>⋅</mo><mi>S</mi><mo class='MathClass-bin' stretchy='false'>+</mo><msubsup><mrow><mi>U</mi></mrow><mrow><mi>B</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msubsup><msup><mrow><mi>E</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup><mi>t</mi><mo class='MathClass-bin' stretchy='false'>+</mo><msup><mrow><mi>K</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup><mi>t</mi><mi mathvariant='normal'>Δ</mi><msup><mrow><mi>M</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo><msup><mrow><mi>K</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup><mi>t</mi><msup><mrow><mi>E</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo><msub><mrow><mi>𝜖</mi></mrow><mrow><mi>d</mi></mrow></msub><mo class='MathClass-bin' stretchy='false'>⋅</mo><mo class='MathClass-open' stretchy='false'>(</mo><mi mathvariant='normal'>Δ</mi><msup><mrow><mi>M</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo><msup><mrow><mi>E</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo><msubsup><mrow><mi>U</mi></mrow><mrow><mi>A</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msubsup><mi>q</mi><mo class='MathClass-bin' stretchy='false'>⋅</mo><mi>S</mi><mo class='MathClass-bin' stretchy='false'>+</mo><msubsup><mrow><mi>U</mi></mrow><mrow><mi>B</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msubsup><mi>q</mi><mo class='MathClass-bin' stretchy='false'>+</mo><msup><mrow><mi>K</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup><mi>q</mi><mo class='MathClass-close' stretchy='false'>)</mo><mstyle mathsize='1.61em'><mrow><mo fence='true' form='prefix'>⌋</mo><mrow></mrow><mo fence='true' form='postfix'></mo></mrow></mstyle><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'>mod</mo><mspace width='0.2em'></mspace><mi>q</mi></mrow></math>
   </p><!-- l. 1118 --><p class='noindent'><!-- l. 1118 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>≈</mo><mi mathvariant='normal'>Δ</mi><msup><mrow><mi>M</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup><msup><mrow><mi>M</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'>mod</mo><mspace width='0.2em'></mspace> <mi>q</mi></mrow></math>
   <span id='textcolor266'># all other terms are relatively much smaller than <!-- l. 1118 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi mathvariant='normal'>Δ</mi><msup><mrow><mi>M</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup><msup><mrow><mi>M</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup></mrow></math>
   in modulo <!-- l. 1118 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>q</mi></math></span>
   </p><!-- l. 1120 --><p class='noindent'><!-- l. 1120 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
   </p></dd><dt class='enumerate-enumitem'>
6. </dt><dd class='enumerate-enumitem'><span class='underline'><span class='rm-lmbx-10x-x-109'>Relinearization</span></span><span class='rm-lmbx-10x-x-109'>:</span>
   <!-- l. 1147 --><p class='noindent'>Once we have derived the rescaled polynomial triple <!-- l. 1147 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msubsup><mrow><mi>D</mi></mrow><mrow><mn>0</mn></mrow><mrow><mi>′</mi></mrow></msubsup><mo class='MathClass-punc' stretchy='false'>,</mo><msubsup><mrow><mi>D</mi></mrow><mrow><mn>1</mn></mrow><mrow><mi>′</mi></mrow></msubsup><mo class='MathClass-punc' stretchy='false'>,</mo><msubsup><mrow><mi>D</mi></mrow><mrow><mn>2</mn></mrow><mrow><mi>′</mi></mrow></msubsup><mo class='MathClass-close' stretchy='false'>)</mo><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi>q</mi></mrow></math>,
   the final relinearization step is equivalent to deriving the synthetic ciphertexts <!-- l. 1147 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖼𝗍</mtext></mstyle></mrow><mrow><mi>α</mi></mrow></msub></math>
   and <!-- l. 1147 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖼𝗍</mtext></mstyle></mrow><mrow><mi>β</mi></mrow></msub></math>
   and then computing <!-- l. 1147 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖼𝗍</mtext></mstyle></mrow><mrow><mi>α</mi></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo><msub><mrow> <mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖼𝗍</mtext></mstyle></mrow><mrow><mi>β</mi></mrow></msub></mrow></math>.
   <!-- l. 1147 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖼𝗍</mtext></mstyle></mrow><mrow><mi>α</mi></mrow></msub></math>
   is simply <!-- l. 1147 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msubsup><mrow><mi>D</mi></mrow><mrow><mn>0</mn></mrow><mrow><mi>′</mi></mrow></msubsup><mo class='MathClass-punc' stretchy='false'>,</mo><msubsup><mrow><mi>D</mi></mrow><mrow><mn>1</mn></mrow><mrow><mi>′</mi></mrow></msubsup><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>,
   and we can derive <!-- l. 1147 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖼𝗍</mtext></mstyle></mrow><mrow><mi>β</mi></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo><msub><mrow> <mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖱𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mi>S</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>D</mi></mrow><mrow><mn>2</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>S</mi></mrow><mrow><mn>2</mn></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
   by using the <span class='rm-lmss-10x-x-109'>DecompMult</span><sub><span class='rm-lmss-10x-x-109'>RNS</span></sub> operation (Summary <a href='DecomposingMultiplicationtextsfDecompMulttextsubscriptRNS.html#decomposing-multiplication-decompmult-rns'>D-5.9<!-- tex4ht:ref: subsec:rns-decompmult  --></a> in <a href='DecomposingMultiplicationtextsfDecompMulttextsubscriptRNS.html#decomposing-multiplication-decompmult-rns'><span class='ts1-lmr10-x-x-109'>§</span>D-5.9<!-- tex4ht:ref: subsec:rns-decompmult  --></a>). The final ciphertext-to-ciphertext
   addition of <!-- l. 1147 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖼𝗍</mtext></mstyle></mrow><mrow><mi>α</mi></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo><msub><mrow> <mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖼𝗍</mtext></mstyle></mrow><mrow><mi>β</mi></mrow></msub></mrow></math>
   can be performed by using regular RNS addition.
</p>
                                                                                         
                                                                                         
   </dd></dl>
   
   <h5 class='subsubsectionHead' id='ckkss-ciphertexttociphertext-multiplication'><span class='titlemark'>D-5.10.5   </span> <a id='x153-241000D-5.10.5'></a>CKKS’s Ciphertext-to-Ciphertext Multiplication</h5>
<!-- l. 1155 --><p class='noindent'>CKKS’s ciphertext-to-ciphertext multiplication (Summary <a href='HomomorphicCiphertexttoCiphertextMultiplication1.html#summary4'>D-3.5.6<!-- tex4ht:ref: subsubsec:ckks-mult-cipher-summary  --></a> in <a href='HomomorphicCiphertexttoCiphertextMultiplication1.html#summary4'><span class='ts1-lmr10-x-x-109'>§</span>D-3.5.6<!-- tex4ht:ref: subsubsec:ckks-mult-cipher-summary  --></a>) is almost the same as BFV’s, except
that CKKS does not need the <span class='rm-lmss-10x-x-109'>ModRaise </span>operation in the beginning (because each multiplicative level’s modulus
<!-- l. 1155 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub></math> is large enough to hold a
multiplied scaled plaintext <!-- l. 1155 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi mathvariant='normal'>Δ</mi></mrow><mrow><mn>2</mn></mrow></msup><msup><mrow><mi>M</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup><msup><mrow><mi>M</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup></mrow></math>).
Therefore, CKKS’s RNS-based multiplication is the same as BFV’s except
that it does not require step 1 (<span class='rm-lmss-10x-x-109'>ModRaise</span>), step 3 (constant multiplication by
<!-- l. 1155 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>t</mi></math>),
and step 5 (exact fast base conversion). Since a CKKS ciphertext’s scaling factor
<!-- l. 1155 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi mathvariant='normal'>Δ</mi></math> is
approximately the same as the prime modulus factor of each multiplicative level, each
ciphertext-to-ciphertext multiplication only needs to perform a modulus switch to a lower
level.
   
</p>
   <h5 class='subsubsectionHead' id='bgvs-ciphertexttociphertext-multiplication'><span class='titlemark'>D-5.10.6   </span> <a id='x153-242000D-5.10.6'></a>BGV’s Ciphertext-to-Ciphertext Multiplication</h5>
<!-- l. 1163 --><p class='noindent'>BGV’s ciphertext-to-ciphertext multiplication (Summary <a href='CiphertexttoCiphertextMultiplication1.html#ciphertexttociphertext-multiplication1'>D-4.8<!-- tex4ht:ref: subsec:bgv-mult-cipher  --></a> in <a href='CiphertexttoCiphertextMultiplication1.html#ciphertexttociphertext-multiplication1'><span class='ts1-lmr10-x-x-109'>§</span>D-4.8<!-- tex4ht:ref: subsec:bgv-mult-cipher  --></a>) is
almost the same as CKKS’s, except that BGV uses its own modulus switch
(<!-- l. 1163 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msubsup><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖬𝗈𝖽𝖲𝗐𝗂𝗍𝖼𝗁</mtext></mstyle></mrow><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖱𝖭𝖲</mtext></mstyle></mrow><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖡𝖦𝖵</mtext></mstyle></mrow></msubsup></math> as
described in Summary <a href='ModulusSwitch.html#modulus-switch1'>D-4.7<!-- tex4ht:ref: subsec:bgv-modulus-switch  --></a> in <a href='ModulusSwitch.html#modulus-switch1'><span class='ts1-lmr10-x-x-109'>§</span>D-4.7<!-- tex4ht:ref: subsec:bgv-modulus-switch  --></a>) during the rescaling step. Therefore, BGV’s RNS-based
ciphertext-to-ciphertext multiplication is the same as CKKS’s, except that <span class='rm-lmss-10x-x-109'>ModSwitch</span><sub><span class='rm-lmss-10x-x-109'>RNS</span></sub> is replaced by
<!-- l. 1163 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msubsup><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖬𝗈𝖽𝖲𝗐𝗂𝗍𝖼𝗁</mtext></mstyle></mrow><mrow>
<mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖱𝖭𝖲</mtext></mstyle></mrow><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖡𝖦𝖵</mtext></mstyle></mrow></msubsup></math>.
   
</p>
   <h5 class='subsubsectionHead' id='bfvs-bootstrapping'><span class='titlemark'>D-5.10.7   </span> <a id='x153-243000D-5.10.7'></a>BFV’s Bootstrapping</h5>
<!-- l. 1169 --><p class='noindent'>BFV’s original bootstrapping procedure (Summary <a href='NoiseBootstrapping1.html#summary3'>D-2.11.7<!-- tex4ht:ref: subsubsec:bfv-bootstrapping-summary  --></a> in <a href='NoiseBootstrapping1.html#summary3'><span class='ts1-lmr10-x-x-109'>§</span>D-2.11.7<!-- tex4ht:ref: subsubsec:bfv-bootstrapping-summary  --></a>) is as follows: (1) modulus switch
from <!-- l. 1169 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>q</mi> <mo class='MathClass-rel' stretchy='false'>→</mo><msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi></mrow></msup></mrow></math>;
(2) homomorphic decryption; (3) <span class='rm-lmss-10x-x-109'>CoeffToSlot</span>; (4) <span class='rm-lmss-10x-x-109'>EvalExp</span>; (5) <span class='rm-lmss-10x-x-109'>SlotToCoeff</span>; and (6) re-interpretation.
</p><!-- l. 1171 --><p class='indent'>   However, in RNS, we cannot mod-switch to <!-- l. 1171 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi></mrow></msup></math>
because RNS’s base moduli have to be co-prime to each other, whereas the factors of
<!-- l. 1171 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi></mrow></msup></math> are not. To
avoid this issue, RNS-based BFV’s bootstrapping instead performs the following: (1) <span class='rm-lmss-10x-x-109'>ModRaise</span><sub><span class='rm-lmss-10x-x-109'>RNS</span></sub> from
<!-- l. 1171 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>q</mi> <mo class='MathClass-rel' stretchy='false'>→</mo><mi mathvariant='italic'>𝑞𝑏</mi><msub><mrow><mi>b</mi></mrow><mrow><mi>α</mi></mrow></msub></mrow></math>, where
<!-- l. 1171 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>b</mi><msub><mrow><mi>b</mi></mrow><mrow><mi>α</mi></mrow></msub></mrow></math> is an auxiliary base; (2)
coefficient multiplication by <!-- l. 1171 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi></mrow></msup></math>;
(3) <span class='rm-lmss-10x-x-109'>ModSwitch</span><sub><span class='rm-lmss-10x-x-109'>RNS</span></sub> from <!-- l. 1171 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi mathvariant='italic'>𝑞𝑏</mi><msub><mrow><mi>b</mi></mrow><mrow><mi>α</mi></mrow></msub> <mo class='MathClass-rel' stretchy='false'>→</mo><mi>b</mi><msub><mrow><mi>b</mi></mrow><mrow><mi>α</mi></mrow></msub></mrow></math>;
(4) <span class='rm-lmss-10x-x-109'>FastBConvEx </span>from <!-- l. 1171 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>b</mi><msub><mrow><mi>b</mi></mrow><mrow><mi>α</mi></mrow></msub> <mo class='MathClass-rel' stretchy='false'>→</mo><mi>q</mi></mrow></math>;
                                                                                         
                                                                                         
(5) homomorphic decryption to adjust the scaling factor of the plaintext; (6) <span class='rm-lmss-10x-x-109'>CoeffToSlot</span>; (7)
<span class='rm-lmss-10x-x-109'>EvalExp</span>; (8) <span class='rm-lmss-10x-x-109'>SlotToCoeff</span>; and (9) re-interpretation. The detailed procedure is described as
follows:
</p><!-- l. 1173 --><p class='indent'>   <!-- l. 1173 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 1175 --><p class='indent'>   <span class='underline'><span class='rm-lmbx-10x-x-109'>Input</span></span><span class='rm-lmbx-10x-x-109'>: </span>The input BFV ciphertext to bootstrap is
<!-- l. 1175 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><mi>A</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>B</mi><mo class='MathClass-close' stretchy='false'>)</mo><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi>q</mi></mrow></math>, which
would decrypt to:
</p><!-- l. 1177 --><p class='indent'>   <!-- l. 1177 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>A</mi> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mi>S</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>B</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mi mathvariant='normal'>Δ</mi><mi>M</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>E</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi mathvariant='italic'>𝐾𝑞</mi></mrow></math> <span id='textcolor267'>#
where <!-- l. 1177 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi mathvariant='normal'>Δ</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mstyle displaystyle='true'><mfrac><mrow> <mi>q</mi>
</mrow><mrow><msup><mrow><mi>p</mi></mrow><mrow><mi>r</mi></mrow></msup></mrow></mfrac></mstyle></mrow></math></span>
</p><!-- l. 1179 --><p class='indent'>   <!-- l. 1179 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 1182 --><p class='indent'>
   </p><dl class='enumerate-enumitem'><dt class='enumerate-enumitem'>
1. </dt><dd class='enumerate-enumitem'><span class='underline'><span class='rm-lmssbx-10x-x-109'>ModRaise</span><sub><span class='rm-lmssbx-10x-x-109'>RNS</span></sub></span> <span class='rm-lmbx-10x-x-109'>from </span><!-- l. 1183 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>q</mi> <mo class='MathClass-rel' stretchy='false'>→</mo><mi mathvariant='italic'>𝑞𝑏</mi><msub><mrow><mi>b</mi></mrow><mrow><mi>α</mi></mrow></msub></mrow></math><span class='rm-lmbx-10x-x-109'>:</span>
   <!-- l. 1185 --><p class='noindent'>Mod-raise ciphertext <!-- l. 1185 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><mi>A</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>B</mi><mo class='MathClass-close' stretchy='false'>)</mo><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi>q</mi></mrow></math>
   to <!-- l. 1185 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><mi>A</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>B</mi><mo class='MathClass-close' stretchy='false'>)</mo><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi mathvariant='italic'>𝑞𝑏</mi><msub><mrow><mi>b</mi></mrow><mrow><mi>α</mi></mrow></msub></mrow></math>,
   which would decrypt to:
   </p><!-- l. 1187 --><p class='noindent'><!-- l. 1187 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>A</mi> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mi>S</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>B</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mi mathvariant='normal'>Δ</mi><mi>M</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>E</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi mathvariant='italic'>𝐾𝑞</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi mathvariant='italic'>𝑈𝑞</mi><mspace width='0.3em'></mspace><mo class='MathClass-open' stretchy='false'>(</mo><mi mathvariant='italic'>𝑚𝑜𝑑</mi><mspace width='0.3em'></mspace><mi mathvariant='italic'>𝑞𝑏</mi><msub><mrow><mi>b</mi></mrow><mrow><mi>α</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
   </p><!-- l. 1189 --><p class='noindent'><span id='textcolor268'># where <!-- l. 1189 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi mathvariant='italic'>𝑈𝑞</mi></mrow></math>
   is the <span class='rm-lmss-10x-x-109'>FastBConv </span>+ <span class='rm-lmss-10x-x-109'>SmallMont </span>error, and <!-- l. 1189 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>U</mi></math>’s
   coefficients are either <!-- l. 1189 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>{</mo><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>0</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>}</mo></mrow></math></span>
   </p><!-- l. 1191 --><p class='noindent'><!-- l. 1191 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
   </p></dd><dt class='enumerate-enumitem'>
2. </dt><dd class='enumerate-enumitem'><span class='underline'><span class='rm-lmbx-10x-x-109'>Coefficient Multiplication</span></span> <span class='rm-lmbx-10x-x-109'>by </span><!-- l. 1193 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi></mrow></msup></math><span class='rm-lmbx-10x-x-109'>:</span>
   <!-- l. 1195 --><p class='noindent'>Multiply the coefficients of <!-- l. 1195 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><mi>A</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>B</mi><mo class='MathClass-close' stretchy='false'>)</mo><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi>q</mi></mrow></math>
   by <!-- l. 1195 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi></mrow></msup></math>
   to update the ciphertext to <!-- l. 1195 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi></mrow></msup><mi>A</mi><mo class='MathClass-punc' stretchy='false'>,</mo><msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi></mrow></msup><mi>B</mi><mo class='MathClass-close' stretchy='false'>)</mo><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi mathvariant='italic'>𝑝𝑏</mi><msub><mrow><mi>b</mi></mrow><mrow><mi>α</mi></mrow></msub></mrow></math>,
   which would decrypt to:
   </p><!-- l. 1197 --><p class='noindent'><!-- l. 1197 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi></mrow></msup><mi>A</mi> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mi>S</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi></mrow></msup><mi>B</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mi mathvariant='normal'>Δ</mi><msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi></mrow></msup><mi>M</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi></mrow></msup><mi>E</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi></mrow></msup><mi mathvariant='italic'>𝐾𝑞</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi></mrow></msup><mi mathvariant='italic'>𝑈𝑞</mi><mspace width='0.3em'></mspace><mo class='MathClass-open' stretchy='false'>(</mo><mi mathvariant='italic'>𝑚𝑜𝑑</mi><mspace width='0.3em'></mspace><mi mathvariant='italic'>𝑞𝑏</mi><msub><mrow><mi>b</mi></mrow><mrow><mi>α</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
   </p><!-- l. 1199 --><p class='noindent'><!-- l. 1199 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
   </p></dd><dt class='enumerate-enumitem'>
3. </dt><dd class='enumerate-enumitem'><span class='underline'><span class='rm-lmssbx-10x-x-109'>ModSwitch</span><sub><span class='rm-lmssbx-10x-x-109'>RNS</span></sub></span> <span class='rm-lmbx-10x-x-109'>from </span><!-- l. 1201 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi mathvariant='italic'>𝑞𝑏</mi><msub><mrow><mi>b</mi></mrow><mrow><mi>α</mi></mrow></msub> <mo class='MathClass-rel' stretchy='false'>→</mo><mi>b</mi><msub><mrow><mi>b</mi></mrow><mrow><mi>α</mi></mrow></msub></mrow></math><span class='rm-lmbx-10x-x-109'>:</span>
   <!-- l. 1203 --><p class='noindent'>Mod-switch the ciphertext <!-- l. 1203 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi></mrow></msup><mi>A</mi><mo class='MathClass-punc' stretchy='false'>,</mo><msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi></mrow></msup><mi>B</mi><mo class='MathClass-close' stretchy='false'>)</mo><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi mathvariant='italic'>𝑝𝑏</mi><msub><mrow><mi>b</mi></mrow><mrow><mi>α</mi></mrow></msub></mrow></math>
   to <!-- l. 1203 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mrow><mo fence='true' form='prefix'>(</mo><mrow><mrow><mo fence='true' form='prefix'>⌈</mo><mrow><mstyle displaystyle='true'><mfrac><mrow><msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi></mrow></msup><mi>A</mi>
 </mrow><mrow><mi>q</mi>  </mrow></mfrac></mstyle></mrow><mo fence='true' form='postfix'>⌋</mo></mrow><mo class='MathClass-punc' stretchy='false'>,</mo> <mrow><mo fence='true' form='prefix'>⌈</mo><mrow><mstyle displaystyle='true'><mfrac><mrow><msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi></mrow></msup><mi>B</mi>
  </mrow><mrow><mi>q</mi>  </mrow></mfrac></mstyle></mrow><mo fence='true' form='postfix'>⌋</mo></mrow></mrow><mo fence='true' form='postfix'>)</mo></mrow><mspace width='0.3em'></mspace><mo class='MathClass-open' stretchy='false'>(</mo><mi mathvariant='italic'>𝑚𝑜𝑑</mi><mspace width='0.3em'></mspace><mi>b</mi><msub><mrow><mi>b</mi></mrow><mrow><mi>α</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>,
   which would decrypt to:
   </p><!-- l. 1205 --><p class='noindent'><!-- l. 1205 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mrow><mo fence='true' form='prefix'>⌈</mo><mrow><mstyle displaystyle='true'><mfrac><mrow><msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi></mrow></msup><mi>A</mi>
 </mrow><mrow><mi>q</mi>  </mrow></mfrac></mstyle></mrow><mo fence='true' form='postfix'>⌋</mo></mrow> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mi>S</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mrow><mo fence='true' form='prefix'>⌈</mo><mrow><mstyle displaystyle='true'><mfrac><mrow><msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi></mrow></msup><mi>B</mi>
  </mrow><mrow><mi>q</mi>  </mrow></mfrac></mstyle></mrow><mo fence='true' form='postfix'>⌋</mo></mrow> <mo class='MathClass-rel' stretchy='false'>=</mo> <mstyle displaystyle='true'><mfrac><mrow><mi mathvariant='normal'>Δ</mi><msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi></mrow></msup><mi>M</mi>
   </mrow><mrow><mi>q</mi>   </mrow></mfrac></mstyle> <mo class='MathClass-bin' stretchy='false'>+</mo> <mstyle displaystyle='true'><mfrac><mrow><msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi></mrow></msup><mi>E</mi>
  </mrow><mrow><mi>q</mi>  </mrow></mfrac></mstyle> <mo class='MathClass-bin' stretchy='false'>+</mo> <mstyle displaystyle='true'><mfrac><mrow><msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi></mrow></msup><mi mathvariant='italic'>𝐾𝑞</mi>
  </mrow><mrow><mi>q</mi>   </mrow></mfrac></mstyle> <mo class='MathClass-bin' stretchy='false'>+</mo> <mstyle displaystyle='true'><mfrac><mrow><msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi></mrow></msup><mi mathvariant='italic'>𝑈𝑞</mi>
  </mrow><mrow><mi>q</mi>   </mrow></mfrac></mstyle> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>𝜖</mi><mspace width='0.3em'></mspace><mo class='MathClass-open' stretchy='false'>(</mo><mi mathvariant='italic'>𝑚𝑜𝑑</mi><mspace width='0.3em'></mspace><mi>b</mi><msub><mrow><mi>b</mi></mrow><mrow><mi>α</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
   </p><!-- l. 1207 --><p class='noindent'><span id='textcolor269'># <!-- l. 1207 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>𝜖</mi></math>
   is a small rounding error</span>
   </p><!-- l. 1209 --><p class='noindent'><!-- l. 1209 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo> <msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mi>r</mi></mrow></msup><mi>M</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mstyle displaystyle='true'><mfrac><mrow><msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi></mrow></msup><mi>E</mi>
  </mrow><mrow><mi>q</mi>  </mrow></mfrac></mstyle> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi></mrow></msup><mi>K</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi></mrow></msup><mi>U</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>𝜖</mi><mspace width='0.3em'></mspace><mo class='MathClass-open' stretchy='false'>(</mo><mi mathvariant='italic'>𝑚𝑜𝑑</mi><mspace width='0.3em'></mspace><mi>b</mi><msub><mrow><mi>b</mi></mrow><mrow><mi>α</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
   </p><!-- l. 1211 --><p class='noindent'><!-- l. 1211 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
   </p></dd><dt class='enumerate-enumitem'>
                                                                                         
                                                                                         
4. </dt><dd class='enumerate-enumitem'><span class='underline'><span class='rm-lmssbx-10x-x-109'>FastBConvEx</span></span> <span class='rm-lmbx-10x-x-109'>from </span><!-- l. 1213 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>b</mi><msub><mrow><mi>b</mi></mrow><mrow><mi>α</mi></mrow></msub> <mo class='MathClass-rel' stretchy='false'>→</mo><mi>q</mi></mrow></math><span class='rm-lmbx-10x-x-109'>:</span>
   <!-- l. 1215 --><p class='noindent'>Exact fast base conversion of <!-- l. 1215 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi></mrow></msup><mi>A</mi><mo class='MathClass-punc' stretchy='false'>,</mo><msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi></mrow></msup><mi>B</mi><mo class='MathClass-close' stretchy='false'>)</mo><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi>b</mi><msub><mrow><mi>b</mi></mrow><mrow><mi>α</mi></mrow></msub></mrow></math>
   to <!-- l. 1215 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi></mrow></msup><mi>A</mi><mo class='MathClass-punc' stretchy='false'>,</mo><msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi></mrow></msup><mi>B</mi><mo class='MathClass-close' stretchy='false'>)</mo><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi>q</mi></mrow></math>,
   which would decrypt to:
   </p><!-- l. 1217 --><p class='noindent'><!-- l. 1217 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mi>r</mi></mrow></msup><mi>M</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mstyle displaystyle='true'><mfrac><mrow><msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi></mrow></msup><mi>E</mi>
  </mrow><mrow><mi>q</mi>  </mrow></mfrac></mstyle> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi></mrow></msup><mi>K</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi></mrow></msup><mi>U</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>𝜖</mi><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi>q</mi></mrow></math>
   </p><!-- l. 1219 --><p class='noindent'><!-- l. 1219 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
   </p></dd><dt class='enumerate-enumitem'>
5. </dt><dd class='enumerate-enumitem'><span class='underline'><span class='rm-lmbx-10x-x-109'>Homomorphic Decryption</span></span><span class='rm-lmbx-10x-x-109'>:</span>
   <!-- l. 1223 --><p class='noindent'>Now, we have the ciphertext <!-- l. 1223 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi></mrow></msup><mi>A</mi><mo class='MathClass-punc' stretchy='false'>,</mo><msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi></mrow></msup><mi>B</mi><mo class='MathClass-close' stretchy='false'>)</mo><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi>q</mi> <mo class='MathClass-rel' stretchy='false'>=</mo><msub><mrow> <mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖱𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mi>S</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub> <mrow><mo fence='true' form='prefix'>(</mo><mrow><msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mi>r</mi></mrow></msup><mi>M</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mstyle displaystyle='true'><mfrac><mrow><msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi></mrow></msup><mi>E</mi>
  </mrow><mrow><mi>q</mi>  </mrow></mfrac></mstyle> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi></mrow></msup><mi>K</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi></mrow></msup><mi>U</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>𝜖</mi></mrow><mo fence='true' form='postfix'>)</mo></mrow><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi>q</mi></mrow></math>.
   We do homomorphic decryption by using the encrypted private key <!-- l. 1223 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖱𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mi>S</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true'>^</mo></mover><mi>S</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>,
   where <!-- l. 1223 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true'>^</mo></mover> <mo class='MathClass-rel' stretchy='false'>=</mo> <mrow><mo fence='true' form='prefix'>⌊</mo><mrow><mstyle displaystyle='true'><mfrac><mrow> <mi>q</mi>
</mrow><mrow><msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi></mrow></msup></mrow></mfrac></mstyle></mrow><mo fence='true' form='postfix'>⌋</mo></mrow></mrow></math>.
   The output is <!-- l. 1223 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖱𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mi>S</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mstyle mathvariant='bold'><mo class='MathClass-open' stretchy='false'>(</mo></mstyle><mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true'>^</mo></mover> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mi>r</mi></mrow></msup><mi>M</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mstyle displaystyle='true'><mfrac><mrow><msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi></mrow></msup><mi>E</mi>
  </mrow><mrow><mi>q</mi>  </mrow></mfrac></mstyle> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi></mrow></msup><mi>K</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi></mrow></msup><mi>U</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>𝜖</mi><mo class='MathClass-close' stretchy='false'>)</mo><mstyle mathvariant='bold'><mo class='MathClass-close' stretchy='false'>)</mo></mstyle><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi>q</mi></mrow></math>.
   </p><!-- l. 1225 --><p class='noindent'><!-- l. 1225 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
   </p></dd><dt class='enumerate-enumitem'>
6. </dt><dd class='enumerate-enumitem'>Perform <span class='rm-lmss-10x-x-109'>CoeffToSlot</span>, digit extraction, and <span class='rm-lmss-10x-x-109'>SlotToCoeff</span>. These operations can be performed by
   only regular RNS-based additions and multiplications. The final digit-extracted ciphertext is
   <!-- l. 1227 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖱𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mi>S</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mstyle mathvariant='bold'><mo class='MathClass-open' stretchy='false'>(</mo></mstyle><mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true'>^</mo></mover> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mi>r</mi></mrow></msup> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mi>M</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>K</mi><msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>U</mi><msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mstyle mathvariant='bold'><mo class='MathClass-close' stretchy='false'>)</mo></mstyle></mrow></math>,
   where all noise values smaller than the (base-<!-- l. 1227 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>p</mi></math>)
   <!-- l. 1227 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><mi>𝜀</mi> <mo class='MathClass-bin' stretchy='false'>−</mo><mi>r</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>-th
   digits are eliminated.
   <!-- l. 1229 --><p class='noindent'><!-- l. 1229 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
   </p></dd><dt class='enumerate-enumitem'>
7. </dt><dd class='enumerate-enumitem'><span class='underline'><span class='rm-lmbx-10x-x-109'>Scaling Factor Re-interpretation:</span></span>
   <!-- l. 1233 --><p class='noindent'>Theoretically re-interpret the ciphertext without any additional mathematical computation. The
   ciphertext <!-- l. 1233 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖱𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mi>S</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mstyle mathvariant='bold'><mo class='MathClass-open' stretchy='false'>(</mo></mstyle><mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true'>^</mo></mover> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mi>r</mi></mrow></msup> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mi>M</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>K</mi><msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>U</mi><msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mstyle mathvariant='bold'><mo class='MathClass-close' stretchy='false'>)</mo></mstyle></mrow></math>
   is mathematically the same as:
   </p><!-- l. 1235 --><p class='noindent'><!-- l. 1235 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖱𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mi>S</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mstyle mathvariant='bold'><mo class='MathClass-open' stretchy='false'>(</mo></mstyle><mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true'>^</mo></mover> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mi>r</mi></mrow></msup> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mi>M</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>K</mi><msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>U</mi><msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mstyle mathvariant='bold'><mo class='MathClass-close' stretchy='false'>)</mo></mstyle></mrow></math>
   </p><!-- l. 1237 --><p class='noindent'><!-- l. 1237 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo><msub><mrow> <mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖱𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mi>S</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mstyle mathvariant='bold'><mo class='MathClass-open' stretchy='false'>(</mo></mstyle><mi mathvariant='normal'>Δ</mi><mi>M</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mo class='MathClass-open' stretchy='false'>(</mo><mi>K</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>U</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mi>q</mi><mstyle mathvariant='bold'><mo class='MathClass-close' stretchy='false'>)</mo></mstyle></mrow></math>
   <span id='textcolor270'># since <!-- l. 1237 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi mathvariant='normal'>Δ</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mstyle displaystyle='true'><mfrac><mrow> <mi>q</mi>
</mrow><mrow><msup><mrow><mi>p</mi></mrow><mrow><mi>r</mi></mrow></msup></mrow></mfrac></mstyle></mrow></math>,
   and <!-- l. 1237 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true'>^</mo></mover> <mo class='MathClass-rel' stretchy='false'>=</mo> <mstyle displaystyle='true'><mfrac><mrow> <mi>a</mi>
</mrow><mrow><msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi></mrow></msup></mrow></mfrac></mstyle></mrow></math></span>
   </p><!-- l. 1239 --><p class='noindent'><!-- l. 1239 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo><msub><mrow> <mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖱𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mi>S</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mstyle mathvariant='bold'><mo class='MathClass-open' stretchy='false'>(</mo></mstyle><mi mathvariant='normal'>Δ</mi><mi>M</mi><mstyle mathvariant='bold'><mo class='MathClass-close' stretchy='false'>)</mo></mstyle><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi>q</mi></mrow></math>.
</p>
   </dd></dl>
   
   <h5 class='subsubsectionHead' id='ckkss-bootstrapping'><span class='titlemark'>D-5.10.8   </span> <a id='x153-244000D-5.10.8'></a>CKKS’s Bootstrapping</h5>
<!-- l. 1271 --><p class='noindent'>CKKS’s original bootstrapping procedure (Summary <a href='ModulusBootstrapping.html#summary5'>D-3.13.7<!-- tex4ht:ref: subsubsec:ckks-bootstrapping-summary  --></a> in <a href='ModulusBootstrapping.html#summary5'><span class='ts1-lmr10-x-x-109'>§</span>D-3.13.7<!-- tex4ht:ref: subsubsec:ckks-bootstrapping-summary  --></a>) is as follows: (1) <span class='rm-lmss-10x-x-109'>Modraise</span>; (2)
homomorphic decryption; (3) <span class='rm-lmss-10x-x-109'>CoeffToSlot</span>; (4) <span class='rm-lmss-10x-x-109'>EvalExp</span>; (5) <span class='rm-lmss-10x-x-109'>CoeffToSlot</span>; (6) Re-interpretation. In the
RNS-based CKKS bootstrapping, we perform <span class='rm-lmss-10x-x-109'>ModRaise</span><sub><span class='rm-lmss-10x-x-109'>RNS</span></sub> at step 1, and all other steps are computed by
using regular RNS-based addition and multiplication operations. Step 1’s <span class='rm-lmss-10x-x-109'>ModRaise</span><sub><span class='rm-lmss-10x-x-109'>RNS</span></sub> operation generates a
                                                                                         
                                                                                         
<!-- l. 1273 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>u</mi> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msub><mrow><mi>q</mi></mrow><mrow><mn>0</mn></mrow></msub></mrow></math> noise (where
<!-- l. 1273 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>u</mi> <mo class='MathClass-rel' stretchy='false'>∈</mo><mo class='MathClass-open' stretchy='false'>{</mo><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>0</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>}</mo></mrow></math> using
<span class='rm-lmss-10x-x-109'>SmallMont</span>) for each polynomial coefficient during <span class='rm-lmss-10x-x-109'>FastBConv</span>. Therefore, step 2’s homomorphic decryption
outputs <!-- l. 1273 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi mathvariant='normal'>Δ</mi><mi>M</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>E</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>W</mi> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msub><mrow><mi>q</mi></mrow><mrow><mn>0</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>K</mi> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msub><mrow><mi>q</mi></mrow><mrow><mn>0</mn></mrow></msub></mrow></math>,
where <!-- l. 1273 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>W</mi> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msub><mrow><mi>q</mi></mrow><mrow><mn>0</mn></mrow></msub></mrow></math>
represents the aggregation of all coefficient noise terms which are multiplied with the
<!-- l. 1273 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>q</mi></mrow><mrow><mn>0</mn></mrow></msub></math>-overflow noises generated by
<span class='rm-lmss-10x-x-109'>FastBConv </span>and <span class='rm-lmss-10x-x-109'>SmallMont</span>. The <!-- l. 1273 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>W</mi> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msub><mrow><mi>q</mi></mrow><mrow><mn>0</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>K</mi> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msub><mrow><mi>q</mi></mrow><mrow><mn>0</mn></mrow></msub></mrow></math>
term gets eliminated by step 4’s <span class='rm-lmss-10x-x-109'>EvalExp </span>which performs approximated modulo reduction based on a sine-graph evaluation
whose period is <!-- l. 1273 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>q</mi></mrow><mrow><mn>0</mn></mrow></msub></math>.
   
</p>
   <h5 class='subsubsectionHead' id='bgvs-bootstrapping'><span class='titlemark'>D-5.10.9   </span> <a id='x153-245000D-5.10.9'></a>BGV’s Bootstrapping</h5>
<!-- l. 1281 --><p class='noindent'>BGV’s original bootstrapping procedure (<a href='ModulusBootstrapping1.html#modulus-bootstrapping1'><span class='ts1-lmr10-x-x-109'>§</span>D-4.11<!-- tex4ht:ref: subsubsec:ckks-bootstrapping-summary  --></a>) is as follows: (1) modulus switch from
<!-- l. 1282 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub> <mo class='MathClass-rel' stretchy='false'>→</mo><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true'>^</mo></mover></mrow></math>; (2) ciphertext coefficient
multiplication by <!-- l. 1282 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msup></math>;
(3) <span class='rm-lmss-10x-x-109'>ModRaise</span>; (4) <span class='rm-lmss-10x-x-109'>CoeffToSlot</span>; (5) <span class='rm-lmss-10x-x-109'>EvalExp</span>; (6) homomorphic multiplication by
<!-- l. 1282 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-rel' stretchy='false'>|</mo><msup><mrow><mi>p</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mo class='MathClass-open' stretchy='false'>(</mo><mi>𝜀</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><msub><mrow><mo class='MathClass-rel' stretchy='false'>|</mo></mrow><mrow><msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi></mrow></msup></mrow></msub></mrow></math>; (7)
<span class='rm-lmss-10x-x-109'>SlottToCoeff</span>; (8) noise term re-interpretation. Given this procedure, the RNS-based bootstrapping steps
are as follows:
</p><!-- l. 1284 --><p class='indent'>   <!-- l. 1284 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 1375 --><p class='indent'>   Suppose the target BGV ciphertext to bootstrap is
<!-- l. 1375 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><mi>A</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>B</mi><mo class='MathClass-close' stretchy='false'>)</mo><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub></mrow></math>, where the plaintext modulus
(i.e., noise scaling factor) is <!-- l. 1375 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>p</mi></math>.
</p><!-- l. 1378 --><p class='indent'>
   </p><dl class='enumerate-enumitem'><dt class='enumerate-enumitem'>
1. </dt><dd class='enumerate-enumitem'><span class='underline'><!-- l. 1379 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msubsup><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖬𝗈𝖽𝖲𝗐𝗂𝗍𝖼𝗁</mtext></mstyle></mrow><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖱𝖭𝖲</mtext></mstyle></mrow><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖡𝖦𝖵</mtext></mstyle></mrow></msubsup></math></span> from
   <!-- l. 1379 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub> <mo class='MathClass-rel' stretchy='false'>→</mo><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true'>^</mo></mover></mrow></math> where
   <!-- l. 1379 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true'>^</mo></mover></math>
   is a special modulus satisfying the following requirements:
   <!-- l. 1379 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true'>^</mo></mover> <mo class='MathClass-rel' stretchy='false'>≡</mo><mn>1</mn><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi></mrow></msup></mrow></math>,
   <!-- l. 1379 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true'>^</mo></mover> <mo class='MathClass-rel' stretchy='false'>≡</mo><mn>1</mn><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi>p</mi></mrow></math>,
   <!-- l. 1379 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true'>^</mo></mover></math> and
   <!-- l. 1379 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub></math> are co-prime,
   and <!-- l. 1379 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true'>^</mo></mover> <mo class='MathClass-rel' stretchy='false'>&lt;</mo> <msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub></mrow></math>.
   <!-- l. 1385 --><p class='noindent'><!-- l. 1385 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
   </p></dd><dt class='enumerate-enumitem'>
2. </dt><dd class='enumerate-enumitem'><span class='underline'><span class='rm-lmbx-10x-x-109'>Constant multiplication</span></span> by <!-- l. 1387 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msup></math>
   to the coefficients of the ciphertext polynomials
   <!-- l. 1387 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><mi>Â</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mover accent='true'><mrow><mi>B</mi></mrow><mo accent='true'>^</mo></mover><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>,
   which increases the underlying plaintext’s noise scaling factor
   <!-- l. 1387 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi mathvariant='normal'>Δ</mi></math> and the plaintext modulus
   from <!-- l. 1387 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>p</mi> <mo class='MathClass-rel' stretchy='false'>→</mo><msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi></mrow></msup></mrow></math>. This effectively updates
                                                                                         
                                                                                         
   the underlying plaintext to <!-- l. 1387 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msup><mi>M</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi></mrow></msup><mi>E</mi></mrow></math>.
   <!-- l. 1389 --><p class='noindent'><!-- l. 1389 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
   </p></dd><dt class='enumerate-enumitem'>
3. </dt><dd class='enumerate-enumitem'><span class='underline'><span class='rm-lmssbx-10x-x-109'>ModRaise</span><sub><span class='rm-lmssbx-10x-x-109'>RNS</span></sub></span> from <!-- l. 1391 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true'>^</mo></mover> <mo class='MathClass-rel' stretchy='false'>→</mo><msub><mrow><mi>q</mi></mrow><mrow><mi>L</mi></mrow></msub></mrow></math>, which
   generates an additional noise <!-- l. 1391 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-rel' stretchy='false'>|</mo><mi>u</mi> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true'>^</mo></mover><msub><mrow><mo class='MathClass-rel' stretchy='false'>|</mo></mrow><mrow><msub><mrow><mi>q</mi></mrow><mrow><mi>L</mi></mrow></msub></mrow></msub></mrow></math>
   (where <!-- l. 1391 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>u</mi> <mo class='MathClass-rel' stretchy='false'>∈</mo><mo class='MathClass-open' stretchy='false'>{</mo><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>0</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>}</mo></mrow></math>using <span class='rm-lmss-10x-x-109'>SmallMont</span>). At
   this point, the ciphertext is <!-- l. 1391 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖱𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mi>S</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msup><mi>M</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi></mrow></msup><mi>E</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true'>^</mo></mover><mi>K</mi><mo class='MathClass-close' stretchy='false'>)</mo><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <msub><mrow><mi>q</mi></mrow><mrow><mi>L</mi></mrow></msub></mrow></math>,
   whose underlying plaintext is:
   <!-- l. 1393 --><p class='noindent'><!-- l. 1393 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msup><mi>M</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi></mrow></msup><mi>E</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true'>^</mo></mover><mi>K</mi></mrow></math>
   </p><!-- l. 1395 --><p class='noindent'><!-- l. 1395 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo> <msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msup><mi>M</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>K</mi><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi></mrow></msup></mrow></math> <span id='textcolor271'># since
   <!-- l. 1395 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true'>^</mo></mover> <mo class='MathClass-rel' stretchy='false'>≡</mo><mn>1</mn><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi></mrow></msup></mrow></math></span>
</p>
   </dd></dl>
<!-- l. 1399 --><p class='indent'>   <!-- l. 1399 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 1401 --><p class='indent'>   After the above steps, the remaining steps (i.e., <span class='rm-lmss-10x-x-109'>CoeffToSlot</span>, <span class='rm-lmss-10x-x-109'>EvalExp</span>, homomorphic multiplication by
<!-- l. 1401 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-rel' stretchy='false'>|</mo><msup><mrow><mi>p</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mo class='MathClass-open' stretchy='false'>(</mo><mi>𝜀</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><msub><mrow><mo class='MathClass-rel' stretchy='false'>|</mo></mrow><mrow><msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi></mrow></msup></mrow></msub></mrow></math>,
<span class='rm-lmss-10x-x-109'>SlotToCoeff</span>, and re-interpretation) can be performed by regular RNS-based addition and multiplication
operations.
   
</p>
   <h5 class='subsubsectionHead' id='noise-impact-of-rns-operations'><span class='titlemark'>D-5.10.10   </span> <a id='x153-246000D-5.10.10'></a>Noise Impact of RNS Operations</h5>
<!-- l. 1407 --><p class='noindent'>When RNS techniques are used in FHE operations, the noise generated by <span class='rm-lmss-10x-x-109'>FastBConvEx</span><sub><span class='rm-lmss-10x-x-109'>RNS</span></sub>,
<span class='rm-lmss-10x-x-109'>ModRaise</span><sub><span class='rm-lmss-10x-x-109'>RNS</span></sub>, and <span class='rm-lmss-10x-x-109'>ModSwitch</span><sub><span class='rm-lmss-10x-x-109'>RNS</span></sub> is directly added to each coefficient of the ciphertext polynomials
<!-- l. 1407 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>A</mi></math> and
<!-- l. 1407 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>B</mi></math>. Since the decryption relation
is <!-- l. 1407 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>A</mi> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mi>S</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>B</mi></mrow></math>, even the noise added to the
coefficients of the polynomial <!-- l. 1407 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>A</mi></math>
gets multiplied by a large factor due to the polynomial multiplication with
<!-- l. 1407 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>S</mi></math>.
Therefore, it is important to always ensure to reduce the generated noise of each <span class='rm-lmss-10x-x-109'>FastBConvEx</span><sub><span class='rm-lmss-10x-x-109'>RNS</span></sub> by
using it with <span class='rm-lmss-10x-x-109'>SmallMont</span>.
   
</p>
   <h5 class='subsubsectionHead' id='python-source-code-of-rns-primitives'><span class='titlemark'>D-5.10.11   </span> <a id='x153-247000D-5.10.11'></a>Python Source Code of RNS Primitives</h5>
<!-- l. 1412 --><p class='noindent'>We provide a  <a href='https://github.com/fhetextbook/fhe-textbook/blob/main/source%20code/rns.py'><span class='underline'>Python script</span></a> implementing the following exemplary RNS primitives: <span class='rm-lmss-10x-x-109'>FastBConv</span>,
<span class='rm-lmss-10x-x-109'>ModRaise</span><sub><span class='rm-lmss-10x-x-109'>RNS</span></sub>, <span class='rm-lmss-10x-x-109'>ModDrop</span><sub><span class='rm-lmss-10x-x-109'>RNS</span></sub>, <span class='rm-lmss-10x-x-109'>ModSwitch</span><sub><span class='rm-lmss-10x-x-109'>RNS</span></sub>, <span class='rm-lmss-10x-x-109'>SmallMont</span>, and <span class='rm-lmss-10x-x-109'>BaseBConvEx</span>.
                                                                                         
                                                                                         
</p>
   <!-- l. 625 --><div class='crosslinks'><p class='noindent'>[<a href='DecomposingMultiplicationtextsfDecompMulttextsubscriptRNS.html'>prev</a>] [<a href='DecomposingMultiplicationtextsfDecompMulttextsubscriptRNS.html#tailDecomposingMultiplicationtextsfDecompMulttextsubscriptRNS.html'>prev-tail</a>] [<a href='ApplyingRNSTechniquestoFHEOperations.html'>front</a>] [<a href='RNSvariantFHESchemes.html#ApplyingRNSTechniquestoFHEOperations.html'>up</a>] </p></div>
<!-- l. 625 --><p class='indent'>   <a id='tailApplyingRNSTechniquestoFHEOperations.html'></a>  </p> 
</body> 
</html>