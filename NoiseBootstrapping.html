<!DOCTYPE html> 
<html lang='en-US' xml:lang='en-US'> 
<head><title>Noise Bootstrapping</title> 
<meta charset='utf-8' /> 
<meta content='TeX4ht (https://tug.org/tex4ht/)' name='generator' /> 
<meta content='width=device-width,initial-scale=1' name='viewport' /> 
<link href='index.css' rel='stylesheet' type='text/css' /> 
<meta content='index.tex' name='src' /> 
 <script async='async' id='MathJax-script' src='https://cdn.jsdelivr.net/npm/mathjax@3/es5/mml-chtml.js' type='text/javascript'></script>  
</head><body>
   <!-- l. 527 --><div class='crosslinks'><p class='noindent'>[<a href='TFHEonaDiscreteTorus.html'>next</a>] [<a href='CoefficientExtraction.html'>prev</a>] [<a href='CoefficientExtraction.html#tailCoefficientExtraction.html'>prev-tail</a>] [<a href='#tailNoiseBootstrapping.html'>tail</a>] [<a href='TFHEScheme.html#NoiseBootstrapping.html'>up</a>] </p></div>
   <h4 class='subsectionHead' id='noise-bootstrapping'><span class='titlemark'>D-1.8   </span> <a id='x103-127000D-1.8'></a>Noise Bootstrapping</h4>
<!-- l. 531 --><p class='noindent'><span class='rm-lmbx-10x-x-109'>- Reference:  </span><a href='https://www.zama.ai/post/tfhe-deep-dive-part-4'>TFHE Deep Dive - Part IV - Programmable Bootstrapping</a> <span class='cite'>[<span class='rm-lmbx-10x-x-109'>?</span>]</span>
</p><!-- l. 534 --><p class='indent'>   <!-- l. 534 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 536 --><p class='indent'>   Continuing homomorphic additions of TFHE ciphertexts does not necessarily increase the noise
<!-- l. 536 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>e</mi></math>,
because <!-- l. 536 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>e</mi></math>
is randomly generated over the Gaussian distribution, thus adding up many noises would
give the mean value of 0. On the other hand, continuing homomorphic multiplications
increases the noise, because the noise terms get multiplied, growing its magnitude. Thus,
we need to somehow <span class='rm-lmri-10x-x-109'>reset </span>the noise before it trespasses on the higher bits where plaintext
<!-- l. 536 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>m</mi></math> resides
(i.e., preventing the red noise bits from overflowing to the blue plaintext bits as shown in <a href='LWECryptosystem.html#an-illustration-of-lwes-plaintext-scaling-and-adding-a-noise-delta-m-e-zq'>Figure 8<!-- tex4ht:ref: subsubsec:scaling-factor-computation  --></a>). The
process of re-initializing the noise to a smaller value is called noise bootstrapping.
</p><!-- l. 538 --><p class='indent'>   As explained in the beginning of this section, TFHE uses LWE (which is GLWE with
<!-- l. 538 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>n</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>1</mn></mrow></math>) to encrypt &amp; decrypt a plaintext.
That is, each plaintext is <!-- l. 538 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>m</mi></math>
(a single number), encoded as a zero-degree polynomial. Further, the secret key S that encrypts each
<!-- l. 538 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>m</mi></math> is a
vector <!-- l. 538 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>{</mo><msub><mrow><mi>s</mi></mrow><mrow><mn>0</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>s</mi></mrow><mrow><mn>1</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><mo class='MathClass-rel' stretchy='false'>⋯</mo><mstyle class='text'><mtext> </mtext></mstyle><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>s</mi></mrow><mrow><mi>k</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub><mo class='MathClass-close' stretchy='false'>}</mo></mrow></math>
instead of a polynomial. On the other hand, TFHE’s noise bootstrapping uses homomorphic addition
between GLWE ciphertexts and homomorphic multiplication between GLWE and GGSW
ciphertexts.
</p><!-- l. 542 --><p class='indent'>   Suppose we have a TFHE ciphertext as follows:
</p><!-- l. 544 --><p class='indent'>   <!-- l. 544 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 546 --><p class='indent'>   <!-- l. 546 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mover accent='true'><mrow><mi>s</mi></mrow><mo accent='true'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mi mathvariant='normal'>Δ</mi><mi>m</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>a</mi></mrow><mrow><mn>0</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>a</mi></mrow><mrow><mn>1</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><mstyle class='text'><mtext></mtext><mstyle class='math'><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace></mstyle><mtext></mtext></mstyle><mstyle class='text'><mtext> </mtext></mstyle><msub><mrow><mi>a</mi></mrow><mrow><mi>k</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><mi>b</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
</p><!-- l. 548 --><p class='indent'>   <!-- l. 548 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>b</mi> <mo class='MathClass-rel' stretchy='false'>=</mo><munderover accent='false' accentunder='false'><mrow> <mi class='MathClass-op'>∑</mi><mo> ⁡<!-- FUNCTION APPLICATION --></mo>
  </mrow><mrow><mi>i</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>0</mn></mrow><mrow><mi>k</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></munderover><msub><mrow><mi>a</mi></mrow><mrow><mi>i</mi></mrow></msub><msub><mrow><mi>s</mi></mrow><mrow><mi>i</mi></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi mathvariant='normal'>Δ</mi><mi>m</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>e</mi></mrow><mrow><mi>b</mi></mrow></msub></mrow></math>
</p><!-- l. 550 --><p class='indent'>   <!-- l. 550 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mover accent='true'><mrow><mi>s</mi></mrow><mo accent='true'>→</mo></mover> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>s</mi></mrow><mrow><mn>0</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>s</mi></mrow><mrow><mn>1</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><mstyle class='text'><mtext></mtext><mstyle class='math'><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace></mstyle><mtext></mtext></mstyle><mstyle class='text'><mtext> </mtext></mstyle><msub><mrow><mi>s</mi></mrow><mrow><mi>k</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
</p><!-- l. 552 --><p class='indent'>   <!-- l. 552 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 554 --><p class='indent'>   , where <!-- l. 554 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>e</mi></mrow><mrow><mi>b</mi></mrow></msub></math> is a
big noise accumulated over a series of many ciphertext (or plaintext) multiplications. The goal of noise bootstrapping
is to convert <!-- l. 554 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>a</mi></mrow><mrow><mn>0</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>a</mi></mrow><mrow><mn>0</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><mstyle class='text'><mtext></mtext><mstyle class='math'><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace></mstyle><mtext></mtext></mstyle><mstyle class='text'><mtext> </mtext></mstyle><msub><mrow><mi>a</mi></mrow><mrow><mi>k</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><mi>b</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
into <!-- l. 554 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msubsup><mrow><mi>a</mi></mrow><mrow><mn>0</mn></mrow><mrow><mi>′</mi></mrow></msubsup><mo class='MathClass-punc' stretchy='false'>,</mo><msubsup><mrow><mi>a</mi></mrow><mrow><mn>1</mn></mrow><mrow><mi>′</mi></mrow></msubsup><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><mstyle class='text'><mtext></mtext><mstyle class='math'><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace></mstyle><mtext></mtext></mstyle><mstyle class='text'><mtext> </mtext></mstyle><msubsup><mrow><mi>a</mi></mrow><mrow><mi>k</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow><mrow><mi>′</mi></mrow></msubsup><mo class='MathClass-punc' stretchy='false'>,</mo><msup><mrow><mi>b</mi></mrow><mrow><mi>′</mi></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
such that:
</p><!-- l. 556 --><p class='indent'>   <!-- l. 556 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 558 --><p class='indent'>   <!-- l. 558 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>b</mi></mrow><mrow><mi>′</mi></mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo><munderover accent='false' accentunder='false'><mrow> <mi class='MathClass-op'>∑</mi><mo> ⁡<!-- FUNCTION APPLICATION --></mo>
  </mrow><mrow><mi>i</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>0</mn></mrow><mrow><mi>k</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></munderover><msubsup><mrow><mi>a</mi></mrow><mrow><mi>i</mi></mrow><mrow><mi>′</mi></mrow></msubsup><msub><mrow><mi>s</mi></mrow><mrow><mi>i</mi></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi mathvariant='normal'>Δ</mi><mi>m</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>e</mi></mrow><mrow><mi>s</mi></mrow></msub></mrow></math>
</p><!-- l. 560 --><p class='indent'>   <!-- l. 560 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 562 --><p class='indent'>   , where <!-- l. 562 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>e</mi></mrow><mrow><mi>s</mi></mrow></msub></math>
is a re-initialized noise.
</p><!-- l. 564 --><p class='indent'>   <!-- l. 564 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
                                                                                         
                                                                                         
</p>
   <h5 class='subsubsectionHead' id='overview3'><span class='titlemark'>D-1.8.1   </span> <a id='x103-128000D-1.8.1'></a>Overview</h5>
<!-- l. 568 --><p class='noindent'>To implement noise bootstrapping, we create a specially designed
<!-- l. 568 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><mi>n</mi> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>-degree polynomial
<!-- l. 568 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>V</mi> <mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math> called a Lookup Table (LUT).
The polynomial <!-- l. 568 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>V</mi> <mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>’s each
degree term <!-- l. 568 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>X</mi></mrow><mrow><msup><mrow><mi>i</mi></mrow><mrow><mi>′</mi></mrow></msup>
 </mrow></msup></math> has its exponent
<!-- l. 568 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>i</mi></mrow><mrow><mi>′</mi></mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo> <mi mathvariant='normal'>Δ</mi><msub><mrow><mi>m</mi></mrow><mrow><mi>i</mi></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>e</mi></mrow></math>, a noisy plaintext, and its
corresponding coefficient <!-- l. 568 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>v</mi></mrow><mrow><msup><mrow><mi>i</mi></mrow><mrow><mi>′</mi></mrow></msup></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo> <mi mathvariant='normal'>Δ</mi><msub><mrow><mi>m</mi></mrow><mrow><mi>i</mi></mrow></msub></mrow></math>, which is
a noise-free plaintext. Therefore, <!-- l. 568 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>V</mi> <mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
is defined as:
</p><!-- l. 570 --><p class='indent'>   <!-- l. 570 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>V</mi> <mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mi>v</mi></mrow><mrow><mn>0</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>v</mi></mrow><mrow><mn>1</mn></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mn>1</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>v</mi></mrow><mrow><mn>2</mn></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mn>2</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <mstyle class='text'><mtext> </mtext></mstyle><mstyle class='text'><mtext></mtext><mstyle class='math'><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace></mstyle><mtext></mtext></mstyle><mstyle class='text'><mtext> </mtext></mstyle> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>v</mi></mrow><mrow><mi>n</mi></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msup></mrow></math>
</p><!-- l. 572 --><p class='indent'>     <!-- l. 572 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mi>m</mi></mrow><mrow><mn>0</mn></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mi mathvariant='normal'>Δ</mi><msub><mrow><mi>m</mi></mrow><mrow><mn>0</mn></mrow></msub><mo class='MathClass-bin' stretchy='false'>+</mo><msub><mrow><mi>e</mi></mrow><mrow><mn>0</mn></mrow></msub></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>m</mi></mrow><mrow><mn>0</mn></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mi mathvariant='normal'>Δ</mi><msub><mrow><mi>m</mi></mrow><mrow><mn>0</mn></mrow></msub><mo class='MathClass-bin' stretchy='false'>+</mo><msub><mrow><mi>e</mi></mrow><mrow><mn>1</mn></mrow></msub></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>m</mi></mrow><mrow><mn>0</mn></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mi mathvariant='normal'>Δ</mi><msub><mrow><mi>m</mi></mrow><mrow><mn>0</mn></mrow></msub><mo class='MathClass-bin' stretchy='false'>+</mo><msub><mrow><mi>e</mi></mrow><mrow><mn>2</mn></mrow></msub></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <mstyle class='text'><mtext> </mtext></mstyle><mstyle class='text'><mtext></mtext><mstyle class='math'><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace></mstyle><mtext></mtext></mstyle><mstyle class='text'><mtext> </mtext></mstyle> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>m</mi></mrow><mrow><mn>0</mn></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mi mathvariant='normal'>Δ</mi><msub><mrow><mi>m</mi></mrow><mrow><mn>0</mn></mrow></msub><mo class='MathClass-bin' stretchy='false'>+</mo><msub><mrow><mi>e</mi></mrow><mrow><mi mathvariant='normal'>Δ</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub></mrow></msup></mrow></math>
</p><!-- l. 574 --><p class='indent'>     <!-- l. 574 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-bin' stretchy='false'>+</mo> <mstyle class='text'><mtext> </mtext></mstyle><msub><mrow><mi>m</mi></mrow><mrow><mn>1</mn></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mi mathvariant='normal'>Δ</mi><msub><mrow><mi>m</mi></mrow><mrow><mn>1</mn></mrow></msub><mo class='MathClass-bin' stretchy='false'>+</mo><msub><mrow><mi>e</mi></mrow><mrow><mn>0</mn></mrow></msub></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>m</mi></mrow><mrow><mn>1</mn></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mi mathvariant='normal'>Δ</mi><msub><mrow><mi>m</mi></mrow><mrow><mn>1</mn></mrow></msub><mo class='MathClass-bin' stretchy='false'>+</mo><msub><mrow><mi>e</mi></mrow><mrow><mn>1</mn></mrow></msub></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>m</mi></mrow><mrow><mn>1</mn></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mi mathvariant='normal'>Δ</mi><msub><mrow><mi>m</mi></mrow><mrow><mn>1</mn></mrow></msub><mo class='MathClass-bin' stretchy='false'>+</mo><msub><mrow><mi>e</mi></mrow><mrow><mn>2</mn></mrow></msub></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <mstyle class='text'><mtext> </mtext></mstyle><mstyle class='text'><mtext></mtext><mstyle class='math'><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace></mstyle><mtext></mtext></mstyle><mstyle class='text'><mtext> </mtext></mstyle> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>m</mi></mrow><mrow><mn>1</mn></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mi mathvariant='normal'>Δ</mi><msub><mrow><mi>m</mi></mrow><mrow><mn>1</mn></mrow></msub><mo class='MathClass-bin' stretchy='false'>+</mo><msub><mrow><mi>e</mi></mrow><mrow><mi mathvariant='normal'>Δ</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub></mrow></msup></mrow></math>
</p><!-- l. 576 --><p class='indent'>     <!-- l. 576 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-bin' stretchy='false'>+</mo> <mstyle class='text'><mtext> </mtext></mstyle><mstyle class='text'><mtext></mtext><mstyle class='math'><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace></mstyle><mtext></mtext></mstyle><mstyle class='text'><mtext> </mtext></mstyle></mrow></math>
</p><!-- l. 578 --><p class='indent'>     <!-- l. 578 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-bin' stretchy='false'>+</mo> <mstyle class='text'><mtext> </mtext></mstyle><msub><mrow><mi>m</mi></mrow><mrow><mi>t</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mi mathvariant='normal'>Δ</mi><msub><mrow><mi>m</mi></mrow><mrow><mi>t</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub><mo class='MathClass-bin' stretchy='false'>+</mo><msub><mrow><mi>e</mi></mrow><mrow><mn>0</mn></mrow></msub></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>m</mi></mrow><mrow><mi>t</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mi mathvariant='normal'>Δ</mi><msub><mrow><mi>m</mi></mrow><mrow><mi>t</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub><mo class='MathClass-bin' stretchy='false'>+</mo><msub><mrow><mi>e</mi></mrow><mrow><mn>1</mn></mrow></msub></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>m</mi></mrow><mrow><mi>t</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mi mathvariant='normal'>Δ</mi><msub><mrow><mi>m</mi></mrow><mrow><mi>t</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub><mo class='MathClass-bin' stretchy='false'>+</mo><msub><mrow><mi>e</mi></mrow><mrow><mn>2</mn></mrow></msub></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <mstyle class='text'><mtext> </mtext></mstyle><mstyle class='text'><mtext></mtext><mstyle class='math'><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace></mstyle><mtext></mtext></mstyle><mstyle class='text'><mtext> </mtext></mstyle> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>m</mi></mrow><mrow><mi>t</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mi mathvariant='normal'>Δ</mi><msub><mrow><mi>m</mi></mrow><mrow><mi>t</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub><mo class='MathClass-bin' stretchy='false'>+</mo><msub><mrow><mi>e</mi></mrow><mrow><mi mathvariant='normal'>Δ</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub></mrow></msup></mrow></math>
</p><!-- l. 580 --><p class='indent'>   <!-- l. 580 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 582 --><p class='indent'>   We design <!-- l. 582 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>V</mi> </mrow></math> to have the
special property that its each <!-- l. 582 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>v</mi></mrow><mrow><msup><mrow><mi>i</mi></mrow><mrow><mi>′</mi></mrow></msup></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><msup><mrow><mi>i</mi></mrow><mrow><mi>′</mi></mrow></msup>
 </mrow></msup></mrow></math>
term has the special mapping of (exponent, coefficient)
<!-- l. 582 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>(</mo><mi mathvariant='normal'>Δ</mi><msub><mrow><mi>m</mi></mrow><mrow><mi>i</mi></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>e</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>m</mi></mrow><mrow><mi>i</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>. During the TFHE setup stage,
we GLWE-encrypt <!-- l. 582 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>V</mi> <mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math> by using
our newly defined GLWE key <!-- l. 582 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mover accent='true'><mrow><mi>S</mi></mrow><mo accent='true'>→</mo></mover></mrow><mrow><mi mathvariant='italic'>𝑘𝑏</mi></mrow></msub></math>,
a <span class='rm-lmri-10x-x-109'>bootstrapping key</span>, which is different from the LWE secret key
<!-- l. 582 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mover accent='true'><mrow><mi>s</mi></mrow><mo accent='true'>→</mo></mover></math>.
<!-- l. 582 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mover accent='true'><mrow><mi>S</mi></mrow><mo accent='true'>→</mo></mover></mrow><mrow><mi mathvariant='italic'>𝑘𝑏</mi></mrow></msub></math> is a list of
<!-- l. 582 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><mi>n</mi> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>-degree
polynomials with binary coefficients. Later, during the noise bootstrapping stage, we rotate the the coefficients
of <!-- l. 582 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>V</mi> </mrow></math> by
<!-- l. 582 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi mathvariant='normal'>Δ</mi><mi>m</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>e</mi></mrow></math> positions to the
left by computing <!-- l. 582 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>V</mi> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>X</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mo class='MathClass-open' stretchy='false'>(</mo><mi mathvariant='normal'>Δ</mi><mi>m</mi><mo class='MathClass-bin' stretchy='false'>+</mo><mi>e</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo> <msup><mrow><mi>V</mi> </mrow><mrow><mi>′</mi></mrow></msup></mrow></math>,
by using the polynomial coefficient rotation method 1 technique (Summary <a href='CoefficientRotation.html#coefficient-rotation'>A-5.2<!-- tex4ht:ref: subsec:coeff-rotation  --></a>.1 in <a href='CoefficientRotation.html#coefficient-rotation'><span class='ts1-lmr10-x-x-109'>§</span>A-5.2<!-- tex4ht:ref: subsec:coeff-rotation  --></a>). Then, we will
extract the polynomial’s constant term’s coefficient (i.e., the left-most 0-degree term’s coefficient in the
rotated <!-- l. 582 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>V</mi> </mrow><mrow><mi>′</mi></mrow></msup></math>)
by using the coefficient extraction technique (<a href='CoefficientExtraction.html#coefficient-extraction'><span class='ts1-lmr10-x-x-109'>§</span>D-1.7<!-- tex4ht:ref: subsec:coeff-rotation  --></a>). Further, we will encrypt
<!-- l. 582 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>V</mi> <mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
as a GLWE ciphertext at the TFHE setup stage, and thus the rotated
<!-- l. 582 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>V</mi> </mrow><mrow><mi>′</mi></mrow></msup><mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>’s
extracted constant term’s coefficient is an LWE encryption of
<!-- l. 582 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>m</mi></math> (i.e.,
<!-- l. 582 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mover accent='true'><mrow><mi>s</mi></mrow><mo accent='true'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mi mathvariant='normal'>Δ</mi><mi>m</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>) with a
re-initialized noise.
</p><!-- l. 584 --><p class='indent'>   To summarize, the noise bootstrapping procedure can be conceptually understood (at least for now) as
follows:
                                                                                         
                                                                                         
</p><!-- l. 586 --><p class='indent'>   <!-- l. 586 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 589 --><p class='indent'>
   </p><dl class='enumerate-enumitem'><dt class='enumerate-enumitem'>
1. </dt><dd class='enumerate-enumitem'><span class='rm-lmbx-10x-x-109'>Input: </span><!-- l. 589 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mover accent='true'><mrow><mi>s</mi></mrow><mo accent='true'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mi mathvariant='normal'>Δ</mi><mi>m</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>e</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
   as a noisy ciphertext encrypting <!-- l. 589 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>m</mi></math>
   </dd><dt class='enumerate-enumitem'>
2. </dt><dd class='enumerate-enumitem'>Convert the input into the form of <!-- l. 590 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>X</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mo class='MathClass-open' stretchy='false'>(</mo><mi mathvariant='normal'>Δ</mi><mi>m</mi><mo class='MathClass-bin' stretchy='false'>+</mo><mi>e</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup></math>
   as a rotator of <!-- l. 590 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>V</mi> <mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
   (Lookup Table)
   </dd><dt class='enumerate-enumitem'>
3. </dt><dd class='enumerate-enumitem'>Rotate <!-- l. 591 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>V</mi> </mrow></math>
   to the left by <!-- l. 591 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi mathvariant='normal'>Δ</mi><mi>m</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>e</mi></mrow></math>
   positions by computing <!-- l. 591 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>V</mi> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>X</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mo class='MathClass-open' stretchy='false'>(</mo><mi mathvariant='normal'>Δ</mi><mi>m</mi><mo class='MathClass-bin' stretchy='false'>+</mo><mi>e</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo> <msup><mrow><mi>V</mi> </mrow><mrow><mi>′</mi></mrow></msup></mrow></math>
   </dd><dt class='enumerate-enumitem'>
4. </dt><dd class='enumerate-enumitem'>Extract the rotated <!-- l. 592 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>V</mi> </mrow><mrow><mi>′</mi></mrow></msup><mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>’s
   constant term’s coefficient <!-- l. 592 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>m</mi></math>
   as an LWE encryption, which is <!-- l. 592 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mover accent='true'><mrow><mi>s</mi></mrow><mo accent='true'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mi mathvariant='normal'>Δ</mi><mi>m</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
   </dd><dt class='enumerate-enumitem'>
5. </dt><dd class='enumerate-enumitem'><span class='rm-lmbx-10x-x-109'>Output: </span><!-- l. 593 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mover accent='true'><mrow><mi>s</mi></mrow><mo accent='true'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mi mathvariant='normal'>Δ</mi><mi>m</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
   as an LWE encryption of the plaintext <!-- l. 593 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>m</mi></math>
   with a re-initialized noise.</dd></dl>
<!-- l. 596 --><p class='indent'>   <!-- l. 596 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 598 --><p class='indent'>   The final <!-- l. 598 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mover accent='true'><mrow><mi>s</mi></mrow><mo accent='true'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mi mathvariant='normal'>Δ</mi><mi>m</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
can be used for subsequent TFHE homomorphic operations (e.g., addition
or multiplication). During this noise bootstrapping process, the polynomial
<!-- l. 598 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>V</mi> </mrow></math>
is used as a <span class='rm-lmri-10x-x-109'>dictionary </span>that contains the mappings from the noisy plaintext
<!-- l. 598 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi mathvariant='normal'>Δ</mi><mi>m</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>e</mi></mrow></math> (i.e., as
<!-- l. 598 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>i</mi></math> in
<!-- l. 598 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>v</mi></mrow><mrow><mi>i</mi></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mi>i</mi></mrow></msup></mrow></math>) to the noise-free
plaintext <!-- l. 598 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>m</mi></math>
(i.e., as <!-- l. 598 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>v</mi></mrow><mrow><mi>i</mi></mrow></msub></math>
in <!-- l. 598 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>v</mi></mrow><mrow><mi>i</mi></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mi>i</mi></mrow></msup></mrow></math>).
Therefore, <!-- l. 598 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>V</mi> </mrow></math>
is called Lookup Table (LUT).
</p><!-- l. 600 --><p class='indent'>   Then, what should be the degree of <!-- l. 600 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>V</mi> </mrow></math>?
In order for <!-- l. 600 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>V</mi> </mrow></math> to encode all
possible mappings from <!-- l. 600 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi mathvariant='normal'>Δ</mi><mi>m</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>e</mi> <mo class='MathClass-rel' stretchy='false'>∈</mo> <msub><mrow><mi>ℤ</mi></mrow><mrow><mi>q</mi></mrow></msub></mrow></math>
to <!-- l. 600 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>m</mi> <mo class='MathClass-rel' stretchy='false'>∈</mo> <msub><mrow><mi>ℤ</mi></mrow><mrow><mi>t</mi></mrow></msub></mrow></math>, it should be a
<!-- l. 600 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><mi>q</mi> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>-degree polynomial.
However, <!-- l. 600 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>q</mi></math>
is a very big number and it is computationally infeasible to manage a
<!-- l. 600 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><mi>q</mi> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>-degree
polynomial. Thus, in practice, we instead use a much smaller polynomial
<!-- l. 600 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>V</mi> </mrow></math> whose degree is
                                                                                         
                                                                                         
<!-- l. 600 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>n</mi> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></math>. Remember that according
to our TFHE setup, <!-- l. 600 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>n</mi> <mo class='MathClass-rel' stretchy='false'>&lt;</mo> <mi>q</mi></mrow></math>.
Therefore, we need a way to <span class='rm-lmri-10x-x-109'>compress </span>the big ciphertext space
<!-- l. 600 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi mathvariant='normal'>Δ</mi><mi>m</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>e</mi> <mo class='MathClass-rel' stretchy='false'>∈</mo> <msub><mrow><mi>ℤ</mi></mrow><mrow><mi>q</mi></mrow></msub></mrow></math> into the smaller space
<!-- l. 600 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>ℤ</mi></mrow><mrow><mi>n</mi></mrow></msub></math> and encode them
as the exponents of <!-- l. 600 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>X</mi></mrow><mrow><mi>i</mi></mrow></msup></math>
in a <span class='rm-lmri-10x-x-109'>proportionally </span>correct way. For this proportional compression from
<!-- l. 600 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>ℤ</mi></mrow><mrow><mi>q</mi></mrow></msub> <mo class='MathClass-rel' stretchy='false'>→</mo> <msub><mrow><mi>ℤ</mi></mrow><mrow><mi>n</mi></mrow></msub></mrow></math>, we will
use the LWE modulus switching technique learned from <a href='LWEModulusSwitching.html#lwe-modulus-switching'><span class='ts1-lmr10-x-x-109'>§</span>C-4.1<!-- tex4ht:ref: subsec:coeff-rotation  --></a>.
   
</p>
   <h5 class='subsubsectionHead' id='modulus-switch-for-noise-boootstrapping'><span class='titlemark'>D-1.8.2   </span> <a id='x103-129000D-1.8.2'></a>Modulus Switch for Noise Boootstrapping</h5>
<!-- l. 605 --><p class='noindent'>We need to compress <!-- l. 605 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>q</mi></math>
possible plaintext elements (<!-- l. 605 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi mathvariant='normal'>Δ</mi><mi>m</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>e</mi> <mo class='MathClass-rel' stretchy='false'>∈</mo> <msub><mrow><mi>ℤ</mi></mrow><mrow><mi>q</mi></mrow></msub></mrow></math>)
as <!-- l. 605 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>n</mi></math> distinct exponents
of the <!-- l. 605 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><mi>n</mi> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>-degree
polynomial <!-- l. 605 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>V</mi> </mrow></math>,
where each <!-- l. 605 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>v</mi></mrow><mrow><mi>i</mi></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mi>i</mi></mrow></msup></mrow></math> term
in <!-- l. 605 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>V</mi> </mrow></math> represents a
mapping from <!-- l. 605 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>i</mi> <mo class='MathClass-rel' stretchy='false'>→</mo><msub><mrow><mi>v</mi></mrow><mrow><mi>i</mi></mrow></msub></mrow></math>
(i.e., noisy plaintext to noise-free plaintext). However, notice that when we rotate the coefficients of the
<!-- l. 605 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><mi>n</mi> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>-degree polynomial
<!-- l. 605 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>V</mi> </mrow></math> to the left, as
<!-- l. 605 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>v</mi></mrow><mrow><mi>i</mi></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mi>i</mi></mrow></msup></mrow></math> rotates around the
boundary between <!-- l. 605 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>X</mi></mrow><mrow><mn>0</mn></mrow></msup></math>
and <!-- l. 605 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>X</mi></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msup></math> degree
terms, <!-- l. 605 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>v</mi></mrow><mrow><mi>i</mi></mrow></msub></math>’s
sign flips to <!-- l. 605 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-bin' stretchy='false'>−</mo><msub><mrow><mi>v</mi></mrow><mrow><mi>i</mi></mrow></msub></mrow></math>
(as shown in the example of <a href='CoefficientRotation.html#example1'><span class='ts1-lmr10-x-x-109'>§</span>A-5.2.1<!-- tex4ht:ref: subsec:coeff-rotation  --></a>). Due to this coefficient sign flip, the
<!-- l. 605 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><mi>n</mi> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>-degree polynomial
<!-- l. 605 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>V</mi> </mrow></math> can encode total
<!-- l. 605 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mn>2</mn><mi>n</mi></mrow></math> distinct coefficient
states as follows: <!-- l. 605 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>v</mi></mrow><mrow><mn>0</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>v</mi></mrow><mrow><mn>1</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>v</mi></mrow><mrow><mn>2</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><mstyle class='text'><mtext></mtext><mstyle class='math'><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace></mstyle><mtext></mtext></mstyle><mstyle class='text'><mtext> </mtext></mstyle><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>v</mi></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-bin' stretchy='false'>−</mo><msub><mrow><mi>v</mi></mrow><mrow><mn>0</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-bin' stretchy='false'>−</mo><msub><mrow><mi>v</mi></mrow><mrow><mn>1</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><mstyle class='text'><mtext></mtext><mstyle class='math'><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace></mstyle><mtext></mtext></mstyle><mstyle class='text'><mtext> </mtext></mstyle><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-bin' stretchy='false'>−</mo><msub><mrow><mi>v</mi></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>. To
move each of these <!-- l. 605 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mn>2</mn><mi>n</mi></mrow></math>
distinct coefficients to the constant term’s position in
<!-- l. 605 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>V</mi> </mrow></math> (i.e., , shifting the coefficient
<!-- l. 605 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>v</mi></mrow><mrow><mi>i</mi></mrow></msub></math> to the leftmost position),
the rotating computation of <!-- l. 605 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>V</mi> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>X</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mi>i</mi></mrow></msup></mrow></math>
can use <!-- l. 605 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mn>2</mn><mi>n</mi></mrow></math> distinct
<!-- l. 605 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>i</mi></math> values, which
are <!-- l. 605 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>{</mo><mn>0</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>1</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>2</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><mstyle class='text'><mtext></mtext><mstyle class='math'><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace></mstyle><mtext></mtext></mstyle><mstyle class='text'><mtext> </mtext></mstyle><mo class='MathClass-punc' stretchy='false'>,</mo><mi>n</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>n</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>1</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><mstyle class='text'><mtext></mtext><mstyle class='math'><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace></mstyle><mtext></mtext></mstyle><mstyle class='text'><mtext> </mtext></mstyle><mo class='MathClass-punc' stretchy='false'>,</mo><mn>2</mn><mi>n</mi><mo class='MathClass-close' stretchy='false'>}</mo></mrow></math>, to move
each of <!-- l. 605 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>v</mi></mrow><mrow><mn>0</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>v</mi></mrow><mrow><mn>1</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>v</mi></mrow><mrow><mn>2</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><mstyle class='text'><mtext></mtext><mstyle class='math'><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace></mstyle><mtext></mtext></mstyle><mstyle class='text'><mtext> </mtext></mstyle><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>v</mi></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-bin' stretchy='false'>−</mo><msub><mrow><mi>v</mi></mrow><mrow><mn>0</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-bin' stretchy='false'>−</mo><msub><mrow><mi>v</mi></mrow><mrow><mn>1</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><mstyle class='text'><mtext></mtext><mstyle class='math'><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace></mstyle><mtext></mtext></mstyle><mstyle class='text'><mtext> </mtext></mstyle><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-bin' stretchy='false'>−</mo><msub><mrow><mi>v</mi></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
coefficients to the constant term’s position. This implies that the exponent
                                                                                         
                                                                                         
<!-- l. 605 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>i</mi></math> in
<!-- l. 605 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>V</mi> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>X</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mi>i</mi></mrow></msup></mrow></math> can take in
<!-- l. 605 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mn>2</mn><mi>n</mi></mrow></math> distinct values to cover all
possible <!-- l. 605 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mn>2</mn><mi>n</mi></mrow></math> coefficient states. Also,
remember that <!-- l. 605 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>i</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mi mathvariant='normal'>Δ</mi><mi>m</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>e</mi></mrow></math>. Therefore,
we will switch the modulo of <!-- l. 605 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi mathvariant='normal'>Δ</mi><mi>m</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>e</mi></mrow></math>
from <!-- l. 605 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>q</mi> <mo class='MathClass-rel' stretchy='false'>→</mo><mn>2</mn><mi>n</mi></mrow></math>.
Using the LWE modulus switching technique (<a href='LWEModulusSwitching.html#lwe-modulus-switching'><span class='ts1-lmr10-x-x-109'>§</span>C-4.1<!-- tex4ht:ref: subsec:coeff-rotation  --></a>), our original LWE ciphertext
<!-- l. 605 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mover accent='true'><mrow><mi>s</mi></mrow><mo accent='true'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mi mathvariant='normal'>Δ</mi><mi>m</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>e</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>a</mi></mrow><mrow><mn>0</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>a</mi></mrow><mrow><mn>1</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><mstyle class='text'><mtext></mtext><mstyle class='math'><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace></mstyle><mtext></mtext></mstyle><mstyle class='text'><mtext> </mtext></mstyle><msub><mrow><mi>a</mi></mrow><mrow><mi>k</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><mi>b</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>∈</mo> <msubsup><mrow><mi>ℤ</mi></mrow><mrow><mi>q</mi></mrow><mrow><mi>k</mi><mo class='MathClass-bin' stretchy='false'>+</mo><mn>1</mn></mrow></msubsup></mrow></math> (i.e.,
the initial input to the noise bootstrapping procedure) will be converted into the following:
</p><!-- l. 607 --><p class='indent'>   <!-- l. 607 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 609 --><p class='indent'>   <!-- l. 609 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mover accent='true'><mrow><mi>s</mi></mrow><mo accent='true'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true'>^</mo></mover><mi>m</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>â</mi></mrow><mrow><mn>0</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>â</mi></mrow><mrow><mn>1</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><mstyle class='text'><mtext></mtext><mstyle class='math'><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace></mstyle><mtext></mtext></mstyle><mstyle class='text'><mtext> </mtext></mstyle><msub><mrow><mi>â</mi></mrow><mrow><mi>k</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><mover accent='true'><mrow><mi>b</mi></mrow><mo accent='true'>^</mo></mover><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>∈</mo> <msubsup><mrow><mi>ℤ</mi></mrow><mrow><mn>2</mn><mi>n</mi></mrow><mrow><mi>k</mi><mo class='MathClass-bin' stretchy='false'>+</mo><mn>1</mn></mrow></msubsup></mrow></math>
</p><!-- l. 611 --><p class='indent'>   <!-- l. 611 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mover accent='true'><mrow><mi>s</mi></mrow><mo accent='true'>→</mo></mover> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>s</mi></mrow><mrow><mn>0</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>s</mi></mrow><mrow><mn>1</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><mstyle class='text'><mtext></mtext><mstyle class='math'><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace></mstyle><mtext></mtext></mstyle><mstyle class='text'><mtext> </mtext></mstyle><msub><mrow><mi>s</mi></mrow><mrow><mi>k</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>∈</mo> <msubsup><mrow><mi>ℤ</mi></mrow><mrow><mn>2</mn></mrow><mrow><mi>k</mi><mo class='MathClass-bin' stretchy='false'>+</mo><mn>1</mn></mrow></msubsup></mrow></math> <span id='textcolor56'># the secret key
stays the same, as each <!-- l. 611 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>s</mi></mrow><mrow><mi>i</mi></mrow></msub></math>
is binary</span>
</p><!-- l. 613 --><p class='indent'>   <!-- l. 613 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true'>^</mo></mover> <mo class='MathClass-rel' stretchy='false'>=</mo> <mi mathvariant='normal'>Δ</mi><mstyle displaystyle='true'><mfrac><mrow><mn>2</mn><mi>n</mi>
 </mrow><mrow><mi>q</mi> </mrow></mfrac></mstyle> <mo class='MathClass-rel' stretchy='false'>∈</mo> <msub><mrow><mi>ℤ</mi></mrow><mrow><mn>2</mn><mi>n</mi></mrow></msub></mrow></math>
</p><!-- l. 615 --><p class='indent'>   <!-- l. 615 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>â</mi></mrow><mrow><mi>i</mi></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo> <mrow><mo fence='true' form='prefix'>⌈</mo><mrow><msub><mrow><mi>a</mi></mrow><mrow><mi>i</mi></mrow></msub><mstyle displaystyle='true'><mfrac><mrow><mn>2</mn><mi>n</mi>
 </mrow><mrow><mi>q</mi> </mrow></mfrac></mstyle></mrow><mo fence='true' form='postfix'>⌋</mo></mrow> <mo class='MathClass-rel' stretchy='false'>∈</mo> <msub><mrow><mi>ℤ</mi></mrow><mrow><mn>2</mn><mi>n</mi></mrow></msub></mrow></math>
</p><!-- l. 617 --><p class='indent'>   <!-- l. 617 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>ê</mi></mrow><mrow><mi>b</mi></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo> <mrow><mo fence='true' form='prefix'>⌈</mo><mrow><msub><mrow><mi>e</mi></mrow><mrow><mi>b</mi></mrow></msub><mstyle displaystyle='true'><mfrac><mrow><mn>2</mn><mi>n</mi>
 </mrow><mrow><mi>q</mi> </mrow></mfrac></mstyle></mrow><mo fence='true' form='postfix'>⌋</mo></mrow> <mo class='MathClass-rel' stretchy='false'>∈</mo> <msub><mrow><mi>ℤ</mi></mrow><mrow><mn>2</mn><mi>n</mi></mrow></msub></mrow></math>
</p><!-- l. 619 --><p class='indent'>   <!-- l. 619 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mover accent='true'><mrow><mi>b</mi></mrow><mo accent='true'>^</mo></mover> <mo class='MathClass-rel' stretchy='false'>=</mo> <mrow><mo fence='true' form='prefix'>⌈</mo><mrow><mi>b</mi><mstyle displaystyle='true'><mfrac><mrow><mn>2</mn><mi>n</mi>
 </mrow><mrow><mi>q</mi> </mrow></mfrac></mstyle></mrow><mo fence='true' form='postfix'>⌋</mo></mrow> <mo class='MathClass-rel' stretchy='false'>≈</mo><munderover accent='false' accentunder='false'><mrow><mi class='MathClass-op'>∑</mi><mo> ⁡<!-- FUNCTION APPLICATION --></mo>
  </mrow><mrow><mi>i</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>0</mn></mrow><mrow><mi>k</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></munderover><msub><mrow><mi>â</mi></mrow><mrow><mi>i</mi></mrow></msub><msub><mrow><mi>s</mi></mrow><mrow><mi>i</mi></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true'>^</mo></mover><mi>m</mi> <mo class='MathClass-bin' stretchy='false'>+</mo><msub><mrow> <mi>ê</mi></mrow><mrow><mi>b</mi></mrow></msub> <mo class='MathClass-rel' stretchy='false'>∈</mo> <msub><mrow><mi>ℤ</mi></mrow><mrow><mn>2</mn><mi>n</mi></mrow></msub></mrow></math>
</p><!-- l. 623 --><p class='indent'>   <!-- l. 623 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 625 --><p class='noindent'><span class='rm-lmbx-10x-x-109'>The degree of </span><!-- l. 625 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>V</mi> <mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
<span class='rm-lmbx-10x-x-109'>and Security</span>: If our goal were to design the minimal-degree polynomial
<!-- l. 625 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>V</mi> </mrow></math>
whose coefficients map all possible values of the plaintext
<!-- l. 625 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>m</mi></math>, then it would be sufficient
to design a <!-- l. 625 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>t</mi></math>-degree
polynomial <!-- l. 625 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>V</mi> </mrow></math>.
Nonetheless, there are two reasons why we choose the degree of
<!-- l. 625 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>V</mi> </mrow></math> to be
<!-- l. 625 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mn>2</mn><mi>n</mi></mrow></math> instead
of <!-- l. 625 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>t</mi></math>: (1)
greater gap of modulus switch creates more noise, due to the decreasing distance between the plaintext bits
and the noise bits in the ciphertext; (2) to guarantee an enough security level– the higher the polynomial
degree <!-- l. 625 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>n</mi></math>
is, the safer our scheme is against attacks.
   
</p>
   <h5 class='subsubsectionHead' id='halving-the-plaintext-space-to-be-used'><span class='titlemark'>D-1.8.3   </span> <a id='x103-130000D-1.8.3'></a>Halving the Plaintext Space To be Used</h5>
<!-- l. 632 --><p class='noindent'>Problematically, Lookup Table <!-- l. 632 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>V</mi> <mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
polynomial rotates <span class='rm-lmri-10x-x-109'>negacyclically</span>, that is, <!-- l. 632 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>V</mi> <mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo><msup><mrow><mi>X</mi></mrow><mrow><mi>n</mi></mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-bin' stretchy='false'>−</mo><mi>V</mi> <mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
                                                                                         
                                                                                         
(i.e., coefficients flip their signs with the rotating period of
<!-- l. 632 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>n</mi></math>). More
generally:
</p>
   <figure class='figure'> 

                                                                                         
                                                                                         
                                                                                         
                                                                                         
<table class='equation-star'><tr><td>
<!-- l. 635 --><math class='equation' display='block' xmlns='http://www.w3.org/1998/Math/MathML'><mrow>
<mi>V</mi> <mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>X</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mi>i</mi></mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo> <mi>V</mi> <mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>X</mi></mrow><mrow><mn>2</mn><mi>n</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mi>i</mi></mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo> <mi>V</mi> <mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>X</mi></mrow><mrow><mn>4</mn><mi>n</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mi>i</mi></mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-rel' stretchy='false'>⋯</mo> <mo class='MathClass-rel' stretchy='false'>=</mo> <mi>V</mi> <mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>X</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mo class='MathClass-open' stretchy='false'>(</mo><mi>i</mi><mstyle class='text'><mtext> </mtext></mstyle><mstyle class='text'><mtext>mod 2n)</mtext></mstyle><mstyle class='text'><mtext> </mtext></mstyle></mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo> <mrow class='cases'> <mrow><mo fence='true' form='prefix'>{</mo><mrow> <mtable align='axis' class='array' columnlines='none' displaystyle='true' equalcolumns='false' equalrows='false' rowlines='none none' style=''> <mtr class='array-row'><mtd class='array-td' columnalign='left'><msub><mrow><mi>v</mi></mrow><mrow><mi>i</mi></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>v</mi></mrow><mrow><mi>i</mi><mo class='MathClass-bin' stretchy='false'>+</mo><mn>1</mn></mrow></msub><mi>X</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext>for </mtext></mstyle><mn>0</mn> <mo class='MathClass-rel' stretchy='false'>≤</mo><mi>i</mi> <mo class='MathClass-rel' stretchy='false'>&lt;</mo> <mi>n</mi>    <mspace class='quad' width='1em'></mspace></mtd></mtr>  <mtr class='array-row'><mtd class='array-td' columnalign='left'><mspace class='quad' width='1em'></mspace></mtd></mtr>  <mtr class='array-row'><mtd class='array-td' columnalign='left'><mspace class='quad' width='1em'></mspace></mtd>
</mtr>  <mtr class='array-row'><mtd class='array-td' columnalign='left'><mo class='MathClass-bin' stretchy='false'>−</mo><msub><mrow><mi>v</mi></mrow><mrow><mi>i</mi></mrow></msub> <mo class='MathClass-bin' stretchy='false'>−</mo><msub><mrow><mi>v</mi></mrow><mrow><mi>i</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub><mi>X</mi> <mo class='MathClass-bin' stretchy='false'>−</mo><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext>for </mtext></mstyle><mi>n</mi> <mo class='MathClass-rel' stretchy='false'>≤</mo><mi>i</mi> <mo class='MathClass-rel' stretchy='false'>&lt;</mo> <mn>2</mn><mi>n</mi><mspace class='quad' width='1em'></mspace></mtd></mtr><!-- @{}l@{\quad }l@{} --></mtable>                                                                        </mrow><mo fence='true' form='postfix'></mo></mrow></mrow>
</mrow></math></td></tr></table>
                                                                                         
                                                                                         
   </figure>
<!-- l. 644 --><p class='noindent'>, where <!-- l. 644 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>v</mi></mrow><mrow><mi>i</mi></mrow></msub></math>
denotes the constant term’s coefficient after rotating the polynomial
<!-- l. 644 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>V</mi> <mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math> by
<!-- l. 644 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>i</mi></math> positions to the left.
Problematically, <!-- l. 644 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>v</mi></mrow><mrow><mi>i</mi></mrow></msub></math>
flips its sign whenever its rotation passes the boundary between
<!-- l. 644 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>X</mi></mrow><mrow><mn>0</mn></mrow></msup></math> and
<!-- l. 644 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>X</mi></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msup></math>. After applying modulus
switch (<a href='#modulus-switch-for-noise-boootstrapping'><span class='ts1-lmr10-x-x-109'>§</span>D-1.8.2<!-- tex4ht:ref: subsec:coeff-rotation  --></a>) to <!-- l. 644 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>V</mi> <mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>,
it becomes the following polynomial:
</p><!-- l. 646 --><p class='indent'>   <!-- l. 646 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 648 --><p class='indent'>   <!-- l. 648 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>V</mi> <mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mi>v</mi></mrow><mrow><mn>0</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>v</mi></mrow><mrow><mn>1</mn></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mn>1</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>v</mi></mrow><mrow><mn>2</mn></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mn>2</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <mstyle class='text'><mtext> </mtext></mstyle><mstyle class='text'><mtext></mtext><mstyle class='math'><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace></mstyle><mtext></mtext></mstyle><mstyle class='text'><mtext> </mtext></mstyle> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>v</mi></mrow><mrow><mi>n</mi></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msup></mrow></math>
</p><!-- l. 650 --><p class='indent'>     <!-- l. 650 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mi>m</mi></mrow><mrow><mn>0</mn></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true'>^</mo></mover><msub><mrow><mi>m</mi></mrow><mrow><mn>0</mn></mrow></msub><mo class='MathClass-bin' stretchy='false'>+</mo><msub><mrow><mi>ê</mi></mrow><mrow><mn>0</mn></mrow></msub></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>m</mi></mrow><mrow><mn>0</mn></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true'>^</mo></mover><msub><mrow><mi>m</mi></mrow><mrow><mn>0</mn></mrow></msub><mo class='MathClass-bin' stretchy='false'>+</mo><msub><mrow><mi>ê</mi></mrow><mrow><mn>1</mn></mrow></msub></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>m</mi></mrow><mrow><mn>0</mn></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true'>^</mo></mover><msub><mrow><mi>m</mi></mrow><mrow><mn>0</mn></mrow></msub><mo class='MathClass-bin' stretchy='false'>+</mo><msub><mrow><mi>ê</mi></mrow><mrow><mn>2</mn></mrow></msub></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <mstyle class='text'><mtext> </mtext></mstyle><mstyle class='text'><mtext></mtext><mstyle class='math'><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace></mstyle><mtext></mtext></mstyle><mstyle class='text'><mtext> </mtext></mstyle> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>m</mi></mrow><mrow><mn>0</mn></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true'>^</mo></mover><msub><mrow><mi>m</mi></mrow><mrow><mn>0</mn></mrow></msub><mo class='MathClass-bin' stretchy='false'>+</mo><msub><mrow><mi>ê</mi></mrow><mrow><mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true'>^</mo></mover><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub></mrow></msup></mrow></math>
</p><!-- l. 652 --><p class='indent'>     <!-- l. 652 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-bin' stretchy='false'>+</mo> <mstyle class='text'><mtext> </mtext></mstyle><msub><mrow><mi>m</mi></mrow><mrow><mn>1</mn></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true'>^</mo></mover><msub><mrow><mi>m</mi></mrow><mrow><mn>1</mn></mrow></msub><mo class='MathClass-bin' stretchy='false'>+</mo><msub><mrow><mi>ê</mi></mrow><mrow><mn>0</mn></mrow></msub></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>m</mi></mrow><mrow><mn>1</mn></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true'>^</mo></mover><msub><mrow><mi>m</mi></mrow><mrow><mn>1</mn></mrow></msub><mo class='MathClass-bin' stretchy='false'>+</mo><msub><mrow><mi>ê</mi></mrow><mrow><mn>1</mn></mrow></msub></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>m</mi></mrow><mrow><mn>1</mn></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true'>^</mo></mover><msub><mrow><mi>m</mi></mrow><mrow><mn>1</mn></mrow></msub><mo class='MathClass-bin' stretchy='false'>+</mo><msub><mrow><mi>ê</mi></mrow><mrow><mn>2</mn></mrow></msub></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <mstyle class='text'><mtext> </mtext></mstyle><mstyle class='text'><mtext></mtext><mstyle class='math'><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace></mstyle><mtext></mtext></mstyle><mstyle class='text'><mtext> </mtext></mstyle> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>m</mi></mrow><mrow><mn>1</mn></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true'>^</mo></mover><msub><mrow><mi>m</mi></mrow><mrow><mn>1</mn></mrow></msub><mo class='MathClass-bin' stretchy='false'>+</mo><msub><mrow><mi>ê</mi></mrow><mrow><mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true'>^</mo></mover><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub></mrow></msup></mrow></math>
</p><!-- l. 654 --><p class='indent'>     <!-- l. 654 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-bin' stretchy='false'>+</mo> <mstyle class='text'><mtext> </mtext></mstyle><mstyle class='text'><mtext></mtext><mstyle class='math'><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace></mstyle><mtext></mtext></mstyle><mstyle class='text'><mtext> </mtext></mstyle></mrow></math>
</p><!-- l. 656 --><p class='indent'>     <!-- l. 656 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-bin' stretchy='false'>+</mo> <mstyle class='text'><mtext> </mtext></mstyle><msub><mrow><mi>m</mi></mrow><mrow><mi>t</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true'>^</mo></mover><msub><mrow><mi>m</mi></mrow><mrow><mi>t</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub><mo class='MathClass-bin' stretchy='false'>+</mo><msub><mrow><mi>ê</mi></mrow><mrow><mn>0</mn></mrow></msub></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>m</mi></mrow><mrow><mi>t</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true'>^</mo></mover><msub><mrow><mi>m</mi></mrow><mrow><mi>t</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub><mo class='MathClass-bin' stretchy='false'>+</mo><msub><mrow><mi>ê</mi></mrow><mrow><mn>1</mn></mrow></msub></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>m</mi></mrow><mrow><mi>t</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true'>^</mo></mover><msub><mrow><mi>m</mi></mrow><mrow><mi>t</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub><mo class='MathClass-bin' stretchy='false'>+</mo><msub><mrow><mi>ê</mi></mrow><mrow><mn>2</mn></mrow></msub></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <mstyle class='text'><mtext> </mtext></mstyle><mstyle class='text'><mtext></mtext><mstyle class='math'><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace></mstyle><mtext></mtext></mstyle><mstyle class='text'><mtext> </mtext></mstyle> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>m</mi></mrow><mrow><mi>t</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true'>^</mo></mover><msub><mrow><mi>m</mi></mrow><mrow><mi>t</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub><mo class='MathClass-bin' stretchy='false'>+</mo><msub><mrow><mi>ê</mi></mrow><mrow><mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true'>^</mo></mover><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub></mrow></msup></mrow></math>
</p><!-- l. 658 --><p class='indent'>   <!-- l. 658 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 660 --><p class='noindent'>, where <!-- l. 660 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true'>^</mo></mover><msub><mrow><mi>m</mi></mrow><mrow><mi>t</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo><msub><mrow> <mi>ê</mi></mrow><mrow><mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true'>^</mo></mover><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub> <mo class='MathClass-rel' stretchy='false'>∈</mo> <msub><mrow><mi>ℤ</mi></mrow><mrow><mn>2</mn><mi>n</mi></mrow></msub></mrow></math>
</p><!-- l. 662 --><p class='indent'>   <!-- l. 662 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 664 --><p class='indent'>   Remember that by computing <!-- l. 664 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>V</mi> <mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>X</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><msup><mrow><mi>i</mi></mrow><mrow><mi>′</mi></mrow></msup>
   </mrow></msup></mrow></math>
for <!-- l. 664 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>i</mi></mrow><mrow><mi>′</mi></mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>{</mo><mn>0</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>1</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace><mo class='MathClass-punc' stretchy='false'>,</mo><mi>n</mi> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>}</mo></mrow></math>, we can rotate
<!-- l. 664 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>V</mi> <mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>’s coefficients to the
left by <!-- l. 664 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>{</mo><mn>0</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>1</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-rel' stretchy='false'>⋯</mo><mi>n</mi> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>}</mo></mrow></math> positions.
Also, remember that <!-- l. 664 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>i</mi></mrow><mrow><mi>′</mi></mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo> <mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true'>^</mo></mover><msub><mrow><mi>m</mi></mrow><mrow><mi>t</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo><msub><mrow> <mi>ê</mi></mrow><mrow><mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true'>^</mo></mover><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub></mrow></math>.
For each rotation of <!-- l. 664 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>i</mi></mrow><mrow><mi>′</mi></mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>{</mo><mn>0</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>1</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace><mo class='MathClass-punc' stretchy='false'>,</mo><mi>n</mi> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>}</mo></mrow></math>,
we get the following values as the constant-term coefficient:
</p><!-- l. 666 --><p class='indent'>   <!-- l. 666 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 669 --><p class='indent'>   <!-- l. 669 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 671 --><p class='indent'>   In the above expression, <!-- l. 671 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>e</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msub></math>
is a noise that can range from <!-- l. 671 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>[</mo><mn>0</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true'>^</mo></mover><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>.
Note that all of <!-- l. 671 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true'>^</mo></mover><msub><mrow><mi>m</mi></mrow><mrow><mi>i</mi></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>e</mi></mrow><mrow><mn>0</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true'>^</mo></mover><msub><mrow><mi>m</mi></mrow><mrow><mi>i</mi></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>e</mi></mrow><mrow><mn>1</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace><mo class='MathClass-punc' stretchy='false'>,</mo><mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true'>^</mo></mover><msub><mrow><mi>m</mi></mrow><mrow><mi>i</mi></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>e</mi></mrow><mrow><mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true'>^</mo></mover><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub></mrow></math>
exponents are associated with the same coefficient value,
<!-- l. 671 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>m</mi></mrow><mrow><mi>i</mi></mrow></msub></math>, because their underlying
plaintext <!-- l. 671 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>m</mi></mrow><mrow><mi>i</mi></mrow></msub></math> is the same. This is
why the coefficients for each <!-- l. 671 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>m</mi></mrow><mrow><mi>i</mi></mrow></msub></math>
are redundantly used <!-- l. 671 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true'>^</mo></mover></math>
times in <!-- l. 671 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>V</mi> <mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>.
</p><!-- l. 673 --><p class='indent'>   So far, the above sequence of <!-- l. 673 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>m</mi></mrow><mrow><mn>0</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>m</mi></mrow><mrow><mn>1</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>m</mi></mrow><mrow><mi>t</mi><mo class='MathClass-bin' stretchy='false'>∕</mo><mn>2</mn><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub></mrow></math>
coefficients is what we expect <!-- l. 673 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>V</mi> </mrow><mrow><mi>′</mi></mrow></msup><mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math> to
return for each of <!-- l. 673 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>[</mo><mn>0</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mi>n</mi> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math> rotations (where
each <!-- l. 673 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>m</mi></mrow><mrow><mi>i</mi></mrow></msub> <mo class='MathClass-rel' stretchy='false'>&lt;</mo> <msub><mrow><mi>m</mi></mrow><mrow><mi>i</mi><mo class='MathClass-bin' stretchy='false'>+</mo><mn>1</mn></mrow></msub></mrow></math>). However, the coefficient
mappings all break between <!-- l. 673 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>[</mo><mi>n</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mn>2</mn><mi>n</mi> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
rotations, because their coefficients get flipped signs as they pass the term’s boundary from
<!-- l. 673 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>X</mi></mrow><mrow><mn>0</mn></mrow></msup></math> to
                                                                                         
                                                                                         
<!-- l. 673 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>X</mi></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msup></math>, due to the nature of a
polynomial ring modulo <!-- l. 673 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>x</mi></mrow><mrow><mi>n</mi></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>:
</p><!-- l. 675 --><p class='indent'>   <!-- l. 675 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 677 --><p class='indent'>   <!-- l. 677 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mover class='msup'><mrow><mover accent='false'><mrow><mover class='msup'><mrow><mover accent='false'><mrow><munder class='msub'><mrow><munder accentunder='false'><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><msub><mrow><mi>m</mi></mrow><mrow><mi>t</mi><mo class='MathClass-bin' stretchy='false'>∕</mo><mn>2</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-bin' stretchy='false'>−</mo><msub><mrow><mi>m</mi></mrow><mrow><mi>t</mi><mo class='MathClass-bin' stretchy='false'>∕</mo><mn>2</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><mstyle class='text'><mtext></mtext><mstyle class='math'><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace></mstyle><mtext></mtext></mstyle><mstyle class='text'><mtext> </mtext></mstyle></mrow><mo>⏟</mo></munder></mrow><mrow><mstyle class='text'><mtext>coeff. of </mtext></mstyle><msup><mrow><mi>X</mi></mrow><mrow><mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true'>^</mo></mover>
   <msub><mrow><mi>m</mi></mrow><mrow><mi>t</mi><mo class='MathClass-bin' stretchy='false'>∕</mo><mn>2</mn></mrow></msub><mo class='MathClass-bin' stretchy='false'>+</mo><msub><mrow><mi>e</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msub>
         </mrow></msup></mrow></munder></mrow><mo>︷</mo></mover></mrow><mrow><mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true'>^</mo></mover><mstyle class='text'><mtext> repetitions</mtext></mstyle></mrow></mover><mover class='msup'><mrow><mover accent='false'><mrow><munder class='msub'><mrow><munder accentunder='false'><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><msub><mrow><mi>m</mi></mrow><mrow>
<mi>t</mi><mo class='MathClass-bin' stretchy='false'>∕</mo><mn>2</mn><mo class='MathClass-bin' stretchy='false'>+</mo><mn>1</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-bin' stretchy='false'>−</mo><msub><mrow><mi>m</mi></mrow><mrow><mi>t</mi><mo class='MathClass-bin' stretchy='false'>∕</mo><mn>2</mn><mo class='MathClass-bin' stretchy='false'>+</mo><mn>1</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><mstyle class='text'><mtext></mtext><mstyle class='math'><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace></mstyle><mtext></mtext></mstyle><mstyle class='text'><mtext> </mtext></mstyle></mrow><mo>⏟</mo></munder></mrow><mrow><mstyle class='text'><mtext>coeff. of </mtext></mstyle><msup><mrow><mi>X</mi></mrow><mrow><mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true'>^</mo></mover><msub><mrow><mi>m</mi></mrow><mrow><mi>t</mi><mo class='MathClass-bin' stretchy='false'>∕</mo><mn>2</mn><mo class='MathClass-bin' stretchy='false'>+</mo><mn>1</mn></mrow></msub><mo class='MathClass-bin' stretchy='false'>+</mo><msub><mrow><mi>e</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msub></mrow></msup></mrow></munder></mrow><mo>︷</mo></mover></mrow><mrow><mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true'>^</mo></mover><mstyle class='text'><mtext> repetitions</mtext></mstyle></mrow></mover><mstyle class='text'><mtext> </mtext></mstyle><mstyle class='text'><mtext></mtext><mstyle class='math'><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace></mstyle><mtext></mtext></mstyle><mstyle class='text'><mtext> </mtext></mstyle><mover class='msup'><mrow><mover accent='false'><mrow><munder class='msub'><mrow><munder accentunder='false'><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><msub><mrow><mi>m</mi></mrow><mrow>
<mi>t</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-bin' stretchy='false'>−</mo><msub><mrow><mi>m</mi></mrow><mrow><mi>t</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><mstyle class='text'><mtext></mtext><mstyle class='math'><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace></mstyle><mtext></mtext></mstyle><mstyle class='text'><mtext> </mtext></mstyle></mrow><mo>⏟</mo></munder></mrow><mrow><mstyle class='text'><mtext>coeff. of </mtext></mstyle><msup><mrow><mi>X</mi></mrow><mrow><mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true'>^</mo></mover><msub><mrow><mi>m</mi></mrow><mrow><mi>t</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub><mo class='MathClass-bin' stretchy='false'>+</mo><msub><mrow><mi>e</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msub></mrow></msup></mrow></munder></mrow><mo>︷</mo></mover></mrow><mrow><mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true'>^</mo></mover><mstyle class='text'><mtext> repetitions</mtext></mstyle></mrow></mover></mrow><mo>︷</mo></mover></mrow><mrow><mstyle class='text'><mtext></mtext><mstyle class='math'><mi>V</mi> <mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo></mstyle><mtext>’s constant term coefficient after each of </mtext><mstyle class='math'><mi>n</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>n</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>1</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-rel' stretchy='false'>⋯</mo><mn>2</mn><mi>n</mi> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mstyle><mtext> rotations</mtext></mstyle></mrow></mover></math>
</p><!-- l. 679 --><p class='indent'>   <!-- l. 679 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 681 --><p class='indent'>   As you see above, the rotated <!-- l. 681 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>V</mi> </mrow><mrow><mi>′</mi></mrow></msup><mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>’s
constant term coefficient shows a negacyclic pattern with the period of
<!-- l. 681 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>n</mi></math>, where the
second <!-- l. 681 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>n</mi></math>
rotation group’s coefficients are the exactly negatived values of the first
<!-- l. 681 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>n</mi></math> rotation
group’s values. Let’s understand why this negacyclic behavior breaks the (exponent, coefficient) =
<!-- l. 681 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true'>^</mo></mover><mi>m</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>ê</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>m</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math> mappings. The semantic
meaning of rotating <!-- l. 681 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>V</mi> <mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
to the left by 1 position means that we increase the value of
<!-- l. 681 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true'>^</mo></mover><msub><mrow><mi>m</mi></mrow><mrow><mi>i</mi></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>e</mi></mrow></math> (i.e., noisy plaintext’s value)
by 1 when we compute <!-- l. 681 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>V</mi> <mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>X</mi></mrow><mrow><mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true'>^</mo></mover><msub><mrow><mi>m</mi></mrow><mrow><mi>i</mi></mrow></msub><mo class='MathClass-bin' stretchy='false'>+</mo><mi>e</mi></mrow></msup></mrow></math>,
and get the rotated <!-- l. 681 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>V</mi> </mrow><mrow><msup><mrow></mrow><mrow><mi>′</mi></mrow></msup></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>’s
constant term coefficient <!-- l. 681 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>m</mi></mrow><mrow><mi>i</mi></mrow></msub></math>
(i.e, the mapped noise-free plaintext). Therefore, as we gradually increase the rotation count of
<!-- l. 681 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>V</mi> </mrow></math> from
<!-- l. 681 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>[</mo><mn>0</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>2</mn><mi>n</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>, the returned
<!-- l. 681 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>m</mi></mrow><mrow><mi>i</mi></mrow></msub></math> should be a value that is either
the same or greater than <!-- l. 681 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>m</mi></mrow><mrow><mi>i</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub></math>, all
the way to <!-- l. 681 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>m</mi></mrow><mrow><mi>t</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub></math>. This constraint
holds for the first-half <!-- l. 681 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>i</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>[</mo><mn>0</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mi>n</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>, as
the rotated <!-- l. 681 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>V</mi> </mrow><mrow><mi>′</mi></mrow></msup><mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>’s constant term
coefficient is <!-- l. 681 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>m</mi></mrow><mrow><mn>0</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>m</mi></mrow><mrow><mn>1</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>m</mi></mrow><mrow><mi>t</mi><mo class='MathClass-bin' stretchy='false'>∕</mo><mn>2</mn><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub></mrow></math>. However,
for the second-half <!-- l. 681 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>i</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>[</mo><mi>n</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mn>2</mn><mi>n</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>, the
rotated <!-- l. 681 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>V</mi> </mrow><mrow><mi>′</mi></mrow></msup><mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>’s constant term
coefficient is <!-- l. 681 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-bin' stretchy='false'>−</mo><msub><mrow><mi>m</mi></mrow><mrow><mn>0</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-bin' stretchy='false'>−</mo><msub><mrow><mi>m</mi></mrow><mrow><mn>1</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-bin' stretchy='false'>−</mo><msub><mrow><mi>m</mi></mrow><mrow><mi>t</mi><mo class='MathClass-bin' stretchy='false'>∕</mo><mn>2</mn><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub></mrow></math>, which violates
our constraint that <!-- l. 681 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>m</mi></mrow><mrow><mi>i</mi></mrow></msub> <mo class='MathClass-rel' stretchy='false'>≤</mo><msub><mrow><mi>m</mi></mrow><mrow><mi>i</mi><mo class='MathClass-bin' stretchy='false'>+</mo><mn>1</mn></mrow></msub></mrow></math>.
Therefore, the combination of the first-half and the second-half domains of
<!-- l. 681 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>i</mi></math>
cannot mathematically implement a continuous modulo value range
<!-- l. 681 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>ℤ</mi></mrow><mrow><mi>t</mi></mrow></msub></math>.
</p><!-- l. 683 --><p class='indent'>   To summarize the problem, <!-- l. 683 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>V</mi> <mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
cannot be used as a complete bootstrapping LUT, because it preserves the correct mappings of (exponent, coefficient)
= <!-- l. 683 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true'>^</mo></mover><mi>m</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>ê</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>m</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math> only for
one half of <!-- l. 683 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>i</mi> <mo class='MathClass-rel' stretchy='false'>∈</mo> <msub><mrow><mi>ℤ</mi></mrow><mrow><mi>t</mi></mrow></msub></mrow></math>,
not for the other half.
</p><!-- l. 685 --><p class='noindent'><span class='rm-lmbx-10x-x-109'>Solution: </span>Fortunately, we have verified that <!-- l. 686 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>V</mi> <mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>’s
mappings of (exponent, coefficient) = <!-- l. 686 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true'>^</mo></mover><mi>m</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>ê</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi mathvariant='normal'>Δ</mi><mi>m</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
preserve their consistency if <!-- l. 686 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>V</mi> <mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
is rotated no more than <!-- l. 686 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>n</mi> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></math>
                                                                                         
                                                                                         
positions. Therefore, the most practical solution for the negacyclic problem of polynomial rotation is to restrict
<!-- l. 686 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>V</mi> <mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math> to be rotated
no more than <!-- l. 686 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>n</mi> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></math>
positions during the noise bootstrapping. To enforce this, we can require the TFHE application
such that while it processes plaintext numbers (in its original plaintext computation logic
without homomorphic computation), the application should ensure to use only some continuous
<!-- l. 686 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mstyle displaystyle='true'><mfrac><mrow> <mi>t</mi>
</mrow><mrow><mn>2</mn></mrow></mfrac></mstyle></math> modulo values within
<!-- l. 686 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>ℤ</mi></mrow><mrow><mi>t</mi></mrow></msub></math>. This enforces the
possible values of <!-- l. 686 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true'>^</mo></mover><mi>m</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>ê</mi></mrow></math>
to be continuous <!-- l. 686 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>n</mi></math>
modulo values within <!-- l. 686 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>ℤ</mi></mrow><mrow><mn>2</mn><mi>n</mi></mrow></msub></math>.
Since LUT <!-- l. 686 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>V</mi> <mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math> is rotated
by computing <!-- l. 686 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>V</mi> <mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>X</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mo class='MathClass-open' stretchy='false'>(</mo><mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true'>^</mo></mover><mi>m</mi><mo class='MathClass-bin' stretchy='false'>+</mo><mi>ê</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup></mrow></math>,
as we restrict <!-- l. 686 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true'>^</mo></mover><mi>m</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>ê</mi></mrow></math>
to be at most <!-- l. 686 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>n</mi> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></math>,
<!-- l. 686 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>V</mi> <mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math> will be rotated
at most <!-- l. 686 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>n</mi> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></math>
positions during the noise bootstrapping. Thus, we can prevent the occurrences of the problematic
<!-- l. 686 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>{</mo><mi>n</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>n</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>1</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><mstyle class='text'><mtext></mtext><mstyle class='math'><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace></mstyle><mtext></mtext></mstyle><mstyle class='text'><mtext> </mtext></mstyle><mo class='MathClass-punc' stretchy='false'>,</mo><mn>2</mn><mi>n</mi> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>}</mo></mrow></math>
rotations that cause coefficient extraction of double-signed contradicting coefficients.
</p><!-- l. 688 --><p class='indent'>   To summarize, at the cost of halving the application’s usable plaintext values to some continuous
<!-- l. 688 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mstyle displaystyle='true'><mfrac><mrow> <mi>t</mi>
</mrow><mrow><mn>2</mn></mrow></mfrac></mstyle></math> modulo values within
<!-- l. 688 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>ℤ</mi></mrow><mrow><mi>t</mi></mrow></msub></math>, we can prevent
<!-- l. 688 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>V</mi> <mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>’s negacyclic rotation problem, and
thereby preserve <!-- l. 688 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>V</mi> <mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>’s correct mappings
of (exponent, coefficient) = <!-- l. 688 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true'>^</mo></mover><mi>m</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>ê</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi mathvariant='normal'>Δ</mi><mi>m</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>.
</p><!-- l. 711 --><p class='indent'>   Considering all these, our final LUT polynomial
<!-- l. 711 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>V</mi> <mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math> is as
follows:
</p>
   <div class='tcolorbox tcolorbox' id='tcolobox-75'>     
<div class='tcolorbox-title'>
<!-- l. 734 --><p class='indent'>   <!-- l. 734 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mstyle mathvariant='bold'><mo class='MathClass-open' stretchy='false'>⟨</mo></mstyle></math><span class='rm-lmbx-10x-x-109'>Summary </span><a href='#halving-the-plaintext-space-to-be-used'><span class='rm-lmbx-10x-x-109'>D-1.8.3</span><!-- tex4ht:ref: subsec:tfhe-zero-padding  --></a><!-- l. 734 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mstyle mathvariant='bold'><mo class='MathClass-close' stretchy='false'>⟩</mo></mstyle></math>
<span class='rm-lmbx-10x-x-109'>Structure  of  Lookup  Table  Polynomial</span>
                                                                                         
                                                                                         
<!-- l. 734 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mstyle mathvariant='bold'><mi>𝐕</mi> <mo class='MathClass-open' stretchy='false'>(</mo><mi>𝐗</mi><mo class='MathClass-close' stretchy='false'>)</mo></mstyle></math></p></div> 
<div class='tcolorbox-content'><!-- l. 715 --><p class='noindent'><!-- l. 715 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 717 --><p class='noindent'><!-- l. 717 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>V</mi> <mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mi>v</mi></mrow><mrow><mn>0</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>v</mi></mrow><mrow><mn>1</mn></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mn>1</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>v</mi></mrow><mrow><mn>2</mn></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mn>2</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <mstyle class='text'><mtext> </mtext></mstyle><mstyle class='text'><mtext></mtext><mstyle class='math'><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace></mstyle><mtext></mtext></mstyle><mstyle class='text'><mtext> </mtext></mstyle> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>v</mi></mrow><mrow><mi>n</mi></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msup></mrow></math>
</p><!-- l. 719 --><p class='noindent'>
<!-- l. 719 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mi>m</mi></mrow><mrow><mn>0</mn></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true'>^</mo></mover><msub><mrow><mi>m</mi></mrow><mrow><mn>0</mn></mrow></msub><mo class='MathClass-bin' stretchy='false'>+</mo><msub><mrow><mi>ê</mi></mrow><mrow><mn>0</mn></mrow></msub></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>m</mi></mrow><mrow><mn>0</mn></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true'>^</mo></mover><msub><mrow><mi>m</mi></mrow><mrow><mn>0</mn></mrow></msub><mo class='MathClass-bin' stretchy='false'>+</mo><msub><mrow><mi>ê</mi></mrow><mrow><mn>1</mn></mrow></msub></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>m</mi></mrow><mrow><mn>0</mn></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true'>^</mo></mover><msub><mrow><mi>m</mi></mrow><mrow><mn>0</mn></mrow></msub><mo class='MathClass-bin' stretchy='false'>+</mo><msub><mrow><mi>ê</mi></mrow><mrow><mn>2</mn></mrow></msub></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <mstyle class='text'><mtext> </mtext></mstyle><mstyle class='text'><mtext></mtext><mstyle class='math'><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace></mstyle><mtext></mtext></mstyle><mstyle class='text'><mtext> </mtext></mstyle> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>m</mi></mrow><mrow><mn>0</mn></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true'>^</mo></mover><msub><mrow><mi>m</mi></mrow><mrow><mn>0</mn></mrow></msub><mo class='MathClass-bin' stretchy='false'>+</mo><msub><mrow><mi>ê</mi></mrow><mrow><mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true'>^</mo></mover><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub></mrow></msup></mrow></math>
</p><!-- l. 721 --><p class='noindent'>
<!-- l. 721 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-bin' stretchy='false'>+</mo> <mstyle class='text'><mtext> </mtext></mstyle><msub><mrow><mi>m</mi></mrow><mrow><mn>1</mn></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true'>^</mo></mover><msub><mrow><mi>m</mi></mrow><mrow><mn>1</mn></mrow></msub><mo class='MathClass-bin' stretchy='false'>+</mo><msub><mrow><mi>ê</mi></mrow><mrow><mn>0</mn></mrow></msub></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>m</mi></mrow><mrow><mn>1</mn></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true'>^</mo></mover><msub><mrow><mi>m</mi></mrow><mrow><mn>1</mn></mrow></msub><mo class='MathClass-bin' stretchy='false'>+</mo><msub><mrow><mi>ê</mi></mrow><mrow><mn>1</mn></mrow></msub></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>m</mi></mrow><mrow><mn>1</mn></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true'>^</mo></mover><msub><mrow><mi>m</mi></mrow><mrow><mn>1</mn></mrow></msub><mo class='MathClass-bin' stretchy='false'>+</mo><msub><mrow><mi>ê</mi></mrow><mrow><mn>2</mn></mrow></msub></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <mstyle class='text'><mtext> </mtext></mstyle><mstyle class='text'><mtext></mtext><mstyle class='math'><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace></mstyle><mtext></mtext></mstyle><mstyle class='text'><mtext> </mtext></mstyle> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>m</mi></mrow><mrow><mn>1</mn></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true'>^</mo></mover><msub><mrow><mi>m</mi></mrow><mrow><mn>1</mn></mrow></msub><mo class='MathClass-bin' stretchy='false'>+</mo><msub><mrow><mi>ê</mi></mrow><mrow><mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true'>^</mo></mover><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub></mrow></msup></mrow></math>
</p><!-- l. 723 --><p class='noindent'>
<!-- l. 723 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-bin' stretchy='false'>+</mo> <mstyle class='text'><mtext> </mtext></mstyle><mstyle class='text'><mtext></mtext><mstyle class='math'><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace></mstyle><mtext></mtext></mstyle><mstyle class='text'><mtext> </mtext></mstyle></mrow></math>
</p><!-- l. 725 --><p class='noindent'>
<!-- l. 725 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>m</mi></mrow><mrow><mi>t</mi><mo class='MathClass-bin' stretchy='false'>∕</mo><mn>2</mn><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true'>^</mo></mover><msub><mrow><mi>m</mi></mrow><mrow><mi>t</mi><mo class='MathClass-bin' stretchy='false'>∕</mo><mn>2</mn><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub><mo class='MathClass-bin' stretchy='false'>+</mo><msub><mrow><mi>ê</mi></mrow><mrow><mn>0</mn></mrow></msub>
                       </mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>m</mi></mrow><mrow><mi>t</mi><mo class='MathClass-bin' stretchy='false'>∕</mo><mn>2</mn><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true'>^</mo></mover><msub><mrow><mi>m</mi></mrow><mrow><mi>t</mi><mo class='MathClass-bin' stretchy='false'>∕</mo><mn>2</mn><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub><mo class='MathClass-bin' stretchy='false'>+</mo><msub><mrow><mi>ê</mi></mrow><mrow><mn>1</mn></mrow></msub>
                       </mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>m</mi></mrow><mrow><mi>t</mi><mo class='MathClass-bin' stretchy='false'>∕</mo><mn>2</mn><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true'>^</mo></mover><msub><mrow><mi>m</mi></mrow><mrow><mi>t</mi><mo class='MathClass-bin' stretchy='false'>∕</mo><mn>2</mn><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub><mo class='MathClass-bin' stretchy='false'>+</mo><msub><mrow><mi>ê</mi></mrow><mrow><mn>2</mn></mrow></msub>
                       </mrow></msup></mrow></math>
</p><!-- l. 727 --><p class='noindent'>
<!-- l. 727 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-bin' stretchy='false'>+</mo> <mstyle class='text'><mtext> </mtext></mstyle><mstyle class='text'><mtext></mtext><mstyle class='math'><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace></mstyle><mtext></mtext></mstyle><mstyle class='text'><mtext> </mtext></mstyle> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>m</mi></mrow><mrow><mi>t</mi><mo class='MathClass-bin' stretchy='false'>∕</mo><mn>2</mn><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true'>^</mo></mover><msub><mrow><mi>m</mi></mrow><mrow><mi>t</mi><mo class='MathClass-bin' stretchy='false'>∕</mo><mn>2</mn><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub><mo class='MathClass-bin' stretchy='false'>+</mo><msub><mrow><mi>ê</mi></mrow><mrow><mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true'>^</mo></mover><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub>
                             </mrow></msup></mrow></math>
</p><!-- l. 729 --><p class='noindent'><!-- l. 729 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 731 --><p class='noindent'>, where <!-- l. 731 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true'>^</mo></mover> <mo class='MathClass-rel' stretchy='false'>=</mo> <mi mathvariant='normal'>Δ</mi> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mstyle displaystyle='true'><mfrac><mrow><mn>2</mn><mi>n</mi>
 </mrow><mrow><mi>q</mi> </mrow></mfrac></mstyle></mrow></math>.
The application should ensure that <!-- l. 731 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>m</mi></mrow><mrow><mn>0</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>m</mi></mrow><mrow><mn>1</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>m</mi></mrow><mrow><mi>t</mi><mo class='MathClass-bin' stretchy='false'>∕</mo><mn>2</mn><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub></mrow></math>
is some continuous <!-- l. 731 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mstyle displaystyle='true'><mfrac><mrow> <mi>t</mi>
</mrow><mrow><mn>2</mn></mrow></mfrac></mstyle></math>
modulo values in <!-- l. 731 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>ℤ</mi></mrow><mrow><mi>t</mi></mrow></msub></math>.
This constraint ensures <!-- l. 731 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>V</mi> <mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>’s
rotation positions <!-- l. 731 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true'>^</mo></mover><msub><mrow><mi>m</mi></mrow><mrow><mi>i</mi></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo><msub><mrow> <mi>ê</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msub></mrow></math>
to be at most <!-- l. 731 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>n</mi></math>
continuous possibilities, preventing <!-- l. 731 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>V</mi> <mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
from making more than 1 full-circle rotation that triggers a negacyclic problem.
</p>
 
</div> 
</div>
   
   <h5 class='subsubsectionHead' id='blind-rotation'><span class='titlemark'>D-1.8.4   </span> <a id='x103-131000D-1.8.4'></a>Blind Rotation</h5>
<!-- l. 740 --><p class='noindent'>Blind rotation refers to rotating an <span class='rm-lmri-10x-x-109'>encrypted </span>polynomial’s coefficients so that it is not possible to know
how many positions the polynomial’s coefficients are rotated, and after the rotation, it is not
possible to see which coefficient has moved to which degree term. Blind rotation uses the basic
polynomial rotation method 1 technique (Summary <a href='CoefficientRotation.html#coefficient-rotation'>A-5.2<!-- tex4ht:ref: subsec:coeff-rotation  --></a> in <a href='CoefficientRotation.html#coefficient-rotation'><span class='ts1-lmr10-x-x-109'>§</span>A-5.2<!-- tex4ht:ref: subsec:coeff-rotation  --></a>), with the difference that the
<!-- l. 740 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>V</mi> <mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>X</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mi>i</mi></mrow></msup></mrow></math>
computation is done homomorphically.
</p><!-- l. 742 --><p class='indent'>   Note that <!-- l. 742 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>X</mi></mrow><mrow><mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true'>^</mo></mover><mi>m</mi><mo class='MathClass-bin' stretchy='false'>+</mo><msub><mrow><mi>ê</mi></mrow><mrow><mi>b</mi></mrow></msub></mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo> <msup><mrow><mi>X</mi></mrow><mrow><mover accent='true'><mrow><mi>b</mi></mrow><mo accent='true'>^</mo></mover><mo class='MathClass-bin' stretchy='false'>−</mo><msubsup><mrow><mi class='MathClass-op'>∑</mi><mo> ⁡<!-- FUNCTION APPLICATION --></mo><!-- nolimits --></mrow><mrow>
<mi>i</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>0</mn></mrow><mrow><mi>k</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msubsup><msub><mrow><mi>â</mi></mrow><mrow><mi>i</mi></mrow></msub><msub><mrow><mi>s</mi></mrow><mrow><mi>i</mi></mrow></msub>
                        </mrow></msup></mrow></math>, so
we can rotate <!-- l. 742 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>V</mi> </mrow></math>
by computing <!-- l. 742 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>V</mi> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>X</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mo class='MathClass-open' stretchy='false'>(</mo><mover accent='true'><mrow><mi>b</mi></mrow><mo accent='true'>^</mo></mover><mo class='MathClass-bin' stretchy='false'>−</mo><msubsup><mrow><mi class='MathClass-op'>∑</mi><mo> ⁡<!-- FUNCTION APPLICATION --></mo><!-- nolimits --></mrow><mrow>
<mi>i</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>0</mn></mrow><mrow><mi>k</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msubsup><msub><mrow><mi>â</mi></mrow><mrow><mi>i</mi></mrow></msub><msub><mrow><mi>s</mi></mrow><mrow><mi>i</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo>
                               </mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo> <mi>V</mi> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>X</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mover accent='true'><mrow><mi>b</mi></mrow><mo accent='true'>^</mo></mover><mo class='MathClass-bin' stretchy='false'>+</mo><msubsup><mrow><mi class='MathClass-op'>∑</mi><mo> ⁡<!-- FUNCTION APPLICATION --></mo><!-- nolimits --></mrow><mrow>
<mi>i</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>0</mn></mrow><mrow><mi>k</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msubsup><msub><mrow><mi>â</mi></mrow><mrow><mi>i</mi></mrow></msub><msub><mrow><mi>s</mi></mrow><mrow><mi>i</mi></mrow></msub>
                          </mrow></msup></mrow></math>.
In fact, we cannot directly compute the LWE decryption formula
<!-- l. 742 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-bin' stretchy='false'>−</mo><mover accent='true'><mrow><mi>b</mi></mrow><mo accent='true'>^</mo></mover> <mo class='MathClass-bin' stretchy='false'>+</mo><msubsup><mrow> <mi class='MathClass-op'>∑</mi><mo> ⁡<!-- FUNCTION APPLICATION --></mo>
  <!-- nolimits --></mrow><mrow><mi>i</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>0</mn></mrow><mrow><mi>k</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msubsup><msub><mrow><mi>â</mi></mrow><mrow><mi>i</mi></mrow></msub><msub><mrow><mi>s</mi></mrow><mrow><mi>i</mi></mrow></msub></mrow></math> (or
<!-- l. 742 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mover accent='true'><mrow><mi>b</mi></mrow><mo accent='true'>^</mo></mover> <mo class='MathClass-bin' stretchy='false'>−</mo><msubsup><mrow><mi class='MathClass-op'>∑</mi><mo> ⁡<!-- FUNCTION APPLICATION --></mo>
  <!-- nolimits --></mrow><mrow><mi>i</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>0</mn></mrow><mrow><mi>k</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msubsup><msub><mrow><mi>â</mi></mrow><mrow><mi>i</mi></mrow></msub><msub><mrow><mi>s</mi></mrow><mrow><mi>i</mi></mrow></msub></mrow></math>) without the knowledge
of the LWE secret key <!-- l. 742 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>S</mi></math>.
Nevertheless, there is a mathematical work-around to compute
<!-- l. 742 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>V</mi> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>X</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mover accent='true'><mrow><mi>b</mi></mrow><mo accent='true'>^</mo></mover><mo class='MathClass-bin' stretchy='false'>+</mo><msubsup><mrow><mi class='MathClass-op'>∑</mi><mo> ⁡<!-- FUNCTION APPLICATION --></mo><!-- nolimits --></mrow><mrow>
<mi>i</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>0</mn></mrow><mrow><mi>k</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msubsup><msub><mrow><mi>â</mi></mrow><mrow><mi>i</mi></mrow></msub><msub><mrow><mi>s</mi></mrow><mrow><mi>i</mi></mrow></msub>
                          </mrow></msup></mrow></math> without the knowledge of the
secret key <!-- l. 742 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>S</mi></math>, provided we are given
<!-- l. 742 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msubsup><mrow><mo class='MathClass-open' stretchy='false'>{</mo><mi mathvariant='italic'>𝐺𝐺𝑆</mi><msubsup><mrow><mi>W</mi></mrow><mrow><msub><mrow><mover accent='true'><mrow><mi>S</mi></mrow><mo accent='true'>→</mo></mover></mrow><mrow><mi mathvariant='italic'>𝑏𝑘</mi></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow><mrow><mi>β</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>l</mi></mrow></msubsup><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>s</mi></mrow><mrow><mi>i</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-close' stretchy='false'>}</mo></mrow><mrow><mi>i</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>0</mn></mrow><mrow><mi>k</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msubsup></math> at the TFHE setup stage. Note
                                                                                         
                                                                                         
that <!-- l. 742 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msubsup><mrow><mo class='MathClass-open' stretchy='false'>{</mo><mi mathvariant='italic'>𝐺𝐺𝑆</mi><msubsup><mrow><mi>W</mi></mrow><mrow><msub><mrow><mover accent='true'><mrow><mi>S</mi></mrow><mo accent='true'>→</mo></mover></mrow><mrow><mi mathvariant='italic'>𝑏𝑘</mi></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow><mrow><mi>β</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>l</mi></mrow></msubsup><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>s</mi></mrow><mrow><mi>i</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-close' stretchy='false'>}</mo></mrow><mrow><mi>i</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>0</mn></mrow><mrow><mi>k</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msubsup></math> is an GGSW encryption of
the LWE secret key <!-- l. 742 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>S</mi></math>, encrypted
by the GLWE secret key <!-- l. 742 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mover accent='true'><mrow><mi>S</mi></mrow><mo accent='true'>→</mo></mover></mrow><mrow><mi mathvariant='italic'>𝑏𝑘</mi></mrow></msub></math> (i.e.,
a <span class='rm-lmri-10x-x-109'>bootstrapping </span>key). We use <!-- l. 742 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mover accent='true'><mrow><mi>S</mi></mrow><mo accent='true'>→</mo></mover></mrow><mrow><mi mathvariant='italic'>𝑏𝑘</mi></mrow></msub></math> to
homomorphically compute <!-- l. 742 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>V</mi> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>X</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mover accent='true'><mrow><mi>b</mi></mrow><mo accent='true'>^</mo></mover><mo class='MathClass-bin' stretchy='false'>+</mo><msubsup><mrow><mi class='MathClass-op'>∑</mi><mo> ⁡<!-- FUNCTION APPLICATION --></mo><!-- nolimits --></mrow><mrow>
<mi>i</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>0</mn></mrow><mrow><mi>k</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msubsup><msub><mrow><mi>â</mi></mrow><mrow><mi>i</mi></mrow></msub><msub><mrow><mi>s</mi></mrow><mrow><mi>i</mi></mrow></msub>
                          </mrow></msup></mrow></math> (i.e.,
blindly rotate the coefficients of <!-- l. 742 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>V</mi> </mrow></math>
to the left by <!-- l. 742 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mover accent='true'><mrow><mi>b</mi></mrow><mo accent='true'>^</mo></mover> <mo class='MathClass-bin' stretchy='false'>+</mo><msubsup><mrow> <mi class='MathClass-op'>∑</mi><mo> ⁡<!-- FUNCTION APPLICATION --></mo>
  <!-- nolimits --></mrow><mrow><mi>i</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>0</mn></mrow><mrow><mi>k</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msubsup><msub><mrow><mi>â</mi></mrow><mrow><mi>i</mi></mrow></msub><msub><mrow><mi>s</mi></mrow><mrow><mi>i</mi></mrow></msub></mrow></math>
positions), according to the following procedure:
</p><!-- l. 745 --><p class='indent'>
   </p><dl class='enumerate-enumitem'><dt class='enumerate-enumitem'>
1. </dt><dd class='enumerate-enumitem'>GLWE-encrypt the polynomial <!-- l. 745 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>V</mi> </mrow></math>
   with the bootstrapping key <!-- l. 745 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mover accent='true'><mrow><mi>S</mi></mrow><mo accent='true'>→</mo></mover></mrow><mrow><mi mathvariant='italic'>𝑏𝑘</mi></mrow></msub></math>
   at the TFHE setup stage, so that each coefficient of <!-- l. 745 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>V</mi> </mrow></math>
   gets encrypted.
   </dd><dt class='enumerate-enumitem'>
2. </dt><dd class='enumerate-enumitem'>Compute <!-- l. 746 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>V</mi> </mrow><mrow><mn>0</mn></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo> <mi>V</mi> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>X</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mover accent='true'><mrow><mi>b</mi></mrow><mo accent='true'>^</mo></mover></mrow></msup></mrow></math>,
   which is basically rotating <!-- l. 746 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>V</mi> </mrow></math>’s
   polynomials by <!-- l. 746 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mover accent='true'><mrow><mi>b</mi></mrow><mo accent='true'>^</mo></mover></math>
   positions to the left. Since <!-- l. 746 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mover accent='true'><mrow><mi>b</mi></mrow><mo accent='true'>^</mo></mover></math>
   is  a  known  value  visible  in  the  LWE  ciphertext,  we  can  directly  compute  the  rotation  of
   <!-- l. 746 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>V</mi> </mrow><mrow><mn>0</mn></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo> <mi>V</mi> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>X</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mover accent='true'><mrow><mi>b</mi></mrow><mo accent='true'>^</mo></mover></mrow></msup></mrow></math>.
   </dd><dt class='enumerate-enumitem'>
3. </dt><dd class='enumerate-enumitem'>Compute <!-- l. 747 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>V</mi> </mrow><mrow><mn>1</mn></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mi>V</mi> </mrow><mrow><mn>0</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>X</mi></mrow><mrow><msub><mrow><mi>â</mi></mrow><mrow><mn>0</mn></mrow></msub><msub><mrow><mi>s</mi></mrow><mrow><mn>0</mn></mrow></msub></mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mi>s</mi></mrow><mrow><mn>0</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>V</mi> </mrow><mrow><mn>0</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>X</mi></mrow><mrow><msub><mrow><mi>â</mi></mrow><mrow><mn>0</mn></mrow></msub></mrow></msup> <mo class='MathClass-bin' stretchy='false'>−</mo><msub><mrow><mi>V</mi> </mrow><mrow><mn>0</mn></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>V</mi> </mrow><mrow><mn>0</mn></mrow></msub></mrow></math>.
   This formula works for the special case where <!-- l. 748 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>s</mi></mrow><mrow><mn>0</mn></mrow></msub> <mo class='MathClass-rel' stretchy='false'>∈</mo><mo class='MathClass-open' stretchy='false'>{</mo><mn>0</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>}</mo></mrow></math>:
   if <!-- l. 748 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>s</mi></mrow><mrow><mn>0</mn></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>0</mn></mrow></math>,
   then <!-- l. 748 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>V</mi> </mrow><mrow><mn>1</mn></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mi>V</mi> </mrow><mrow><mn>0</mn></mrow></msub></mrow></math>;
   else if <!-- l. 748 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>s</mi></mrow><mrow><mn>0</mn></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>1</mn></mrow></math>,
   then <!-- l. 748 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>V</mi> </mrow><mrow><mn>1</mn></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mi>V</mi> </mrow><mrow><mn>0</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>X</mi></mrow><mrow><msub><mrow><mi>â</mi></mrow><mrow><mn>0</mn></mrow></msub></mrow></msup></mrow></math>.
   Computing <!-- l. 748 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>s</mi></mrow><mrow><mn>0</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>V</mi> </mrow><mrow><mn>0</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>X</mi></mrow><mrow><msub><mrow><mi>â</mi></mrow><mrow><mn>0</mn></mrow></msub></mrow></msup> <mo class='MathClass-bin' stretchy='false'>−</mo><msub><mrow><mi>V</mi> </mrow><mrow><mn>0</mn></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>V</mi> </mrow><mrow><mn>0</mn></mrow></msub></mrow></math>
   is done as a TFHE homomorphic addition and multiplication. We call this blind rotation of
   <!-- l. 748 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>V</mi> </mrow><mrow><mn>0</mn></mrow></msub></math>,
   where the selection bit <!-- l. 748 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>s</mi></mrow><mrow><mn>0</mn></mrow></msub></math>
   (i.e., the 1st element of the secret key vector <!-- l. 748 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>S</mi></math>)
   is encrypted as a GGSW ciphertext by using <!-- l. 748 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mover accent='true'><mrow><mi>S</mi></mrow><mo accent='true'>→</mo></mover></mrow><mrow><mi mathvariant='italic'>𝑏𝑘</mi></mrow></msub></math>
   (i.e. the bootstrapping key) and <!-- l. 748 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>V</mi> </mrow><mrow><mn>0</mn></mrow></msub></math>
   is an encrypted polynomial as a GLWE ciphertext. Multiplying GLWE-encrypted <!-- l. 748 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>V</mi> </mrow><mrow><mn>0</mn></mrow></msub></math>
   with <!-- l. 748 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>x</mi></mrow><mrow><msub><mrow><mi>â</mi></mrow><mrow><mn>0</mn></mrow></msub></mrow></msup></math>
   is done by GLWE ciphertext-to-plaintext multiplication (<a href='GLWECiphertexttoPlaintextMultiplication.html#glwe-ciphertexttoplaintext-multiplication'><span class='ts1-lmr10-x-x-109'>§</span>C-3<!-- tex4ht:ref: subsec:coeff-rotation  --></a>), and subtracting the result by
   GLWE-encrypted <!-- l. 748 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>V</mi> </mrow><mrow><mn>0</mn></mrow></msub></math>
   is done by GLWE ciphertext-to-ciphertext addition/subtraction (<a href='GLWECiphertexttoCiphertextAddition.html#glwe-ciphertexttociphertext-addition'><span class='ts1-lmr10-x-x-109'>§</span>C-1<!-- tex4ht:ref: subsec:coeff-rotation  --></a>), and multiplying the
   result by GGSW-encrypted <!-- l. 748 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>s</mi></mrow><mrow><mn>0</mn></mrow></msub></math>
   is done by GLWE-to-GGSW multiplication (<a href='HomomorphicCiphertexttoCiphertextMultiplication.html#generalization-to-glwetoggsw-multiplication'><span class='ts1-lmr10-x-x-109'>§</span>D-1.6.2<!-- tex4ht:ref: subsec:coeff-rotation  --></a>), and adding the result with GLWE-encrypted
   <!-- l. 748 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>V</mi> </mrow><mrow><mn>0</mn></mrow></msub></math>
   is done by GLWE ciphertext-to-ciphertext addition. If <!-- l. 748 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>s</mi></mrow><mrow><mn>0</mn></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>1</mn></mrow></math>,
   then the formula’s <!-- l. 748 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>X</mi></mrow><mrow><msub><mrow><mi>â</mi></mrow><mrow><mn>0</mn></mrow></msub></mrow></msup></math>
                                                                                         
                                                                                         
   term gets multiplied to <!-- l. 748 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>V</mi> </mrow><mrow><mn>0</mn></mrow></msub></math>,
   which effectively rotates <!-- l. 748 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>V</mi> </mrow><mrow><mn>0</mn></mrow></msub></math>’s
   coefficients by <!-- l. 748 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>â</mi></mrow><mrow><mn>0</mn></mrow></msub></math>
   positions to the right. Else if <!-- l. 748 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>s</mi></mrow><mrow><mn>0</mn></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>0</mn></mrow></math>,
   then <!-- l. 748 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>V</mi> </mrow><mrow><mn>0</mn></mrow></msub></math>
   does not get rotated and stays the same. In both cases, the resulting <!-- l. 748 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>V</mi> </mrow><mrow><mn>1</mn></mrow></msub></math>
   is encrypted as a new GLWE ciphertext. During this blind rotation, unless we have the knowledge
   of <!-- l. 748 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>s</mi></mrow><mrow><mn>0</mn></mrow></msub></math>
   and <!-- l. 748 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mover accent='true'><mrow><mi>S</mi></mrow><mo accent='true'>→</mo></mover></mrow><mrow><mi mathvariant='italic'>𝑏𝑘</mi></mrow></msub></math>,
   it is impossible to know whether <!-- l. 748 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>V</mi> </mrow><mrow><mn>0</mn></mrow></msub></math>
   has been rotated or not, and also how many positions have been rotated.
   </dd><dt class='enumerate-enumitem'>
4. </dt><dd class='enumerate-enumitem'>By using the same blind rotation method as in the previous step, compute the GLWE encryption
   of <!-- l. 749 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>V</mi> </mrow><mrow><mn>2</mn></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mi>V</mi> </mrow><mrow><mn>1</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>X</mi></mrow><mrow><msub><mrow><mi>â</mi></mrow><mrow><mn>1</mn></mrow></msub><msub><mrow><mi>s</mi></mrow><mrow><mn>1</mn></mrow></msub></mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mi>s</mi></mrow><mrow><mn>1</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>V</mi> </mrow><mrow><mn>1</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msubsup><mrow><mi>X</mi></mrow><mrow><mn>1</mn></mrow><mrow><mi>â</mi></mrow></msubsup> <mo class='MathClass-bin' stretchy='false'>−</mo><msub><mrow><mi>V</mi> </mrow><mrow><mn>1</mn></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>V</mi> </mrow><mrow><mn>1</mn></mrow></msub></mrow></math>.
   Note that we have the following publicly known components: <!-- l. 749 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>â</mi></mrow><mrow><mn>1</mn></mrow></msub></math>,
   a GLWE encryption of <!-- l. 749 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>V</mi> </mrow><mrow><mn>1</mn></mrow></msub></math>,
   and a GGSW ciphertext of <!-- l. 749 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>s</mi></mrow><mrow><mn>1</mn></mrow></msub></math>
   encrypted by using <!-- l. 749 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mover accent='true'><mrow><mi>S</mi></mrow><mo accent='true'>→</mo></mover></mrow><mrow><mi mathvariant='italic'>𝑏𝑘</mi></mrow></msub></math>.
   </dd><dt class='enumerate-enumitem'>
5. </dt><dd class='enumerate-enumitem'>Continue to compute the GLWE encryption of <!-- l. 750 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>V</mi> </mrow><mrow><mn>3</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>V</mi> </mrow><mrow><mn>4</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><mstyle class='text'><mtext></mtext><mstyle class='math'><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace></mstyle><mtext></mtext></mstyle><mstyle class='text'><mtext> </mtext></mstyle><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>V</mi> </mrow><mrow><mi>k</mi></mrow></msub></mrow></math>
   in the same manner, and we finally get a GLWE encryption of <!-- l. 750 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>V</mi> </mrow><mrow><mi>k</mi></mrow></msub></math>,
   whose computed value is equivalent to:
   <!-- l. 752 --><p class='noindent'><!-- l. 752 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>V</mi> </mrow><mrow><mi>′</mi></mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mi>V</mi> </mrow><mrow><mi>k</mi></mrow></msub></mrow></math>
   </p><!-- l. 754 --><p class='noindent'><!-- l. 754 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mstyle class='text'><mtext> </mtext></mstyle> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mi>V</mi> </mrow><mrow><mi>k</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>X</mi></mrow><mrow><msub><mrow><mi>â</mi></mrow><mrow><mi>k</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub><msub><mrow><mi>s</mi></mrow><mrow><mi>k</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub></mrow></msup></mrow></math>
   </p><!-- l. 756 --><p class='noindent'><!-- l. 756 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mstyle class='text'><mtext> </mtext></mstyle> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mi>V</mi> </mrow><mrow><mn>0</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>X</mi></mrow><mrow><msub><mrow><mi>â</mi></mrow><mrow><mn>0</mn></mrow></msub><msub><mrow><mi>s</mi></mrow><mrow><mn>0</mn></mrow></msub></mrow></msup><msup><mrow><mi>X</mi></mrow><mrow><msub><mrow><mi>â</mi></mrow><mrow><mn>1</mn></mrow></msub><msub><mrow><mi>s</mi></mrow><mrow><mn>1</mn></mrow></msub></mrow></msup><mo class='MathClass-rel' stretchy='false'>⋯</mo><msup><mrow><mi>X</mi></mrow><mrow><msub><mrow><mi>â</mi></mrow><mrow><mi>k</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub><msub><mrow><mi>s</mi></mrow><mrow><mi>k</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub></mrow></msup></mrow></math>
   </p><!-- l. 758 --><p class='noindent'><!-- l. 758 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mstyle class='text'><mtext> </mtext></mstyle> <mo class='MathClass-rel' stretchy='false'>=</mo> <mi>V</mi> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>X</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mover accent='true'><mrow><mi>b</mi></mrow><mo accent='true'>^</mo></mover><mo class='MathClass-bin' stretchy='false'>+</mo><msubsup><mrow><mi class='MathClass-op'>∑</mi><mo> ⁡<!-- FUNCTION APPLICATION --></mo><!-- nolimits --></mrow><mrow>
<mi>i</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>0</mn></mrow><mrow><mi>k</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msubsup><msub><mrow><mi>â</mi></mrow><mrow><mi>i</mi></mrow></msub><msub><mrow><mi>s</mi></mrow><mrow><mi>i</mi></mrow></msub>
                          </mrow></msup></mrow></math>
   </p><!-- l. 760 --><p class='noindent'><!-- l. 760 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mstyle class='text'><mtext> </mtext></mstyle> <mo class='MathClass-rel' stretchy='false'>=</mo> <mi>V</mi> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>X</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mo class='MathClass-open' stretchy='false'>(</mo><mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true'>^</mo></mover><mi>m</mi><mo class='MathClass-bin' stretchy='false'>+</mo><msub><mrow><mi>ê</mi></mrow><mrow><mi>b</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup></mrow></math>
</p>
   </dd></dl>
<!-- l. 764 --><p class='indent'>   This means that the GLWE encryption of the final polynomial
<!-- l. 764 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>V</mi> </mrow><mrow><mi>k</mi></mrow></msub></math> will have the coefficient
<!-- l. 764 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>m</mi></math> in its constant term,
as <!-- l. 764 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>V</mi> <mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math> is designed to
have the mapping (<!-- l. 764 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true'>^</mo></mover><mi>m</mi> <mo class='MathClass-bin' stretchy='false'>+</mo><msub><mrow> <mi>ê</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><mi>m</mi></mrow></math>).
</p><!-- l. 766 --><p class='indent'>   Note that while we restrict the application’s plaintext space usage to some continuous
<!-- l. 766 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mstyle displaystyle='true'><mfrac><mrow> <mi>t</mi>
</mrow><mrow><mn>2</mn></mrow></mfrac></mstyle></math> modulo
values within <!-- l. 766 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>ℤ</mi></mrow><mrow><mi>t</mi></mrow></msub></math>
(<a href='#halving-the-plaintext-space-to-be-used'><span class='ts1-lmr10-x-x-109'>§</span>D-1.8.3<!-- tex4ht:ref: subsec:coeff-rotation  --></a>), this restriction does not exist in the ciphertext space. That is, it is okay for blind rotations to
rotate <!-- l. 766 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>V</mi> <mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
more than <!-- l. 766 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>n</mi></math>
positions during the intermediate steps, because their invalid positions can be brought back to valid ones by
their subsequent steps. Therefore, what matters for the noise bootstrapping correctness is only the completed
state <!-- l. 766 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>V</mi> </mrow><mrow><mi>k</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>. The
rotation-completed <!-- l. 766 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>V</mi> </mrow><mrow><mi>k</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
must have been rotated <!-- l. 766 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true'>^</mo></mover><mi>m</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>ê</mi></mrow></math>
                                                                                         
                                                                                         
positions to the left. Therefore, we only need to ensure that
<!-- l. 766 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true'>^</mo></mover><mi>m</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>ê</mi></mrow></math> falls within our
pre-defined continuous <!-- l. 766 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mstyle displaystyle='true'><mfrac><mrow> <mi>t</mi>
</mrow><mrow><mn>2</mn></mrow></mfrac></mstyle></math>
modulo range within the <!-- l. 766 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>ℤ</mi></mrow><mrow><mi>t</mi></mrow></msub></math>
domain, which is equivalent to ensuring that the aggregate rotation count is at most
<!-- l. 766 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>n</mi> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></math>
positions to avoid coefficient extraction of any double-signed contradicting coefficients.
</p>
   <figure class='figure'> 

                                                                                         
                                                                                         
                                                                                         
                                                                                         
<!-- l. 770 --><p class='noindent' id='an-illustration-of-the-mux-logic-gate-'> <img alt='PIC' src='figures/mux-.png' /> <a id='x103-131006r12'></a></p>
<figcaption class='caption'><span class='id'>Figure 12: </span><span class='content'>An illustration of the MUX logic gate                                             </span></figcaption><!-- tex4ht:label?: x103-131006r12  -->
                                                                                         
                                                                                         
   </figure>
<!-- l. 775 --><p class='noindent'><span class='rm-lmbx-10x-x-109'>Homomorphic MUX Logic Gate: </span>In step 3, the formula
<!-- l. 775 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>s</mi></mrow><mrow><mn>0</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>V</mi> </mrow><mrow><mn>0</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>X</mi></mrow><mrow><msub><mrow><mi>â</mi></mrow><mrow><mn>0</mn></mrow></msub></mrow></msup> <mo class='MathClass-bin' stretchy='false'>−</mo><msub><mrow><mi>V</mi> </mrow><mrow><mn>0</mn></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>V</mi> </mrow><mrow><mn>0</mn></mrow></msub></mrow></math>
implements the MUX logic gate as shown in <a href='#an-illustration-of-the-mux-logic-gate-'>Figure 12<!-- tex4ht:ref: subsec:coeff-rotation  --></a>, where in our case
<!-- l. 775 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>s</mi></mrow><mrow><mn>0</mn></mrow></msub></math> is the selection bit that chooses
between the two inputs: <!-- l. 775 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>V</mi> </mrow><mrow><mn>0</mn></mrow></msub></math>
and <!-- l. 775 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>V</mi> </mrow><mrow><mn>0</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>X</mi></mrow><mrow><msub><mrow><mi>â</mi></mrow><mrow><mn>0</mn></mrow></msub></mrow></msup></mrow></math>. If
<!-- l. 775 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>s</mi></mrow><mrow><mn>0</mn></mrow></msub></math> is 1, then the output is
<!-- l. 775 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>V</mi> </mrow><mrow><mn>0</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>X</mi></mrow><mrow><msub><mrow><mi>â</mi></mrow><mrow><mn>0</mn></mrow></msub></mrow></msup></mrow></math>; otherwise, the output
is <!-- l. 775 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>V</mi> </mrow><mrow><mn>0</mn></mrow></msub></math>. In our design, the
homomorphic computation of <!-- l. 775 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>s</mi></mrow><mrow><mn>0</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>V</mi> </mrow><mrow><mn>0</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>X</mi></mrow><mrow><msub><mrow><mi>â</mi></mrow><mrow><mn>0</mn></mrow></msub></mrow></msup> <mo class='MathClass-bin' stretchy='false'>−</mo><msub><mrow><mi>V</mi> </mrow><mrow><mn>0</mn></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>V</mi> </mrow><mrow><mn>0</mn></mrow></msub></mrow></math>
effectively implements a homomorphic MUX gate, where the two inputs are LWE-encrypted and the
selection bit is GGSW-encrypted.
   
</p>
   <h5 class='subsubsectionHead' id='coefficient-extraction1'><span class='titlemark'>D-1.8.5   </span> <a id='x103-132000D-1.8.5'></a>Coefficient Extraction</h5>
<!-- l. 780 --><p class='noindent'>Finally, we use the coefficient extraction technique (<a href='CoefficientExtraction.html#coefficient-extraction'><span class='ts1-lmr10-x-x-109'>§</span>D-1.7<!-- tex4ht:ref: subsec:coeff-rotation  --></a>) to extract the rotated polynomial
<!-- l. 780 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>V</mi> </mrow><mrow><mi>′</mi></mrow></msup><mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>’s constant term’s coefficient
as an encryption of <!-- l. 780 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>m</mi></math>:
<!-- l. 780 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mover accent='true'><mrow><mi>s</mi></mrow><mo accent='true'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mi mathvariant='normal'>Δ</mi><mi>m</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>. At this point, the original
<!-- l. 780 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖫𝖶𝖤</mtext></mstyle></math> ciphertext’s old noise
<!-- l. 780 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>ê</mi></mrow><mrow><mi>b</mi></mrow></msub></math> has gone, and the bootstrapped
new ciphertext <!-- l. 780 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mover accent='true'><mrow><mi>s</mi></mrow><mo accent='true'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mi mathvariant='normal'>Δ</mi><mi>m</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math> has a newly
generated small noise <!-- l. 780 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>e</mi></mrow><mrow><mi>s</mi></mrow></msub></math>.
</p><!-- l. 782 --><p class='indent'>   In fact, the homomorphic MUX logic in the blind rotation procedure (<a href='#blind-rotation'><span class='ts1-lmr10-x-x-109'>§</span>D-1.8.4<!-- tex4ht:ref: subsec:coeff-rotation  --></a>) involves lots of ciphertext
multiplications and additions, which can accumulate additional noises until we reach the point of coefficient
extraction. In order to limit the accumulating noises during the series of MUX logic, we can carefully adjust
the security parameters. For example, we can design a narrower Gaussian distribution for sampling the noise
<!-- l. 782 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>e</mi></math>, while designing a
sufficiently large <!-- l. 782 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>n</mi></math>
to compensate for the reduced noise. Meanwhile, increasing
<!-- l. 782 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>q</mi></math>
rather makes the system less secure, because it becomes more vulnerable to Lattice reduction
attacks.
   
</p>
   <h5 class='subsubsectionHead' id='noise-bootstrapping-summary'><span class='titlemark'>D-1.8.6   </span> <a id='x103-133000D-1.8.6'></a>Noise Bootstrapping Summary</h5>
<!-- l. 792 --><p class='noindent'>TFHE’s noise bootstrapping procedure is summarized as follows:
</p>
   <div class='tcolorbox tcolorbox' id='tcolobox-76'>     
<div class='tcolorbox-title'>
<!-- l. 847 --><p class='indent'>   <!-- l. 847 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mstyle mathvariant='bold'><mo class='MathClass-open' stretchy='false'>⟨</mo></mstyle></math><span class='rm-lmbx-10x-x-109'>Summary </span><a href='#noise-bootstrapping-summary'><span class='rm-lmbx-10x-x-109'>D-1.8.6</span><!-- tex4ht:ref: subsec:tfhe-summary  --></a><!-- l. 847 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mstyle mathvariant='bold'><mo class='MathClass-close' stretchy='false'>⟩</mo></mstyle></math>
                                                                                         
                                                                                         
<span class='rm-lmbx-10x-x-109'>TFHE Noise Bootstrapping Procedure</span></p></div> 
<div class='tcolorbox-content'><!-- l. 796 --><p class='noindent'><span class='underline'><span class='rm-lmbx-10x-x-109'>Lookup Table Encryption</span></span><span class='rm-lmbx-10x-x-109'>:          </span>Encrypt           the           LUT           polynomial
<!-- l. 796 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>V</mi> <mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
as       a       GLWE       ciphertext       by       using       the       bootstrapping       key
<!-- l. 796 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mover accent='true'><mrow><mi>S</mi></mrow><mo accent='true'>→</mo></mover></mrow><mrow><mi mathvariant='italic'>𝑏𝑘</mi></mrow></msub></math>.
</p><!-- l. 798 --><p class='noindent'><!-- l. 798 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
    </p><dl class='enumerate-enumitem'><dt class='enumerate-enumitem'>
1.  </dt><dd class='enumerate-enumitem'><span class='underline'><span class='rm-lmbx-10x-x-109'>Modulus Switch</span></span><span class='rm-lmbx-10x-x-109'>:     </span>Change     the     modulus     of     the     TFHE     ciphertext
    <!-- l. 801 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mover accent='true'><mrow><mi>s</mi></mrow><mo accent='true'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mi mathvariant='normal'>Δ</mi><mi>m</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>e</mi></mrow><mrow><mi>b</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
    from <!-- l. 801 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>q</mi> <mo class='MathClass-rel' stretchy='false'>→</mo><mn>2</mn><mi>n</mi></mrow></math>
   to get <!-- l. 801 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mover accent='true'><mrow><mi>s</mi></mrow><mo accent='true'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true'>^</mo></mover><mi>m</mi> <mo class='MathClass-bin' stretchy='false'>+</mo><msub><mrow> <mi>ê</mi></mrow><mrow><mi>b</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>,
    where <!-- l. 801 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true'>^</mo></mover> <mo class='MathClass-rel' stretchy='false'>=</mo> <mi mathvariant='normal'>Δ</mi> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mstyle displaystyle='true'><mfrac><mrow><mn>2</mn><mi>n</mi>
 </mrow><mrow><mi>q</mi> </mrow></mfrac></mstyle></mrow></math>.
    <!-- l. 803 --><p class='noindent'><!-- l. 803 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
    </p></dd><dt class='enumerate-enumitem'>
2.  </dt><dd class='enumerate-enumitem'><span class='underline'><span class='rm-lmbx-10x-x-109'>Blind Rotation</span></span><span class='rm-lmbx-10x-x-109'>:         </span>Rotate           the           GLWE-encrypted           polynomial
    <!-- l. 805 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>V</mi> </mrow></math>
   by <!-- l. 805 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><mover accent='true'><mrow><mi>b</mi></mrow><mo accent='true'>^</mo></mover> <mo class='MathClass-bin' stretchy='false'>−</mo><munderover accent='false' accentunder='false'><mrow><mi class='MathClass-op'>∑</mi><mo> ⁡<!-- FUNCTION APPLICATION --></mo>
  </mrow><mrow><mi>i</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>0</mn></mrow><mrow><mi>k</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></munderover><msub><mrow><mi>â</mi></mrow><mrow><mi>i</mi></mrow></msub><msub><mrow><mi>s</mi></mrow><mrow><mi>i</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>(</mo><mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true'>^</mo></mover><mi>m</mi> <mo class='MathClass-bin' stretchy='false'>+</mo><msub><mrow> <mi>ê</mi></mrow><mrow><mi>b</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
    positions to the left, by recursively computing:
    <!-- l. 807 --><p class='noindent'><!-- l. 807 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>V</mi> </mrow><mrow><mn>0</mn></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo> <mi>V</mi> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>X</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mover accent='true'><mrow><mi>b</mi></mrow><mo accent='true'>^</mo></mover></mrow></msup></mrow></math>
    </p><!-- l. 809 --><p class='noindent'><!-- l. 809 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>V</mi> </mrow><mrow><mn>1</mn></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mi>V</mi> </mrow><mrow><mn>0</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>X</mi></mrow><mrow><msub><mrow><mi>â</mi></mrow><mrow><mn>0</mn></mrow></msub><msub><mrow><mi>s</mi></mrow><mrow><mn>0</mn></mrow></msub></mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mi>s</mi></mrow><mrow><mn>0</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>V</mi> </mrow><mrow><mn>0</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>X</mi></mrow><mrow><msub><mrow><mi>â</mi></mrow><mrow><mn>0</mn></mrow></msub></mrow></msup> <mo class='MathClass-bin' stretchy='false'>−</mo><msub><mrow><mi>V</mi> </mrow><mrow><mn>0</mn></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>V</mi> </mrow><mrow><mn>0</mn></mrow></msub></mrow></math>
     </p><!-- l. 811 --><p class='noindent'>  <!-- l. 811 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>⋮</mi></math>
   </p><!-- l. 813 --><p class='noindent'><!-- l. 813 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>V</mi> </mrow><mrow><mi>k</mi></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mi>V</mi> </mrow><mrow><mi>k</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>X</mi></mrow><mrow><msub><mrow><mi>â</mi></mrow><mrow><mi>k</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub><msub><mrow><mi>s</mi></mrow><mrow><mi>k</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub></mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mi>s</mi></mrow><mrow><mi>k</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>V</mi> </mrow><mrow><mi>k</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>X</mi></mrow><mrow><msub><mrow><mi>â</mi></mrow><mrow><mn>0</mn></mrow></msub></mrow></msup> <mo class='MathClass-bin' stretchy='false'>−</mo><msub><mrow><mi>V</mi> </mrow><mrow><mn>0</mn></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>V</mi> </mrow><mrow><mi>k</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub></mrow></math>
     </p><!-- l. 815 --><p class='noindent'><!-- l. 815 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mi>V</mi> </mrow><mrow><mn>0</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>X</mi></mrow><mrow><msub><mrow><mi>â</mi></mrow><mrow><mn>0</mn></mrow></msub><msub><mrow><mi>s</mi></mrow><mrow><mn>0</mn></mrow></msub></mrow></msup><msup><mrow><mi>X</mi></mrow><mrow><msub><mrow><mi>â</mi></mrow><mrow><mn>1</mn></mrow></msub><msub><mrow><mi>s</mi></mrow><mrow><mn>1</mn></mrow></msub></mrow></msup><mo class='MathClass-rel' stretchy='false'>⋯</mo><msup><mrow><mi>X</mi></mrow><mrow><msub><mrow><mi>â</mi></mrow><mrow><mi>k</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub><msub><mrow><mi>s</mi></mrow><mrow><mi>k</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub></mrow></msup></mrow></math>
      </p><!-- l. 817 --><p class='noindent'><!-- l. 817 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo> <mi>V</mi> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>X</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mover accent='true'><mrow><mi>b</mi></mrow><mo accent='true'>^</mo></mover><mo class='MathClass-bin' stretchy='false'>+</mo><msubsup><mrow><mi class='MathClass-op'>∑</mi><mo> ⁡<!-- FUNCTION APPLICATION --></mo><!-- nolimits --></mrow><mrow>
<mi>i</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>0</mn></mrow><mrow><mi>k</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msubsup><msub><mrow><mi>â</mi></mrow><mrow><mi>i</mi></mrow></msub><msub><mrow><mi>s</mi></mrow><mrow><mi>i</mi></mrow></msub>
                          </mrow></msup></mrow></math>
     </p><!-- l. 819 --><p class='noindent'><!-- l. 819 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo> <mi>V</mi> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>X</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mo class='MathClass-open' stretchy='false'>(</mo><mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true'>^</mo></mover><mi>m</mi><mo class='MathClass-bin' stretchy='false'>+</mo><msub><mrow><mi>ê</mi></mrow><mrow><mi>b</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup></mrow></math>
     </p><!-- l. 821 --><p class='noindent'><!-- l. 821 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
     </p><!-- l. 823 --><p class='noindent'>Each  step  of  the  actual  blind  rotation  above  is  computed  as  the  following  TFHE
    ciphertext-to-ciphertext multiplication and addition:
    </p><!-- l. 825 --><p class='noindent'><!-- l. 825 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖦𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mover accent='true'><mrow><mi>S</mi></mrow><mo accent='true'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>V</mi> </mrow><mrow><mi>i</mi><mo class='MathClass-bin' stretchy='false'>+</mo><mn>1</mn></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo><msubsup><mrow> <mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖦𝖦𝖲𝖶</mtext></mstyle></mrow><mrow><mover accent='true'><mrow><mi>S</mi></mrow><mo accent='true'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow><mrow><mi>β</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>l</mi></mrow></msubsup><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>s</mi></mrow><mrow><mi>i</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-bin' stretchy='false'>⋅</mo><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖦𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mover accent='true'><mrow><mi>S</mi></mrow><mo accent='true'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>V</mi> </mrow><mrow><mi>i</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>X</mi></mrow><mrow><msub><mrow><mi>a</mi></mrow><mrow><mn>0</mn></mrow></msub></mrow></msup> <mo class='MathClass-bin' stretchy='false'>−</mo><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖦𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mover accent='true'><mrow><mi>S</mi></mrow><mo accent='true'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>V</mi> </mrow><mrow><mi>i</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-bin' stretchy='false'>+</mo><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖦𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mover accent='true'><mrow><mi>S</mi></mrow><mo accent='true'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>V</mi> </mrow><mrow><mi>i</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
    </p><!-- l. 827 --><p class='noindent'><!-- l. 827 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
    </p></dd><dt class='enumerate-enumitem'>
3.  </dt><dd class='enumerate-enumitem'><span class='underline'><span class='rm-lmbx-10x-x-109'>Coefficient Extractio</span></span><span class='rm-lmbx-10x-x-109'>:  </span>Homomorphically   extract   the   constant   term’s   coefficient
    <!-- l. 829 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>m</mi></math>
   from the rotated polynomial <!-- l. 829 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>V</mi> </mrow><mrow><mi>k</mi></mrow></msub></math>,
    which is <!-- l. 829 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mover accent='true'><mrow><mi>s</mi></mrow><mo accent='true'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true'>^</mo></mover><mi>m</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>.
    </dd></dl>
<!-- l. 841 --><p class='noindent'><!-- l. 841 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 843 --><p class='noindent'><span class='underline'><span class='rm-lmbx-10x-x-109'>Halving the Usable Plaintext Range</span></span><span class='rm-lmbx-10x-x-109'>:  </span>Problematically, the LUT polynomial V rotates
negacyclically. To avoid this problem, we require the application to ensure that the plaintext
<!-- l. 843 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>m</mi></math> uses only continuous
<!-- l. 843 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mstyle displaystyle='true'><mfrac><mrow> <mi>t</mi>
</mrow><mrow><mn>2</mn></mrow></mfrac></mstyle></math> modulo values
within <!-- l. 843 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>ℤ</mi></mrow><mrow><mi>t</mi></mrow></msub></math>. This way,
we avoid rotating <!-- l. 843 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>V</mi> <mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
more than <!-- l. 843 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>n</mi> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></math>
positions that cause coefficient extraction of double-signed contradicting coefficients.
</p> 
</div> 
</div>
                                                                                         
                                                                                         
   
   <h5 class='subsubsectionHead' id='example-noise-bootstrapping'><span class='titlemark'>D-1.8.7   </span> <a id='x103-134000D-1.8.7'></a>Example: Noise Bootstrapping</h5>
<!-- l. 853 --><p class='noindent'>Suppose the GLWE security setup: <!-- l. 853 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>n</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>16</mn></mrow></math>,
<!-- l. 853 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>t</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>8</mn></mrow></math>,
<!-- l. 853 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>q</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>64</mn></mrow></math>,
<!-- l. 853 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>k</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>8</mn></mrow></math>
</p><!-- l. 855 --><p class='indent'>   <!-- l. 855 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>ℤ</mi></mrow><mrow><mi>t</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>8</mn></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>{</mo><mo class='MathClass-bin' stretchy='false'>−</mo><mn>4</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-bin' stretchy='false'>−</mo><mn>3</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-bin' stretchy='false'>−</mo><mn>2</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>0</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>1</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>2</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>3</mn><mo class='MathClass-close' stretchy='false'>}</mo></mrow></math>
</p><!-- l. 857 --><p class='indent'>   <!-- l. 857 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>ℤ</mi></mrow><mrow><mi>q</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>64</mn></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>{</mo><mo class='MathClass-bin' stretchy='false'>−</mo><mn>32</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-bin' stretchy='false'>−</mo><mn>31</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-bin' stretchy='false'>−</mo><mn>30</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><mstyle class='text'><mtext></mtext><mstyle class='math'><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace></mstyle><mtext></mtext></mstyle><mstyle class='text'><mtext> </mtext></mstyle><mo class='MathClass-punc' stretchy='false'>,</mo><mn>29</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>30</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>31</mn><mo class='MathClass-close' stretchy='false'>}</mo></mrow></math>
</p><!-- l. 859 --><p class='indent'>   <!-- l. 859 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi mathvariant='normal'>Δ</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mstyle displaystyle='true'><mfrac><mrow><mi>q</mi>
</mrow><mrow><mi>t</mi></mrow></mfrac></mstyle> <mo class='MathClass-rel' stretchy='false'>=</mo> <mstyle displaystyle='true'><mfrac><mrow><mn>64</mn>
 </mrow><mrow><mn>8</mn> </mrow></mfrac></mstyle> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>8</mn></mrow></math>
</p><!-- l. 861 --><p class='indent'>   <!-- l. 861 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 863 --><p class='indent'>   And suppose we have the following LWE ciphertext:
</p><!-- l. 865 --><p class='indent'>   <!-- l. 865 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mover accent='true'><mrow><mi>s</mi></mrow><mo accent='true'>→</mo></mover> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>(</mo><mn>1</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>0</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>0</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>1</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>1</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>1</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>0</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo> <msubsup><mrow><mi>ℤ</mi></mrow><mrow><mn>2</mn></mrow><mrow><mi>k</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>8</mn></mrow></msubsup></mrow></math>
</p><!-- l. 867 --><p class='indent'>   <!-- l. 867 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>m</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>1</mn> <mo class='MathClass-rel' stretchy='false'>∈</mo> <msub><mrow><mi>ℤ</mi></mrow><mrow><mi>t</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>8</mn></mrow></msub></mrow></math>
</p><!-- l. 869 --><p class='indent'>   <!-- l. 869 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi mathvariant='normal'>Δ</mi><mi>m</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>1</mn> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mn>8</mn> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>8</mn> <mo class='MathClass-rel' stretchy='false'>∈</mo> <msub><mrow><mi>ℤ</mi></mrow><mrow><mi>q</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>64</mn></mrow></msub></mrow></math>
</p><!-- l. 873 --><p class='indent'>   <!-- l. 873 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mover accent='true'><mrow><mi>s</mi></mrow><mo accent='true'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mi mathvariant='normal'>Δ</mi><mi>m</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>a</mi></mrow><mrow><mn>0</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>a</mi></mrow><mrow><mn>1</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>a</mi></mrow><mrow><mn>2</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>a</mi></mrow><mrow><mn>3</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>a</mi></mrow><mrow><mn>4</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>a</mi></mrow><mrow><mn>5</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>a</mi></mrow><mrow><mn>6</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>a</mi></mrow><mrow><mn>7</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><mi>b</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>(</mo><mn>8</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-bin' stretchy='false'>−</mo><mn>28</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>4</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-bin' stretchy='false'>−</mo><mn>32</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>0</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>31</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-bin' stretchy='false'>−</mo><mn>6</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>7</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>24</mn><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>∈</mo> <msubsup><mrow><mi>ℤ</mi></mrow><mrow><mi>q</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>64</mn></mrow><mrow><mi>k</mi><mo class='MathClass-bin' stretchy='false'>+</mo><mn>1</mn><mo class='MathClass-rel' stretchy='false'>=</mo><mn>9</mn></mrow></msubsup></mrow></math>
</p><!-- l. 876 --><p class='indent'>   <!-- l. 876 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>e</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>2</mn> <mo class='MathClass-rel' stretchy='false'>∈</mo> <msub><mrow><mi>ℤ</mi></mrow><mrow><mi>q</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>64</mn></mrow></msub></mrow></math> (should be
the case that <!-- l. 876 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-rel' stretchy='false'>|</mo><mi>e</mi><mo class='MathClass-rel' stretchy='false'>|</mo><mo class='MathClass-rel' stretchy='false'>&lt;</mo> <mstyle displaystyle='true'><mfrac><mrow><mi mathvariant='normal'>Δ</mi>
</mrow><mrow><mn>2</mn></mrow></mfrac></mstyle> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>4</mn></mrow></math>
for correct decryption)
</p><!-- l. 878 --><p class='indent'>   <!-- l. 878 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>b</mi> <mo class='MathClass-rel' stretchy='false'>=</mo><munderover accent='false' accentunder='false'><mrow> <mi class='MathClass-op'>∑</mi><mo> ⁡<!-- FUNCTION APPLICATION --></mo>
  </mrow><mrow><mi>i</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>0</mn></mrow><mrow><mn>7</mn></mrow></munderover><msub><mrow><mi>a</mi></mrow><mrow><mi>i</mi></mrow></msub><msub><mrow><mi>s</mi></mrow><mrow><mi>i</mi></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi mathvariant='normal'>Δ</mi><mi>m</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>e</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>(</mo><mn>8</mn> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>32</mn> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>31</mn> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>7</mn><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>8</mn> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>2</mn> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>24</mn> <mo class='MathClass-rel' stretchy='false'>∈</mo> <msub><mrow><mi>ℤ</mi></mrow><mrow><mi>q</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>64</mn></mrow></msub></mrow></math>
</p><!-- l. 880 --><p class='indent'>   <!-- l. 880 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 882 --><p class='indent'>   Now then, the TFHE noise bootstrapping procedure is as follows:
</p><!-- l. 884 --><p class='indent'>   <!-- l. 884 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 887 --><p class='indent'>
   </p><dl class='enumerate-enumitem'><dt class='enumerate-enumitem'>
1. </dt><dd class='enumerate-enumitem'><span class='rm-lmbx-10x-x-109'>Modulus Switch: </span>Switch the modulus of <!-- l. 887 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mover accent='true'><mrow><mi>s</mi></mrow><mo accent='true'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mi mathvariant='normal'>Δ</mi><mi>m</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
   From <!-- l. 887 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>q</mi> <mo class='MathClass-rel' stretchy='false'>→</mo><mn>2</mn><mi>n</mi></mrow></math>,
   which is from <!-- l. 887 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mn>64</mn> <mo class='MathClass-rel' stretchy='false'>→</mo><mn>32</mn></mrow></math>.
   After the modulus switch, the original LWE ciphertext is converted as follows:
   <!-- l. 889 --><p class='noindent'><!-- l. 889 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>ℤ</mi></mrow><mrow><mn>2</mn><mi>n</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>32</mn></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>{</mo><mo class='MathClass-bin' stretchy='false'>−</mo><mn>16</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-bin' stretchy='false'>−</mo><mn>15</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-bin' stretchy='false'>−</mo><mn>14</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><mstyle class='text'><mtext></mtext><mstyle class='math'><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace></mstyle><mtext></mtext></mstyle><mstyle class='text'><mtext> </mtext></mstyle><mo class='MathClass-punc' stretchy='false'>,</mo><mn>13</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>14</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>15</mn><mo class='MathClass-close' stretchy='false'>}</mo></mrow></math>
   </p><!-- l. 891 --><p class='noindent'><!-- l. 891 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mover accent='true'><mrow><mi>s</mi></mrow><mo accent='true'>→</mo></mover> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>(</mo><mn>1</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>0</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>0</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>1</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>1</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>1</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>0</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo> <msubsup><mrow><mi>ℤ</mi></mrow><mrow><mn>2</mn></mrow><mrow><mi>k</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>8</mn></mrow></msubsup></mrow></math>
   </p><!-- l. 894 --><p class='noindent'><!-- l. 894 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true'>^</mo></mover> <mo class='MathClass-rel' stretchy='false'>=</mo> <mi mathvariant='normal'>Δ</mi><mstyle displaystyle='true'><mfrac><mrow><mn>2</mn><mi>n</mi>
</mrow><mrow><mn>64</mn></mrow></mfrac></mstyle> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>8</mn><mstyle displaystyle='true'><mfrac><mrow><mn>32</mn>
</mrow><mrow><mn>64</mn></mrow></mfrac></mstyle> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>4</mn></mrow></math>
   </p><!-- l. 896 --><p class='noindent'><!-- l. 896 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true'>^</mo></mover><mi>m</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>4</mn> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mn>1</mn> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>4</mn> <mo class='MathClass-rel' stretchy='false'>∈</mo> <msub><mrow><mi>ℤ</mi></mrow><mrow><mn>2</mn><mi>n</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>32</mn></mrow></msub></mrow></math>
   </p><!-- l. 898 --><p class='noindent'><!-- l. 898 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>ê</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mrow><mo fence='true' form='prefix'>⌈</mo><mrow><mi>e</mi><mstyle displaystyle='true'><mfrac><mrow><mn>2</mn><mi>n</mi>
 </mrow><mrow><mi>q</mi> </mrow></mfrac></mstyle></mrow><mo fence='true' form='postfix'>⌋</mo></mrow> <mo class='MathClass-rel' stretchy='false'>=</mo> <mrow><mo fence='true' form='prefix'>⌈</mo><mrow><mn>2</mn><mstyle displaystyle='true'><mfrac><mrow><mn>32</mn>
</mrow><mrow><mn>64</mn></mrow></mfrac></mstyle></mrow><mo fence='true' form='postfix'>⌋</mo></mrow> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>1</mn> <mo class='MathClass-rel' stretchy='false'>∈</mo> <msub><mrow><mi>ℤ</mi></mrow><mrow><mn>2</mn><mi>n</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>32</mn></mrow></msub></mrow></math>
   </p><!-- l. 900 --><p class='noindent'><!-- l. 900 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
   </p><!-- l. 902 --><p class='noindent'><!-- l. 902 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mover accent='true'><mrow><mi>s</mi></mrow><mo accent='true'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true'>^</mo></mover><mi>m</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>â</mi></mrow><mrow><mn>0</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>â</mi></mrow><mrow><mn>1</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>â</mi></mrow><mrow><mn>2</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>â</mi></mrow><mrow><mn>3</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>â</mi></mrow><mrow><mn>4</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>â</mi></mrow><mrow><mn>5</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>â</mi></mrow><mrow><mn>6</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>â</mi></mrow><mrow><mn>7</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><mover accent='true'><mrow><mi>b</mi></mrow><mo accent='true'>^</mo></mover><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>∈</mo> <msubsup><mrow><mi>ℤ</mi></mrow><mrow><mn>2</mn><mi>n</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>32</mn></mrow><mrow><mi>k</mi><mo class='MathClass-bin' stretchy='false'>+</mo><mn>1</mn><mo class='MathClass-rel' stretchy='false'>=</mo><mn>9</mn></mrow></msubsup></mrow></math>
   </p><!-- l. 905 --><p class='noindent'><!-- l. 905 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>(</mo><mstyle mathsize='1.61em'><mrow><mo fence='true' form='prefix'>⌈</mo><mrow></mrow><mo fence='true' form='postfix'></mo></mrow></mstyle><mn>8</mn><mstyle displaystyle='true'><mfrac><mrow><mn>32</mn>
</mrow><mrow><mn>64</mn></mrow></mfrac></mstyle><mstyle mathsize='1.61em'><mrow><mo fence='true' form='prefix'>⌋</mo><mrow></mrow><mo fence='true' form='postfix'></mo></mrow></mstyle><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle mathsize='1.61em'><mrow><mo fence='true' form='prefix'>⌈</mo><mrow></mrow><mo fence='true' form='postfix'></mo></mrow></mstyle> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>28</mn><mstyle displaystyle='true'><mfrac><mrow><mn>32</mn>
</mrow><mrow><mn>64</mn></mrow></mfrac></mstyle><mstyle mathsize='1.61em'><mrow><mo fence='true' form='prefix'>⌋</mo><mrow></mrow><mo fence='true' form='postfix'></mo></mrow></mstyle><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle mathsize='1.61em'><mrow><mo fence='true' form='prefix'>⌈</mo><mrow></mrow><mo fence='true' form='postfix'></mo></mrow></mstyle><mn>4</mn><mstyle displaystyle='true'><mfrac><mrow><mn>32</mn>
</mrow><mrow><mn>64</mn></mrow></mfrac></mstyle><mstyle mathsize='1.61em'><mrow><mo fence='true' form='prefix'>⌋</mo><mrow></mrow><mo fence='true' form='postfix'></mo></mrow></mstyle><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle mathsize='1.61em'><mrow><mo fence='true' form='prefix'>⌈</mo><mrow></mrow><mo fence='true' form='postfix'></mo></mrow></mstyle> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>32</mn><mstyle displaystyle='true'><mfrac><mrow><mn>32</mn>
</mrow><mrow><mn>64</mn></mrow></mfrac></mstyle><mstyle mathsize='1.61em'><mrow><mo fence='true' form='prefix'>⌋</mo><mrow></mrow><mo fence='true' form='postfix'></mo></mrow></mstyle><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle mathsize='1.61em'><mrow><mo fence='true' form='prefix'>⌈</mo><mrow></mrow><mo fence='true' form='postfix'></mo></mrow></mstyle><mn>0</mn><mstyle displaystyle='true'><mfrac><mrow><mn>32</mn>
</mrow><mrow><mn>64</mn></mrow></mfrac></mstyle><mstyle mathsize='1.61em'><mrow><mo fence='true' form='prefix'>⌋</mo><mrow></mrow><mo fence='true' form='postfix'></mo></mrow></mstyle><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle mathsize='1.61em'><mrow><mo fence='true' form='prefix'>⌈</mo><mrow></mrow><mo fence='true' form='postfix'></mo></mrow></mstyle><mn>31</mn><mstyle displaystyle='true'><mfrac><mrow><mn>32</mn>
</mrow><mrow><mn>64</mn></mrow></mfrac></mstyle><mstyle mathsize='1.61em'><mrow><mo fence='true' form='prefix'>⌋</mo><mrow></mrow><mo fence='true' form='postfix'></mo></mrow></mstyle><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle mathsize='1.61em'><mrow><mo fence='true' form='prefix'>⌈</mo><mrow></mrow><mo fence='true' form='postfix'></mo></mrow></mstyle> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>6</mn><mstyle displaystyle='true'><mfrac><mrow><mn>32</mn>
</mrow><mrow><mn>64</mn></mrow></mfrac></mstyle><mstyle mathsize='1.61em'><mrow><mo fence='true' form='prefix'>⌋</mo><mrow></mrow><mo fence='true' form='postfix'></mo></mrow></mstyle><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle mathsize='1.61em'><mrow><mo fence='true' form='prefix'>⌈</mo><mrow></mrow><mo fence='true' form='postfix'></mo></mrow></mstyle><mn>7</mn><mstyle displaystyle='true'><mfrac><mrow><mn>32</mn>
</mrow><mrow><mn>64</mn></mrow></mfrac></mstyle><mstyle mathsize='1.61em'><mrow><mo fence='true' form='prefix'>⌋</mo><mrow></mrow><mo fence='true' form='postfix'></mo></mrow></mstyle><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle mathsize='1.61em'><mrow><mo fence='true' form='prefix'>⌈</mo><mrow></mrow><mo fence='true' form='postfix'></mo></mrow></mstyle><mn>24</mn><mstyle displaystyle='true'><mfrac><mrow><mn>32</mn>
</mrow><mrow><mn>64</mn></mrow></mfrac></mstyle><mstyle mathsize='1.61em'><mrow><mo fence='true' form='prefix'>⌋</mo><mrow></mrow><mo fence='true' form='postfix'></mo></mrow></mstyle><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
   </p><!-- l. 907 --><p class='noindent'><!-- l. 907 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
   </p><!-- l. 909 --><p class='noindent'><!-- l. 909 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>(</mo><mn>4</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-bin' stretchy='false'>−</mo><mn>14</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>2</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-bin' stretchy='false'>−</mo><mn>16</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>0</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>16</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-bin' stretchy='false'>−</mo><mn>3</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>4</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>12</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
   </p><!-- l. 911 --><p class='noindent'><!-- l. 911 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
   </p><!-- l. 913 --><p class='noindent'>Note that <!-- l. 913 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><munderover accent='false' accentunder='false'><mrow><mi class='MathClass-op'>∑</mi><mo> ⁡<!-- FUNCTION APPLICATION --></mo>
  </mrow><mrow><mi>i</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>0</mn></mrow><mrow><mn>7</mn></mrow></munderover><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>â</mi></mrow><mrow><mi>i</mi></mrow></msub><msub><mrow><mi>s</mi></mrow><mrow><mi>i</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>+</mo> <mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true'>^</mo></mover><mi>m</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>ê</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>(</mo><mn>4</mn> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>16</mn> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>16</mn> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>4</mn><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>4</mn> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>1</mn> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>13</mn> <mo class='MathClass-rel' stretchy='false'>∈</mo> <msub><mrow><mi>ℤ</mi></mrow><mrow><mn>2</mn><mi>n</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>32</mn></mrow></msub></mrow></math>
   </p><!-- l. 915 --><p class='noindent'><!-- l. 915 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
                                                                                         
                                                                                         
   </p><!-- l. 917 --><p class='noindent'><!-- l. 917 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mover accent='true'><mrow><mi>b</mi></mrow><mo accent='true'>^</mo></mover> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>12</mn> <mo class='MathClass-rel' stretchy='false'>≈</mo><mn>13</mn> <mo class='MathClass-rel' stretchy='false'>=</mo><munderover accent='false' accentunder='false'><mrow> <mi class='MathClass-op'>∑</mi><mo> ⁡<!-- FUNCTION APPLICATION --></mo>
  </mrow><mrow><mi>i</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>0</mn></mrow><mrow><mn>7</mn></mrow></munderover><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>â</mi></mrow><mrow><mi>i</mi></mrow></msub><msub><mrow><mi>s</mi></mrow><mrow><mi>i</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>+</mo> <mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true'>^</mo></mover><mi>m</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>ê</mi></mrow></math>
   </p><!-- l. 919 --><p class='noindent'>This small difference in <!-- l. 919 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mover accent='true'><mrow><mi>b</mi></mrow><mo accent='true'>^</mo></mover></math>
   comes from the aggregated noises of rounding <!-- l. 919 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>â</mi></mrow><mrow><mn>0</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>â</mi></mrow><mrow><mn>1</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace><mo class='MathClass-punc' stretchy='false'>,</mo><mi>ê</mi></mrow></math>
   during the modulus switch.
   </p></dd><dt class='enumerate-enumitem'>
2. </dt><dd class='enumerate-enumitem'><span class='rm-lmbx-10x-x-109'>Blind Rotation: </span>We assume that the application avoids the problem of negacyclic polynomial
   rotation by ensuring that the usable plaintext values are the following continuous <!-- l. 922 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mstyle displaystyle='true'><mfrac><mrow><mn>8</mn>
</mrow><mrow><mn>2</mn></mrow></mfrac></mstyle></math>
   modulo values within <!-- l. 922 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>ℤ</mi></mrow><mrow><mn>8</mn></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>{</mo><mo class='MathClass-bin' stretchy='false'>−</mo><mn>4</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-bin' stretchy='false'>−</mo><mn>3</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-bin' stretchy='false'>−</mo><mn>2</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>0</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>1</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>2</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>3</mn><mo class='MathClass-close' stretchy='false'>}</mo></mrow></math>,
   which are <!-- l. 922 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>{</mo><mo class='MathClass-bin' stretchy='false'>−</mo><mn>2</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>0</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>}</mo></mrow></math>.
   This implies that the only possible values of <!-- l. 922 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>i</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true'>^</mo></mover><mi>m</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>ê</mi></mrow></math>
   in <!-- l. 922 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>V</mi> <mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>X</mi></mrow><mrow><mi>i</mi></mrow></msup></mrow></math>
   will be: <!-- l. 922 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>i</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>{</mo><mo class='MathClass-bin' stretchy='false'>−</mo><mn>8</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-bin' stretchy='false'>−</mo><mn>7</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace><mo class='MathClass-punc' stretchy='false'>,</mo><mn>6</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>7</mn><mo class='MathClass-close' stretchy='false'>}</mo></mrow></math>.
   Based on these requirements, <a href='#the-lookup-table-for-n-q-t-lwe-setup-orangeorange-is-the-plaintext-ms-bits-greengreen-is-the-noise-es-bits-'>Table 4<!-- tex4ht:ref: subsec:coeff-rotation  --></a> is the Lookup Table polynomial <!-- l. 922 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>V</mi> <mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
   that maps <!-- l. 922 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true'>^</mo></mover><mi>m</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>ê</mi></mrow></math>
   to <!-- l. 922 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi mathvariant='normal'>Δ</mi><mi>m</mi></mrow></math>.
   <div class='table'>
   <!-- l. 925 --><p class='noindent'></p><figure class='float' id='x103-134003r4'><span id='the-lookup-table-for-n-q-t-lwe-setup-orangeorange-is-the-plaintext-ms-bits-greengreen-is-the-noise-es-bits-'></span>
   <!-- tex4ht:inline --><div class='tabular'> <table class='tabular' id='TBL-37' rules='groups'><colgroup id='TBL-37-1g'><col id='TBL-37-1' /></colgroup><colgroup id='TBL-37-2g'><col id='TBL-37-2' /></colgroup><colgroup id='TBL-37-3g'><col id='TBL-37-3' /></colgroup><colgroup id='TBL-37-4g'><col id='TBL-37-4' /></colgroup><colgroup id='TBL-37-5g'><col id='TBL-37-5' /></colgroup><colgroup id='TBL-37-6g'><col id='TBL-37-6' /></colgroup><colgroup id='TBL-37-7g'><col id='TBL-37-7' /></colgroup><colgroup id='TBL-37-8g'><col id='TBL-37-8' /></colgroup><colgroup id='TBL-37-9g'><col id='TBL-37-9' /></colgroup><colgroup id='TBL-37-10g'><col id='TBL-37-10' /></colgroup><colgroup id='TBL-37-11g'><col id='TBL-37-11' /></colgroup><tr class='hline'><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr id='TBL-37-1-'><td class='td11' colspan='6' id='TBL-37-1-1' style='text-align:center; white-space:nowrap;'></td> <div class='multicolumn' style='text-align:left; white-space:nowrap;'><!-- l. 954 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>V</mi> <mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mi>v</mi></mrow><mrow><mn>0</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>v</mi></mrow><mrow><mn>1</mn></mrow></msub><mi>X</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>v</mi></mrow><mrow><mn>2</mn></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mn>2</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>v</mi></mrow><mrow><mn>3</mn></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mn>3</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>v</mi></mrow><mrow><mn>4</mn></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mn>4</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>v</mi></mrow><mrow><mn>5</mn></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mn>5</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>v</mi></mrow><mrow><mn>6</mn></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mn>6</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>v</mi></mrow><mrow><mn>7</mn></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mn>7</mn></mrow></msup></mrow></math></div>         
</tr><tr id='TBL-037-4-'><td class='td11' colspan='6' id='TBL-037-4-1' style='text-align:center; white-space:nowrap;'></td> <div class='multicolumn' style='text-align:left; white-space:nowrap;'><span id='textcolor57'>......</span> <!-- l. 954 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>v</mi></mrow><mrow><mn>8</mn></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mn>8</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>v</mi></mrow><mrow><mn>9</mn></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mn>9</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>v</mi></mrow><mrow><mn>10</mn></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mn>10</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>v</mi></mrow><mrow><mn>11</mn></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mn>11</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>v</mi></mrow><mrow><mn>12</mn></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mn>12</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>v</mi></mrow><mrow><mn>13</mn></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mn>13</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>v</mi></mrow><mrow><mn>14</mn></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mn>14</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>v</mi></mrow><mrow><mn>15</mn></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mn>15</mn></mrow></msup></mrow></math></div>  
</tr><tr id='TBL-0037-7-'><td class='td11' colspan='6' id='TBL-0037-7-1' style='text-align:center; white-space:nowrap;'></td> <div class='multicolumn' style='text-align:left; white-space:nowrap;'><span id='textcolor58'>....</span><!-- l. 954 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>0</mn> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>0</mn><mi>X</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>0</mn><msup><mrow><mi>X</mi></mrow><mrow><mn>2</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>0</mn><msup><mrow><mi>X</mi></mrow><mrow><mn>3</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>1</mn><msup><mrow><mi>X</mi></mrow><mrow><mn>4</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>1</mn><msup><mrow><mi>X</mi></mrow><mrow><mn>5</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>1</mn><msup><mrow><mi>X</mi></mrow><mrow><mn>6</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>1</mn><msup><mrow><mi>X</mi></mrow><mrow><mn>7</mn></mrow></msup></mrow></math></div>      
</tr><tr id='TBL-00037-10-'><td class='td11' colspan='6' id='TBL-00037-10-1' style='text-align:center; white-space:nowrap;'></td> <div class='multicolumn' style='text-align:left; white-space:nowrap;'><span id='textcolor59'>......</span><!-- l. 954 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>2</mn><msup><mrow><mi>X</mi></mrow><mrow><mn>8</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>2</mn><msup><mrow><mi>X</mi></mrow><mrow><mn>9</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>2</mn><msup><mrow><mi>X</mi></mrow><mrow><mn>10</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>2</mn><msup><mrow><mi>X</mi></mrow><mrow><mn>11</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>1</mn><msup><mrow><mi>X</mi></mrow><mrow><mn>12</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>1</mn><msup><mrow><mi>X</mi></mrow><mrow><mn>13</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>1</mn><msup><mrow><mi>X</mi></mrow><mrow><mn>14</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>1</mn><msup><mrow><mi>X</mi></mrow><mrow><mn>15</mn></mrow></msup></mrow></math></div>   
</tr><tr class='hline'><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr class='hline'><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr id='TBL-000037-13-'><td class='td11' id='TBL-000037-13-1' style='text-align:center; white-space:nowrap;'>       <!-- l. 954 --><math display='inline' mathvariant='bold-italic' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>i</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true'>^</mo></mover><mi>m</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>ê</mi></mrow></math>        </td><td class='td11' id='TBL-000037-13-2' style='text-align:center; white-space:nowrap;'>  <!-- l. 954 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mn>8</mn></mrow></math>   </td><td class='td11' id='TBL-000037-13-3' style='text-align:center; white-space:nowrap;'>  <!-- l. 954 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mn>7</mn></mrow></math>   </td><td class='td11' id='TBL-000037-13-4' style='text-align:center; white-space:nowrap;'>  <!-- l. 954 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mn>6</mn></mrow></math>   </td><td class='td11' id='TBL-000037-13-5' style='text-align:center; white-space:nowrap;'>  <!-- l. 954 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mn>5</mn></mrow></math>   </td><td class='td11' id='TBL-000037-13-6' style='text-align:center; white-space:nowrap;'>  <!-- l. 954 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mn>4</mn></mrow></math>   </td><td class='td11' id='TBL-000037-13-7' style='text-align:center; white-space:nowrap;'>  <!-- l. 954 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mn>3</mn></mrow></math>   </td><td class='td11' id='TBL-000037-13-8' style='text-align:center; white-space:nowrap;'>  <!-- l. 954 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mn>2</mn></mrow></math>   </td><td class='td11' id='TBL-000037-13-9' style='text-align:center; white-space:nowrap;'>  <!-- l. 954 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></math>   </td></tr><tr id='TBL-0000037-16-'><td class='td11' id='TBL-0000037-16-1' style='text-align:center; white-space:nowrap;'>     (in <!-- l. 954 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>V</mi> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>X</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mi>i</mi></mrow></msup></mrow></math>)        </td><td class='td11' id='TBL-0000037-16-2' style='text-align:center; white-space:nowrap;'> (<!-- l. 954 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mstyle mathcolor='#00FFFF'></mstyle><mstyle mathcolor='#FF8000'><mn>110</mn></mstyle><msub><mrow><mstyle mathcolor='#00FF00'><mn>00</mn></mstyle></mrow><mrow><mn>2</mn></mrow></msub></mrow></math>)  </td><td class='td11' id='TBL-0000037-16-3' style='text-align:center; white-space:nowrap;'> (<!-- l. 954 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mstyle mathcolor='#00FFFF'></mstyle><mstyle mathcolor='#FF8000'><mn>110</mn></mstyle><msub><mrow><mstyle mathcolor='#00FF00'><mn>01</mn></mstyle></mrow><mrow><mn>2</mn></mrow></msub></mrow></math>)  </td><td class='td11' id='TBL-0000037-16-4' style='text-align:center; white-space:nowrap;'> (<!-- l. 954 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mstyle mathcolor='#00FFFF'></mstyle><mstyle mathcolor='#FF8000'><mn>110</mn></mstyle><msub><mrow><mstyle mathcolor='#00FF00'><mn>10</mn></mstyle></mrow><mrow><mn>2</mn></mrow></msub></mrow></math>)  </td><td class='td11' id='TBL-0000037-16-5' style='text-align:center; white-space:nowrap;'> (<!-- l. 954 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mstyle mathcolor='#00FFFF'></mstyle><mstyle mathcolor='#FF8000'><mn>110</mn></mstyle><msub><mrow><mstyle mathcolor='#00FF00'><mn>11</mn></mstyle></mrow><mrow><mn>2</mn></mrow></msub></mrow></math>)  </td><td class='td11' id='TBL-0000037-16-6' style='text-align:center; white-space:nowrap;'> (<!-- l. 954 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mstyle mathcolor='#00FFFF'></mstyle><mstyle mathcolor='#FF8000'><mn>111</mn></mstyle><msub><mrow><mstyle mathcolor='#00FF00'><mn>00</mn></mstyle></mrow><mrow><mn>2</mn></mrow></msub></mrow></math>)  </td><td class='td11' id='TBL-0000037-16-7' style='text-align:center; white-space:nowrap;'> (<!-- l. 954 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mstyle mathcolor='#00FFFF'></mstyle><mstyle mathcolor='#FF8000'><mn>111</mn></mstyle><msub><mrow><mstyle mathcolor='#00FF00'><mn>01</mn></mstyle></mrow><mrow><mn>2</mn></mrow></msub></mrow></math>)  </td><td class='td11' id='TBL-0000037-16-8' style='text-align:center; white-space:nowrap;'> (<!-- l. 954 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mstyle mathcolor='#00FFFF'></mstyle><mstyle mathcolor='#FF8000'><mn>111</mn></mstyle><msub><mrow><mstyle mathcolor='#00FF00'><mn>10</mn></mstyle></mrow><mrow><mn>2</mn></mrow></msub></mrow></math>)  </td><td class='td11' id='TBL-0000037-16-9' style='text-align:center; white-space:nowrap;'> (<!-- l. 954 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mstyle mathcolor='#00FFFF'></mstyle><mstyle mathcolor='#FF8000'><mn>111</mn></mstyle><msub><mrow><mstyle mathcolor='#00FF00'><mn>11</mn></mstyle></mrow><mrow><mn>2</mn></mrow></msub></mrow></math>)  </td>
</tr><tr class='hline'><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr id='TBL-00000037-19-'><td class='td11' id='TBL-00000037-19-1' style='text-align:center; white-space:nowrap;'>                                        <span class='rm-lmbx-10x-x-109'>constant term’s                                                       </span></td><td class='td11' id='TBL-00000037-19-2' style='text-align:center; white-space:nowrap;'>  <!-- l. 954 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mn>2</mn></mrow></math>   </td><td class='td11' id='TBL-00000037-19-3' style='text-align:center; white-space:nowrap;'>  <!-- l. 954 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mn>2</mn></mrow></math>   </td><td class='td11' id='TBL-00000037-19-4' style='text-align:center; white-space:nowrap;'>  <!-- l. 954 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mn>2</mn></mrow></math>   </td><td class='td11' id='TBL-00000037-19-5' style='text-align:center; white-space:nowrap;'>  <!-- l. 954 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mn>2</mn></mrow></math>   </td><td class='td11' id='TBL-00000037-19-6' style='text-align:center; white-space:nowrap;'>  <!-- l. 954 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></math>   </td><td class='td11' id='TBL-00000037-19-7' style='text-align:center; white-space:nowrap;'>  <!-- l. 954 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></math>   </td><td class='td11' id='TBL-00000037-19-8' style='text-align:center; white-space:nowrap;'>  <!-- l. 954 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></math>   </td><td class='td11' id='TBL-00000037-19-9' style='text-align:center; white-space:nowrap;'>  <!-- l. 954 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></math>   </td></tr><tr id='TBL-000000037-22-'><td class='td11' id='TBL-000000037-22-1' style='text-align:center; white-space:nowrap;'>  <span class='rm-lmbx-10x-x-109'>coeff. of </span><!-- l. 954 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>V</mi> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>X</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mi>i</mi></mrow></msup></mrow></math>     </td><td class='td11' id='TBL-000000037-22-2' style='text-align:center; white-space:nowrap;'>  <!-- l. 954 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mstyle mathcolor='#FF8000'><mn>110</mn></mstyle></mrow><mrow><mn>2</mn></mrow></msub></math>    </td><td class='td11' id='TBL-000000037-22-3' style='text-align:center; white-space:nowrap;'>  <!-- l. 954 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mstyle mathcolor='#FF8000'><mn>110</mn></mstyle></mrow><mrow><mn>2</mn></mrow></msub></math>    </td><td class='td11' id='TBL-000000037-22-4' style='text-align:center; white-space:nowrap;'>  <!-- l. 954 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mstyle mathcolor='#FF8000'><mn>110</mn></mstyle></mrow><mrow><mn>2</mn></mrow></msub></math>    </td><td class='td11' id='TBL-000000037-22-5' style='text-align:center; white-space:nowrap;'>  <!-- l. 954 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mstyle mathcolor='#FF8000'><mn>110</mn></mstyle></mrow><mrow><mn>2</mn></mrow></msub></math>    </td><td class='td11' id='TBL-000000037-22-6' style='text-align:center; white-space:nowrap;'>  <!-- l. 954 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mstyle mathcolor='#FF8000'><mn>111</mn></mstyle></mrow><mrow><mn>2</mn></mrow></msub></math>    </td><td class='td11' id='TBL-000000037-22-7' style='text-align:center; white-space:nowrap;'>  <!-- l. 954 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mstyle mathcolor='#FF8000'><mn>111</mn></mstyle></mrow><mrow><mn>2</mn></mrow></msub></math>    </td><td class='td11' id='TBL-000000037-22-8' style='text-align:center; white-space:nowrap;'>  <!-- l. 954 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mstyle mathcolor='#FF8000'><mn>111</mn></mstyle></mrow><mrow><mn>2</mn></mrow></msub></math>    </td><td class='td11' id='TBL-000000037-22-9' style='text-align:center; white-space:nowrap;'>  <!-- l. 954 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mstyle mathcolor='#FF8000'><mn>111</mn></mstyle><msub><mrow><mstyle mathcolor='#00FF00'><mn>00</mn></mstyle></mrow><mrow><mn>2</mn></mrow></msub></mrow></math>    </td>
</tr><tr class='hline'><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr id='TBL-0000000037-25-'><td class='td11' id='TBL-0000000037-25-1' style='text-align:center; white-space:nowrap;'> <!-- l. 954 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mstyle mathvariant='bold'><mi>𝐦</mi></mstyle></math> <span class='rm-lmbx-10x-x-109'>(plaintext) </span></td><td class='td11' id='TBL-0000000037-25-2' style='text-align:center; white-space:nowrap;'>  <!-- l. 954 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mn>2</mn></mrow></math>   </td><td class='td11' id='TBL-0000000037-25-3' style='text-align:center; white-space:nowrap;'>  <!-- l. 954 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mn>2</mn></mrow></math>   </td><td class='td11' id='TBL-0000000037-25-4' style='text-align:center; white-space:nowrap;'>  <!-- l. 954 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mn>2</mn></mrow></math>   </td><td class='td11' id='TBL-0000000037-25-5' style='text-align:center; white-space:nowrap;'>  <!-- l. 954 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mn>2</mn></mrow></math>   </td><td class='td11' id='TBL-0000000037-25-6' style='text-align:center; white-space:nowrap;'>  <!-- l. 954 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></math>   </td><td class='td11' id='TBL-0000000037-25-7' style='text-align:center; white-space:nowrap;'>  <!-- l. 954 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></math>   </td><td class='td11' id='TBL-0000000037-25-8' style='text-align:center; white-space:nowrap;'>  <!-- l. 954 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></math>   </td><td class='td11' id='TBL-0000000037-25-9' style='text-align:center; white-space:nowrap;'>  <!-- l. 954 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></math>   </td>
</tr><tr class='hline'><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr class='hline'><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr id='TBL-00000000037-28-'><td class='td11' id='TBL-00000000037-28-1' style='text-align:center; white-space:nowrap;'>       <!-- l. 954 --><math display='inline' mathvariant='bold-italic' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>i</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true'>^</mo></mover><mi>m</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>ê</mi></mrow></math>        </td><td class='td11' id='TBL-00000000037-28-2' style='text-align:center; white-space:nowrap;'>  <!-- l. 954 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mn>0</mn></math>   </td><td class='td11' id='TBL-00000000037-28-3' style='text-align:center; white-space:nowrap;'>  <!-- l. 954 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mn>1</mn></math>   </td><td class='td11' id='TBL-00000000037-28-4' style='text-align:center; white-space:nowrap;'>  <!-- l. 954 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mn>2</mn></math>   </td><td class='td11' id='TBL-00000000037-28-5' style='text-align:center; white-space:nowrap;'>  <!-- l. 954 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mn>3</mn></math>   </td><td class='td11' id='TBL-00000000037-28-6' style='text-align:center; white-space:nowrap;'>  <!-- l. 954 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mn>4</mn></math>   </td><td class='td11' id='TBL-00000000037-28-7' style='text-align:center; white-space:nowrap;'>  <!-- l. 954 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mn>5</mn></math>   </td><td class='td11' id='TBL-00000000037-28-8' style='text-align:center; white-space:nowrap;'>  <!-- l. 954 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mn>6</mn></math>   </td><td class='td11' id='TBL-00000000037-28-9' style='text-align:center; white-space:nowrap;'>  <!-- l. 954 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mn>7</mn></math>   </td></tr><tr id='TBL-000000000037-31-'><td class='td11' id='TBL-000000000037-31-1' style='text-align:center; white-space:nowrap;'>     (in <!-- l. 954 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>V</mi> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>X</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mi>i</mi></mrow></msup></mrow></math>)        </td><td class='td11' id='TBL-000000000037-31-2' style='text-align:center; white-space:nowrap;'> (<!-- l. 954 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mstyle mathcolor='#00FFFF'></mstyle><msub><mrow><mstyle mathcolor='#FF8000'><mn>000</mn></mstyle></mrow><mrow><mn>2</mn></mrow></msub></mrow></math>)  </td><td class='td11' id='TBL-000000000037-31-3' style='text-align:center; white-space:nowrap;'> (<!-- l. 954 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mstyle mathcolor='#00FFFF'></mstyle><msub><mrow><mstyle mathcolor='#FF8000'><mn>000</mn></mstyle></mrow><mrow><mn>2</mn></mrow></msub></mrow></math>)  </td><td class='td11' id='TBL-000000000037-31-4' style='text-align:center; white-space:nowrap;'> (<!-- l. 954 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mstyle mathcolor='#00FFFF'></mstyle><msub><mrow><mstyle mathcolor='#FF8000'><mn>000</mn></mstyle></mrow><mrow><mn>2</mn></mrow></msub></mrow></math>)  </td><td class='td11' id='TBL-000000000037-31-5' style='text-align:center; white-space:nowrap;'> (<!-- l. 954 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mstyle mathcolor='#00FFFF'></mstyle><msub><mrow><mstyle mathcolor='#FF8000'><mn>000</mn></mstyle></mrow><mrow><mn>2</mn></mrow></msub></mrow></math>)  </td><td class='td11' id='TBL-000000000037-31-6' style='text-align:center; white-space:nowrap;'> (<!-- l. 954 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mstyle mathcolor='#00FFFF'></mstyle><msub><mrow><mstyle mathcolor='#FF8000'><mn>001</mn></mstyle></mrow><mrow><mn>2</mn></mrow></msub></mrow></math>)  </td><td class='td11' id='TBL-000000000037-31-7' style='text-align:center; white-space:nowrap;'> (<!-- l. 954 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mstyle mathcolor='#00FFFF'></mstyle><msub><mrow><mstyle mathcolor='#FF8000'><mn>001</mn></mstyle></mrow><mrow><mn>2</mn></mrow></msub></mrow></math>)  </td><td class='td11' id='TBL-000000000037-31-8' style='text-align:center; white-space:nowrap;'> (<!-- l. 954 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mstyle mathcolor='#00FFFF'></mstyle><msub><mrow><mstyle mathcolor='#FF8000'><mn>001</mn></mstyle></mrow><mrow><mn>2</mn></mrow></msub></mrow></math>)  </td><td class='td11' id='TBL-000000000037-31-9' style='text-align:center; white-space:nowrap;'> (<!-- l. 954 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mstyle mathcolor='#00FFFF'></mstyle><msub><mrow><mstyle mathcolor='#FF8000'><mn>001</mn></mstyle></mrow><mrow><mn>2</mn></mrow></msub></mrow></math>)  </td>
</tr><tr class='hline'><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr id='TBL-0000000000037-34-'><td class='td11' id='TBL-0000000000037-34-1' style='text-align:center; white-space:nowrap;'>                                        <span class='rm-lmbx-10x-x-109'>constant term’s                                                       </span></td><td class='td11' id='TBL-0000000000037-34-2' style='text-align:center; white-space:nowrap;'>  <!-- l. 954 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mn>0</mn></math>   </td><td class='td11' id='TBL-0000000000037-34-3' style='text-align:center; white-space:nowrap;'>  <!-- l. 954 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mn>0</mn></math>   </td><td class='td11' id='TBL-0000000000037-34-4' style='text-align:center; white-space:nowrap;'>  <!-- l. 954 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mn>0</mn></math>   </td><td class='td11' id='TBL-0000000000037-34-5' style='text-align:center; white-space:nowrap;'>  <!-- l. 954 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mn>0</mn></math>   </td><td class='td11' id='TBL-0000000000037-34-6' style='text-align:center; white-space:nowrap;'>  <!-- l. 954 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mn>1</mn></math>   </td><td class='td11' id='TBL-0000000000037-34-7' style='text-align:center; white-space:nowrap;'>  <!-- l. 954 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mn>1</mn></math>   </td><td class='td11' id='TBL-0000000000037-34-8' style='text-align:center; white-space:nowrap;'>  <!-- l. 954 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mn>1</mn></math>   </td><td class='td11' id='TBL-0000000000037-34-9' style='text-align:center; white-space:nowrap;'>  <!-- l. 954 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mn>1</mn></math>   </td></tr><tr id='TBL-00000000000037-37-'><td class='td11' id='TBL-00000000000037-37-1' style='text-align:center; white-space:nowrap;'>  <span class='rm-lmbx-10x-x-109'>coeff. of </span><!-- l. 954 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>V</mi> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>X</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mi>i</mi></mrow></msup></mrow></math>     </td><td class='td11' id='TBL-00000000000037-37-2' style='text-align:center; white-space:nowrap;'>  <!-- l. 954 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mstyle mathcolor='#FF8000'><mn>000</mn></mstyle><msub><mrow><mstyle mathcolor='#00FF00'><mn>00</mn></mstyle></mrow><mrow><mn>2</mn></mrow></msub></mrow></math>    </td><td class='td11' id='TBL-00000000000037-37-3' style='text-align:center; white-space:nowrap;'>  <!-- l. 954 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mstyle mathcolor='#FF8000'><mn>000</mn></mstyle><msub><mrow><mstyle mathcolor='#00FF00'><mn>00</mn></mstyle></mrow><mrow><mn>2</mn></mrow></msub></mrow></math>    </td><td class='td11' id='TBL-00000000000037-37-4' style='text-align:center; white-space:nowrap;'>  <!-- l. 954 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mstyle mathcolor='#FF8000'><mn>000</mn></mstyle><msub><mrow><mstyle mathcolor='#00FF00'><mn>00</mn></mstyle></mrow><mrow><mn>2</mn></mrow></msub></mrow></math>    </td><td class='td11' id='TBL-00000000000037-37-5' style='text-align:center; white-space:nowrap;'>  <!-- l. 954 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mstyle mathcolor='#FF8000'><mn>000</mn></mstyle><msub><mrow><mstyle mathcolor='#00FF00'><mn>00</mn></mstyle></mrow><mrow><mn>2</mn></mrow></msub></mrow></math>    </td><td class='td11' id='TBL-00000000000037-37-6' style='text-align:center; white-space:nowrap;'>  <!-- l. 954 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mstyle mathcolor='#FF8000'><mn>001</mn></mstyle><msub><mrow><mstyle mathcolor='#00FF00'><mn>00</mn></mstyle></mrow><mrow><mn>2</mn></mrow></msub></mrow></math>    </td><td class='td11' id='TBL-00000000000037-37-7' style='text-align:center; white-space:nowrap;'>  <!-- l. 954 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mstyle mathcolor='#FF8000'><mn>001</mn></mstyle><msub><mrow><mstyle mathcolor='#00FF00'><mn>00</mn></mstyle></mrow><mrow><mn>2</mn></mrow></msub></mrow></math>    </td><td class='td11' id='TBL-00000000000037-37-8' style='text-align:center; white-space:nowrap;'>  <!-- l. 954 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mstyle mathcolor='#FF8000'><mn>001</mn></mstyle><msub><mrow><mstyle mathcolor='#00FF00'><mn>00</mn></mstyle></mrow><mrow><mn>2</mn></mrow></msub></mrow></math>    </td><td class='td11' id='TBL-00000000000037-37-9' style='text-align:center; white-space:nowrap;'>  <!-- l. 954 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mstyle mathcolor='#FF8000'><mn>001</mn></mstyle><msub><mrow><mstyle mathcolor='#00FF00'><mn>00</mn></mstyle></mrow><mrow><mn>2</mn></mrow></msub></mrow></math>    </td>
</tr><tr class='hline'><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr id='TBL-000000000000037-40-'><td class='td11' id='TBL-000000000000037-40-1' style='text-align:center; white-space:nowrap;'> <!-- l. 954 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mstyle mathvariant='bold'><mi>𝐦</mi></mstyle></math> <span class='rm-lmbx-10x-x-109'>(plaintext) </span></td><td class='td11' id='TBL-000000000000037-40-2' style='text-align:center; white-space:nowrap;'>  <!-- l. 954 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mn>0</mn></math>   </td><td class='td11' id='TBL-000000000000037-40-3' style='text-align:center; white-space:nowrap;'>  <!-- l. 954 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mn>0</mn></math>   </td><td class='td11' id='TBL-000000000000037-40-4' style='text-align:center; white-space:nowrap;'>  <!-- l. 954 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mn>0</mn></math>   </td><td class='td11' id='TBL-000000000000037-40-5' style='text-align:center; white-space:nowrap;'>  <!-- l. 954 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mn>0</mn></math>   </td><td class='td11' id='TBL-000000000000037-40-6' style='text-align:center; white-space:nowrap;'>  <!-- l. 954 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mn>1</mn></math>   </td><td class='td11' id='TBL-000000000000037-40-7' style='text-align:center; white-space:nowrap;'>  <!-- l. 954 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mn>1</mn></math>   </td><td class='td11' id='TBL-000000000000037-40-8' style='text-align:center; white-space:nowrap;'>  <!-- l. 954 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mn>1</mn></math>   </td><td class='td11' id='TBL-000000000000037-40-9' style='text-align:center; white-space:nowrap;'>  <!-- l. 954 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mn>1</mn></math>   </td>
</tr><tr class='hline'><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr></table> </div>
   
                                                                                         
                                                                                         
<figcaption class='caption'><span class='id'>Table 4: </span><span class='content'>The Lookup Table for <!-- l. 958 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>n</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>16</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mi>q</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>64</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mi>t</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>8</mn></mrow></math>
LWE setup. <span id='textcolor62'>Orange</span> is the plaintext <!-- l. 958 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>m</mi></math>’s
bits. <span id='textcolor63'>Green</span> is the noise <!-- l. 958 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>e</mi></math>’s
bits.                                                                                      </span></figcaption><!-- tex4ht:label?: x103-134003r4  -->
   </figure>
   </div>
   <!-- l. 962 --><p class='noindent'>Note that <!-- l. 962 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>V</mi> <mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>’s
   coefficients for the <!-- l. 962 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>X</mi></mrow><mrow><mn>8</mn></mrow></msup> <mo class='MathClass-rel' stretchy='false'>∼</mo><msup><mrow><mi>X</mi></mrow><mrow><mn>15</mn></mrow></msup></mrow></math>
   terms are <!-- l. 962 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>{</mo><mn>2</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>}</mo></mrow></math>
   instead of <!-- l. 962 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>{</mo><mo class='MathClass-bin' stretchy='false'>−</mo><mn>2</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>}</mo></mrow></math>,
   so that if <!-- l. 962 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>V</mi> </mrow></math> gets
   rotated by <!-- l. 962 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>{</mo><mo class='MathClass-bin' stretchy='false'>−</mo><mn>8</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-bin' stretchy='false'>−</mo><mn>7</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-bin' stretchy='false'>−</mo><mn>6</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-bin' stretchy='false'>−</mo><mn>5</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>4</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>5</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>6</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>7</mn><mo class='MathClass-close' stretchy='false'>}</mo></mrow></math>
   slots to the left, the constant term’s coefficient flips its sign to
   <!-- l. 962 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>{</mo><mo class='MathClass-bin' stretchy='false'>−</mo><mn>2</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>}</mo></mrow></math>due to wrapping around
   the boundary of the <!-- l. 962 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>n</mi></math>
   exponent.
   </p><!-- l. 964 --><p class='noindent'>During the actual bootstrapping, we will do blind rotation of <a href='#the-lookup-table-for-n-q-t-lwe-setup-orangeorange-is-the-plaintext-ms-bits-greengreen-is-the-noise-es-bits-'>Table 4<!-- tex4ht:ref: subsec:coeff-rotation  --></a>’s
   <!-- l. 964 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>V</mi> <mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math> (which is
   GLWE-encrypted) by <!-- l. 964 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mover accent='true'><mrow><mi>b</mi></mrow><mo accent='true'>^</mo></mover> <mo class='MathClass-bin' stretchy='false'>−</mo><munderover accent='false' accentunder='false'><mrow><mi class='MathClass-op'>∑</mi><mo> ⁡<!-- FUNCTION APPLICATION --></mo>
  </mrow><mrow><mi>i</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>0</mn></mrow><mrow><mn>7</mn></mrow></munderover><msub><mrow><mi>â</mi></mrow><mrow><mi>i</mi></mrow></msub><msub><mrow><mi>s</mi></mrow><mrow><mi>i</mi></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>4</mn></mrow></math>
   positions to the left, which computed as follows:
   </p><!-- l. 966 --><p class='noindent'><!-- l. 966 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true'>^</mo></mover><mi>m</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>ê</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mover accent='true'><mrow><mi>b</mi></mrow><mo accent='true'>^</mo></mover> <mo class='MathClass-bin' stretchy='false'>−</mo><munderover accent='false' accentunder='false'><mrow><mi class='MathClass-op'>∑</mi><mo> ⁡<!-- FUNCTION APPLICATION --></mo>
  </mrow><mrow><mi>i</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>0</mn></mrow><mrow><mn>7</mn></mrow></munderover><msub><mrow><mi>â</mi></mrow><mrow><mi>i</mi></mrow></msub><msub><mrow><mi>s</mi></mrow><mrow><mi>i</mi></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>12</mn> <mo class='MathClass-bin' stretchy='false'>−</mo><mo class='MathClass-open' stretchy='false'>(</mo><mn>4</mn> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>16</mn> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>16</mn> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>4</mn><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>4</mn><mstyle class='text'><mtext> mod 32</mtext></mstyle> <mo class='MathClass-rel' stretchy='false'>∈</mo> <msub><mrow><mi>ℤ</mi></mrow><mrow><mn>2</mn><mi>n</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>32</mn></mrow></msub></mrow></math>
   </p><!-- l. 969 --><p class='noindent'>In <a href='#the-lookup-table-for-n-q-t-lwe-setup-orangeorange-is-the-plaintext-ms-bits-greengreen-is-the-noise-es-bits-'>Table 4<!-- tex4ht:ref: subsec:coeff-rotation  --></a>, if the rotation count <!-- l. 969 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>i</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>4</mn></mrow></math>, the
   corresponding constant term coefficient is <!-- l. 969 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>v</mi></mrow><mrow><mn>4</mn></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>1</mn> <mo class='MathClass-rel' stretchy='false'>=</mo> <mi>m</mi></mrow></math>.
   As <!-- l. 969 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi mathvariant='normal'>Δ</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>4</mn></mrow></math>, we
   finally get <!-- l. 969 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mover accent='true'><mrow><mi>s</mi></mrow><mo accent='true'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mi mathvariant='normal'>Δ</mi><mi>m</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>1</mn></mrow></math>.
   </p><!-- l. 973 --><p class='noindent'><!-- l. 973 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
   </p><!-- l. 975 --><p class='noindent'>The actual blind rotation is computed as follows:
   </p><!-- l. 977 --><p class='noindent'><!-- l. 977 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mover accent='true'><mrow><mi>s</mi></mrow><mo accent='true'>→</mo></mover> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>(</mo><mn>1</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>0</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>0</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>1</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>1</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>1</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>0</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
   </p><!-- l. 979 --><p class='noindent'><!-- l. 979 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mover accent='true'><mrow><mi>s</mi></mrow><mo accent='true'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true'>^</mo></mover><mi>m</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>â</mi></mrow><mrow><mn>0</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>â</mi></mrow><mrow><mn>1</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>â</mi></mrow><mrow><mn>2</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>â</mi></mrow><mrow><mn>3</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>â</mi></mrow><mrow><mn>4</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>â</mi></mrow><mrow><mn>5</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>â</mi></mrow><mrow><mn>6</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>â</mi></mrow><mrow><mn>7</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><mover accent='true'><mrow><mi>b</mi></mrow><mo accent='true'>^</mo></mover><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>(</mo><mn>4</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-bin' stretchy='false'>−</mo><mn>14</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>2</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-bin' stretchy='false'>−</mo><mn>16</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>0</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>16</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-bin' stretchy='false'>−</mo><mn>3</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>4</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>12</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
   </p><!-- l. 981 --><p class='noindent'><!-- l. 981 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>V</mi> </mrow><mrow><mn>0</mn></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo> <mi>V</mi> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>X</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mover accent='true'><mrow><mi>b</mi></mrow><mo accent='true'>^</mo></mover></mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo> <mi>V</mi> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>X</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mn>12</mn></mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mi>v</mi></mrow><mrow><mn>12</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>v</mi></mrow><mrow><mn>13</mn></mrow></msub><mi>X</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>v</mi></mrow><mrow><mn>14</mn></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mn>2</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace></mrow></math>
   </p><!-- l. 983 --><p class='noindent'><!-- l. 983 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>V</mi> </mrow><mrow><mn>1</mn></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mi>V</mi> </mrow><mrow><mn>0</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>X</mi></mrow><mrow><msub><mrow><mi>â</mi></mrow><mrow><mn>0</mn></mrow></msub><msub><mrow><mi>s</mi></mrow><mrow><mn>0</mn></mrow></msub></mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mi>s</mi></mrow><mrow><mn>0</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>V</mi> </mrow><mrow><mn>0</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>X</mi></mrow><mrow><msub><mrow><mi>a</mi></mrow><mrow><mn>0</mn></mrow></msub></mrow></msup> <mo class='MathClass-bin' stretchy='false'>−</mo><msub><mrow><mi>V</mi> </mrow><mrow><mn>0</mn></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>V</mi> </mrow><mrow><mn>0</mn></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mi>V</mi> </mrow><mrow><mn>0</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>X</mi></mrow><mrow><mn>4</mn></mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mi>v</mi></mrow><mrow><mn>8</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>v</mi></mrow><mrow><mn>9</mn></mrow></msub><mi>X</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>v</mi></mrow><mrow><mn>10</mn></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mn>2</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace></mrow></math>
   </p><!-- l. 985 --><p class='noindent'><!-- l. 985 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>V</mi> </mrow><mrow><mn>2</mn></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mi>V</mi> </mrow><mrow><mn>1</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>X</mi></mrow><mrow><msub><mrow><mi>â</mi></mrow><mrow><mn>1</mn></mrow></msub><msub><mrow><mi>s</mi></mrow><mrow><mn>1</mn></mrow></msub></mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mi>s</mi></mrow><mrow><mn>1</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>V</mi> </mrow><mrow><mn>1</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>X</mi></mrow><mrow><msub><mrow><mi>a</mi></mrow><mrow><mn>1</mn></mrow></msub></mrow></msup> <mo class='MathClass-bin' stretchy='false'>−</mo><msub><mrow><mi>V</mi> </mrow><mrow><mn>1</mn></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>V</mi> </mrow><mrow><mn>1</mn></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mi>V</mi> </mrow><mrow><mn>1</mn></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mi>v</mi></mrow><mrow><mn>8</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>v</mi></mrow><mrow><mn>9</mn></mrow></msub><mi>X</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>v</mi></mrow><mrow><mn>10</mn></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mn>2</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace></mrow></math>
   </p><!-- l. 987 --><p class='noindent'><!-- l. 987 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>V</mi> </mrow><mrow><mn>3</mn></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mi>V</mi> </mrow><mrow><mn>2</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>X</mi></mrow><mrow><msub><mrow><mi>â</mi></mrow><mrow><mn>2</mn></mrow></msub><msub><mrow><mi>s</mi></mrow><mrow><mn>2</mn></mrow></msub></mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mi>s</mi></mrow><mrow><mn>2</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>V</mi> </mrow><mrow><mn>2</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>X</mi></mrow><mrow><msub><mrow><mi>a</mi></mrow><mrow><mn>2</mn></mrow></msub></mrow></msup> <mo class='MathClass-bin' stretchy='false'>−</mo><msub><mrow><mi>V</mi> </mrow><mrow><mn>2</mn></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>V</mi> </mrow><mrow><mn>2</mn></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mi>V</mi> </mrow><mrow><mn>2</mn></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mi>v</mi></mrow><mrow><mn>8</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>v</mi></mrow><mrow><mn>9</mn></mrow></msub><mi>X</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>v</mi></mrow><mrow><mn>10</mn></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mn>2</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace></mrow></math>
   </p><!-- l. 989 --><p class='noindent'><!-- l. 989 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>V</mi> </mrow><mrow><mn>4</mn></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mi>V</mi> </mrow><mrow><mn>3</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>X</mi></mrow><mrow><msub><mrow><mi>â</mi></mrow><mrow><mn>3</mn></mrow></msub><msub><mrow><mi>s</mi></mrow><mrow><mn>3</mn></mrow></msub></mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mi>s</mi></mrow><mrow><mn>3</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>V</mi> </mrow><mrow><mn>3</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>X</mi></mrow><mrow><msub><mrow><mi>a</mi></mrow><mrow><mn>3</mn></mrow></msub></mrow></msup> <mo class='MathClass-bin' stretchy='false'>−</mo><msub><mrow><mi>V</mi> </mrow><mrow><mn>3</mn></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>V</mi> </mrow><mrow><mn>3</mn></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mi>V</mi> </mrow><mrow><mn>3</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>X</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mn>16</mn></mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-bin' stretchy='false'>−</mo><msub><mrow><mi>v</mi></mrow><mrow><mn>8</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>−</mo><msub><mrow><mi>v</mi></mrow><mrow><mn>9</mn></mrow></msub><mi>X</mi> <mo class='MathClass-bin' stretchy='false'>−</mo><msub><mrow><mi>v</mi></mrow><mrow><mn>10</mn></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mn>2</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>−</mo><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace></mrow></math>
   </p><!-- l. 991 --><p class='noindent'><!-- l. 991 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>V</mi> </mrow><mrow><mn>5</mn></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mi>V</mi> </mrow><mrow><mn>4</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>X</mi></mrow><mrow><msub><mrow><mi>â</mi></mrow><mrow><mn>4</mn></mrow></msub><msub><mrow><mi>s</mi></mrow><mrow><mn>4</mn></mrow></msub></mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mi>s</mi></mrow><mrow><mn>4</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>V</mi> </mrow><mrow><mn>4</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>X</mi></mrow><mrow><msub><mrow><mi>a</mi></mrow><mrow><mn>4</mn></mrow></msub></mrow></msup> <mo class='MathClass-bin' stretchy='false'>−</mo><msub><mrow><mi>V</mi> </mrow><mrow><mn>4</mn></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>V</mi> </mrow><mrow><mn>4</mn></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mi>V</mi> </mrow><mrow><mn>4</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>X</mi></mrow><mrow><mn>0</mn></mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-bin' stretchy='false'>−</mo><msub><mrow><mi>v</mi></mrow><mrow><mn>8</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>−</mo><msub><mrow><mi>v</mi></mrow><mrow><mn>9</mn></mrow></msub><mi>X</mi> <mo class='MathClass-bin' stretchy='false'>−</mo><msub><mrow><mi>v</mi></mrow><mrow><mn>10</mn></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mn>2</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>−</mo><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace></mrow></math>
   </p><!-- l. 993 --><p class='noindent'><!-- l. 993 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>V</mi> </mrow><mrow><mn>6</mn></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mi>V</mi> </mrow><mrow><mn>5</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>X</mi></mrow><mrow><msub><mrow><mi>â</mi></mrow><mrow><mn>5</mn></mrow></msub><msub><mrow><mi>s</mi></mrow><mrow><mn>5</mn></mrow></msub></mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mi>s</mi></mrow><mrow><mn>5</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>V</mi> </mrow><mrow><mn>5</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>X</mi></mrow><mrow><msub><mrow><mi>a</mi></mrow><mrow><mn>5</mn></mrow></msub></mrow></msup> <mo class='MathClass-bin' stretchy='false'>−</mo><msub><mrow><mi>V</mi> </mrow><mrow><mn>5</mn></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>V</mi> </mrow><mrow><mn>5</mn></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mi>V</mi> </mrow><mrow><mn>5</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>X</mi></mrow><mrow><mn>16</mn></mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mi>v</mi></mrow><mrow><mn>8</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>v</mi></mrow><mrow><mn>9</mn></mrow></msub><mi>X</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>v</mi></mrow><mrow><mn>10</mn></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mn>2</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace></mrow></math>
   </p><!-- l. 995 --><p class='noindent'><!-- l. 995 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>V</mi> </mrow><mrow><mn>7</mn></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mi>V</mi> </mrow><mrow><mn>6</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>X</mi></mrow><mrow><msub><mrow><mi>â</mi></mrow><mrow><mn>6</mn></mrow></msub><msub><mrow><mi>s</mi></mrow><mrow><mn>6</mn></mrow></msub></mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mi>s</mi></mrow><mrow><mn>6</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>V</mi> </mrow><mrow><mn>6</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>X</mi></mrow><mrow><msub><mrow><mi>a</mi></mrow><mrow><mn>6</mn></mrow></msub></mrow></msup> <mo class='MathClass-bin' stretchy='false'>−</mo><msub><mrow><mi>V</mi> </mrow><mrow><mn>6</mn></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>V</mi> </mrow><mrow><mn>6</mn></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mi>V</mi> </mrow><mrow><mn>6</mn></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mi>v</mi></mrow><mrow><mn>8</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>v</mi></mrow><mrow><mn>9</mn></mrow></msub><mi>X</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>v</mi></mrow><mrow><mn>10</mn></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mn>2</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace></mrow></math>
   </p><!-- l. 997 --><p class='noindent'><!-- l. 997 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>V</mi> </mrow><mrow><mn>8</mn></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mi>V</mi> </mrow><mrow><mn>7</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>X</mi></mrow><mrow><msub><mrow><mi>â</mi></mrow><mrow><mn>7</mn></mrow></msub><msub><mrow><mi>s</mi></mrow><mrow><mn>7</mn></mrow></msub></mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mi>s</mi></mrow><mrow><mn>7</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>V</mi> </mrow><mrow><mn>7</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>X</mi></mrow><mrow><msub><mrow><mi>a</mi></mrow><mrow><mn>7</mn></mrow></msub></mrow></msup> <mo class='MathClass-bin' stretchy='false'>−</mo><msub><mrow><mi>V</mi> </mrow><mrow><mn>7</mn></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>V</mi> </mrow><mrow><mn>7</mn></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mi>V</mi> </mrow><mrow><mn>7</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>X</mi></mrow><mrow><mn>4</mn></mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mi>v</mi></mrow><mrow><mn>4</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>v</mi></mrow><mrow><mn>5</mn></mrow></msub><mi>X</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>v</mi></mrow><mrow><mn>6</mn></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mn>2</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace></mrow></math>
   </p><!-- l. 999 --><p class='noindent'><!-- l. 999 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
   </p><!-- l. 1001 --><p class='noindent'>The final output of blind rotation is the GLWE ciphertext of
   <!-- l. 1001 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>V</mi> </mrow><mrow><mn>8</mn></mrow></msub></math>,
   <!-- l. 1001 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖦𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mover accent='true'><mrow><mi>S</mi></mrow><mo accent='true'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>V</mi> </mrow><mrow><mn>8</mn></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>, whose constant
   term’s coefficient is <!-- l. 1001 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>v</mi></mrow><mrow><mn>4</mn></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo> <mi>m</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>1</mn></mrow></math>.
   </p><!-- l. 1003 --><p class='noindent'><!-- l. 1003 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
   </p><!-- l. 1005 --><p class='noindent'>Each step of the actual blind rotation above is computed as the following TFHE ciphertext-to-ciphertext
                                                                                         
                                                                                         
   multiplication:
   </p><!-- l. 1007 --><p class='noindent'><!-- l. 1007 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖦𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mover accent='true'><mrow><mi>S</mi></mrow><mo accent='true'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>V</mi> </mrow><mrow><mi>i</mi><mo class='MathClass-bin' stretchy='false'>+</mo><mn>1</mn></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo><msubsup><mrow> <mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖦𝖦𝖲𝖶</mtext></mstyle></mrow><mrow><mover accent='true'><mrow><mi>S</mi></mrow><mo accent='true'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow><mrow><mi>β</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>l</mi></mrow></msubsup><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>s</mi></mrow><mrow><mi>i</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖦𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mover accent='true'><mrow><mi>S</mi></mrow><mo accent='true'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>V</mi> </mrow><mrow><mi>i</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>X</mi></mrow><mrow><msub><mrow><mi>a</mi></mrow><mrow><mn>0</mn></mrow></msub></mrow></msup> <mo class='MathClass-bin' stretchy='false'>−</mo><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖦𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mover accent='true'><mrow><mi>S</mi></mrow><mo accent='true'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>V</mi> </mrow><mrow><mi>i</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>+</mo><msub><mrow> <mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖦𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mover accent='true'><mrow><mi>S</mi></mrow><mo accent='true'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>V</mi> </mrow><mrow><mi>i</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
   </p><!-- l. 1009 --><p class='noindent'><!-- l. 1009 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
   </p><!-- l. 1011 --><p class='noindent'>We will leave this computation for the reader’s exercise.
   </p><!-- l. 1013 --><p class='noindent'><!-- l. 1013 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
   </p></dd><dt class='enumerate-enumitem'>
3. </dt><dd class='enumerate-enumitem'><span class='rm-lmbx-10x-x-109'>Coefficient Extraction: </span>At the end of blind rotation, we finally get the following GLWE
   ciphertext:
   <!-- l. 1017 --><p class='noindent'><!-- l. 1017 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖦𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mover accent='true'><mrow><mi>S</mi></mrow><mo accent='true'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>V</mi> </mrow><mrow><mn>8</mn></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
   </p><!-- l. 1019 --><p class='noindent'><!-- l. 1019 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo><msub><mrow> <mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖦𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mover accent='true'><mrow><mi>S</mi></mrow><mo accent='true'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mstyle mathvariant='bold'><mo class='MathClass-open' stretchy='false'>(</mo></mstyle><mi mathvariant='normal'>Δ</mi><mo class='MathClass-bin' stretchy='false'>⋅</mo><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>v</mi></mrow><mrow><mn>4</mn></mrow></msub><mo class='MathClass-bin' stretchy='false'>+</mo><msub><mrow><mi>v</mi></mrow><mrow><mn>5</mn></mrow></msub><mi>X</mi><mo class='MathClass-bin' stretchy='false'>+</mo><msub><mrow><mi>v</mi></mrow><mrow><mn>6</mn></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mn>2</mn></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo><msub><mrow><mi>v</mi></mrow><mrow><mn>7</mn></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mn>3</mn></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo><msub><mrow><mi>v</mi></mrow><mrow><mn>8</mn></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mn>4</mn></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo><msub><mrow><mi>v</mi></mrow><mrow><mn>9</mn></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mn>5</mn></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo><msub><mrow><mi>v</mi></mrow><mrow><mn>10</mn></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mn>6</mn></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo><msub><mrow><mi>v</mi></mrow><mrow><mn>11</mn></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mn>7</mn></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo><msub><mrow><mi>v</mi></mrow><mrow><mn>12</mn></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mn>8</mn></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo><msub><mrow><mi>v</mi></mrow><mrow><mn>13</mn></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mn>9</mn></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo><msub><mrow><mi>v</mi></mrow><mrow><mn>14</mn></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mn>10</mn></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo><msub><mrow><mi>v</mi></mrow><mrow><mn>15</mn></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mn>11</mn></mrow></msup><mo class='MathClass-bin' stretchy='false'>−</mo><msub><mrow><mi>v</mi></mrow><mrow><mn>0</mn></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mn>12</mn></mrow></msup><mo class='MathClass-bin' stretchy='false'>−</mo><msub><mrow><mi>v</mi></mrow><mrow><mn>1</mn></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mn>13</mn></mrow></msup><mo class='MathClass-bin' stretchy='false'>−</mo><msub><mrow><mi>v</mi></mrow><mrow><mn>2</mn></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mn>14</mn></mrow></msup><mo class='MathClass-bin' stretchy='false'>−</mo><msub><mrow><mi>v</mi></mrow><mrow><mn>3</mn></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mn>15</mn></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mstyle mathvariant='bold'><mo class='MathClass-close' stretchy='false'>)</mo></mstyle></mrow></math>
   </p><!-- l. 1021 --><p class='noindent'><!-- l. 1021 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo><msub><mrow> <mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖦𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mover accent='true'><mrow><mi>S</mi></mrow><mo accent='true'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mstyle mathvariant='bold'><mo class='MathClass-open' stretchy='false'>(</mo></mstyle><mi mathvariant='normal'>Δ</mi><mo class='MathClass-bin' stretchy='false'>⋅</mo><mo class='MathClass-open' stretchy='false'>(</mo><mn>1</mn><mo class='MathClass-bin' stretchy='false'>+</mo><mn>1</mn><mi>X</mi><mo class='MathClass-bin' stretchy='false'>+</mo><mn>1</mn><msup><mrow><mi>X</mi></mrow><mrow><mn>2</mn></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo><mn>1</mn><msup><mrow><mi>X</mi></mrow><mrow><mn>3</mn></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo><mn>2</mn><msup><mrow><mi>X</mi></mrow><mrow><mn>4</mn></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo><mn>2</mn><msup><mrow><mi>X</mi></mrow><mrow><mn>5</mn></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo><mn>2</mn><msup><mrow><mi>X</mi></mrow><mrow><mn>6</mn></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo><mn>2</mn><msup><mrow><mi>X</mi></mrow><mrow><mn>7</mn></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo><mn>1</mn><msup><mrow><mi>X</mi></mrow><mrow><mn>8</mn></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo><mn>1</mn><msup><mrow><mi>X</mi></mrow><mrow><mn>9</mn></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo><mn>1</mn><msup><mrow><mi>X</mi></mrow><mrow><mn>10</mn></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo><mn>1</mn><msup><mrow><mi>X</mi></mrow><mrow><mn>11</mn></mrow></msup><mo class='MathClass-bin' stretchy='false'>−</mo><mn>0</mn><msup><mrow><mi>X</mi></mrow><mrow><mn>12</mn></mrow></msup><mo class='MathClass-bin' stretchy='false'>−</mo><mn>0</mn><msup><mrow><mi>X</mi></mrow><mrow><mn>13</mn></mrow></msup><mo class='MathClass-bin' stretchy='false'>−</mo><mn>0</mn><msup><mrow><mi>X</mi></mrow><mrow><mn>14</mn></mrow></msup><mo class='MathClass-bin' stretchy='false'>−</mo><mn>0</mn><msup><mrow><mi>X</mi></mrow><mrow><mn>15</mn></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mstyle mathvariant='bold'><mo class='MathClass-close' stretchy='false'>)</mo></mstyle></mrow></math>
   </p><!-- l. 1023 --><p class='noindent'><!-- l. 1023 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo> <mrow><mo fence='true' form='prefix'>(</mo><mrow><msub><mrow><mi>A</mi></mrow><mrow><mn>0</mn></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo><munderover accent='false' accentunder='false'><mrow> <mi class='MathClass-op'>∑</mi><mo> ⁡<!-- FUNCTION APPLICATION --></mo>
  </mrow><mrow><mi>j</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>0</mn></mrow><mrow><mn>15</mn></mrow></munderover><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>a</mi></mrow><mrow><mn>0</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>0</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>a</mi></mrow><mrow><mn>0</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>1</mn></mrow></msub><mi>X</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>A</mi></mrow><mrow><mn>1</mn></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>A</mi></mrow><mrow><mi>k</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace><mo class='MathClass-punc' stretchy='false'>,</mo><mi>B</mi> <mo class='MathClass-rel' stretchy='false'>=</mo><munderover accent='false' accentunder='false'><mrow><mo> ∑</mo>
  </mrow><mrow><mi>j</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>0</mn></mrow><mrow><mn>15</mn></mrow></munderover><msub><mrow><mi>b</mi></mrow><mrow><mi>j</mi></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mi>j</mi></mrow></msup></mrow><mo fence='true' form='postfix'>)</mo></mrow></mrow></math>
   </p><!-- l. 1025 --><p class='noindent'>Now, we extract the constant term’s coefficient of the encrypted polynomial
   <!-- l. 1025 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖦𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mover accent='true'><mrow><mi>S</mi></mrow><mo accent='true'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mi mathvariant='normal'>Δ</mi> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mo class='MathClass-open' stretchy='false'>(</mo><mn>1</mn> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>1</mn><mi>X</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>1</mn><msup><mrow><mi>X</mi></mrow><mrow><mn>2</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math> by using the
   coefficient extraction formula (Summary <a href='CoefficientExtraction.html#coefficient-extraction'>D-1.7<!-- tex4ht:ref: subsec:tfhe-extraction  --></a>). Specifically, we will extract the constant term’s coefficient, which
   corresponds to <!-- l. 1025 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mover accent='true'><mrow><mi>s</mi></mrow><mo accent='true'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mi mathvariant='normal'>Δ</mi><msub><mrow><mi>m</mi></mrow><mrow><mn>0</mn></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>.
   We extract <!-- l. 1025 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mover accent='true'><mrow><mi>s</mi></mrow><mo accent='true'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mi mathvariant='normal'>Δ</mi><msub><mrow><mi>m</mi></mrow><mrow><mn>0</mn></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
   by computing the following:
   </p><!-- l. 1027 --><p class='noindent'><!-- l. 1027 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mover accent='true'><mrow><mi>s</mi></mrow><mo accent='true'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mi mathvariant='normal'>Δ</mi><msub><mrow><mi>m</mi></mrow><mrow><mn>0</mn></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>(</mo><msubsup><mrow><mi>a</mi></mrow><mrow><mn>0</mn></mrow><mrow><mi>′</mi></mrow></msubsup><mo class='MathClass-punc' stretchy='false'>,</mo><msubsup><mrow><mi>a</mi></mrow><mrow><mn>1</mn></mrow><mrow><mi>′</mi></mrow></msubsup><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><mstyle class='text'><mtext></mtext><mstyle class='math'><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace></mstyle><mtext></mtext></mstyle><mstyle class='text'><mtext> </mtext></mstyle><mo class='MathClass-punc' stretchy='false'>,</mo><msubsup><mrow><mi>a</mi></mrow><mrow><mi>k</mi></mrow><mrow><mi>′</mi></mrow></msubsup><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>b</mi></mrow><mrow><mi>h</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
</p>
   <table class='equation-star'><tr><td>
   <!-- l. 1029 --><math class='equation' display='block' xmlns='http://www.w3.org/1998/Math/MathML'><mrow>
<mstyle class='text'><mtext>, where </mtext></mstyle><msubsup><mrow><mi>a</mi></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>⋅</mo><mi>i</mi><mo class='MathClass-bin' stretchy='false'>+</mo><mi>j</mi></mrow><mrow><mi>′</mi></mrow></msubsup> <mo class='MathClass-rel' stretchy='false'>=</mo> <mrow class='cases'> <mrow><mo fence='true' form='prefix'>{</mo><mrow> <mtable align='axis' class='array' columnlines='none' displaystyle='true' equalcolumns='false' equalrows='false' rowlines='none none none none' style=''> <mtr class='array-row'><mtd class='array-td' columnalign='left'><msub><mrow><mi>a</mi></mrow><mrow><mi>i</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mn>0</mn><mo class='MathClass-bin' stretchy='false'>−</mo><mi>j</mi></mrow></msub><mstyle class='text'><mtext> (if </mtext></mstyle><mn>0</mn> <mo class='MathClass-rel' stretchy='false'>≤</mo><mi>j</mi> <mo class='MathClass-rel' stretchy='false'>≤</mo><mn>0</mn><mstyle class='text'><mtext>)</mtext></mstyle>              <mspace class='quad' width='1em'></mspace></mtd></mtr>  <mtr class='array-row'><mtd class='array-td' columnalign='left'><mspace class='quad' width='1em'></mspace></mtd></mtr>  <mtr class='array-row'><mtd class='array-td' columnalign='left'><mspace class='quad' width='1em'></mspace></mtd>
</mtr>  <mtr class='array-row'><mtd class='array-td' columnalign='left'><msub><mrow><mi>a</mi></mrow><mrow><mi>i</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>n</mi><mo class='MathClass-bin' stretchy='false'>+</mo><mn>0</mn><mo class='MathClass-bin' stretchy='false'>−</mo><mi>j</mi></mrow></msub><mstyle class='text'><mtext> (if </mtext></mstyle><mn>0</mn> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>1</mn> <mo class='MathClass-rel' stretchy='false'>≤</mo><mi>j</mi> <mo class='MathClass-rel' stretchy='false'>≤</mo><mi>n</mi> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn><mstyle class='text'><mtext>)</mtext></mstyle><mspace class='quad' width='1em'></mspace></mtd></mtr>  <mtr class='array-row'><mtd class='array-td' columnalign='left'><mspace class='quad' width='1em'></mspace></mtd></mtr>    <!-- @{}l@{\quad }l@{} --></mtable>                                                                                       </mrow><mo fence='true' form='postfix'></mo></mrow></mrow><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>b</mi></mrow><mrow><mn>0</mn></mrow></msub><mstyle class='text'><mtext> is obtained from the polynomial </mtext></mstyle><mi>B</mi>
</mrow></math></td></tr></table>
   </dd></dl>
   
   <h5 class='subsubsectionHead' id='discussion6'><span class='titlemark'>D-1.8.8   </span> <a id='x103-135000D-1.8.8'></a>Discussion</h5>
   <ul class='itemize1'>
   <li class='itemize'><span class='rm-lmbx-10x-x-109'>Programmable  Bootstrapping</span>:  While  the  bootstrapping  (<a href='#noise-bootstrapping'><span class='ts1-lmr10-x-x-109'>§</span>D-1.8<!-- tex4ht:ref: subsec:coeff-rotation  --></a>)  uses  a  simple  Lookup
   Table <!-- l. 1046 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>V</mi> <mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
   which maps <!-- l. 1046 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi mathvariant='normal'>Δ</mi><mi>m</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>e</mi></mrow></math>
   to <!-- l. 1046 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi mathvariant='normal'>Δ</mi><mi>m</mi></mrow></math>,
                                                                                         
                                                                                         
   we can edit the coefficients of <!-- l. 1046 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>V</mi> <mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
   to make <!-- l. 1046 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi mathvariant='normal'>Δ</mi><mi>m</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>e</mi></mrow></math>
   map to different values. For example, an altered mappings between the inputs and outputs to
   LUT can implement logic gates such as AND, OR, XOR, CMUX, etc, which will be explained in
   <a href='#application-gate-bootstrapping'><span class='ts1-lmr10-x-x-109'>§</span>D-1.8.9<!-- tex4ht:ref: subsec:coeff-rotation  --></a>. Such edited mappings between the exponents and coefficients in <!-- l. 1046 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>V</mi> <mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
   are called programmable bootstrapping. If we encrypt <!-- l. 1046 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>V</mi> <mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
   as a GLWE ciphertext, we can hide the mappings as well as each input instance, which effectively
   implements <span class='rm-lmri-10x-x-109'>functional encryption</span>. Note that both the vanilla bootstrapping (<a href='#noise-bootstrapping'><span class='ts1-lmr10-x-x-109'>§</span>D-1.8<!-- tex4ht:ref: subsec:coeff-rotation  --></a>) and programmable
   bootstrapping (<a href='#application-gate-bootstrapping'><span class='ts1-lmr10-x-x-109'>§</span>D-1.8.9<!-- tex4ht:ref: subsec:coeff-rotation  --></a>) generate the same amount of noise.
   </li>
   <li class='itemize'><span class='rm-lmbx-10x-x-109'>Bootstrapping Noise</span>: During the bootstrapping’s LUT polynomial <!-- l. 1047 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>V</mi> <mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
   rotation, we perform many TFHE multiplications in the homomorphic MUX gates to derive
   <!-- l. 1047 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>V</mi> </mrow><mrow><mn>0</mn></mrow></msub><mo class='MathClass-rel' stretchy='false'>⋯</mo><msub><mrow><mi>V</mi> </mrow><mrow><mi>k</mi></mrow></msub></mrow></math>,
   which inevitably creates additional noises before the the noise gets re-initialized at the end.
   However, a careful parameter choice can limit the growth of this additional noise during modulus
   switch and blind rotation.</li></ul>
   
   <h5 class='subsubsectionHead' id='application-gate-bootstrapping'><span class='titlemark'>D-1.8.9   </span> <a id='x103-136000D-1.8.9'></a>Application: Gate Bootstrapping</h5>
<!-- l. 1054 --><p class='noindent'>Besides implementing the homomorphic MUX logic gate used during blind rotation (<a href='#blind-rotation'><span class='ts1-lmr10-x-x-109'>§</span>D-1.8.4<!-- tex4ht:ref: subsec:coeff-rotation  --></a>), it is possible to leverage
the LUT polynomial <!-- l. 1054 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>V</mi> <mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
to implement other homomorphic logic gates such as AND, NAND, OR, XOR, etc. When implementing
these gates, each ciphertext is an encryption of a single-bit plaintext (or several bits can be bundled up
in a linear combination formula and be processed simultaneously by using LUT). Suppose
<!-- l. 1054 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>q</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>32</mn></mrow></math>,
<!-- l. 1054 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>t</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>8</mn></mrow></math>,
<!-- l. 1054 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>m</mi> <mo class='MathClass-rel' stretchy='false'>∈</mo> <msub><mrow><mi>ℤ</mi></mrow><mrow><mn>8</mn></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>{</mo><mo class='MathClass-bin' stretchy='false'>−</mo><mn>4</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-bin' stretchy='false'>−</mo><mn>3</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-bin' stretchy='false'>−</mo><mn>2</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>0</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>1</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>2</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>3</mn><mo class='MathClass-close' stretchy='false'>}</mo></mrow></math>,
<!-- l. 1054 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi mathvariant='normal'>Δ</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mstyle displaystyle='true'><mfrac><mrow><mi>q</mi>
</mrow><mrow><mi>t</mi></mrow></mfrac></mstyle> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>4</mn></mrow></math>,
<!-- l. 1054 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true'>^</mo></mover> <mo class='MathClass-rel' stretchy='false'>=</mo> <mstyle displaystyle='true'><mfrac><mrow><mi mathvariant='normal'>Δ</mi> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mn>2</mn><mi>n</mi>
  </mrow><mrow><mi>q</mi>   </mrow></mfrac></mstyle> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>2</mn></mrow></math>, and we encode the gate
input into LWE plaintext as <!-- l. 1054 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mn>0</mn> <mo class='MathClass-rel' stretchy='false'>→</mo><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></math>,
and <!-- l. 1054 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mn>1</mn> <mo class='MathClass-rel' stretchy='false'>→</mo><mn>1</mn></mrow></math>, and the maximum
(accumulated) noise <!-- l. 1054 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>e</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>[</mo><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>]</mo></mrow></math>.
</p>
   <div class='table'>
                                                                                         
                                                                                         
<!-- l. 1057 --><p class='indent'>   </p><figure class='float' id='x103-136001r5'><span id='an-example-truth-table-for-an-and-operation-with-an-additional-encoding'></span>
                                                                                         
                                                                                         
<!-- tex4ht:inline --><div class='tabular'> <table class='tabular' id='TBL-39' rules='groups'><colgroup id='TBL-39-1g'><col id='TBL-39-1' /><col id='TBL-39-2' /></colgroup><colgroup id='TBL-39-3g'><col id='TBL-39-3' /><col id='TBL-39-4' /></colgroup><colgroup id='TBL-39-5g'><col id='TBL-39-5' /></colgroup><colgroup id='TBL-39-6g'><col id='TBL-39-6' /></colgroup><colgroup id='TBL-39-7g'><col id='TBL-39-7' /></colgroup><colgroup id='TBL-39-8g'><col id='TBL-39-8' /></colgroup><tr class='hline'><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr id='TBL-39-1-'><td class='td11' colspan='6' id='TBL-39-1-1' style='text-align:center; white-space:nowrap;'></td>                                                                                                                                                                                                                                                                                                                  <div class='multicolumn' style='text-align:center; white-space:nowrap;'>Lookup Table Polynomial <!-- l. 1108 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>V</mi> <mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>1</mn> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>1</mn><mi>X</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>1</mn><msup><mrow><mi>X</mi></mrow><mrow><mn>2</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>1</mn><msup><mrow><mi>X</mi></mrow><mrow><mn>3</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>1</mn><msup><mrow><mi>X</mi></mrow><mrow><mn>4</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>1</mn><msup><mrow><mi>X</mi></mrow><mrow><mn>5</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>1</mn><msup><mrow><mi>X</mi></mrow><mrow><mn>6</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>1</mn><msup><mrow><mi>X</mi></mrow><mrow><mn>7</mn></mrow></msup></mrow></math></div>
</tr><tr class='hline'><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr id='TBL-039-4-'><td class='td11' colspan='2' id='TBL-039-4-1' style='text-align:center; white-space:nowrap;'>                                                                                 <div class='multicolumn' style='text-align:center; white-space:nowrap;'><span class='rm-lmbx-10x-x-109'>Decoded</span></div>                                                                                                              </td><td class='td11' colspan='2' id='TBL-039-4-3' style='text-align:center; white-space:nowrap;'>                                                                                 <div class='multicolumn' style='text-align:center; white-space:nowrap;'><span class='rm-lmbx-10x-x-109'>Encoded</span></div>                                                                                                               </td><td class='td11' id='TBL-039-4-5' style='text-align:center; white-space:nowrap;'> <div class='multicolumn' style='text-align:center; white-space:nowrap;'><!-- tex4ht:inline --><div class='tabular'> <table class='tabular' id='TBL-039' rules='groups'><tr id='TBL-039-1-'><td class='td11' id='TBL-039-1-1' style='text-align:center; white-space:nowrap;'>                                       <span class='rm-lmbx-10x-x-109'>Linear                                                     </span></td></tr><tr id='TBL-0039-4-'><td class='td11' id='TBL-0039-4-1' style='text-align:center; white-space:nowrap;'> <span class='rm-lmbx-10x-x-109'>combination</span></td>
</tr><tr id='TBL-00039-7-'><td class='td11' id='TBL-00039-7-1' style='text-align:center; white-space:nowrap;'>                                    <span class='rm-lmbx-10x-x-109'>of encodings                                                 </span></td></tr></table></div></div> </td><td class='td11' id='TBL-039-4-6' style='text-align:center; white-space:nowrap;'> <div class='multicolumn' style='text-align:center; white-space:nowrap;'><!-- tex4ht:inline --><div class='tabular'> <table class='tabular' id='TBL-039' rules='groups'><tr id='TBL-039-1-'><td class='td11' id='TBL-039-1-1' style='text-align:center; white-space:nowrap;'>                                  <span class='rm-lmbx-10x-x-109'>Scaled Encoded                                               </span></td></tr><tr id='TBL-0039-4-'><td class='td11' id='TBL-0039-4-1' style='text-align:center; white-space:nowrap;'> <span class='rm-lmbx-10x-x-109'>Combination</span></td></tr></table></div></div> </td><td class='td11' id='TBL-039-4-7' style='text-align:center; white-space:nowrap;'>                                             <span class='rm-lmbx-10x-x-109'>Bootstrapping                                                              </span></td><td class='td11' id='TBL-039-4-8' style='text-align:center; white-space:nowrap;'> <!-- tex4ht:inline --><div class='tabular'> <table class='tabular' id='TBL-40'><colgroup id='TBL-40-1g'><col id='TBL-40-1' /></colgroup><tr id='TBL-40-1-'><td class='td11' id='TBL-40-1-1' style='text-align:center; white-space:nowrap;'>                                     <span class='rm-lmbx-10x-x-109'>Decoded                                                   </span></td></tr><tr id='TBL-040-4-'><td class='td11' id='TBL-040-4-1' style='text-align:center; white-space:nowrap;'> <span class='rm-lmbx-10x-x-109'>result</span></td>
</tr></table></div> </td>
</tr><tr class='hline'><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr id='TBL-0039-7-'><td class='td11' id='TBL-0039-7-1' style='text-align:center; white-space:nowrap;'> <!-- l. 1108 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>d</mi></mrow><mrow><mn>1</mn></mrow></msub></math>  </td><td class='td11' id='TBL-0039-7-2' style='text-align:center; white-space:nowrap;'> <!-- l. 1108 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>d</mi></mrow><mrow><mn>2</mn></mrow></msub></math>  </td><td class='td11' id='TBL-0039-7-3' style='text-align:right; white-space:nowrap;'> <!-- l. 1108 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>m</mi></mrow><mrow><mn>1</mn></mrow></msub></math>  </td><td class='td11' id='TBL-0039-7-4' style='text-align:right; white-space:nowrap;'> <!-- l. 1108 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>m</mi></mrow><mrow><mn>2</mn></mrow></msub></math>  </td><td class='td11' id='TBL-0039-7-5' style='text-align:center; white-space:nowrap;'>   <!-- l. 1108 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>m</mi></mrow><mrow><mn>1</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>m</mi></mrow><mrow><mn>2</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></math>     </td><td class='td11' id='TBL-0039-7-6' style='text-align:center; white-space:nowrap;'>   <!-- l. 1108 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true'>^</mo></mover> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>m</mi></mrow><mrow><mn>1</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>m</mi></mrow><mrow><mn>2</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>     </td><td class='td11' id='TBL-0039-7-7' style='text-align:center; white-space:nowrap;'>           <!-- l. 1108 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>V</mi> <mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>X</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true'>^</mo></mover><mo class='MathClass-bin' stretchy='false'>⋅</mo><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>m</mi></mrow><mrow><mn>1</mn></mrow></msub><mo class='MathClass-bin' stretchy='false'>+</mo><msub><mrow><mi>m</mi></mrow><mrow><mn>2</mn></mrow></msub><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-bin' stretchy='false'>+</mo><mi>e</mi></mrow></msup></mrow></math>                   </td><td class='td11' id='TBL-0039-7-8' style='text-align:center; white-space:nowrap;'>   <!-- l. 1108 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>d</mi></mrow><mrow><mn>1</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>∧</mo><msub><mrow><mi>d</mi></mrow><mrow><mn>2</mn></mrow></msub></mrow></math>      </td>
</tr><tr class='hline'><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr id='TBL-00039-10-'><td class='td11' id='TBL-00039-10-1' style='text-align:center; white-space:nowrap;'>                                         0                                                                 </td><td class='td11' id='TBL-00039-10-2' style='text-align:center; white-space:nowrap;'>                                         0                                                                 </td><td class='td11' id='TBL-00039-10-3' style='text-align:right; white-space:nowrap;'> <!-- l. 1108 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></math>  </td><td class='td11' id='TBL-00039-10-4' style='text-align:right; white-space:nowrap;'> <!-- l. 1108 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></math>  </td><td class='td11' id='TBL-00039-10-5' style='text-align:center; white-space:nowrap;'>   <!-- l. 1108 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mn>3</mn></mrow></math>     </td><td class='td11' id='TBL-00039-10-6' style='text-align:center; white-space:nowrap;'>   <!-- l. 1108 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mn>6</mn></mrow></math>     </td><td class='td11' id='TBL-00039-10-7' style='text-align:center; white-space:nowrap;'> constant term’s coeff. is <!-- l. 1108 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></math>  </td><td class='td11' id='TBL-00039-10-8' style='text-align:center; white-space:nowrap;'>                                           0                                                                    </td>
</tr><tr id='TBL-000039-13-'><td class='td11' id='TBL-000039-13-1' style='text-align:center; white-space:nowrap;'>                                         0                                                                 </td><td class='td11' id='TBL-000039-13-2' style='text-align:center; white-space:nowrap;'>                                         1                                                                 </td><td class='td11' id='TBL-000039-13-3' style='text-align:right; white-space:nowrap;'> <!-- l. 1108 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></math>  </td><td class='td11' id='TBL-000039-13-4' style='text-align:right; white-space:nowrap;'> <!-- l. 1108 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mn>1</mn></math>  </td><td class='td11' id='TBL-000039-13-5' style='text-align:center; white-space:nowrap;'>   <!-- l. 1108 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></math>     </td><td class='td11' id='TBL-000039-13-6' style='text-align:center; white-space:nowrap;'>   <!-- l. 1108 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mn>2</mn></mrow></math>     </td><td class='td11' id='TBL-000039-13-7' style='text-align:center; white-space:nowrap;'> constant term’s coeff. is <!-- l. 1108 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></math>  </td><td class='td11' id='TBL-000039-13-8' style='text-align:center; white-space:nowrap;'>                                           0                                                                    </td>
</tr><tr id='TBL-0000039-16-'><td class='td11' id='TBL-0000039-16-1' style='text-align:center; white-space:nowrap;'>                                         1                                                                 </td><td class='td11' id='TBL-0000039-16-2' style='text-align:center; white-space:nowrap;'>                                         0                                                                 </td><td class='td11' id='TBL-0000039-16-3' style='text-align:right; white-space:nowrap;'> <!-- l. 1108 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mn>1</mn></math>  </td><td class='td11' id='TBL-0000039-16-4' style='text-align:right; white-space:nowrap;'> <!-- l. 1108 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></math>  </td><td class='td11' id='TBL-0000039-16-5' style='text-align:center; white-space:nowrap;'>   <!-- l. 1108 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></math>     </td><td class='td11' id='TBL-0000039-16-6' style='text-align:center; white-space:nowrap;'>   <!-- l. 1108 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mn>2</mn></mrow></math>     </td><td class='td11' id='TBL-0000039-16-7' style='text-align:center; white-space:nowrap;'> constant term’s coeff. is <!-- l. 1108 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></math>  </td><td class='td11' id='TBL-0000039-16-8' style='text-align:center; white-space:nowrap;'>                                           0                                                                    </td>
</tr><tr id='TBL-00000039-19-'><td class='td11' id='TBL-00000039-19-1' style='text-align:center; white-space:nowrap;'>                                         1                                                                 </td><td class='td11' id='TBL-00000039-19-2' style='text-align:center; white-space:nowrap;'>                                         1                                                                 </td><td class='td11' id='TBL-00000039-19-3' style='text-align:right; white-space:nowrap;'> <!-- l. 1108 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mn>1</mn></math>  </td><td class='td11' id='TBL-00000039-19-4' style='text-align:right; white-space:nowrap;'> <!-- l. 1108 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mn>1</mn></math>  </td><td class='td11' id='TBL-00000039-19-5' style='text-align:center; white-space:nowrap;'>   <!-- l. 1108 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mn>1</mn></math>     </td><td class='td11' id='TBL-00000039-19-6' style='text-align:center; white-space:nowrap;'>   <!-- l. 1108 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mn>2</mn></math>     </td><td class='td11' id='TBL-00000039-19-7' style='text-align:center; white-space:nowrap;'> constant term’s coeff. is <!-- l. 1108 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mn>1</mn></math>  </td><td class='td11' id='TBL-00000039-19-8' style='text-align:center; white-space:nowrap;'>                                           1                                                                    </td>
</tr><tr class='hline'><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr></table>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      </div>

<figcaption class='caption'><span class='id'>Table 5: </span><span class='content'>An example truth table for an AND operation with an additional encoding.            </span></figcaption><!-- tex4ht:label?: x103-136001r5  -->
                                                                                         
                                                                                         
   </figure>
   </div>
<!-- l. 1122 --><p class='indent'>   <a href='#an-example-truth-table-for-an-and-operation-with-an-additional-encoding'>Table 5<!-- tex4ht:ref: subsec:coeff-rotation  --></a> is a programmable bootstrapping design for an AND logic gate. For this application, we define the LUT
polynomial <!-- l. 1122 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>V</mi> </mrow></math> as
<!-- l. 1122 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>V</mi> <mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo><munderover accent='false' accentunder='false'><mrow> <mi class='MathClass-op'>∑</mi><mo> ⁡<!-- FUNCTION APPLICATION --></mo>
  </mrow><mrow><mi>i</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>0</mn></mrow><mrow><mn>7</mn></mrow></munderover> <mo class='MathClass-bin' stretchy='false'>−</mo><msup><mrow><mi>X</mi></mrow><mrow><mi>i</mi></mrow></msup></mrow></math>. The LUT polynomial
<!-- l. 1122 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>V</mi> <mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math> maps one half of the plaintext
domain to <!-- l. 1122 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></math>, while the other
half to <!-- l. 1122 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></math> (as the terms wrap
around the boundary of <!-- l. 1122 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>n</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>7</mn></mrow></math>).
In this design setup, each bit is separately encrypted as independent TFHE ciphertext. Gate input 0 and 1 are
encoded as <!-- l. 1122 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></math>
and <!-- l. 1122 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mn>1</mn></math>,
respectively. The linear combination (i.e., homomorphic computation formula) for an AND gate is
<!-- l. 1122 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mover accent='true'><mrow><mi>s</mi></mrow><mo accent='true'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mi mathvariant='normal'>Δ</mi><msub><mrow><mi>m</mi></mrow><mrow><mn>1</mn></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>+</mo><msub><mrow> <mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mover accent='true'><mrow><mi>s</mi></mrow><mo accent='true'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mi mathvariant='normal'>Δ</mi><msub><mrow><mi>m</mi></mrow><mrow><mn>2</mn></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></math>. Its output is positive if both
inputs are positive (i.e. <!-- l. 1122 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mn>1</mn></math>, in which
case the blind rotation will rotate <!-- l. 1122 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>V</mi> </mrow></math>
to the left by <!-- l. 1122 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true'>^</mo></mover> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mn>1</mn> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>e</mi></mrow></math> positions and the
constant term’s coefficient will be <!-- l. 1122 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mn>1</mn></math>.
Thus, the output of blind rotation and coefficient extraction will be
<!-- l. 1122 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mover accent='true'><mrow><mi>s</mi></mrow><mo accent='true'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mi mathvariant='normal'>Δ</mi> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math> with a reduced noise, which is an
encoding of <!-- l. 1122 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mn>1</mn></math>. This design can tolerate
the maximum noise of <!-- l. 1122 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-rel' stretchy='false'>|</mo><mi>e</mi><mo class='MathClass-rel' stretchy='false'>|</mo><mo class='MathClass-rel' stretchy='false'>=</mo> <mn>1</mn></mrow></math>. To endure
bigger noises, we should increase <!-- l. 1122 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>q</mi></math>
and <!-- l. 1122 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>n</mi></math>.
</p><!-- l. 1124 --><p class='indent'>   Note that the AND gate’s LUT layout is negacyclic, which is a special case, thus we could use the entire
<!-- l. 1124 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mn>2</mn><mi>n</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>16</mn></mrow></math> coefficient
states in <!-- l. 1124 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>V</mi> <mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
for the AND gate mapping function’s outputs, by leveraging
<!-- l. 1124 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>V</mi> <mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>’s innate
property of negacyclic rotation. However, in many use cases, the LUT layout is not necessarily negacyclic
like this AND gate example. Even our noise bootstrapping’s LUT layout (<a href='#overview3'><span class='ts1-lmr10-x-x-109'>§</span>D-1.8.1<!-- tex4ht:ref: subsec:coeff-rotation  --></a>) was not negacyclic,
but a unity function (as it simply removes the noise). Thus, for most use cases, we need to use only
<!-- l. 1124 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mstyle displaystyle='true'><mfrac><mrow> <mi>t</mi>
</mrow><mrow><mn>2</mn></mrow></mfrac></mstyle></math> out of
<!-- l. 1124 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>t</mi></math> plaintext space to
avoid more than <!-- l. 1124 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>n</mi> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></math>
rotations of <!-- l. 1124 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>V</mi> <mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
(<a href='#halving-the-plaintext-space-to-be-used'><span class='ts1-lmr10-x-x-109'>§</span>D-1.8.3<!-- tex4ht:ref: subsec:coeff-rotation  --></a>).
</p><!-- l. 1126 --><p class='indent'>   Besides the AND gate, other logic gates can be built in a similar manner, each of which based on a
different linear combination formula and LUT layout.
</p><!-- l. 1128 --><p class='noindent'><span class='rm-lmbx-10x-x-109'>Division: </span>TFHE does not support direct division of plaintext numbers
of any size. This is because TFHE’s LWE vector elements are in the
<!-- l. 1128 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>Z</mi></mrow><mrow><mi>q</mi></mrow></msub></math> ring, where each element
<!-- l. 1128 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>g</mi></math> does not necessarily have a
multiplicative inverse <!-- l. 1128 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>g</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msup></math>, which
makes it hard to multiply <!-- l. 1128 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>g</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msup></math>
                                                                                         
                                                                                         
to the target number to divide. Instead, division can be implemented as binary division based on the gates
implemented by gate bootstrapping. To support binary division, each plaintext has to be a single bit and
encrypted as an independent ciphertext. Or multiple bits can be bundled up and processed concurrently
by designing a linear combination formula, similar to the linear combination that we designed for
processing 2 input bits of an AND gate.
   
</p>
   <h5 class='subsubsectionHead' id='application-neural-networks-bootstrapping'><span class='titlemark'>D-1.8.10   </span> <a id='x103-137000D-1.8.10'></a>Application: Neural Networks Bootstrapping</h5>
   <figure class='figure'> 

                                                                                         
                                                                                         
                                                                                         
                                                                                         
<!-- l. 1135 --><p class='noindent' id='an-illustration-of-neural-networks-'> <img alt='PIC' src='figures/neural-network-.png' /> <a id='x103-137001r13'></a></p>
<figcaption class='caption'><span class='id'>Figure 13: </span><span class='content'>An illustration of neural networks                                                </span></figcaption><!-- tex4ht:label?: x103-137001r13  -->
                                                                                         
                                                                                         
   </figure>
   <figure class='figure'> 

                                                                                         
                                                                                         
                                                                                         
                                                                                         
<!-- l. 1142 --><p class='noindent' id='an-illustration-of-neural-networkss-programmable-bootstrapping'> <img alt='PIC' src='figures/nn-homomorphic-.png' /> <a id='x103-137002r14'></a></p>
<figcaption class='caption'><span class='id'>Figure 14: </span><span class='content'>An illustration of neural networks’s programmable bootstrapping                    </span></figcaption><!-- tex4ht:label?: x103-137002r14  -->
                                                                                         
                                                                                         
   </figure>
<!-- l. 1147 --><p class='indent'>   Homomorphic encryption can be applied to the neurons of deep neural networks, in which each neuron
is generally comprised of two steps of computation:
   </p><dl class='enumerate-enumitem'><dt class='enumerate-enumitem'>
1. </dt><dd class='enumerate-enumitem'><span class='rm-lmbx-10x-x-109'>Linear Combination of Input Values: </span>An input feature value (or intermediate value) set
   <!-- l. 1150 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>x</mi></mrow><mrow><mn>1</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>x</mi></mrow><mrow><mn>2</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><mstyle class='text'><mtext></mtext><mstyle class='math'><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace></mstyle><mtext></mtext></mstyle><mstyle class='text'><mtext> </mtext></mstyle><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>x</mi></mrow><mrow><mi>n</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>,
   a weight set <!-- l. 1150 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>w</mi></mrow><mrow><mn>1</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>w</mi></mrow><mrow><mn>2</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><mstyle class='text'><mtext></mtext><mstyle class='math'><mo class='MathClass-rel' stretchy='false'>⋯</mo><mi>x</mi></mstyle><mtext></mtext></mstyle><mstyle class='text'><mtext> </mtext></mstyle><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>w</mi></mrow><mrow><mi>n</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>,
   and a bias <!-- l. 1150 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>b</mi></math>
   are computed as: <!-- l. 1150 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>y</mi> <mo class='MathClass-rel' stretchy='false'>=</mo><munderover accent='false' accentunder='false'><mrow> <mi class='MathClass-op'>∑</mi><mo> ⁡<!-- FUNCTION APPLICATION --></mo>
  </mrow><mrow><mi>i</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>1</mn></mrow><mrow><mi>n</mi></mrow></munderover><msub><mrow><mi>a</mi></mrow><mrow><mn>0</mn></mrow></msub><msub><mrow><mi>w</mi></mrow><mrow><mn>0</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>b</mi></mrow></math>.
   </dd><dt class='enumerate-enumitem'>
2. </dt><dd class='enumerate-enumitem'><span class='rm-lmbx-10x-x-109'>Activation Function: </span><!-- l. 1151 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>f</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>y</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
   is computed, where <!-- l. 1151 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>f</mi></math>
   is a non-linear activation function such as the <!-- l. 1151 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi class='loglike'>sin</mi><mo>⁡<!-- FUNCTION APPLICATION --></mo><!-- nolimits --></mrow></math>
   function, ReLU, sigmoid, hyperbolic tangent, etc.</dd></dl>
<!-- l. 1154 --><p class='indent'>   TFHE can homomorphically compute the 1st step’s linear combination formula:
<!-- l. 1154 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>y</mi> <mo class='MathClass-rel' stretchy='false'>=</mo><munderover accent='false' accentunder='false'><mrow> <mi class='MathClass-op'>∑</mi><mo> ⁡<!-- FUNCTION APPLICATION --></mo>
  </mrow><mrow><mi>i</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>1</mn></mrow><mrow><mi>n</mi></mrow></munderover><msub><mrow><mi>a</mi></mrow><mrow><mn>0</mn></mrow></msub><msub><mrow><mi>w</mi></mrow><mrow><mn>0</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>b</mi></mrow></math> as
<!-- l. 1154 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><munderover accent='false' accentunder='false'><mrow><mi class='MathClass-op'>∑</mi><mo> ⁡<!-- FUNCTION APPLICATION --></mo>
  </mrow><mrow><mi>i</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>1</mn></mrow><mrow><mi>n</mi></mrow></munderover><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mover accent='true'><mrow><mi>s</mi></mrow><mo accent='true'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>a</mi></mrow><mrow><mn>0</mn></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msub><mrow><mi>w</mi></mrow><mrow><mn>0</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>b</mi></mrow></math>, which
can be implemented as ciphertext addition (<a href='GLWECiphertexttoCiphertextAddition.html#glwe-ciphertexttociphertext-addition'><span class='ts1-lmr10-x-x-109'>§</span>C-1<!-- tex4ht:ref: subsec:coeff-rotation  --></a>) and ciphertext-to-plaintext multiplication
(<a href='GLWECiphertexttoPlaintextMultiplication.html#glwe-ciphertexttoplaintext-multiplication'><span class='ts1-lmr10-x-x-109'>§</span>C-3<!-- tex4ht:ref: subsec:coeff-rotation  --></a>).
</p><!-- l. 1156 --><p class='indent'>   However, the 2nd step’s non-linear functions cannot be expressed as addition and multiplication of
ciphertexts. To address this issue, the activation function can be evaluated as a programmable
bootstrapping, such that the output of the bootstrapping matches or (or is similar) to the output of the
activation function. If we use bootstrapping at the 2nd step, noises can be refreshed at the end of every
neuron, thus we can potentially handle neural networks of any depth without worrying about the noise
growth.
                                                                                         
                                                                                         
</p>
   <!-- l. 1160 --><div class='crosslinks'><p class='noindent'>[<a href='TFHEonaDiscreteTorus.html'>next</a>] [<a href='CoefficientExtraction.html'>prev</a>] [<a href='CoefficientExtraction.html#tailCoefficientExtraction.html'>prev-tail</a>] [<a href='NoiseBootstrapping.html'>front</a>] [<a href='TFHEScheme.html#NoiseBootstrapping.html'>up</a>] </p></div>
<!-- l. 1160 --><p class='indent'>   <a id='tailNoiseBootstrapping.html'></a>  </p> 
</body> 
</html>