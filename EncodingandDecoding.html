<!DOCTYPE html> 
<html lang='en-US' xml:lang='en-US'> 
<head><title>Encoding and Decoding</title> 
<meta charset='utf-8' /> 
<meta content='TeX4ht (https://tug.org/tex4ht/)' name='generator' /> 
<meta content='width=device-width,initial-scale=1' name='viewport' /> 
<link href='index.css' rel='stylesheet' type='text/css' /> 
<meta content='index.tex' name='src' /> 
 <script async='async' id='MathJax-script' src='https://cdn.jsdelivr.net/npm/mathjax@3/es5/mml-chtml.js' type='text/javascript'></script>  
</head><body>
   <!-- l. 70 --><div class='crosslinks'><p class='noindent'>[<a href='EncryptionandDecryption2.html'>next</a>] [<a href='#tailEncodingandDecoding.html'>tail</a>] [<a href='CKKSScheme.html#EncodingandDecoding.html'>up</a>] </p></div>
   <h4 class='subsectionHead' id='encoding-and-decoding'><span class='titlemark'>D-3.1   </span> <a id='x118-174000D-3.1'></a>Encoding and Decoding</h4>
<!-- l. 74 --><p class='noindent'>CKKS’s encoding and decoding is fundamentally very similar to BFV’s batch encoding scheme.
BFV designs its batch encoding scheme (Summary <a href='EncryptionandDecryption1.html#encryption-and-decryption1'>D-2.3<!-- tex4ht:ref: subsec:bfv-enc-dec  --></a> in <a href='EncryptionandDecryption1.html#encryption-and-decryption1'><span class='ts1-lmr10-x-x-109'>§</span>D-2.3<!-- tex4ht:ref: subsec:bfv-enc-dec  --></a>) based on the updated
<!-- l. 74 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mover accent='true'><mrow><mi>Ŵ</mi></mrow><mo accent='true'>^</mo></mover></math> and
<!-- l. 74 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mover accent='true'><mrow><mi>Ŵ</mi></mrow><mo accent='true'>^</mo></mover></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msup></math> matrices
(Summary <a href='HomomorphicRotationofInputVectorSlots.html#summary2'>D-2.9.3<!-- tex4ht:ref: subsubsec:bfv-rotation-summary  --></a> in <a href='HomomorphicRotationofInputVectorSlots.html#homomorphic-rotation-of-input-vector-slots'><span class='ts1-lmr10-x-x-109'>§</span>D-2.9<!-- tex4ht:ref: subsubsec:bfv-rotation-summary  --></a>). That is, BFV decodes a polynomial into an input slot vector by evaluating the polynomial
at each root of <!-- l. 74 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>X</mi></mrow><mrow><mi>n</mi></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>1</mn></mrow></math>, which
is the primitive <!-- l. 74 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><mi>μ</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>2</mn><mi>n</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>-th
root of unity (i.e., <!-- l. 74 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mover accent='true'><mrow><mi>v</mi></mrow><mo accent='true'>→</mo></mover> <mo class='MathClass-rel' stretchy='false'>=</mo><msup><mrow> <mover accent='true'><mrow><mi>Ŵ</mi></mrow><mo accent='true'>^</mo></mover></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msup><mo class='MathClass-bin' stretchy='false'>⋅</mo><mover accent='true'><mrow><mi>m</mi></mrow><mo accent='true'>→</mo></mover></mrow></math>),
and encodes an input slot vector into a polynomial by inversing this operation (i.e.,
                                                                                         
                                                                                         
<!-- l. 74 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mover accent='true'><mrow><mi>m</mi></mrow><mo accent='true'>→</mo></mover> <mo class='MathClass-rel' stretchy='false'>=</mo> <msup><mrow><mi>n</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mover accent='true'><mrow><mi>Ŵ</mi></mrow><mo accent='true'>^</mo></mover> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msubsup><mrow><mi>I</mi></mrow><mrow><mi>n</mi></mrow><mrow><mi>R</mi></mrow></msubsup> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mover accent='true'><mrow><mi>v</mi></mrow><mo accent='true'>→</mo></mover></mrow></math>). This encoding
and decoding scheme is designed based on Summary <a href='IsomorphismbetweenPolynomialsandVectorsoverComplexNumbers.html#isomorphism-between-polynomials-and-vectors-over-complex-numbers'>A-10.7<!-- tex4ht:ref: subsec:poly-vector-transformation-complex  --></a> (<a href='IsomorphismbetweenPolynomialsandVectorsoverComplexNumbers.html#isomorphism-between-polynomials-and-vectors-over-complex-numbers'><span class='ts1-lmr10-x-x-109'>§</span>A-10.7<!-- tex4ht:ref: subsec:poly-vector-transformation-complex  --></a>) which designs the isomorphic mapping between
<!-- l. 74 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>n</mi></math>-dimensional vectors of integer
ring (finite field) and <!-- l. 74 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><mi>n</mi> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>-degree
(or lesser degree) polynomials as follows:
</p><!-- l. 76 --><p class='indent'>   <!-- l. 76 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>σ</mi> <mo class='MathClass-punc' stretchy='false'>:</mo> <mi>f</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>x</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>∈</mo> <msub><mrow><mi>ℤ</mi></mrow><mrow><mi>t</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>[</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>]</mo><mo class='MathClass-bin' stretchy='false'>∕</mo><mi>F</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo><mstyle class='text'><mtext> </mtext></mstyle><mo class='MathClass-rel' stretchy='false'>→</mo><mstyle class='text'><mtext> </mtext></mstyle><mo class='MathClass-open' stretchy='false'>(</mo><mi>f</mi><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mn>1</mn></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-punc' stretchy='false'>,</mo><mi>f</mi><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mn>3</mn></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace><mo class='MathClass-punc' stretchy='false'>,</mo><mi>f</mi><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>∈</mo> <msubsup><mrow><mi>ℤ</mi></mrow><mrow><mi>t</mi></mrow><mrow><mi>n</mi></mrow></msubsup></mrow></math>
</p><!-- l. 78 --><p class='indent'>   , where <!-- l. 78 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>ω</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <msup><mrow><mi>g</mi></mrow><mrow><mfrac><mrow><mi>t</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow>
 <mrow><mn>2</mn><mi>n</mi></mrow></mfrac> </mrow></msup></mrow></math> is a root of
(i.e., primitive <!-- l. 78 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><mi>μ</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>2</mn><mi>n</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>-th root of
unity) of the <!-- l. 78 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><mi>μ</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>2</mn><mi>n</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>-th cyclotomic
polynomial <!-- l. 78 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>X</mi></mrow><mrow><mi>n</mi></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>1</mn></mrow></math> defined
over a prime modulo <!-- l. 78 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>t</mi></math>
ring.
</p><!-- l. 80 --><p class='indent'>   <!-- l. 80 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 82 --><p class='indent'>   CKKS’s batch encoding scheme uses exactly the same formula for encoding and decoding (i.e.,
<!-- l. 82 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mover accent='true'><mrow><mi>v</mi></mrow><mo accent='true'>→</mo></mover> <mo class='MathClass-rel' stretchy='false'>=</mo> <msup><mrow><mi>W</mi></mrow><mrow><mi>T</mi> </mrow></msup> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mover accent='true'><mrow><mi>m</mi></mrow><mo accent='true'>→</mo></mover></mrow></math> and
<!-- l. 82 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mover accent='true'><mrow><mi>m</mi></mrow><mo accent='true'>→</mo></mover> <mo class='MathClass-rel' stretchy='false'>=</mo> <mstyle displaystyle='true'><mfrac><mrow><mi>W</mi> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msubsup><mrow><mi>I</mi></mrow><mrow><mi>n</mi></mrow><mrow><mi>R</mi></mrow></msubsup> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mover accent='true'><mrow><mi>v</mi></mrow><mo accent='true'>→</mo></mover>
      </mrow><mrow><mi>n</mi>      </mrow></mfrac></mstyle></mrow></math>), but the
<!-- l. 82 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>n</mi></math>-dimensional input slot vector
comprises not in an integer ring (i.e., <!-- l. 82 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msubsup><mrow><mi>ℤ</mi></mrow><mrow><mi>p</mi></mrow><mrow><mi>n</mi></mrow></msubsup></math>),
but complex numbers (i.e., <!-- l. 82 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>Ĉ</mi></mrow><mrow><mi>n</mi></mrow></msup></math>).
In Summary <a href='IsomorphismbetweenPolynomialsandVectorsoverComplexNumbers.html#isomorphism-between-polynomials-and-vectors-over-complex-numbers'>A-10.7<!-- tex4ht:ref: subsec:poly-vector-transformation-complex  --></a> (<a href='IsomorphismbetweenPolynomialsandVectorsoverComplexNumbers.html#isomorphism-between-polynomials-and-vectors-over-complex-numbers'><span class='ts1-lmr10-x-x-109'>§</span>A-10.7<!-- tex4ht:ref: subsec:poly-vector-transformation-complex  --></a>), we also designed the mapping
<!-- l. 82 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>σ</mi></mrow><mrow><mi>c</mi></mrow></msub></math>
between polynomials and vectors over complex numbers as follows:
</p><!-- l. 84 --><p class='indent'>   <!-- l. 84 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>σ</mi></mrow><mrow><mi>c</mi></mrow></msub> <mo class='MathClass-punc' stretchy='false'>:</mo> <mi>f</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>∈</mo> <mi>ℝ</mi><mo class='MathClass-open' stretchy='false'>[</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>]</mo><mo class='MathClass-bin' stretchy='false'>∕</mo><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>X</mi></mrow><mrow><mi>n</mi></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-rel' stretchy='false'>→</mo><mo class='MathClass-open' stretchy='false'>(</mo><mi>f</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>ω</mi><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-punc' stretchy='false'>,</mo><mi>f</mi><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mn>3</mn></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-punc' stretchy='false'>,</mo><mi>f</mi><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mn>5</mn></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace><mo class='MathClass-punc' stretchy='false'>,</mo><mi>f</mi><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mn>2</mn><mi>n</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>∈</mo><msup><mrow><mi>Ĉ</mi></mrow><mrow><mi>n</mi></mrow></msup><mstyle class='text'><mtext> </mtext></mstyle><mo class='MathClass-open' stretchy='false'>(</mo><mo class='MathClass-rel' stretchy='false'>→</mo><msup><mrow><mi>ℂ</mi></mrow><mrow><mfrac><mrow><mi>n</mi></mrow>
<mrow><mn>2</mn></mrow></mfrac> </mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
</p><!-- l. 87 --><p class='indent'>   , where <!-- l. 87 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>ω</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <msup><mrow><mi>e</mi></mrow><mrow><mi mathvariant='italic'>𝑖𝜋</mi><mo class='MathClass-bin' stretchy='false'>∕</mo><mi>n</mi></mrow></msup></mrow></math> is a root (i.e.,
the primitive <!-- l. 87 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><mi>μ</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>2</mn><mi>n</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>-th root)
of the <!-- l. 87 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><mi>μ</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>2</mn><mi>n</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>-th cyclotomic
polynomial <!-- l. 87 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>X</mi></mrow><mrow><mi>n</mi></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>1</mn></mrow></math> defined over
complex numbers, and <!-- l. 87 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>Ĉ</mi></mrow><mrow><mi>n</mi></mrow></msup></math>
is <!-- l. 87 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>n</mi></math>-dimensional
complex special vector space whose second-half elements are reverse-ordered conjugates of the first-half elements.
And <!-- l. 87 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>Ĉ</mi></mrow><mrow><mi>n</mi></mrow></msup></math> is isomorphic
to <!-- l. 87 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>ℂ</mi></mrow><mrow><mfrac><mrow><mi>n</mi></mrow>
<mrow><mn>2</mn></mrow></mfrac> </mrow></msup></math>, because the
second-half elements of <!-- l. 87 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>Ĉ</mi></mrow><mrow><mi>n</mi></mrow></msup></math>
are automatically determined by its first-half elements. Therefore, the
<!-- l. 87 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>σ</mi></mrow><mrow><mi>c</mi></mrow></msub></math> mapping is essentially an
isomorphism between <!-- l. 87 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mstyle displaystyle='true'><mfrac><mrow><mi>n</mi>
</mrow><mrow><mn>2</mn></mrow></mfrac></mstyle></math>-dimensional
complex vectors <!-- l. 87 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mover accent='true'><mrow><mi>v</mi></mrow><mo accent='true'>→</mo></mover> <mo class='MathClass-rel' stretchy='false'>∈</mo> <msup><mrow><mi>ℂ</mi></mrow><mrow><mfrac><mrow><mi>n</mi></mrow>
<mrow><mn>2</mn></mrow></mfrac> </mrow></msup></mrow></math> and
<!-- l. 87 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><mi>n</mi> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>-degree (or lesser degree)
real-number polynomials <!-- l. 87 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>ℝ</mi><mo class='MathClass-open' stretchy='false'>[</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>]</mo><mo class='MathClass-bin' stretchy='false'>∕</mo><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>X</mi></mrow><mrow><mi>n</mi></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>.
Therefore, CKKS’ batch encoding scheme encodes an
<!-- l. 87 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mstyle displaystyle='true'><mfrac><mrow><mi>n</mi>
</mrow><mrow><mn>2</mn></mrow></mfrac></mstyle></math>-dimensional complex input
slot vector into an <!-- l. 87 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><mi>n</mi> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>-degree
(or lesser degree) real-number polynomial, and the decoding process is a reverse of this.
</p><!-- l. 89 --><p class='indent'>   In addition, remember that in BFV, we updated
                                                                                         
                                                                                         
<!-- l. 89 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>W</mi></math> and
<!-- l. 89 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>W</mi></mrow><mrow><mi>T</mi> </mrow></msup></math> to
<!-- l. 89 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mover accent='true'><mrow><mi>Ŵ</mi></mrow><mo accent='true'>^</mo></mover></math> and
<!-- l. 89 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mover accent='true'><mrow><mi>Ŵ</mi></mrow><mo accent='true'>^</mo></mover></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msup></math> (Summary <a href='HomomorphicRotationofInputVectorSlots.html#summary2'>D-2.9.3<!-- tex4ht:ref: subsubsec:bfv-rotation-summary  --></a>
in <a href='HomomorphicRotationofInputVectorSlots.html#summary2'><span class='ts1-lmr10-x-x-109'>§</span>D-2.9.3<!-- tex4ht:ref: subsubsec:bfv-rotation-summary  --></a>) to support homomorphic rotation of input vector slots. Likewise, the CKKS batch encoding scheme
uses <!-- l. 89 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mover accent='true'><mrow><mi>Ŵ</mi></mrow><mo accent='true'>^</mo></mover></math> and
<!-- l. 89 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mover accent='true'><mrow><mi>Ŵ</mi></mrow><mo accent='true'>^</mo></mover></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msup></math> instead
of <!-- l. 89 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>W</mi></math> and
<!-- l. 89 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>W</mi></mrow><mrow><mi>T</mi> </mrow></msup></math> in
order to support homomorphic rotation. Therefore, the CKKS batch encoding scheme’s isomorphic
mapping is updated as follows:
</p><!-- l. 92 --><p class='indent'>   <!-- l. 92 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>σ</mi></mrow><mrow><mi>c</mi></mrow></msub> <mo class='MathClass-punc' stretchy='false'>:</mo> <mi>f</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>∈</mo> <mi>ℝ</mi><mo class='MathClass-open' stretchy='false'>[</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>]</mo><mo class='MathClass-bin' stretchy='false'>∕</mo><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>X</mi></mrow><mrow><mi>n</mi></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-rel' stretchy='false'>→</mo><mstyle mathvariant='bold'><mo class='MathClass-open' stretchy='false'>(</mo></mstyle><mi>f</mi><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mn>0</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-punc' stretchy='false'>,</mo><mi>f</mi><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-punc' stretchy='false'>,</mo><mi>f</mi><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace><mo class='MathClass-punc' stretchy='false'>,</mo><mi>f</mi><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mfrac><mrow><mi>n</mi></mrow>
<mrow><mn>2</mn></mrow></mfrac> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-punc' stretchy='false'>,</mo></mrow></math>
</p><!-- l. 94 --><p class='indent'>   <span id='textcolor124'><!-- l. 94 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>f</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>∈</mo> <mi>ℝ</mi><mo class='MathClass-open' stretchy='false'>[</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>]</mo><mo class='MathClass-bin' stretchy='false'>∕</mo><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>X</mi></mrow><mrow><mi>n</mi></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-rel' stretchy='false'>→</mo><mstyle mathvariant='bold'><mo class='MathClass-open' stretchy='false'>(</mo></mstyle></mrow></math></span>
<!-- l. 94 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace><mo class='MathClass-punc' stretchy='false'>,</mo><mi>f</mi><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><msub><mrow><mi>J</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mn>0</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-punc' stretchy='false'>,</mo><mi>f</mi><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><msub><mrow><mi>J</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-punc' stretchy='false'>,</mo><mi>f</mi><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><msub><mrow><mi>J</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace><mo class='MathClass-punc' stretchy='false'>,</mo><mi>f</mi><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><msub><mrow><mi>J</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mfrac><mrow><mi>n</mi></mrow>
<mrow><mn>2</mn></mrow></mfrac> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mstyle mathvariant='bold'><mo class='MathClass-close' stretchy='false'>)</mo></mstyle> <mo class='MathClass-rel' stretchy='false'>∈</mo><msup><mrow><mi>Ĉ</mi></mrow><mrow><mi>n</mi></mrow></msup><mstyle class='text'><mtext> </mtext></mstyle><mo class='MathClass-open' stretchy='false'>(</mo><mo class='MathClass-rel' stretchy='false'>→</mo><msup><mrow><mi>ℂ</mi></mrow><mrow><mfrac><mrow><mi>n</mi></mrow>
<mrow><mn>2</mn></mrow></mfrac> </mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
</p><!-- l. 96 --><p class='indent'>   , where <!-- l. 96 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>h</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo> <msup><mrow><mn>5</mn></mrow><mrow><mi>h</mi></mrow></msup><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mn>2</mn><mi>n</mi></mrow></math>,
a rotation helper formula.
</p><!-- l. 99 --><p class='indent'>   <!-- l. 99 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 101 --><p class='indent'>   The encoding schemes of BFV and CKKS have the following differences:
</p>
   <ul class='itemize1'>
   <li class='itemize'><span class='rm-lmbx-10x-x-109'>Type of Input Slot Values: </span>BFV’s input slot values are <!-- l. 104 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>n</mi></math>-dimensional
   integer modulo <!-- l. 104 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>t</mi></math>,
   which are encoded into <!-- l. 104 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>n</mi></math>-dimensional
   polynomial coefficients (i.e., modulo-<!-- l. 104 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>t</mi></math>
   integers). On the other hand, CKKS’s input slot values are <!-- l. 104 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mstyle displaystyle='true'><mfrac><mrow><mi>n</mi>
</mrow><mrow><mn>2</mn></mrow></mfrac></mstyle></math>-dimensional
   complex numbers, which are encoded into <!-- l. 104 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>n</mi></math>-dimensional
   polynomial coefficients (i.e., real numbers).
   </li>
   <li class='itemize'><span class='rm-lmbx-10x-x-109'>Type of Polynomial Coefficients: </span>BFV’s encoded polynomial coefficients are integer moduli,
   whereas CKKS’s encoded polynomial coefficients are real numbers.
   </li>
   <li class='itemize'><span class='rm-lmbx-10x-x-109'>Scaling Factor: </span>Both BFV and CKKS scales their encoded polynomial coefficients <!-- l. 108 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mover accent='true'><mrow><mi>m</mi></mrow><mo accent='true'>→</mo></mover></math>
   by <!-- l. 108 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi mathvariant='normal'>Δ</mi></math>
   to <!-- l. 108 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>⌈</mo><mi mathvariant='normal'>Δ</mi> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mover accent='true'><mrow><mi>m</mi></mrow><mo accent='true'>→</mo></mover><mo class='MathClass-close' stretchy='false'>⌋</mo></mrow></math>.
   BFV’s suggested scaling factor is <!-- l. 108 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi mathvariant='normal'>Δ</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>⌊</mo><mstyle displaystyle='true'><mfrac><mrow><msub><mrow><mi>q</mi></mrow><mrow><mn>0</mn></mrow></msub>
 </mrow><mrow><mi>t</mi> </mrow></mfrac></mstyle><mo class='MathClass-close' stretchy='false'>⌋</mo></mrow></math>,
   but CKKS’s scaling factor <!-- l. 108 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi mathvariant='normal'>Δ</mi></math>
   has no suggested formula because its polynomial coefficients are real numbers not bound by
   modulus, and thus it can be any value provided that the scaled coefficients do not overflow or
   underflow the range <!-- l. 108 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>[</mo><mn>1</mn><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>q</mi></mrow><mrow><mn>0</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>]</mo></mrow></math>
   (or <!-- l. 108 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'> <mrow><mo fence='true' form='prefix'>[</mo><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mstyle displaystyle='true'><mfrac><mrow><msub><mrow><mi>q</mi></mrow><mrow><mn>0</mn></mrow></msub>
 </mrow><mrow><mn>2</mn> </mrow></mfrac></mstyle><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle displaystyle='true'><mfrac><mrow><msub><mrow><mi>q</mi></mrow><mrow><mn>0</mn></mrow></msub>
 </mrow><mrow><mn>2</mn> </mrow></mfrac></mstyle></mrow><mo fence='true' form='postfix'>)</mo></mrow></math>).
                                                                                         
                                                                                         
   </li>
   <li class='itemize'><span class='rm-lmbx-10x-x-109'>Encoding Precision: </span>In the case of BFV, during its decoding process, BFV’s down-scaled
   polynomial coefficients <!-- l. 110 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mstyle displaystyle='true'><mfrac><mrow><mi mathvariant='normal'>Δ</mi> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mover accent='true'><mrow><mi>m</mi></mrow><mo accent='true'>→</mo></mover>
   </mrow><mrow><mi mathvariant='normal'>Δ</mi>   </mrow></mfrac></mstyle></math>
   preserve the precision of input values . On the other hand, CKKS’s down-scaled polynomial
   coefficients may lose their precision if their original input values have too many decimal digits so
   that the scaling factor cannot left-shift all of them to make them part of the integer domain, which
   means that some lower decimal digits of the input value may be rounded off, which loses precision
   of the original input. For example, suppose the polynomial coefficient <!-- l. 112 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>m</mi></mrow><mrow><mi>i</mi></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo> <mstyle displaystyle='true'><mfrac><mrow><mn>1</mn>
</mrow><mrow><mn>3</mn></mrow></mfrac></mstyle> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>0.33333</mn><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace></mrow></math>,
   and the scaling factor <!-- l. 112 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi mathvariant='normal'>Δ</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>100</mn></mrow></math>.
   Then, the scaled coefficient <!-- l. 112 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>⌈</mo><mi mathvariant='normal'>Δ</mi><msub><mrow><mi>m</mi></mrow><mrow><mi>i</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>⌋</mo><mo class='MathClass-rel' stretchy='false'>=</mo> <mn>33</mn></mrow></math>,
   and down-scaling it gives <!-- l. 112 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mstyle displaystyle='true'><mfrac><mrow> <mn>33</mn>
</mrow><mrow><mn>100</mn></mrow></mfrac></mstyle> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>0.33</mn></mrow></math>.
   Since <!-- l. 112 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mn>0.33</mn><mo class='MathClass-rel' stretchy='false'>≠</mo><mn>0.33333</mn><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace></mrow></math>,
   CKKS’s encoding and decoding process does not always guarantee exact precision. Due to this
   encoding error, CKKS is called an <span class='rm-lmri-10x-x-109'>approximate </span>encryption scheme. The impact of this encoding
   error can grow over homomorphic operations which increases the magnitude of error and the
   decoded result would gradually become more deviated from the expected exact value. One way to
   reduce CKKS’s encoding error is to increase <!-- l. 112 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi mathvariant='normal'>Δ</mi></math>,
   and thereby left-shift more decimal digits to make them part of the scaled integer digits.
</li></ul>
<!-- l. 116 --><p class='indent'>   <!-- l. 116 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 119 --><p class='noindent'><span class='rm-lmbx-10x-x-109'>Structure of </span><!-- l. 119 --><math display='inline' mathvariant='bold-italic' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mover accent='true'><mrow><mi>v</mi></mrow><mo accent='true'>→</mo></mover></mrow><mrow><msup><mrow></mrow><mrow><mi>′</mi></mrow></msup></mrow></msub> <mo class='MathClass-rel' stretchy='false'>∈</mo><msup><mrow><mi>Ĉ</mi></mrow><mrow><mi>n</mi></mrow></msup></mrow></math><span class='rm-lmbx-10x-x-109'>: </span>Note that the
original decoding scheme for <!-- l. 119 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mover accent='true'><mrow><mi>v</mi></mrow><mo accent='true'>→</mo></mover></mrow><mrow><msup><mrow></mrow><mrow><mi>′</mi></mrow></msup></mrow></msub></math>
described in Summary <a href='IsomorphismbetweenPolynomialsandVectorsoverComplexNumbers.html#isomorphism-between-polynomials-and-vectors-over-complex-numbers'>A-10.7<!-- tex4ht:ref: subsec:poly-vector-transformation-complex  --></a> (<a href='IsomorphismbetweenPolynomialsandVectorsoverComplexNumbers.html#isomorphism-between-polynomials-and-vectors-over-complex-numbers'><span class='ts1-lmr10-x-x-109'>§</span>A-10.7<!-- tex4ht:ref: subsec:poly-vector-transformation-complex  --></a>) was:
</p><!-- l. 121 --><p class='indent'>   <!-- l. 121 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mover accent='true'><mrow><mi>v</mi></mrow><mo accent='true'>→</mo></mover></mrow><mrow><msup><mrow></mrow><mrow><mi>′</mi></mrow></msup></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo> <mstyle mathvariant='bold'><mo class='MathClass-open' stretchy='false'>(</mo></mstyle><mstyle class='text'><mtext> </mtext></mstyle><mi>M</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>ω</mi><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><mi>M</mi><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mn>3</mn></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><mi>M</mi><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mn>5</mn></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace><mo class='MathClass-punc' stretchy='false'>,</mo><mi>M</mi><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mn>2</mn><mi>n</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>3</mn></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><mi>M</mi><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mn>2</mn><mi>n</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mstyle mathvariant='bold'><mo class='MathClass-close' stretchy='false'>)</mo></mstyle></mrow></math>
</p><!-- l. 123 --><p class='indent'>   , which decodes to an Hermitian vector:
</p><!-- l. 125 --><p class='indent'>   <!-- l. 125 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mover accent='true'><mrow><mi>v</mi></mrow><mo accent='true'>→</mo></mover></mrow><mrow><msup><mrow></mrow><mrow><mi>′</mi></mrow></msup></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>v</mi></mrow><mrow><mn>0</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>v</mi></mrow><mrow><mn>1</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>v</mi></mrow><mrow><mfrac><mrow><mi>n</mi></mrow>
<mrow><mn>2</mn></mrow></mfrac> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mover accent='false' class='mml-overline'><mrow><mi>v</mi></mrow><mo accent='true'>¯</mo></mover></mrow><mrow><mfrac><mrow><mi>n</mi></mrow>
<mrow><mn>2</mn></mrow></mfrac> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mover accent='false' class='mml-overline'><mrow><mi>v</mi></mrow><mo accent='true'>¯</mo></mover></mrow><mrow><mn>1</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mover accent='false' class='mml-overline'><mrow><mi>v</mi></mrow><mo accent='true'>¯</mo></mover></mrow><mrow><mn>0</mn></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
</p><!-- l. 127 --><p class='indent'>   , whose second-half elements are reverse-ordered conjugates of the first-half elements.
</p><!-- l. 129 --><p class='indent'>   <!-- l. 129 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 131 --><p class='indent'>   However, by replacing <!-- l. 131 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>W</mi></math>
and <!-- l. 131 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>W</mi></mrow><mrow><mi>T</mi> </mrow></msup></math> to
<!-- l. 131 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mover accent='true'><mrow><mi>Ŵ</mi></mrow><mo accent='true'>^</mo></mover></math> and
<!-- l. 131 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mover accent='true'><mrow><mi>Ŵ</mi></mrow><mo accent='true'>^</mo></mover></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msup></math>, we
changed the above decoding scheme to the following that supports homomorphic rotation:
</p><!-- l. 134 --><p class='indent'>   <!-- l. 134 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mover accent='true'><mrow><mi>v</mi></mrow><mo accent='true'>→</mo></mover></mrow><mrow><msup><mrow></mrow><mrow><mi>′</mi></mrow></msup></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo> <mstyle mathvariant='bold'><mo class='MathClass-open' stretchy='false'>(</mo></mstyle><mstyle class='text'><mtext> </mtext></mstyle><mi>M</mi><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mn>0</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><mi>M</mi><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><mi>M</mi><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace><mo class='MathClass-punc' stretchy='false'>,</mo><mi>M</mi><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mfrac><mrow><mi>n</mi></mrow>
<mrow><mn>2</mn></mrow></mfrac> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><mi>M</mi><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><msub><mrow><mi>J</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mn>0</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><mi>M</mi><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><msub><mrow><mi>J</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace><mo class='MathClass-punc' stretchy='false'>,</mo><mi>M</mi><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><msub><mrow><mi>J</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mfrac><mrow><mi>n</mi></mrow>
<mrow><mn>2</mn></mrow></mfrac> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mstyle class='text'><mtext> </mtext></mstyle><mstyle mathvariant='bold'><mo class='MathClass-close' stretchy='false'>)</mo></mstyle></mrow></math>
</p><!-- l. 137 --><p class='indent'>   <!-- l. 137 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mstyle mathcolor='#FFFFFF'><msub><mrow><mover accent='true'><mrow><mi>v</mi></mrow><mo accent='true'>→</mo></mover></mrow><mrow><msup><mrow></mrow><mrow><mi>′</mi></mrow></msup></mrow></msub></mstyle> <mo class='MathClass-rel' stretchy='false'>=</mo> <mstyle mathvariant='bold'><mo class='MathClass-open' stretchy='false'>(</mo></mstyle><mstyle class='text'><mtext> </mtext></mstyle><mi>M</mi><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mn>0</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><mi>M</mi><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><mi>M</mi><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace><mo class='MathClass-punc' stretchy='false'>,</mo><mi>M</mi><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mfrac><mrow><mi>n</mi></mrow>
<mrow><mn>2</mn></mrow></mfrac> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><mi>M</mi><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mover accent='false' class='mml-overline'><mrow><mi>ω</mi></mrow><mo accent='true'>¯</mo></mover></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mn>0</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><mi>M</mi><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mover accent='false' class='mml-overline'><mrow><mi>ω</mi></mrow><mo accent='true'>¯</mo></mover></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace><mo class='MathClass-punc' stretchy='false'>,</mo><mi>M</mi><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mover accent='false' class='mml-overline'><mrow><mi>ω</mi></mrow><mo accent='true'>¯</mo></mover></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mfrac><mrow><mi>n</mi></mrow>
<mrow><mn>2</mn></mrow></mfrac> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mstyle class='text'><mtext> </mtext></mstyle><mstyle mathvariant='bold'><mo class='MathClass-close' stretchy='false'>)</mo></mstyle></mrow></math>
</p><!-- l. 140 --><p class='indent'>   <span id='textcolor125'># because <!-- l. 140 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>ω</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo> <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>e</mi></mrow><mrow><mfrac><mrow><mi mathvariant='italic'>𝑖𝜋</mi></mrow>
<mrow><mi>n</mi></mrow></mfrac> </mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo> <msup><mrow><mi>e</mi></mrow><mrow><mfrac><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mi mathvariant='italic'>𝑖𝜋</mi></mrow>
 <mrow><mi>n</mi></mrow></mfrac>  </mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo> <mover accent='false' class='mml-overline'><mrow><mi>ω</mi></mrow><mo accent='true'>¯</mo></mover></mrow></math></span>
</p><!-- l. 142 --><p class='indent'>   , which decodes to a <span class='rm-lmri-10x-x-109'>forward-ordered </span>(not reverse-ordered) Hermitian vector as follows:
</p><!-- l. 144 --><p class='indent'>   <!-- l. 144 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mover accent='true'><mrow><mi>v</mi></mrow><mo accent='true'>→</mo></mover></mrow><mrow><msup><mrow></mrow><mrow><mi>′</mi></mrow></msup></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>v</mi></mrow><mrow><mn>0</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>v</mi></mrow><mrow><mn>1</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>v</mi></mrow><mrow><mfrac><mrow><mi>n</mi></mrow>
<mrow><mn>2</mn></mrow></mfrac> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mover accent='false' class='mml-overline'><mrow><mi>v</mi></mrow><mo accent='true'>¯</mo></mover></mrow><mrow><mn>0</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mover accent='false' class='mml-overline'><mrow><mi>v</mi></mrow><mo accent='true'>¯</mo></mover></mrow><mrow><mn>1</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mover accent='false' class='mml-overline'><mrow><mi>v</mi></mrow><mo accent='true'>¯</mo></mover></mrow><mrow><mfrac><mrow><mi>n</mi></mrow>
<mrow><mn>2</mn></mrow></mfrac> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
</p><!-- l. 146 --><p class='indent'>   , whose second-half elements are conjugates of the first-half elements with the same
order. Upon homomorphic rotation (which will be explained in <a href='HomomorphicRotationofInputVectorSlots1.html#homomorphic-rotation-of-input-vector-slots1'><span class='ts1-lmr10-x-x-109'>§</span>D-3.9<!-- tex4ht:ref: subsec:poly-vector-transformation-complex  --></a>), just like in
BFV’s homomorphic rotation, the first-half elements and the second-half elements of
<!-- l. 146 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mover accent='true'><mrow><mi>v</mi></mrow><mo accent='true'>→</mo></mover></mrow><mrow><msup><mrow></mrow><mrow><mi>′</mi>
 </mrow></msup></mrow></msub></math> rotate
                                                                                         
                                                                                         
within their own group in a wrapping manner.
</p><!-- l. 150 --><p class='indent'>   We summarize CKKS’s encoding and decoding procedure as follows, which is similar to BFV’s
encoding and decoding procedure (described in Summary <a href='BatchEncoding.html#summary'>D-2.2.5<!-- tex4ht:ref: subsubsec:bfv-encoding-summary  --></a> in <a href='BatchEncoding.html#summary'><span class='ts1-lmr10-x-x-109'>§</span>D-2.2.5<!-- tex4ht:ref: subsubsec:bfv-encoding-summary  --></a>):
</p>
   <div class='tcolorbox tcolorbox' id='tcolobox-87'>     
<div class='tcolorbox-title'>
<!-- l. 238 --><p class='indent'>   <!-- l. 238 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mstyle mathvariant='bold'><mo class='MathClass-open' stretchy='false'>⟨</mo></mstyle></math><span class='rm-lmbx-10x-x-109'>Summary </span><a href='#encoding-and-decoding'><span class='rm-lmbx-10x-x-109'>D-3.1</span><!-- tex4ht:ref: subsec:ckks-encoding-decoding  --></a><!-- l. 238 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mstyle mathvariant='bold'><mo class='MathClass-close' stretchy='false'>⟩</mo></mstyle></math>
                                                                                         
                                                                                         
<span class='rm-lmbx-10x-x-109'>CKKS’s Encoding and Decoding</span></p></div> 
<div class='tcolorbox-content'><!-- l. 154 --><p class='noindent'><span class='underline'><span class='rm-lmbx-10x-x-109'>Input</span></span><span class='rm-lmbx-10x-x-109'>: </span>An <!-- l. 154 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mstyle displaystyle='true'><mfrac><mrow><mi>n</mi>
</mrow><mrow><mn>2</mn></mrow></mfrac></mstyle></math>-dimensional
complex vector <!-- l. 154 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mover accent='true'><mrow><mi>v</mi></mrow><mo accent='true'>→</mo></mover> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>v</mi></mrow><mrow><mn>0</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>v</mi></mrow><mrow><mn>1</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>v</mi></mrow><mrow><mfrac><mrow><mi>n</mi></mrow>
<mrow><mn>2</mn></mrow></mfrac> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>∈</mo> <msup><mrow><mi>ℂ</mi></mrow><mrow><mfrac><mrow><mi>n</mi></mrow>
<mrow><mn>2</mn></mrow></mfrac> </mrow></msup></mrow></math>
</p><!-- l. 156 --><p class='noindent'></p><hr />
<!-- l. 158 --><p class='noindent'><span class='underline'><span class='rm-lmbx-10x-x-109'>Encoding</span></span><span class='rm-lmbx-10x-x-109'>:</span>
</p><!-- l. 160 --><p class='noindent'><!-- l. 160 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
   </p><dl class='enumerate-enumitem'><dt class='enumerate-enumitem'>
1.  </dt><dd class='enumerate-enumitem'>Convert (i.e., isomorphically transform) <!-- l. 163 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mover accent='true'><mrow><mi>v</mi></mrow><mo accent='true'>→</mo></mover></math>
   into an <!-- l. 163 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>n</mi></math>-dimensional
    <span class='rm-lmri-10x-x-109'>forward-ordered </span>Hermitian vector <!-- l. 163 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mover accent='true'><mrow><mi>v</mi></mrow><mo accent='true'>→</mo></mover></mrow><mrow><msup><mrow></mrow><mrow><mi>′</mi></mrow></msup></mrow></msub></math>
   as follows:
    <!-- l. 165 --><p class='noindent'><!-- l. 165 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mover accent='true'><mrow><mi>v</mi></mrow><mo accent='true'>→</mo></mover></mrow><mrow><msup><mrow></mrow><mrow><mi>′</mi></mrow></msup></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>v</mi></mrow><mrow><mn>0</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>v</mi></mrow><mrow><mn>1</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>v</mi></mrow><mrow><mfrac><mrow><mi>n</mi></mrow>
<mrow><mn>2</mn></mrow></mfrac> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mover accent='false' class='mml-overline'><mrow><mi>v</mi></mrow><mo accent='true'>¯</mo></mover></mrow><mrow><mn>0</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mover accent='false' class='mml-overline'><mrow><mi>v</mi></mrow><mo accent='true'>¯</mo></mover></mrow><mrow><mn>1</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mover accent='false' class='mml-overline'><mrow><mi>v</mi></mrow><mo accent='true'>¯</mo></mover></mrow><mrow><mfrac><mrow><mi>n</mi></mrow>
<mrow><mn>2</mn></mrow></mfrac> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>∈</mo><msup><mrow><mi>Ĉ</mi></mrow><mrow><mi>n</mi></mrow></msup></mrow></math>
    </p></dd><dt class='enumerate-enumitem'>
2.  </dt><dd class='enumerate-enumitem'>Convert <!-- l. 167 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mover accent='true'><mrow><mi>v</mi></mrow><mo accent='true'>→</mo></mover></mrow><mrow><msup><mrow></mrow><mrow><mi>′</mi></mrow></msup></mrow></msub></math>
   into a real number vector <!-- l. 167 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mover accent='true'><mrow><mi>m</mi></mrow><mo accent='true'>→</mo></mover></math>
   by applying the transformation <!-- l. 167 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mover accent='true'><mrow><mi>m</mi></mrow><mo accent='true'>→</mo></mover> <mo class='MathClass-rel' stretchy='false'>=</mo> <mstyle displaystyle='true'><mfrac><mrow><mover accent='true'><mrow><mi>Ŵ</mi></mrow><mo accent='true'>^</mo></mover> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msubsup><mrow><mi>I</mi></mrow><mrow><mi>n</mi></mrow><mrow><mi>R</mi></mrow></msubsup> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msub><mrow><mover accent='true'><mrow><mi>v</mi></mrow><mo accent='true'>→</mo></mover></mrow><mrow><msup><mrow></mrow><mrow><mi>′</mi></mrow></msup></mrow></msub>
       </mrow><mrow><mi>n</mi>       </mrow></mfrac></mstyle></mrow></math>
   <!-- l. 169 --><p class='noindent'>, where <!-- l. 169 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>W</mi></math>
   is a basis of the <!-- l. 169 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>n</mi></math>-dimensional
    vector space crafted as follows:
    </p><!-- l. 171 --><p class='noindent'><!-- l. 171 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
    </p><!-- l. 173 --><p class='noindent'><!-- l. 173 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mover accent='true'><mrow><mi>Ŵ</mi></mrow><mo accent='true'>^</mo></mover> <mo class='MathClass-rel' stretchy='false'>=</mo>  <mrow><mo fence='true' form='prefix'>[</mo><mrow><mtable align='axis' class='array' columnlines='none none none none none none none none none' displaystyle='true' equalcolumns='false' equalrows='false' rowlines='none none none none none none none none none none none' style=''><mtr class='array-row'><mtd class='array-td' columnalign='center'>          <mn>1</mn>          </mtd><mtd class='array-td' columnalign='center'>          <mn>1</mn>          </mtd><mtd class='array-td' columnalign='center'>  <mo class='MathClass-rel' stretchy='false'>⋯</mo> </mtd><mtd class='array-td' columnalign='center'>       <mn>1</mn>        </mtd><mtd class='array-td' columnalign='center'>          <mn>1</mn>          </mtd><mtd class='array-td' columnalign='center'>          <mn>1</mn>          </mtd><mtd class='array-td' columnalign='center'>  <mo class='MathClass-rel' stretchy='false'>⋯</mo> </mtd><mtd class='array-td' columnalign='center'>       <mn>1</mn>        </mtd></mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'> </mtd></mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'> </mtd>
</mtr><mtr class='array-row'><mtd class='array-td' columnalign='center'>    <mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mfrac><mrow><mi>n</mi></mrow><mrow><mn>2</mn></mrow></mfrac> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo>    </mtd><mtd class='array-td' columnalign='center'>    <mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mfrac><mrow><mi>n</mi></mrow><mrow><mn>2</mn></mrow></mfrac> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo>    </mtd><mtd class='array-td' columnalign='center'>  <mo class='MathClass-rel' stretchy='false'>⋯</mo> </mtd><mtd class='array-td' columnalign='center'>   <mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mn>0</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo>    </mtd><mtd class='array-td' columnalign='center'>    <mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><msub><mrow><mi>J</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mfrac><mrow><mi>n</mi></mrow><mrow><mn>2</mn></mrow></mfrac> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo>    </mtd><mtd class='array-td' columnalign='center'>    <mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><msub><mrow><mi>J</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mfrac><mrow><mi>n</mi></mrow><mrow><mn>2</mn></mrow></mfrac> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo>    </mtd><mtd class='array-td' columnalign='center'>  <mo class='MathClass-rel' stretchy='false'>⋯</mo> </mtd><mtd class='array-td' columnalign='center'>   <mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><msub><mrow><mi>J</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mn>0</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo>    </mtd></mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'> </mtd></mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'> </mtd>
</mtr><mtr class='array-row'><mtd class='array-td' columnalign='center'>   <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mfrac><mrow><mi>n</mi></mrow><mrow><mn>2</mn></mrow></mfrac> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>2</mn></mrow></msup>    </mtd><mtd class='array-td' columnalign='center'>    <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mfrac><mrow><mi>n</mi></mrow><mrow><mn>2</mn></mrow></mfrac> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>2</mn></mrow></msup>    </mtd><mtd class='array-td' columnalign='center'>  <mo class='MathClass-rel' stretchy='false'>⋯</mo> </mtd><mtd class='array-td' columnalign='center'>   <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mn>0</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>2</mn></mrow></msup>    </mtd><mtd class='array-td' columnalign='center'>    <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><msub><mrow><mi>J</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mfrac><mrow><mi>n</mi></mrow><mrow><mn>2</mn></mrow></mfrac> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>2</mn></mrow></msup>    </mtd><mtd class='array-td' columnalign='center'>    <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><msub><mrow><mi>J</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mfrac><mrow><mi>n</mi></mrow><mrow><mn>2</mn></mrow></mfrac> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>2</mn></mrow></msup>    </mtd><mtd class='array-td' columnalign='center'>  <mo class='MathClass-rel' stretchy='false'>⋯</mo> </mtd><mtd class='array-td' columnalign='center'>   <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><msub><mrow><mi>J</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mn>0</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>2</mn></mrow></msup>    </mtd>
</mtr><mtr class='array-row'><mtd class='array-td' columnalign='center'>                          </mtd></mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'></mtd></mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'> <mi>⋮</mi></mtd><mtd class='array-td' columnalign='center'>        <mi>⋮</mi>        </mtd><mtd class='array-td' columnalign='center'> <mo class='MathClass-rel' stretchy='false'>⋱</mo> </mtd><mtd class='array-td' columnalign='center'>      <mi>⋮</mi>      </mtd><mtd class='array-td' columnalign='center'>         <mi>⋮</mi>         </mtd><mtd class='array-td' columnalign='center'>         <mo class='MathClass-rel' stretchy='false'>⋱</mo>         </mtd><mtd class='array-td' columnalign='center'> <mi>⋮</mi> </mtd><mtd class='array-td' columnalign='center'>       <mi>⋮</mi>       </mtd></mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'> </mtd></mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'> </mtd>
</mtr><mtr class='array-row'><mtd class='array-td' columnalign='center'> <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mfrac><mrow><mi>n</mi></mrow><mrow><mn>2</mn></mrow></mfrac> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msup>  </mtd><mtd class='array-td' columnalign='center'>  <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mfrac><mrow><mi>n</mi></mrow><mrow><mn>2</mn></mrow></mfrac> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msup>  </mtd><mtd class='array-td' columnalign='center'>  <mo class='MathClass-rel' stretchy='false'>⋯</mo> </mtd><mtd class='array-td' columnalign='center'> <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mn>0</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msup>  </mtd><mtd class='array-td' columnalign='center'>  <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><msub><mrow><mi>J</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mfrac><mrow><mi>n</mi></mrow><mrow><mn>2</mn></mrow></mfrac> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msup>  </mtd><mtd class='array-td' columnalign='center'>  <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><msub><mrow><mi>J</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mfrac><mrow><mi>n</mi></mrow><mrow><mn>2</mn></mrow></mfrac> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msup>  </mtd><mtd class='array-td' columnalign='center'>  <mi>⋮</mi> </mtd><mtd class='array-td' columnalign='center'> <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><msub><mrow><mi>J</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mn>0</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msup>  </mtd>
</mtr><!-- *\c@MaxMatrixCols c --></mtable>                                                                                                                                                                            </mrow><mo fence='true' form='postfix'>]</mo></mrow> </mrow></math>
      </p><!-- l. 181 --><p class='noindent'><span id='textcolor126'># where <!-- l. 181 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>ω</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <msup><mrow><mi>e</mi></mrow><mrow><mi mathvariant='italic'>𝑖𝜋</mi><mo class='MathClass-bin' stretchy='false'>∕</mo><mi>n</mi></mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo> <mi class='loglike'>cos</mi><mo>⁡<!-- FUNCTION APPLICATION --></mo><!-- nolimits --> <mrow><mo fence='true' form='prefix'>(</mo><mrow><mstyle displaystyle='true'><mfrac><mrow><mi>π</mi>
</mrow><mrow><mi>n</mi></mrow></mfrac></mstyle></mrow><mo fence='true' form='postfix'>)</mo></mrow> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>i</mi><mstyle><mi class='loglike'>sin</mi><mo>⁡<!-- FUNCTION APPLICATION --></mo></mstyle><!-- nolimits --> <mrow><mo fence='true' form='prefix'>(</mo><mrow><mstyle displaystyle='true'><mfrac><mrow><mi>π</mi>
</mrow><mrow><mi>n</mi></mrow></mfrac></mstyle></mrow><mo fence='true' form='postfix'>)</mo></mrow></mrow></math></span>
   </p><!-- l. 183 --><p class='noindent'><!-- l. 183 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo>  <mrow><mo fence='true' form='prefix'>[</mo><mrow><mtable align='axis' class='array' columnlines='none none none none none none none none none' displaystyle='true' equalcolumns='false' equalrows='false' rowlines='none none none none none none none none none none none' style=''><mtr class='array-row'><mtd class='array-td' columnalign='center'>          <mn>1</mn>          </mtd><mtd class='array-td' columnalign='center'>          <mn>1</mn>          </mtd><mtd class='array-td' columnalign='center'>  <mo class='MathClass-rel' stretchy='false'>⋯</mo> </mtd><mtd class='array-td' columnalign='center'>      <mn>1</mn>        </mtd><mtd class='array-td' columnalign='center'>          <mn>1</mn>          </mtd><mtd class='array-td' columnalign='center'>          <mn>1</mn>          </mtd><mtd class='array-td' columnalign='center'>  <mo class='MathClass-rel' stretchy='false'>⋯</mo> </mtd><mtd class='array-td' columnalign='center'>      <mn>1</mn>        </mtd></mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'> </mtd></mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'> </mtd>
</mtr><mtr class='array-row'><mtd class='array-td' columnalign='center'>    <mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mfrac><mrow><mi>n</mi></mrow>
<mrow><mn>2</mn></mrow></mfrac> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo>    </mtd><mtd class='array-td' columnalign='center'>    <mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mfrac><mrow><mi>n</mi></mrow>
<mrow><mn>2</mn></mrow></mfrac> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo>    </mtd><mtd class='array-td' columnalign='center'>  <mo class='MathClass-rel' stretchy='false'>⋯</mo> </mtd><mtd class='array-td' columnalign='center'>   <mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mn>0</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo>    </mtd><mtd class='array-td' columnalign='center'>    <mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mover accent='false' class='mml-overline'><mrow><mi>ω</mi></mrow><mo accent='true'>¯</mo></mover></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mfrac><mrow><mi>n</mi></mrow>
<mrow><mn>2</mn></mrow></mfrac> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo>    </mtd><mtd class='array-td' columnalign='center'>    <mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mover accent='false' class='mml-overline'><mrow><mi>ω</mi></mrow><mo accent='true'>¯</mo></mover></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mfrac><mrow><mi>n</mi></mrow>
<mrow><mn>2</mn></mrow></mfrac> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo>    </mtd><mtd class='array-td' columnalign='center'>  <mo class='MathClass-rel' stretchy='false'>⋯</mo> </mtd><mtd class='array-td' columnalign='center'>   <mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mover accent='false' class='mml-overline'><mrow><mi>ω</mi></mrow><mo accent='true'>¯</mo></mover></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mn>0</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo>    </mtd></mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'> </mtd></mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'> </mtd>
</mtr><mtr class='array-row'><mtd class='array-td' columnalign='center'>   <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mfrac><mrow><mi>n</mi></mrow>
<mrow><mn>2</mn></mrow></mfrac> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>2</mn></mrow></msup>    </mtd><mtd class='array-td' columnalign='center'>    <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mfrac><mrow><mi>n</mi></mrow>
<mrow><mn>2</mn></mrow></mfrac> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>2</mn></mrow></msup>    </mtd><mtd class='array-td' columnalign='center'>  <mo class='MathClass-rel' stretchy='false'>⋯</mo> </mtd><mtd class='array-td' columnalign='center'>   <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mn>0</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>2</mn></mrow></msup>    </mtd><mtd class='array-td' columnalign='center'>    <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mover accent='false' class='mml-overline'><mrow><mi>ω</mi></mrow><mo accent='true'>¯</mo></mover></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mfrac><mrow><mi>n</mi></mrow>
<mrow><mn>2</mn></mrow></mfrac> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>2</mn></mrow></msup>    </mtd><mtd class='array-td' columnalign='center'>    <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mover accent='false' class='mml-overline'><mrow><mi>ω</mi></mrow><mo accent='true'>¯</mo></mover></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mfrac><mrow><mi>n</mi></mrow>
<mrow><mn>2</mn></mrow></mfrac> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>2</mn></mrow></msup>    </mtd><mtd class='array-td' columnalign='center'>  <mo class='MathClass-rel' stretchy='false'>⋯</mo> </mtd><mtd class='array-td' columnalign='center'>   <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mover accent='false' class='mml-overline'><mrow><mi>ω</mi></mrow><mo accent='true'>¯</mo></mover></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mn>0</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>2</mn></mrow></msup>    </mtd></mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'> </mtd></mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'> </mtd>
</mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'>            <mi>⋮</mi>        </mtd><mtd class='array-td' columnalign='center'>        <mi>⋮</mi>        </mtd><mtd class='array-td' columnalign='center'> <mo class='MathClass-rel' stretchy='false'>⋱</mo> </mtd><mtd class='array-td' columnalign='center'>      <mi>⋮</mi>      </mtd><mtd class='array-td' columnalign='center'>        <mi>⋮</mi>        </mtd><mtd class='array-td' columnalign='center'>        <mo class='MathClass-rel' stretchy='false'>⋱</mo>        </mtd><mtd class='array-td' columnalign='center'> <mi>⋮</mi> </mtd><mtd class='array-td' columnalign='center'>      <mi>⋮</mi>      </mtd></mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'> </mtd></mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'> </mtd>
</mtr><mtr class='array-row'><mtd class='array-td' columnalign='center'> <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mfrac><mrow><mi>n</mi></mrow>
<mrow><mn>2</mn></mrow></mfrac> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msup>  </mtd><mtd class='array-td' columnalign='center'>  <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mfrac><mrow><mi>n</mi></mrow>
<mrow><mn>2</mn></mrow></mfrac> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msup>  </mtd><mtd class='array-td' columnalign='center'>  <mo class='MathClass-rel' stretchy='false'>⋯</mo> </mtd><mtd class='array-td' columnalign='center'> <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mn>0</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msup>  </mtd><mtd class='array-td' columnalign='center'>  <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mover accent='false' class='mml-overline'><mrow><mi>ω</mi></mrow><mo accent='true'>¯</mo></mover></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mfrac><mrow><mi>n</mi></mrow>
<mrow><mn>2</mn></mrow></mfrac> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msup>  </mtd><mtd class='array-td' columnalign='center'>  <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mover accent='false' class='mml-overline'><mrow><mi>ω</mi></mrow><mo accent='true'>¯</mo></mover></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mfrac><mrow><mi>n</mi></mrow>
<mrow><mn>2</mn></mrow></mfrac> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msup>  </mtd><mtd class='array-td' columnalign='center'>  <mi>⋮</mi> </mtd><mtd class='array-td' columnalign='center'> <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mover accent='false' class='mml-overline'><mrow><mi>ω</mi></mrow><mo accent='true'>¯</mo></mover></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mn>0</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msup>  </mtd></mtr><!-- *\c@MaxMatrixCols c --></mtable>   </mrow><mo fence='true' form='postfix'>]</mo></mrow> </mrow></math>
     </p><!-- l. 191 --><p class='noindent'><span id='textcolor127'><span class='rm-lmr-10'># because </span><!-- l. 191 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>ω</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo> <msup><mrow><mi>e</mi></mrow><mrow><mfrac><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mi mathvariant='italic'>𝑖𝜋</mi></mrow>
 <mrow><mi>n</mi></mrow></mfrac>  </mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo> <mover accent='false' class='mml-overline'><mrow><msup><mrow><mi>e</mi></mrow><mrow><mfrac><mrow><mi mathvariant='italic'>𝑖𝜋</mi></mrow>
<mrow><mi>n</mi></mrow></mfrac> </mrow></msup></mrow><mo accent='true'>¯</mo></mover> <mo class='MathClass-rel' stretchy='false'>=</mo> <mover accent='false' class='mml-overline'><mrow><mi>ω</mi></mrow><mo accent='true'>¯</mo></mover></mrow></math></span>
    </p><!-- l. 193 --><p class='noindent'><!-- l. 193 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
    </p></dd><dt class='enumerate-enumitem'>
<span class='rm-lmr-10'>3.</span>  </dt><dd class='enumerate-enumitem'><span class='rm-lmr-10'>Convert </span><!-- l. 195 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mover accent='true'><mrow><mi>m</mi></mrow><mo accent='true'>→</mo></mover></math>
    <span class='rm-lmr-10'>into a scaled integer vector </span><!-- l. 195 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>⌈</mo><mi mathvariant='normal'>Δ</mi><mover accent='true'><mrow><mi>m</mi></mrow><mo accent='true'>→</mo></mover><mo class='MathClass-close' stretchy='false'>⌋</mo><mo class='MathClass-rel' stretchy='false'>≈</mo><mi mathvariant='normal'>Δ</mi><mover accent='true'><mrow><mi>m</mi></mrow><mo accent='true'>→</mo></mover></mrow></math><span class='rm-lmr-10'>,
    where </span><!-- l. 195 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi mathvariant='normal'>Δ</mi></math>
    <span class='rm-lmr-10'>is a scaling factor bigger than 1 such that </span><!-- l. 195 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi mathvariant='normal'>Δ</mi><msub><mrow><mi>m</mi></mrow><mrow><mi>i</mi></mrow></msub></mrow></math>
    <span class='rm-lmr-10'>never overflows or underflows </span><!-- l. 195 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>q</mi></mrow><mrow><mn>0</mn></mrow></msub></math>
     <span class='rm-lmr-10'>(i.e., </span><!-- l. 195 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mn>0</mn> <mo class='MathClass-rel' stretchy='false'>≤</mo><mi mathvariant='normal'>Δ</mi><msub><mrow><mi>m</mi></mrow><mrow><mi>i</mi></mrow></msub> <mo class='MathClass-rel' stretchy='false'>&lt;</mo> <msub><mrow><mi>q</mi></mrow><mrow><mn>0</mn></mrow></msub></mrow></math>
     <span class='rm-lmr-10'>or </span><!-- l. 195 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-bin' stretchy='false'>−</mo><mstyle displaystyle='true'><mfrac><mrow><msub><mrow><mi>q</mi></mrow><mrow><mn>0</mn></mrow></msub>
 </mrow><mrow><mn>2</mn> </mrow></mfrac></mstyle> <mo class='MathClass-rel' stretchy='false'>≤</mo><mi mathvariant='normal'>Δ</mi><msub><mrow><mi>m</mi></mrow><mrow><mi>i</mi></mrow></msub> <mo class='MathClass-rel' stretchy='false'>&lt;</mo> <mstyle displaystyle='true'><mfrac><mrow><msub><mrow><mi>q</mi></mrow><mrow><mn>0</mn></mrow></msub>
 </mrow><mrow><mn>2</mn> </mrow></mfrac></mstyle></mrow></math><span class='rm-lmr-10'>)
    in all cases, even across all homomorphic operations. The finally encoded plaintext polynomial is</span>
    <!-- l. 195 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi mathvariant='normal'>Δ</mi><mi>M</mi> <mo class='MathClass-rel' stretchy='false'>=</mo><munderover accent='false' accentunder='false'><mrow> <mi class='MathClass-op'>∑</mi><mo> ⁡<!-- FUNCTION APPLICATION --></mo>
  </mrow><mrow><mi>i</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>0</mn></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></munderover><mo class='MathClass-open' stretchy='false'>⌈</mo><mi mathvariant='normal'>Δ</mi><msub><mrow><mi>m</mi></mrow><mrow><mi>i</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>⌋</mo><msup><mrow><mi>X</mi></mrow><mrow><mi>i</mi></mrow></msup><mstyle class='text'><mtext> </mtext></mstyle> <mo class='MathClass-rel' stretchy='false'>∈</mo><msub><mrow><mi>ℤ</mi></mrow><mrow><mi>q</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>[</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>]</mo><mo class='MathClass-bin' stretchy='false'>∕</mo><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>X</mi></mrow><mrow><mi>n</mi></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math><span class='rm-lmr-10'>.
    The rounding process of </span><!-- l. 195 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>⌈</mo><mi mathvariant='normal'>Δ</mi><mover accent='true'><mrow><mi>m</mi></mrow><mo accent='true'>→</mo></mover><mo class='MathClass-close' stretchy='false'>⌋</mo></mrow></math>
  <span class='rm-lmr-10'>during  the  encoding  process  causes  an  encoding  error,  which  makes  CKKS  an  approximate
    encryption scheme.</span>
    </dd></dl>
<!-- l. 199 --><p class='noindent'></p><hr />
<!-- l. 201 --><p class='noindent'><span class='underline'><span class='rm-lmbx-10x-x-109'>Decoding</span></span><span class='rm-lmbx-10x-x-109'>:   </span>From  the  plaintext  polynomial
<!-- l. 201 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi mathvariant='normal'>Δ</mi><mi>M</mi> <mo class='MathClass-rel' stretchy='false'>=</mo><munderover accent='false' accentunder='false'><mrow> <mi class='MathClass-op'>∑</mi><mo> ⁡<!-- FUNCTION APPLICATION --></mo>
  </mrow><mrow><mi>i</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>0</mn></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></munderover></mrow></math><!-- l. 201 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi mathvariant='normal'>Δ</mi><msub><mrow><mi>m</mi></mrow><mrow><mi>i</mi></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mi>i</mi></mrow></msup></mrow></math>,
recover <!-- l. 201 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mover accent='true'><mrow><mi>m</mi></mrow><mo accent='true'>→</mo></mover> <mo class='MathClass-rel' stretchy='false'>=</mo> <mstyle displaystyle='true'><mfrac><mrow><mi mathvariant='normal'>Δ</mi><mover accent='true'><mrow><mi>m</mi></mrow><mo accent='true'>→</mo></mover>
  </mrow><mrow><mi mathvariant='normal'>Δ</mi>  </mrow></mfrac></mstyle></mrow></math>. Then,
compute <!-- l. 202 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mover accent='true'><mrow><mi>v</mi></mrow><mo accent='true'>→</mo></mover></mrow><mrow><msup><mrow></mrow><mrow><mi>′</mi></mrow></msup></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo><msup><mrow> <mover accent='true'><mrow><mi>Ŵ</mi></mrow><mo accent='true'>^</mo></mover></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msup><mo class='MathClass-bin' stretchy='false'>⋅</mo><mover accent='true'><mrow><mi>m</mi></mrow><mo accent='true'>→</mo></mover></mrow></math>,
where:
</p><!-- l. 204 --><p class='noindent'><!-- l. 204 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mover accent='true'><mrow><mi>Ŵ</mi></mrow><mo accent='true'>^</mo></mover></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo>  <mrow><mo fence='true' form='prefix'>[</mo><mrow><mtable align='axis' class='array' columnlines='none none none none none none none none none' displaystyle='true' equalcolumns='false' equalrows='false' rowlines='none none none none none none none none none none none none none none none none none none none none none none none none none none none none' style=''> <mtr class='array-row'><mtd class='array-td' columnalign='center'> <mn>1</mn> </mtd><mtd class='array-td' columnalign='center'>    <mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mn>0</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo>    </mtd><mtd class='array-td' columnalign='center'>    <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mn>0</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>2</mn></mrow></msup>     </mtd><mtd class='array-td' columnalign='center'>  <mo class='MathClass-rel' stretchy='false'>⋯</mo> </mtd><mtd class='array-td' columnalign='center'>   <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mn>0</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msup>     </mtd></mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'> </mtd></mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'> </mtd>
</mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'>  <mn>1</mn> </mtd><mtd class='array-td' columnalign='center'>    <mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo>    </mtd><mtd class='array-td' columnalign='center'>    <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>2</mn></mrow></msup>     </mtd><mtd class='array-td' columnalign='center'>  <mo class='MathClass-rel' stretchy='false'>⋯</mo> </mtd><mtd class='array-td' columnalign='center'>   <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msup>     </mtd></mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'> </mtd></mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'> </mtd>
</mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'>  <mn>1</mn> </mtd><mtd class='array-td' columnalign='center'>    <mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo>    </mtd><mtd class='array-td' columnalign='center'>    <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>2</mn></mrow></msup>     </mtd><mtd class='array-td' columnalign='center'>  <mo class='MathClass-rel' stretchy='false'>⋯</mo> </mtd><mtd class='array-td' columnalign='center'>   <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msup>     </mtd></mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'> </mtd></mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'> </mtd>
</mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'>  <mi>⋮</mi> </mtd><mtd class='array-td' columnalign='center'>      <mi>⋮</mi>      </mtd><mtd class='array-td' columnalign='center'>       <mi>⋮</mi>       </mtd><mtd class='array-td' columnalign='center'> <mo class='MathClass-rel' stretchy='false'>⋱</mo> </mtd><mtd class='array-td' columnalign='center'>        <mi>⋮</mi>        </mtd></mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'> </mtd></mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'> </mtd>
</mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'> <mn>1</mn> </mtd><mtd class='array-td' columnalign='center'>  <mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mfrac><mrow><mi>n</mi></mrow>
<mrow><mn>2</mn></mrow></mfrac> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo>  </mtd><mtd class='array-td' columnalign='center'>  <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mfrac><mrow><mi>n</mi></mrow>
<mrow><mn>2</mn></mrow></mfrac> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>2</mn></mrow></msup>   </mtd><mtd class='array-td' columnalign='center'>  <mo class='MathClass-rel' stretchy='false'>⋯</mo> </mtd><mtd class='array-td' columnalign='center'>  <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mfrac><mrow><mi>n</mi></mrow>
<mrow><mn>2</mn></mrow></mfrac> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msup>   </mtd>
</mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'>      </mtd></mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'></mtd>
</mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'>  <mn>1</mn> </mtd><mtd class='array-td' columnalign='center'>   <mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><msub><mrow><mi>J</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mn>0</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo>   </mtd><mtd class='array-td' columnalign='center'>   <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><msub><mrow><mi>J</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mn>0</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>2</mn></mrow></msup>    </mtd><mtd class='array-td' columnalign='center'>  <mo class='MathClass-rel' stretchy='false'>⋯</mo> </mtd><mtd class='array-td' columnalign='center'>   <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><msub><mrow><mi>J</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mn>0</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msup>    </mtd>
</mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'>      </mtd></mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'></mtd>
</mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'>  <mn>1</mn> </mtd><mtd class='array-td' columnalign='center'>   <mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><msub><mrow><mi>J</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo>   </mtd><mtd class='array-td' columnalign='center'>   <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><msub><mrow><mi>J</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>2</mn></mrow></msup>    </mtd><mtd class='array-td' columnalign='center'>  <mo class='MathClass-rel' stretchy='false'>⋯</mo> </mtd><mtd class='array-td' columnalign='center'>   <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><msub><mrow><mi>J</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msup>    </mtd>
</mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'>      </mtd></mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'></mtd>
</mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'>  <mn>1</mn> </mtd><mtd class='array-td' columnalign='center'>   <mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><msub><mrow><mi>J</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo>   </mtd><mtd class='array-td' columnalign='center'>   <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><msub><mrow><mi>J</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>2</mn></mrow></msup>    </mtd><mtd class='array-td' columnalign='center'>  <mo class='MathClass-rel' stretchy='false'>⋯</mo> </mtd><mtd class='array-td' columnalign='center'>   <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><msub><mrow><mi>J</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msup>    </mtd>
</mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'>      </mtd></mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'></mtd></mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'> <mi>⋮</mi></mtd><mtd class='array-td' columnalign='center'>      <mi>⋮</mi>      </mtd><mtd class='array-td' columnalign='center'>       <mi>⋮</mi>       </mtd><mtd class='array-td' columnalign='center'> <mo class='MathClass-rel' stretchy='false'>⋱</mo> </mtd><mtd class='array-td' columnalign='center'>        <mi>⋮</mi>        </mtd></mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'> </mtd></mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'> </mtd>
</mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'> <mn>1</mn> </mtd><mtd class='array-td' columnalign='center'> <mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><msub><mrow><mi>J</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mfrac><mrow><mi>n</mi></mrow>
<mrow><mn>2</mn></mrow></mfrac> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo> </mtd><mtd class='array-td' columnalign='center'> <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><msub><mrow><mi>J</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mfrac><mrow><mi>n</mi></mrow>
<mrow><mn>2</mn></mrow></mfrac> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>2</mn></mrow></msup>  </mtd><mtd class='array-td' columnalign='center'>  <mo class='MathClass-rel' stretchy='false'>⋯</mo> </mtd><mtd class='array-td' columnalign='center'> <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><msub><mrow><mi>J</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mfrac><mrow><mi>n</mi></mrow>
<mrow><mn>2</mn></mrow></mfrac> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msup>  </mtd>
</mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'>      </mtd></mtr>  <!-- *\c@MaxMatrixCols c --></mtable>                                                                                                                                                 </mrow><mo fence='true' form='postfix'>]</mo></mrow> </mrow></math>
</p><!-- l. 217 --><p class='noindent'><!-- l. 217 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 219 --><p class='noindent'><!-- l. 219 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo>  <mrow><mo fence='true' form='prefix'>[</mo><mrow><mtable align='axis' class='array' columnlines='none none none none none none none none none' displaystyle='true' equalcolumns='false' equalrows='false' rowlines='none none none none none none none none none none none none none none none none none none none none none none none none none none none none' style=''> <mtr class='array-row'><mtd class='array-td' columnalign='center'> <mn>1</mn> </mtd><mtd class='array-td' columnalign='center'>   <mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mn>0</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo>   </mtd><mtd class='array-td' columnalign='center'>   <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mn>0</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>2</mn></mrow></msup>    </mtd><mtd class='array-td' columnalign='center'>  <mo class='MathClass-rel' stretchy='false'>⋯</mo> </mtd><mtd class='array-td' columnalign='center'>   <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mn>0</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msup>    </mtd></mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'> </mtd></mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'> </mtd>
</mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'>  <mn>1</mn> </mtd><mtd class='array-td' columnalign='center'>   <mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo>   </mtd><mtd class='array-td' columnalign='center'>   <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>2</mn></mrow></msup>    </mtd><mtd class='array-td' columnalign='center'>  <mo class='MathClass-rel' stretchy='false'>⋯</mo> </mtd><mtd class='array-td' columnalign='center'>   <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msup>    </mtd></mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'> </mtd></mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'> </mtd>
</mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'>  <mn>1</mn> </mtd><mtd class='array-td' columnalign='center'>   <mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo>   </mtd><mtd class='array-td' columnalign='center'>   <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>2</mn></mrow></msup>    </mtd><mtd class='array-td' columnalign='center'>  <mo class='MathClass-rel' stretchy='false'>⋯</mo> </mtd><mtd class='array-td' columnalign='center'>   <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msup>    </mtd></mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'> </mtd></mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'> </mtd>
</mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'>  <mi>⋮</mi> </mtd><mtd class='array-td' columnalign='center'>      <mi>⋮</mi>      </mtd><mtd class='array-td' columnalign='center'>      <mi>⋮</mi>      </mtd><mtd class='array-td' columnalign='center'> <mo class='MathClass-rel' stretchy='false'>⋱</mo> </mtd><mtd class='array-td' columnalign='center'>        <mi>⋮</mi>        </mtd></mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'> </mtd></mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'> </mtd>
</mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'> <mn>1</mn> </mtd><mtd class='array-td' columnalign='center'> <mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mfrac><mrow><mi>n</mi></mrow>
<mrow><mn>2</mn></mrow></mfrac> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo> </mtd><mtd class='array-td' columnalign='center'> <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mfrac><mrow><mi>n</mi></mrow>
<mrow><mn>2</mn></mrow></mfrac> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>2</mn></mrow></msup>  </mtd><mtd class='array-td' columnalign='center'>  <mo class='MathClass-rel' stretchy='false'>⋯</mo> </mtd><mtd class='array-td' columnalign='center'> <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mfrac><mrow><mi>n</mi></mrow>
<mrow><mn>2</mn></mrow></mfrac> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msup>  </mtd>
</mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'>      </mtd></mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'></mtd>
</mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'>  <mn>1</mn> </mtd><mtd class='array-td' columnalign='center'>   <mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mover accent='false' class='mml-overline'><mrow><mi>ω</mi></mrow><mo accent='true'>¯</mo></mover></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mn>0</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo>   </mtd><mtd class='array-td' columnalign='center'>   <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mover accent='false' class='mml-overline'><mrow><mi>ω</mi></mrow><mo accent='true'>¯</mo></mover></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mn>0</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>2</mn></mrow></msup>    </mtd><mtd class='array-td' columnalign='center'>  <mo class='MathClass-rel' stretchy='false'>⋯</mo> </mtd><mtd class='array-td' columnalign='center'>   <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mover accent='false' class='mml-overline'><mrow><mi>ω</mi></mrow><mo accent='true'>¯</mo></mover></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mn>0</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msup>    </mtd></mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'> </mtd></mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'> </mtd>
</mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'>  <mn>1</mn> </mtd><mtd class='array-td' columnalign='center'>   <mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mover accent='false' class='mml-overline'><mrow><mi>ω</mi></mrow><mo accent='true'>¯</mo></mover></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo>   </mtd><mtd class='array-td' columnalign='center'>   <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mover accent='false' class='mml-overline'><mrow><mi>ω</mi></mrow><mo accent='true'>¯</mo></mover></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>2</mn></mrow></msup>    </mtd><mtd class='array-td' columnalign='center'>  <mo class='MathClass-rel' stretchy='false'>⋯</mo> </mtd><mtd class='array-td' columnalign='center'>   <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mover accent='false' class='mml-overline'><mrow><mi>ω</mi></mrow><mo accent='true'>¯</mo></mover></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msup>    </mtd></mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'> </mtd></mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'> </mtd>
</mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'>  <mn>1</mn> </mtd><mtd class='array-td' columnalign='center'>   <mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mover accent='false' class='mml-overline'><mrow><mi>ω</mi></mrow><mo accent='true'>¯</mo></mover></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo>   </mtd><mtd class='array-td' columnalign='center'>   <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mover accent='false' class='mml-overline'><mrow><mi>ω</mi></mrow><mo accent='true'>¯</mo></mover></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>2</mn></mrow></msup>    </mtd><mtd class='array-td' columnalign='center'>  <mo class='MathClass-rel' stretchy='false'>⋯</mo> </mtd><mtd class='array-td' columnalign='center'>   <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mover accent='false' class='mml-overline'><mrow><mi>ω</mi></mrow><mo accent='true'>¯</mo></mover></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msup>    </mtd></mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'> </mtd></mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'> </mtd>
</mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'>  <mi>⋮</mi> </mtd><mtd class='array-td' columnalign='center'>      <mi>⋮</mi>      </mtd><mtd class='array-td' columnalign='center'>      <mi>⋮</mi>      </mtd><mtd class='array-td' columnalign='center'> <mo class='MathClass-rel' stretchy='false'>⋱</mo> </mtd><mtd class='array-td' columnalign='center'>        <mi>⋮</mi>        </mtd></mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'> </mtd></mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'> </mtd>
</mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'> <mn>1</mn> </mtd><mtd class='array-td' columnalign='center'> <mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mover accent='false' class='mml-overline'><mrow><mi>ω</mi></mrow><mo accent='true'>¯</mo></mover></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mfrac><mrow><mi>n</mi></mrow>
<mrow><mn>2</mn></mrow></mfrac> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo> </mtd><mtd class='array-td' columnalign='center'> <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mover accent='false' class='mml-overline'><mrow><mi>ω</mi></mrow><mo accent='true'>¯</mo></mover></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mfrac><mrow><mi>n</mi></mrow>
<mrow><mn>2</mn></mrow></mfrac> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>2</mn></mrow></msup>  </mtd><mtd class='array-td' columnalign='center'>  <mo class='MathClass-rel' stretchy='false'>⋯</mo> </mtd><mtd class='array-td' columnalign='center'> <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mover accent='false' class='mml-overline'><mrow><mi>ω</mi></mrow><mo accent='true'>¯</mo></mover></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mfrac><mrow><mi>n</mi></mrow>
<mrow><mn>2</mn></mrow></mfrac> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msup>  </mtd>
</mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'>      </mtd></mtr>  <!-- *\c@MaxMatrixCols c --></mtable>                                                                                                                                                 </mrow><mo fence='true' form='postfix'>]</mo></mrow> </mrow></math>
</p><!-- l. 232 --><p class='noindent'><!-- l. 232 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 234 --><p class='noindent'><!-- l. 234 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 236 --><p class='noindent'>, and extract only the first <!-- l. 236 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mstyle displaystyle='true'><mfrac><mrow><mi>n</mi>
</mrow><mrow><mn>2</mn></mrow></mfrac></mstyle></math>
elements in the <span class='rm-lmri-10x-x-109'>forward-ordered  </span>Hermitian vector
<!-- l. 236 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mover accent='true'><mrow><mi>v</mi></mrow><mo accent='true'>→</mo></mover></mrow><mrow><msup><mrow></mrow><mrow><mi>′</mi></mrow></msup></mrow></msub></math> to recover the
input vector <!-- l. 236 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mover accent='true'><mrow><mi>v</mi></mrow><mo accent='true'>→</mo></mover></math>.
</p>
 
</div> 
</div>
<!-- l. 259 --><p class='noindent'><span class='rm-lmbx-10x-x-109'>CKKS’s Approximation Property: </span>In the encoding process, when we convert              
                                                                                         
<!-- l. 259 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mover accent='true'><mrow><mi>v</mi></mrow><mo accent='true'>→</mo></mover></mrow><mrow><msup><mrow></mrow><mrow><mi>′</mi>
 </mrow></msup></mrow></msub> <mo class='MathClass-rel' stretchy='false'>→</mo><mover accent='true'><mrow><mi>m</mi></mrow><mo accent='true'>→</mo></mover> <mo class='MathClass-rel' stretchy='false'>→</mo><mi mathvariant='normal'>Δ</mi><mover accent='true'><mrow><mi>m</mi></mrow><mo accent='true'>→</mo></mover></mrow></math>, we
multiply <!-- l. 259 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mover accent='true'><mrow><mi>v</mi></mrow><mo accent='true'>→</mo></mover></mrow><mrow><msup><mrow></mrow><mrow><mi>′</mi></mrow></msup></mrow></msub></math> by
<!-- l. 259 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>W</mi></math> which contains real numbers
with infinite decimals (e.g., <!-- l. 259 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msqrt><mrow><mn>2</mn></mrow></msqrt></math>)
coming from Euler’s formula, which we should round to the nearest integer by computing
<!-- l. 259 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>⌈</mo><mi mathvariant='normal'>Δ</mi><mi>m</mi><mo class='MathClass-close' stretchy='false'>⌋</mo></mrow></math> (which we
will denote as <!-- l. 259 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi mathvariant='normal'>Δ</mi><mi>m</mi></mrow></math>
throughout this section for simplicity) and thus we lose some precision. This implies that if we later
decode <!-- l. 259 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi mathvariant='normal'>Δ</mi><mover accent='true'><mrow><mi>m</mi></mrow><mo accent='true'>→</mo></mover></mrow></math>
into <!-- l. 259 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mover accent='true'><mrow><mi>v</mi></mrow><mo accent='true'>→</mo></mover></mrow><mrow><msup><mrow></mrow><mrow><mi>′</mi></mrow></msup><mi>d</mi></mrow></msub></math>,
this value would be slightly different from the original input vector
<!-- l. 259 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mover accent='true'><mrow><mi>v</mi></mrow><mo accent='true'>→</mo></mover></mrow><mrow><msup><mrow></mrow><mrow><mi>′</mi>
 </mrow></msup></mrow></msub></math>. As
CKKS’s encoding scheme is subject to such a small rounding error, the decryption does not
perfectly match the original input vector. Such errors also propagate across homomorphic
computations, because those computations are done based on approximately encoded plaintext
<!-- l. 259 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>⌈</mo><mi mathvariant='normal'>Δ</mi><mover accent='true'><mrow><mi>m</mi></mrow><mo accent='true'>→</mo></mover><mo class='MathClass-close' stretchy='false'>⌋</mo></mrow></math>.
As these errors are caused by throwing away the infinitely long decimal digits, they can
be corrected during the decoding process only if we use an infinitely big scaling factor
<!-- l. 259 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi mathvariant='normal'>Δ</mi></math>, which is impossible because
<!-- l. 259 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi mathvariant='normal'>Δ</mi><msub><mrow><mi>m</mi></mrow><mrow><mi>i</mi></mrow></msub></mrow></math> should not overflow the
ciphertext modulus <!-- l. 259 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>q</mi></mrow><mrow><mn>0</mn></mrow></msub></math>
of the lowest multiplicative level. Due to this limitation, CKKS is considered an <span class='rm-lmri-10x-x-109'>approximate</span>
homomorphic encryption.
   
</p>
   <h5 class='subsubsectionHead' id='example6'><span class='titlemark'>D-3.1.1   </span> <a id='x118-175000D-3.1.1'></a>Example</h5>
<!-- l. 266 --><p class='noindent'>Suppose our input complex vector’s dimension <!-- l. 266 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mstyle displaystyle='true'><mfrac><mrow><mi>n</mi>
</mrow><mrow><mn>2</mn></mrow></mfrac></mstyle> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>2</mn></mrow></math>,
the bounding polynomial degree <!-- l. 266 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>n</mi></math>
= 4, the scaling factor <!-- l. 266 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi mathvariant='normal'>Δ</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>1024</mn></mrow></math>.
</p><!-- l. 268 --><p class='indent'>   Our basis of the <!-- l. 268 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>n</mi></math>-dimensional
vector space
</p><!-- l. 270 --><p class='indent'>   <!-- l. 270 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>W</mi> <mo class='MathClass-rel' stretchy='false'>=</mo>  <mrow><mo fence='true' form='prefix'>[</mo><mrow><mtable align='axis' class='array' columnlines='none none none none none none none none none' displaystyle='true' equalcolumns='false' equalrows='false' rowlines='none none none none none none none none none none' style=''> <mtr class='array-row'><mtd class='array-td' columnalign='center'>      <mn>1</mn>      </mtd><mtd class='array-td' columnalign='center'>      <mn>1</mn>      </mtd><mtd class='array-td' columnalign='center'>      <mn>1</mn>      </mtd><mtd class='array-td' columnalign='center'>      <mn>1</mn>      </mtd></mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'> </mtd></mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'> </mtd>
</mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'>   <msup><mrow><mi>ω</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup>    </mtd><mtd class='array-td' columnalign='center'>    <msup><mrow><mi>ω</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mn>0</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup>    </mtd><mtd class='array-td' columnalign='center'><msup><mrow>    <mover accent='false' class='mml-overline'><mrow><mi>ω</mi></mrow><mo accent='true'>¯</mo></mover></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup>    </mtd><mtd class='array-td' columnalign='center'><msup><mrow>    <mover accent='false' class='mml-overline'><mrow><mi>ω</mi></mrow><mo accent='true'>¯</mo></mover></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mn>0</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup>    </mtd></mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'> </mtd></mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'> </mtd>
</mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'>  <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>2</mn></mrow></msup>  </mtd><mtd class='array-td' columnalign='center'>  <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mn>0</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>2</mn></mrow></msup>  </mtd><mtd class='array-td' columnalign='center'>  <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mover accent='false' class='mml-overline'><mrow><mi>ω</mi></mrow><mo accent='true'>¯</mo></mover></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>2</mn></mrow></msup>  </mtd><mtd class='array-td' columnalign='center'>  <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mover accent='false' class='mml-overline'><mrow><mi>ω</mi></mrow><mo accent='true'>¯</mo></mover></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mn>0</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>2</mn></mrow></msup>  </mtd></mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'> </mtd></mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'> </mtd>
</mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'>  <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>3</mn></mrow></msup>  </mtd><mtd class='array-td' columnalign='center'>  <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mn>0</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>3</mn></mrow></msup>  </mtd><mtd class='array-td' columnalign='center'>  <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mover accent='false' class='mml-overline'><mrow><mi>ω</mi></mrow><mo accent='true'>¯</mo></mover></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>3</mn></mrow></msup>  </mtd><mtd class='array-td' columnalign='center'>  <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mover accent='false' class='mml-overline'><mrow><mi>ω</mi></mrow><mo accent='true'>¯</mo></mover></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mn>0</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>3</mn></mrow></msup>  </mtd></mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'> </mtd></mtr>   <!-- *\c@MaxMatrixCols c --></mtable>                                                                                               </mrow><mo fence='true' form='postfix'>]</mo></mrow> </mrow></math>
<!-- l. 276 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo>  <mrow><mo fence='true' form='prefix'>[</mo><mrow><mtable align='axis' class='array' columnlines='none none none none none none none none none' displaystyle='true' equalcolumns='false' equalrows='false' rowlines='none none none none none none none none none none' style=''> <mtr class='array-row'><mtd class='array-td' columnalign='center'>  <mn>1</mn>  </mtd><mtd class='array-td' columnalign='center'>  <mn>1</mn>  </mtd><mtd class='array-td' columnalign='center'>  <mn>1</mn>  </mtd><mtd class='array-td' columnalign='center'>  <mn>1</mn>  </mtd></mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'> </mtd></mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'> </mtd>
</mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'> <msup><mrow><mi>ω</mi></mrow><mrow><mn>5</mn></mrow></msup>  </mtd><mtd class='array-td' columnalign='center'>   <mi>ω</mi>  </mtd><mtd class='array-td' columnalign='center'><msup><mrow> <mover accent='false' class='mml-overline'><mrow><mi>ω</mi></mrow><mo accent='true'>¯</mo></mover></mrow><mrow><mn>5</mn></mrow></msup>  </mtd><mtd class='array-td' columnalign='center'>   <mover accent='false' class='mml-overline'><mrow><mi>ω</mi></mrow><mo accent='true'>¯</mo></mover>  </mtd></mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'> </mtd></mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'> </mtd>
</mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'> <msup><mrow><mi>ω</mi></mrow><mrow><mn>2</mn></mrow></msup>  </mtd><mtd class='array-td' columnalign='center'>  <msup><mrow><mi>ω</mi></mrow><mrow><mn>2</mn></mrow></msup>  </mtd><mtd class='array-td' columnalign='center'>  <mover accent='false' class='mml-overline'><mrow><msup><mrow><mi>ω</mi></mrow><mrow><mn>2</mn></mrow></msup></mrow><mo accent='true'>¯</mo></mover>  </mtd><mtd class='array-td' columnalign='center'><msup><mrow>  <mover accent='false' class='mml-overline'><mrow><mi>ω</mi></mrow><mo accent='true'>¯</mo></mover></mrow><mrow><mn>2</mn></mrow></msup>  </mtd></mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'> </mtd></mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'> </mtd>
</mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'>  <msup><mrow><mi>ω</mi></mrow><mrow><mn>7</mn></mrow></msup>  </mtd><mtd class='array-td' columnalign='center'>  <msup><mrow><mi>ω</mi></mrow><mrow><mn>3</mn></mrow></msup>  </mtd><mtd class='array-td' columnalign='center'><msup><mrow>  <mover accent='false' class='mml-overline'><mrow><mi>ω</mi></mrow><mo accent='true'>¯</mo></mover></mrow><mrow><mn>7</mn></mrow></msup>  </mtd><mtd class='array-td' columnalign='center'><msup><mrow>  <mover accent='false' class='mml-overline'><mrow><mi>ω</mi></mrow><mo accent='true'>¯</mo></mover></mrow><mrow><mn>3</mn></mrow></msup>  </mtd></mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'> </mtd></mtr>   <!-- *\c@MaxMatrixCols c --></mtable>                                                                                                                                   </mrow><mo fence='true' form='postfix'>]</mo></mrow> </mrow></math>
</p><!-- l. 283 --><p class='indent'>   , where <!-- l. 283 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>ω</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <msup><mrow><mi>e</mi></mrow><mrow><mi mathvariant='italic'>𝑖𝜋</mi><mo class='MathClass-bin' stretchy='false'>∕</mo><mi>n</mi></mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo> <mi class='loglike'>cos</mi><mo>⁡<!-- FUNCTION APPLICATION --></mo><!-- nolimits --> <mrow><mo fence='true' form='prefix'>(</mo><mrow><mstyle displaystyle='true'><mfrac><mrow><mi>π</mi>
</mrow><mrow><mi>n</mi></mrow></mfrac></mstyle></mrow><mo fence='true' form='postfix'>)</mo></mrow> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>i</mi><mstyle><mi class='loglike'>sin</mi><mo>⁡<!-- FUNCTION APPLICATION --></mo></mstyle><!-- nolimits --> <mrow><mo fence='true' form='prefix'>(</mo><mrow><mstyle displaystyle='true'><mfrac><mrow><mi>π</mi>
</mrow><mrow><mi>n</mi></mrow></mfrac></mstyle></mrow><mo fence='true' form='postfix'>)</mo></mrow></mrow></math>
</p><!-- l. 285 --><p class='indent'>   <!-- l. 285 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 288 --><p class='indent'>   Given this setup, suppose we have the input complex vector
<!-- l. 288 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mover accent='true'><mrow><mi>v</mi></mrow><mo accent='true'>→</mo></mover> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>(</mo><mn>1.1</mn> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>4.3</mn><mi>i</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><mn>3.5</mn> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1.4</mn><mi>i</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math> to
encode.
</p><!-- l. 290 --><p class='indent'>   <!-- l. 290 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
                                                                                         
                                                                                         
</p><!-- l. 292 --><p class='indent'>   First, construct the forward-ordered Hermitian vector
<!-- l. 292 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mover accent='true'><mrow><mi>v</mi></mrow><mo accent='true'>→</mo></mover></mrow><mrow><msup><mrow></mrow><mrow><mi>′</mi>
 </mrow></msup></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>(</mo><mn>1.1</mn> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>4.3</mn><mi>i</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><mn>3.5</mn> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1.4</mn><mi>i</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><mn>1.1</mn> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>4.3</mn><mi>i</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><mn>3.5</mn> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>1.4</mn><mi>i</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>.
</p><!-- l. 294 --><p class='indent'>   <!-- l. 294 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 296 --><p class='indent'>   Next, convert the complex vector <!-- l. 296 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mover accent='true'><mrow><mi>v</mi></mrow><mo accent='true'>→</mo></mover></mrow><mrow><msup><mrow></mrow><mrow><mi>′</mi></mrow></msup></mrow></msub></math>
into a real number vector <!-- l. 296 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mover accent='true'><mrow><mi>m</mi></mrow><mo accent='true'>→</mo></mover></math>
by applying the transformation:
</p><!-- l. 299 --><p class='indent'>   <!-- l. 299 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mover accent='true'><mrow><mi>m</mi></mrow><mo accent='true'>→</mo></mover> <mo class='MathClass-rel' stretchy='false'>=</mo> <mstyle displaystyle='true'><mfrac><mrow><mover accent='true'><mrow><mi>Ŵ</mi></mrow><mo accent='true'>^</mo></mover> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msubsup><mrow><mi>I</mi></mrow><mrow><mi>n</mi></mrow><mrow><mi>R</mi></mrow></msubsup> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msub><mrow><mover accent='true'><mrow><mi>v</mi></mrow><mo accent='true'>→</mo></mover></mrow><mrow><msup><mrow></mrow><mrow><mi>′</mi></mrow></msup></mrow></msub>
       </mrow><mrow><mi>n</mi>       </mrow></mfrac></mstyle> <mo class='MathClass-rel' stretchy='false'>=</mo> <mstyle displaystyle='true'><mfrac><mrow><mn>1</mn>
</mrow><mrow><mn>4</mn></mrow></mfrac></mstyle><mo class='MathClass-bin' stretchy='false'>⋅</mo><mrow><mo fence='true' form='prefix'>[</mo><mrow><mtable align='axis' class='array' columnlines='none none none none none none none none none' displaystyle='true' equalcolumns='false' equalrows='false' rowlines='none none none none none none none none none none' style=''><mtr class='array-row'><mtd class='array-td' columnalign='center'> <mn>1</mn>  </mtd><mtd class='array-td' columnalign='center'>  <mn>1</mn>  </mtd><mtd class='array-td' columnalign='center'>  <mn>1</mn>  </mtd><mtd class='array-td' columnalign='center'>  <mn>1</mn>  </mtd></mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'> </mtd></mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'> </mtd>
</mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'> <msup><mrow><mi>ω</mi></mrow><mrow><mn>5</mn></mrow></msup>  </mtd><mtd class='array-td' columnalign='center'>   <mi>ω</mi>  </mtd><mtd class='array-td' columnalign='center'><msup><mrow> <mover accent='false' class='mml-overline'><mrow><mi>ω</mi></mrow><mo accent='true'>¯</mo></mover></mrow><mrow><mn>5</mn></mrow></msup>  </mtd><mtd class='array-td' columnalign='center'>   <mover accent='false' class='mml-overline'><mrow><mi>ω</mi></mrow><mo accent='true'>¯</mo></mover>  </mtd></mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'> </mtd></mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'> </mtd>
</mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'> <msup><mrow><mi>ω</mi></mrow><mrow><mn>2</mn></mrow></msup>  </mtd><mtd class='array-td' columnalign='center'>  <msup><mrow><mi>ω</mi></mrow><mrow><mn>2</mn></mrow></msup>  </mtd><mtd class='array-td' columnalign='center'><msup><mrow>  <mover accent='false' class='mml-overline'><mrow><mi>ω</mi></mrow><mo accent='true'>¯</mo></mover></mrow><mrow><mn>2</mn></mrow></msup>  </mtd><mtd class='array-td' columnalign='center'><msup><mrow>  <mover accent='false' class='mml-overline'><mrow><mi>ω</mi></mrow><mo accent='true'>¯</mo></mover></mrow><mrow><mn>2</mn></mrow></msup>  </mtd></mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'> </mtd></mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'> </mtd>
</mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'>  <msup><mrow><mi>ω</mi></mrow><mrow><mn>7</mn></mrow></msup>  </mtd><mtd class='array-td' columnalign='center'>  <msup><mrow><mi>ω</mi></mrow><mrow><mn>3</mn></mrow></msup>  </mtd><mtd class='array-td' columnalign='center'><msup><mrow>  <mover accent='false' class='mml-overline'><mrow><mi>ω</mi></mrow><mo accent='true'>¯</mo></mover></mrow><mrow><mn>7</mn></mrow></msup>  </mtd><mtd class='array-td' columnalign='center'><msup><mrow>  <mover accent='false' class='mml-overline'><mrow><mi>ω</mi></mrow><mo accent='true'>¯</mo></mover></mrow><mrow><mn>3</mn></mrow></msup>  </mtd></mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'> </mtd></mtr>   <!-- *\c@MaxMatrixCols c --></mtable>                                                                                                                                   </mrow><mo fence='true' form='postfix'>]</mo></mrow> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mrow><mo fence='true' form='prefix'>[</mo><mrow><mtable align='axis' class='array' columnlines='none none none none none none none none none' displaystyle='true' equalcolumns='false' equalrows='false' rowlines='none none none none none none none none' style=''><mtr class='array-row'><mtd class='array-td' columnalign='center'> <mn>0</mn> </mtd><mtd class='array-td' columnalign='center'> <mn>0</mn> </mtd><mtd class='array-td' columnalign='center'> <mn>0</mn> </mtd><mtd class='array-td' columnalign='center'> <mn>1</mn> </mtd></mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'> </mtd></mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'> </mtd></mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'> <mn>0</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>0</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>1</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>0</mn></mtd></mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'> </mtd></mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'> </mtd>
</mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'> <mn>0</mn> </mtd><mtd class='array-td' columnalign='center'> <mn>1</mn> </mtd><mtd class='array-td' columnalign='center'> <mn>0</mn> </mtd><mtd class='array-td' columnalign='center'> <mn>0</mn> </mtd></mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'> </mtd></mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'> </mtd></mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'> <mn>1</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>0</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>0</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>0</mn></mtd></mtr> <!-- *\c@MaxMatrixCols c --></mtable>                                                                                                             </mrow><mo fence='true' form='postfix'>]</mo></mrow><mo class='MathClass-bin' stretchy='false'>⋅</mo><mrow><mo fence='true' form='prefix'>[</mo><mrow><mtable align='axis' class='array' columnlines='none none none none none none none none none' displaystyle='true' equalcolumns='false' equalrows='false' rowlines='none none none none none none none none' style=''><mtr class='array-row'><mtd class='array-td' columnalign='center'> <mn>1.1</mn> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>4.3</mn><mi>i</mi> </mtd></mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'></mtd></mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'></mtd>
</mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'> <mn>3.5</mn> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1.4</mn><mi>i</mi> </mtd></mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'></mtd></mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'></mtd>
</mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'> <mn>1.1</mn> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>4.3</mn><mi>i</mi> </mtd></mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'></mtd></mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'></mtd>
</mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'> <mn>3.5</mn> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>1.4</mn><mi>i</mi> </mtd></mtr> <!-- *\c@MaxMatrixCols c --></mtable>                                                                                              </mrow><mo fence='true' form='postfix'>]</mo></mrow></mrow></math>
</p><!-- l. 314 --><p class='indent'>   <!-- l. 314 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 316 --><p class='indent'>   <!-- l. 316 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo> <mstyle displaystyle='true'><mfrac><mrow><mi>W</mi> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msubsup><mrow><mi>I</mi></mrow><mrow><mi>n</mi></mrow><mrow><mi>R</mi></mrow></msubsup> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msub><mrow><mover accent='true'><mrow><mi>v</mi></mrow><mo accent='true'>→</mo></mover></mrow><mrow><msup><mrow></mrow><mrow><mi>′</mi></mrow></msup></mrow></msub>
      </mrow><mrow><mi>n</mi>       </mrow></mfrac></mstyle> <mo class='MathClass-rel' stretchy='false'>=</mo> <mstyle displaystyle='true'><mfrac><mrow><mn>1</mn>
</mrow><mrow><mn>4</mn></mrow></mfrac></mstyle><mo class='MathClass-bin' stretchy='false'>⋅</mo><mrow><mo fence='true' form='prefix'>[</mo><mrow><mtable align='axis' class='array' columnlines='none none none none none none none none none' displaystyle='true' equalcolumns='false' equalrows='false' rowlines='none none none none none none none none none none' style=''><mtr class='array-row'><mtd class='array-td' columnalign='center'> <mn>1</mn>  </mtd><mtd class='array-td' columnalign='center'>  <mn>1</mn>  </mtd><mtd class='array-td' columnalign='center'>  <mn>1</mn>  </mtd><mtd class='array-td' columnalign='center'>  <mn>1</mn>  </mtd></mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'> </mtd></mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'> </mtd>
</mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'>  <mover accent='false' class='mml-overline'><mrow><mi>ω</mi></mrow><mo accent='true'>¯</mo></mover>  </mtd><mtd class='array-td' columnalign='center'><msup><mrow> <mover accent='false' class='mml-overline'><mrow><mi>ω</mi></mrow><mo accent='true'>¯</mo></mover></mrow><mrow><mn>5</mn></mrow></msup>  </mtd><mtd class='array-td' columnalign='center'>   <mi>ω</mi>  </mtd><mtd class='array-td' columnalign='center'> <msup><mrow><mi>ω</mi></mrow><mrow><mn>5</mn></mrow></msup>  </mtd></mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'> </mtd></mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'> </mtd>
</mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'><msup><mrow>  <mover accent='false' class='mml-overline'><mrow><mi>ω</mi></mrow><mo accent='true'>¯</mo></mover></mrow><mrow><mn>2</mn></mrow></msup>  </mtd><mtd class='array-td' columnalign='center'><msup><mrow>  <mover accent='false' class='mml-overline'><mrow><mi>ω</mi></mrow><mo accent='true'>¯</mo></mover></mrow><mrow><mn>2</mn></mrow></msup>  </mtd><mtd class='array-td' columnalign='center'>  <msup><mrow><mi>ω</mi></mrow><mrow><mn>2</mn></mrow></msup>  </mtd><mtd class='array-td' columnalign='center'>  <msup><mrow><mi>ω</mi></mrow><mrow><mn>2</mn></mrow></msup>  </mtd></mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'> </mtd></mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'> </mtd>
</mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'><msup><mrow>  <mover accent='false' class='mml-overline'><mrow><mi>ω</mi></mrow><mo accent='true'>¯</mo></mover></mrow><mrow><mn>3</mn></mrow></msup>  </mtd><mtd class='array-td' columnalign='center'><msup><mrow>  <mover accent='false' class='mml-overline'><mrow><mi>ω</mi></mrow><mo accent='true'>¯</mo></mover></mrow><mrow><mn>7</mn></mrow></msup>  </mtd><mtd class='array-td' columnalign='center'>  <msup><mrow><mi>ω</mi></mrow><mrow><mn>3</mn></mrow></msup>  </mtd><mtd class='array-td' columnalign='center'>  <msup><mrow><mi>ω</mi></mrow><mrow><mn>7</mn></mrow></msup>  </mtd></mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'> </mtd></mtr>   <!-- *\c@MaxMatrixCols c --></mtable>                                                                                                                                   </mrow><mo fence='true' form='postfix'>]</mo></mrow> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mrow><mo fence='true' form='prefix'>[</mo><mrow><mtable align='axis' class='array' columnlines='none none none none none none none none none' displaystyle='true' equalcolumns='false' equalrows='false' rowlines='none none none none none none none none' style=''><mtr class='array-row'><mtd class='array-td' columnalign='center'> <mn>1.1</mn> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>4.3</mn><mi>i</mi> </mtd></mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'></mtd></mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'></mtd>
</mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'> <mn>3.5</mn> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1.4</mn><mi>i</mi> </mtd></mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'></mtd></mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'></mtd>
</mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'> <mn>1.1</mn> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>4.3</mn><mi>i</mi> </mtd></mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'></mtd></mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'></mtd>
</mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'> <mn>3.5</mn> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>1.4</mn><mi>i</mi> </mtd></mtr> <!-- *\c@MaxMatrixCols c --></mtable>                                                                                              </mrow><mo fence='true' form='postfix'>]</mo></mrow></mrow></math>
</p><!-- l. 325 --><p class='indent'>   <!-- l. 325 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 327 --><p class='indent'>   <!-- l. 327 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo> <mstyle displaystyle='true'><mfrac><mrow><mn>1</mn>
</mrow><mrow><mn>4</mn></mrow></mfrac></mstyle> <mo class='MathClass-bin' stretchy='false'>⋅</mo> <mrow><mo fence='true' form='prefix'>[</mo><mrow><mtable align='axis' class='array' columnlines='none none none none none none none none none' displaystyle='true' equalcolumns='false' equalrows='false' rowlines='none none none none none none none none none none' style=''><mtr class='array-row'><mtd class='array-td' columnalign='center'>     <mo class='MathClass-open' stretchy='false'>(</mo><mn>1.1</mn> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>4.3</mn><mi>i</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>+</mo> <mo class='MathClass-open' stretchy='false'>(</mo><mn>3.5</mn> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1.4</mn><mi>i</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>+</mo> <mo class='MathClass-open' stretchy='false'>(</mo><mn>1.1</mn> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>4.3</mn><mi>i</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>+</mo> <mo class='MathClass-open' stretchy='false'>(</mo><mn>3.5</mn> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>1.4</mn><mi>i</mi><mo class='MathClass-close' stretchy='false'>)</mo>        </mtd></mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'></mtd></mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'></mtd>
</mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'>   <mo class='MathClass-open' stretchy='false'>(</mo><mn>1.1</mn> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>4.3</mn><mi>i</mi><mo class='MathClass-close' stretchy='false'>)</mo><mover accent='false' class='mml-overline'><mrow><mi>ω</mi></mrow><mo accent='true'>¯</mo></mover> <mo class='MathClass-bin' stretchy='false'>+</mo> <mo class='MathClass-open' stretchy='false'>(</mo><mn>3.5</mn> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1.4</mn><mi>i</mi><mo class='MathClass-close' stretchy='false'>)</mo><msup><mrow><mover accent='false' class='mml-overline'><mrow><mi>ω</mi></mrow><mo accent='true'>¯</mo></mover></mrow><mrow><mn>5</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <mo class='MathClass-open' stretchy='false'>(</mo><mn>1.1</mn> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>4.3</mn><mi>i</mi><mo class='MathClass-close' stretchy='false'>)</mo><mi>ω</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mo class='MathClass-open' stretchy='false'>(</mo><mn>3.5</mn> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>1.4</mn><mi>i</mi><mo class='MathClass-close' stretchy='false'>)</mo><msup><mrow><mi>ω</mi></mrow><mrow><mn>5</mn></mrow></msup>   </mtd></mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'></mtd></mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'></mtd>
</mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'>  <mo class='MathClass-open' stretchy='false'>(</mo><mn>1.1</mn> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>4.3</mn><mi>i</mi><mo class='MathClass-close' stretchy='false'>)</mo><mover accent='false' class='mml-overline'><mrow><msup><mrow><mi>ω</mi></mrow><mrow><mn>2</mn></mrow></msup></mrow><mo accent='true'>¯</mo></mover> <mo class='MathClass-bin' stretchy='false'>+</mo> <mo class='MathClass-open' stretchy='false'>(</mo><mn>3.5</mn> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1.4</mn><mi>i</mi><mo class='MathClass-close' stretchy='false'>)</mo><mover accent='false' class='mml-overline'><mrow><msup><mrow><mi>ω</mi></mrow><mrow><mn>2</mn></mrow></msup></mrow><mo accent='true'>¯</mo></mover> <mo class='MathClass-bin' stretchy='false'>+</mo> <mo class='MathClass-open' stretchy='false'>(</mo><mn>1.1</mn> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>4.3</mn><mi>i</mi><mo class='MathClass-close' stretchy='false'>)</mo><msup><mrow><mi>ω</mi></mrow><mrow><mn>2</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <mo class='MathClass-open' stretchy='false'>(</mo><mn>3.5</mn> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>1.4</mn><mi>i</mi><mo class='MathClass-close' stretchy='false'>)</mo><msup><mrow><mi>ω</mi></mrow><mrow><mn>2</mn></mrow></msup>  </mtd></mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'></mtd></mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'></mtd>
</mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'>  <mo class='MathClass-open' stretchy='false'>(</mo><mn>1.1</mn> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>4.3</mn><mi>i</mi><mo class='MathClass-close' stretchy='false'>)</mo><msup><mrow><mover accent='false' class='mml-overline'><mrow><mi>ω</mi></mrow><mo accent='true'>¯</mo></mover></mrow><mrow><mn>3</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <mo class='MathClass-open' stretchy='false'>(</mo><mn>3.5</mn> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1.4</mn><mi>i</mi><mo class='MathClass-close' stretchy='false'>)</mo><msup><mrow><mover accent='false' class='mml-overline'><mrow><mi>ω</mi></mrow><mo accent='true'>¯</mo></mover></mrow><mrow><mn>7</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <mo class='MathClass-open' stretchy='false'>(</mo><mn>1.1</mn> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>4.3</mn><mi>i</mi><mo class='MathClass-close' stretchy='false'>)</mo><msup><mrow><mi>ω</mi></mrow><mrow><mn>3</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <mo class='MathClass-open' stretchy='false'>(</mo><mn>3.5</mn> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>1.4</mn><mi>i</mi><mo class='MathClass-close' stretchy='false'>)</mo><msup><mrow><mi>ω</mi></mrow><mrow><mn>7</mn></mrow></msup>  </mtd></mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'></mtd></mtr>   <!-- *\c@MaxMatrixCols c --></mtable>                                                    </mrow><mo fence='true' form='postfix'>]</mo></mrow> </mrow></math>
</p><!-- l. 335 --><p class='indent'>   <!-- l. 335 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 337 --><p class='indent'>   <!-- l. 337 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo> <mstyle displaystyle='true'><mfrac><mrow><mn>1</mn>
</mrow><mrow><mn>4</mn></mrow></mfrac></mstyle> <mo class='MathClass-bin' stretchy='false'>⋅</mo> <mrow><mo fence='true' form='prefix'>[</mo><mrow><mtable align='axis' class='array' columnlines='none none none none none none none none none' displaystyle='true' equalcolumns='false' equalrows='false' rowlines='none none none none none none none none none none' style=''><mtr class='array-row'><mtd class='array-td' columnalign='center'>     <mo class='MathClass-open' stretchy='false'>(</mo><mn>1.1</mn> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>4.3</mn><mi>i</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>+</mo> <mo class='MathClass-open' stretchy='false'>(</mo><mn>3.5</mn> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1.4</mn><mi>i</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>+</mo> <mo class='MathClass-open' stretchy='false'>(</mo><mn>1.1</mn> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>4.3</mn><mi>i</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>+</mo> <mo class='MathClass-open' stretchy='false'>(</mo><mn>3.5</mn> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>1.4</mn><mi>i</mi><mo class='MathClass-close' stretchy='false'>)</mo>        </mtd></mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'></mtd></mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'></mtd>
</mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'>    <mo class='MathClass-open' stretchy='false'>(</mo><mn>1.1</mn> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>4.3</mn><mi>i</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>+</mo> <mo class='MathClass-open' stretchy='false'>(</mo><mn>3.5</mn> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1.4</mn><mi>i</mi><mo class='MathClass-close' stretchy='false'>)</mo><msup><mrow><mover accent='false' class='mml-overline'><mrow><mi>ω</mi></mrow><mo accent='true'>¯</mo></mover></mrow><mrow><mn>5</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <mo class='MathClass-open' stretchy='false'>(</mo><mn>1.1</mn> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>4.3</mn><mi>i</mi><mo class='MathClass-close' stretchy='false'>)</mo><mi>ω</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mo class='MathClass-open' stretchy='false'>(</mo><mn>3.5</mn> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>1.4</mn><mi>i</mi><mo class='MathClass-close' stretchy='false'>)</mo><msup><mrow><mi>ω</mi></mrow><mrow><mn>5</mn></mrow></msup>     </mtd></mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'></mtd></mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'></mtd>
</mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'>  <mo class='MathClass-open' stretchy='false'>(</mo><mn>1.1</mn> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>4.3</mn><mi>i</mi><mo class='MathClass-close' stretchy='false'>)</mo><mover accent='false' class='mml-overline'><mrow><msup><mrow><mi>ω</mi></mrow><mrow><mn>2</mn></mrow></msup></mrow><mo accent='true'>¯</mo></mover> <mo class='MathClass-bin' stretchy='false'>+</mo> <mo class='MathClass-open' stretchy='false'>(</mo><mn>3.5</mn> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1.4</mn><mi>i</mi><mo class='MathClass-close' stretchy='false'>)</mo><mover accent='false' class='mml-overline'><mrow><msup><mrow><mi>ω</mi></mrow><mrow><mn>2</mn></mrow></msup></mrow><mo accent='true'>¯</mo></mover> <mo class='MathClass-bin' stretchy='false'>+</mo> <mo class='MathClass-open' stretchy='false'>(</mo><mn>1.1</mn> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>4.3</mn><mi>i</mi><mo class='MathClass-close' stretchy='false'>)</mo><msup><mrow><mi>ω</mi></mrow><mrow><mn>2</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <mo class='MathClass-open' stretchy='false'>(</mo><mn>3.5</mn> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>1.4</mn><mi>i</mi><mo class='MathClass-close' stretchy='false'>)</mo><msup><mrow><mi>ω</mi></mrow><mrow><mn>2</mn></mrow></msup>  </mtd></mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'></mtd></mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'></mtd>
</mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'>  <mo class='MathClass-open' stretchy='false'>(</mo><mn>1.1</mn> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>4.3</mn><mi>i</mi><mo class='MathClass-close' stretchy='false'>)</mo><msup><mrow><mover accent='false' class='mml-overline'><mrow><mi>ω</mi></mrow><mo accent='true'>¯</mo></mover></mrow><mrow><mn>3</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <mo class='MathClass-open' stretchy='false'>(</mo><mn>3.5</mn> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1.4</mn><mi>i</mi><mo class='MathClass-close' stretchy='false'>)</mo><msup><mrow><mover accent='false' class='mml-overline'><mrow><mi>ω</mi></mrow><mo accent='true'>¯</mo></mover></mrow><mrow><mn>7</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <mo class='MathClass-open' stretchy='false'>(</mo><mn>1.1</mn> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>4.3</mn><mi>i</mi><mo class='MathClass-close' stretchy='false'>)</mo><msup><mrow><mi>ω</mi></mrow><mrow><mn>3</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <mo class='MathClass-open' stretchy='false'>(</mo><mn>3.5</mn> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>1.4</mn><mi>i</mi><mo class='MathClass-close' stretchy='false'>)</mo><msup><mrow><mi>ω</mi></mrow><mrow><mn>7</mn></mrow></msup>  </mtd></mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'></mtd></mtr>   <!-- *\c@MaxMatrixCols c --></mtable>                                                    </mrow><mo fence='true' form='postfix'>]</mo></mrow> </mrow></math>
</p><!-- l. 345 --><p class='indent'>   <!-- l. 345 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 347 --><p class='indent'>   <!-- l. 347 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo> <mstyle displaystyle='true'><mfrac><mrow><mn>1</mn>
</mrow><mrow><mn>4</mn></mrow></mfrac></mstyle> <mo class='MathClass-bin' stretchy='false'>⋅</mo> <mrow><mo fence='true' form='prefix'>[</mo><mrow><mtable align='axis' class='array' columnlines='none none none none none none none none none' displaystyle='true' equalcolumns='false' equalrows='false' rowlines='none none none none none none none none none none' style=''><mtr class='array-row'><mtd class='array-td' columnalign='center'>                      <mn>9.2</mn>                                       </mtd></mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'></mtd></mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'></mtd>
</mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'>    <mn>1.1</mn><mo class='MathClass-open' stretchy='false'>(</mo><mover accent='false' class='mml-overline'><mrow><mi>ω</mi></mrow><mo accent='true'>¯</mo></mover> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>ω</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>4.3</mn><mi>i</mi><mo class='MathClass-open' stretchy='false'>(</mo><mover accent='false' class='mml-overline'><mrow><mi>ω</mi></mrow><mo accent='true'>¯</mo></mover> <mo class='MathClass-bin' stretchy='false'>−</mo><mi>ω</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>3.5</mn><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mover accent='false' class='mml-overline'><mrow><mi>ω</mi></mrow><mo accent='true'>¯</mo></mover></mrow><mrow><mn>5</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>ω</mi></mrow><mrow><mn>5</mn></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1.4</mn><mi>i</mi><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mover accent='false' class='mml-overline'><mrow><mi>ω</mi></mrow><mo accent='true'>¯</mo></mover></mrow><mrow><mn>5</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>−</mo><msup><mrow><mi>ω</mi></mrow><mrow><mn>5</mn></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo>    </mtd></mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'></mtd></mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'></mtd>
</mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'> <mn>1.1</mn><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mover accent='false' class='mml-overline'><mrow><mi>ω</mi></mrow><mo accent='true'>¯</mo></mover></mrow><mrow><mn>2</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>ω</mi></mrow><mrow><mn>2</mn></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>4.3</mn><mi>i</mi><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mover accent='false' class='mml-overline'><mrow><mi>ω</mi></mrow><mo accent='true'>¯</mo></mover></mrow><mrow><mn>2</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>−</mo><msup><mrow><mi>ω</mi></mrow><mrow><mn>2</mn></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>3.5</mn><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mover accent='false' class='mml-overline'><mrow><mi>ω</mi></mrow><mo accent='true'>¯</mo></mover></mrow><mrow><mn>2</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>ω</mi></mrow><mrow><mn>2</mn></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1.4</mn><mi>i</mi><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mover accent='false' class='mml-overline'><mrow><mi>ω</mi></mrow><mo accent='true'>¯</mo></mover></mrow><mrow><mn>2</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>−</mo><msup><mrow><mi>ω</mi></mrow><mrow><mn>2</mn></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo> </mtd></mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'></mtd></mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'></mtd>
</mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'> <mn>1.1</mn><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mover accent='false' class='mml-overline'><mrow><mi>ω</mi></mrow><mo accent='true'>¯</mo></mover></mrow><mrow><mn>3</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo><msup><mrow> <mover accent='false' class='mml-overline'><mrow><mi>ω</mi></mrow><mo accent='true'>¯</mo></mover></mrow><mrow><mn>3</mn></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>4.3</mn><mi>i</mi><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mover accent='false' class='mml-overline'><mrow><mi>ω</mi></mrow><mo accent='true'>¯</mo></mover></mrow><mrow><mn>3</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>−</mo><msup><mrow><mover accent='false' class='mml-overline'><mrow><mi>ω</mi></mrow><mo accent='true'>¯</mo></mover></mrow><mrow><mn>3</mn></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>3.5</mn><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mover accent='false' class='mml-overline'><mrow><mi>ω</mi></mrow><mo accent='true'>¯</mo></mover></mrow><mrow><mn>7</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo><msup><mrow> <mover accent='false' class='mml-overline'><mrow><mi>ω</mi></mrow><mo accent='true'>¯</mo></mover></mrow><mrow><mn>7</mn></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1.4</mn><mi>i</mi><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mover accent='false' class='mml-overline'><mrow><mi>ω</mi></mrow><mo accent='true'>¯</mo></mover></mrow><mrow><mn>7</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>−</mo><msup><mrow><mover accent='false' class='mml-overline'><mrow><mi>ω</mi></mrow><mo accent='true'>¯</mo></mover></mrow><mrow><mn>7</mn></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo> </mtd></mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'></mtd></mtr>   <!-- *\c@MaxMatrixCols c --></mtable>                                            </mrow><mo fence='true' form='postfix'>]</mo></mrow></mrow></math>
</p><!-- l. 358 --><p class='indent'>   <!-- l. 358 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 360 --><p class='indent'>   <!-- l. 360 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo> <mstyle displaystyle='true'><mfrac><mrow><mn>1</mn>
</mrow><mrow><mn>4</mn></mrow></mfrac></mstyle> <mo class='MathClass-bin' stretchy='false'>⋅</mo> <mrow><mo fence='true' form='prefix'>[</mo><mrow><mtable align='axis' class='array' columnlines='none none none none none none none none none' displaystyle='true' equalcolumns='false' equalrows='false' rowlines='none none none none none none none none none none' style=''><mtr class='array-row'><mtd class='array-td' columnalign='center'>                      <mn>9.2</mn>                                      </mtd></mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'></mtd></mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'></mtd>
</mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'>   <mn>1.1</mn> <mrow><mo fence='true' form='prefix'>(</mo><mrow><mn>2</mn><mi class='loglike'>cos</mi><mo>⁡<!-- FUNCTION APPLICATION --></mo><!-- nolimits --><mstyle displaystyle='true'><mfrac><mrow><mi>π</mi>
</mrow><mrow><mn>4</mn></mrow></mfrac></mstyle></mrow><mo fence='true' form='postfix'>)</mo></mrow> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>4.3</mn><mi>i</mi> <mrow><mo fence='true' form='prefix'>(</mo><mrow><mn>2</mn><mi>i</mi><mi class='loglike'>sin</mi><mo>⁡<!-- FUNCTION APPLICATION --></mo><!-- nolimits --><mstyle displaystyle='true'><mfrac><mrow><mi>π</mi>
</mrow><mrow><mn>4</mn></mrow></mfrac></mstyle></mrow><mo fence='true' form='postfix'>)</mo></mrow> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>3.5</mn> <mrow><mo fence='true' form='prefix'>(</mo><mrow><mn>2</mn><mi class='loglike'>cos</mi><mo>⁡<!-- FUNCTION APPLICATION --></mo><!-- nolimits --><mstyle displaystyle='true'><mfrac><mrow><mn>5</mn><mi>π</mi>
 </mrow><mrow><mn>4</mn> </mrow></mfrac></mstyle></mrow><mo fence='true' form='postfix'>)</mo></mrow> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>1.4</mn><mi>i</mi> <mrow><mo fence='true' form='prefix'>(</mo><mrow><mn>2</mn><mi>i</mi><mi class='loglike'>sin</mi><mo>⁡<!-- FUNCTION APPLICATION --></mo><!-- nolimits --><mstyle displaystyle='true'><mfrac><mrow><mn>5</mn><mi>π</mi>
 </mrow><mrow><mn>4</mn> </mrow></mfrac></mstyle></mrow><mo fence='true' form='postfix'>)</mo></mrow>   </mtd></mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'></mtd></mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'></mtd>
</mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'>    <mn>1.1</mn> <mrow><mo fence='true' form='prefix'>(</mo><mrow><mn>2</mn><mi class='loglike'>cos</mi><mo>⁡<!-- FUNCTION APPLICATION --></mo><!-- nolimits --><mstyle displaystyle='true'><mfrac><mrow><mi>π</mi>
</mrow><mrow><mn>2</mn></mrow></mfrac></mstyle></mrow><mo fence='true' form='postfix'>)</mo></mrow> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>4.3</mn><mi>i</mi> <mrow><mo fence='true' form='prefix'>(</mo><mrow><mn>2</mn><mi>i</mi><mi class='loglike'>sin</mi><mo>⁡<!-- FUNCTION APPLICATION --></mo><!-- nolimits --><mstyle displaystyle='true'><mfrac><mrow><mi>π</mi>
</mrow><mrow><mn>2</mn></mrow></mfrac></mstyle></mrow><mo fence='true' form='postfix'>)</mo></mrow> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>3.5</mn> <mrow><mo fence='true' form='prefix'>(</mo><mrow><mn>2</mn><mi class='loglike'>cos</mi><mo>⁡<!-- FUNCTION APPLICATION --></mo><!-- nolimits --><mstyle displaystyle='true'><mfrac><mrow><mi>π</mi>
</mrow><mrow><mn>2</mn></mrow></mfrac></mstyle></mrow><mo fence='true' form='postfix'>)</mo></mrow> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>1.4</mn><mi>i</mi> <mrow><mo fence='true' form='prefix'>(</mo><mrow><mn>2</mn><mi>i</mi><mi class='loglike'>sin</mi><mo>⁡<!-- FUNCTION APPLICATION --></mo><!-- nolimits --><mstyle displaystyle='true'><mfrac><mrow><mi>π</mi>
</mrow><mrow><mn>2</mn></mrow></mfrac></mstyle></mrow><mo fence='true' form='postfix'>)</mo></mrow>    </mtd></mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'></mtd></mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'></mtd>
</mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'> <mn>1.1</mn> <mrow><mo fence='true' form='prefix'>(</mo><mrow><mn>2</mn><mi class='loglike'>cos</mi><mo>⁡<!-- FUNCTION APPLICATION --></mo><!-- nolimits --><mstyle displaystyle='true'><mfrac><mrow><mn>3</mn><mi>π</mi>
 </mrow><mrow><mn>4</mn> </mrow></mfrac></mstyle></mrow><mo fence='true' form='postfix'>)</mo></mrow> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>4.3</mn><mi>i</mi> <mrow><mo fence='true' form='prefix'>(</mo><mrow><mn>2</mn><mi>i</mi><mi class='loglike'>sin</mi><mo>⁡<!-- FUNCTION APPLICATION --></mo><!-- nolimits --><mstyle displaystyle='true'><mfrac><mrow><mn>3</mn><mi>π</mi>
 </mrow><mrow><mn>4</mn> </mrow></mfrac></mstyle></mrow><mo fence='true' form='postfix'>)</mo></mrow> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>3.5</mn> <mrow><mo fence='true' form='prefix'>(</mo><mrow><mn>2</mn><mi class='loglike'>cos</mi><mo>⁡<!-- FUNCTION APPLICATION --></mo><!-- nolimits --><mstyle displaystyle='true'><mfrac><mrow><mn>7</mn><mi>π</mi>
 </mrow><mrow><mn>4</mn> </mrow></mfrac></mstyle></mrow><mo fence='true' form='postfix'>)</mo></mrow> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>1.4</mn><mi>i</mi> <mrow><mo fence='true' form='prefix'>(</mo><mrow><mn>2</mn><mi>i</mi><mi class='loglike'>sin</mi><mo>⁡<!-- FUNCTION APPLICATION --></mo><!-- nolimits --><mstyle displaystyle='true'><mfrac><mrow><mn>7</mn><mi>π</mi>
 </mrow><mrow><mn>4</mn> </mrow></mfrac></mstyle></mrow><mo fence='true' form='postfix'>)</mo></mrow> </mtd></mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'></mtd></mtr>   <!-- *\c@MaxMatrixCols c --></mtable>                                             </mrow><mo fence='true' form='postfix'>]</mo></mrow></mrow></math>
</p><!-- l. 368 --><p class='indent'>   <!-- l. 368 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 370 --><p class='indent'>   <!-- l. 370 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo> <mstyle displaystyle='true'><mfrac><mrow><mn>1</mn>
</mrow><mrow><mn>4</mn></mrow></mfrac></mstyle> <mo class='MathClass-bin' stretchy='false'>⋅</mo> <mrow><mo fence='true' form='prefix'>[</mo><mrow><mtable align='axis' class='array' columnlines='none none none none none none none none none' displaystyle='true' equalcolumns='false' equalrows='false' rowlines='none none none none none none none none none none' style=''><mtr class='array-row'><mtd class='array-td' columnalign='center'>                 <mn>9.2</mn>                              </mtd></mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'></mtd></mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'></mtd>
</mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'>  <mn>1.1</mn> <mrow><mo fence='true' form='prefix'>(</mo><mrow><mn>2</mn><mstyle displaystyle='true'><mfrac><mrow><msqrt><mrow><mn>2</mn></mrow></msqrt>
 </mrow><mrow><mn>2</mn>  </mrow></mfrac></mstyle></mrow><mo fence='true' form='postfix'>)</mo></mrow> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>4.3</mn> <mrow><mo fence='true' form='prefix'>(</mo><mrow><mn>2</mn><mstyle displaystyle='true'><mfrac><mrow><msqrt><mrow><mn>2</mn></mrow></msqrt>
 </mrow><mrow><mn>2</mn>  </mrow></mfrac></mstyle></mrow><mo fence='true' form='postfix'>)</mo></mrow> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>3.5</mn> <mrow><mo fence='true' form='prefix'>(</mo><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mn>2</mn><mstyle displaystyle='true'><mfrac><mrow><msqrt><mrow><mn>2</mn></mrow></msqrt>
 </mrow><mrow><mn>2</mn>  </mrow></mfrac></mstyle></mrow><mo fence='true' form='postfix'>)</mo></mrow> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1.4</mn> <mrow><mo fence='true' form='prefix'>(</mo><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mn>2</mn><mstyle displaystyle='true'><mfrac><mrow><msqrt><mrow><mn>2</mn></mrow></msqrt>
 </mrow><mrow><mn>2</mn>  </mrow></mfrac></mstyle></mrow><mo fence='true' form='postfix'>)</mo></mrow>  </mtd></mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'></mtd></mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'></mtd>
</mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'>    <mn>1.1</mn><mo class='MathClass-open' stretchy='false'>(</mo><mn>2</mn> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mn>0</mn><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>4.3</mn><mo class='MathClass-open' stretchy='false'>(</mo><mn>2</mn> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>3.5</mn><mo class='MathClass-open' stretchy='false'>(</mo><mn>2</mn> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mn>0</mn><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1.4</mn><mo class='MathClass-open' stretchy='false'>(</mo><mn>2</mn> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo>    </mtd></mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'></mtd></mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'></mtd>
</mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'> <mn>1.1</mn> <mrow><mo fence='true' form='prefix'>(</mo><mrow><mn>2</mn> <mo class='MathClass-bin' stretchy='false'>−</mo><mstyle displaystyle='true'><mfrac><mrow><msqrt><mrow><mn>2</mn></mrow></msqrt>
 </mrow><mrow><mn>2</mn>  </mrow></mfrac></mstyle></mrow><mo fence='true' form='postfix'>)</mo></mrow> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>4.3</mn> <mrow><mo fence='true' form='prefix'>(</mo><mrow><mn>2</mn><mstyle displaystyle='true'><mfrac><mrow><msqrt><mrow><mn>2</mn></mrow></msqrt>
 </mrow><mrow><mn>2</mn>  </mrow></mfrac></mstyle></mrow><mo fence='true' form='postfix'>)</mo></mrow> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>3.5</mn> <mrow><mo fence='true' form='prefix'>(</mo><mrow><mn>2</mn><mstyle displaystyle='true'><mfrac><mrow><msqrt><mrow><mn>2</mn></mrow></msqrt>
 </mrow><mrow><mn>2</mn>  </mrow></mfrac></mstyle></mrow><mo fence='true' form='postfix'>)</mo></mrow> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1.4</mn> <mrow><mo fence='true' form='prefix'>(</mo><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mn>2</mn><mstyle displaystyle='true'><mfrac><mrow><msqrt><mrow><mn>2</mn></mrow></msqrt>
 </mrow><mrow><mn>2</mn>  </mrow></mfrac></mstyle></mrow><mo fence='true' form='postfix'>)</mo></mrow> </mtd></mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'></mtd></mtr>   <!-- *\c@MaxMatrixCols c --></mtable>                                                             </mrow><mo fence='true' form='postfix'>]</mo></mrow></mrow></math>
</p><!-- l. 378 --><p class='indent'>   <!-- l. 378 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 380 --><p class='indent'>   <!-- l. 380 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>0.25</mn><mo class='MathClass-bin' stretchy='false'>⋅</mo><mrow><mo fence='true' form='prefix'>[</mo><mrow><mtable align='axis' class='array' columnlines='none none none none none none none none none' displaystyle='true' equalcolumns='false' equalrows='false' rowlines='none none none none none none none none none none' style=''><mtr class='array-row'><mtd class='array-td' columnalign='center'>            <mn>9.2</mn>                      </mtd></mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'></mtd></mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'></mtd>
</mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'>   <mn>1.1</mn><msqrt><mrow><mn>2</mn></mrow></msqrt> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>4.3</mn><msqrt><mrow><mn>2</mn></mrow></msqrt> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>3.5</mn><msqrt><mrow><mn>2</mn></mrow></msqrt> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>1.4</mn><msqrt><mrow><mn>2</mn></mrow></msqrt>   </mtd></mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'></mtd></mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'></mtd>
</mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'>   <mn>1.1</mn><mo class='MathClass-open' stretchy='false'>(</mo><mn>0</mn><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>4.3</mn><mo class='MathClass-open' stretchy='false'>(</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>3.5</mn><mo class='MathClass-open' stretchy='false'>(</mo><mn>0</mn><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1.4</mn><mo class='MathClass-open' stretchy='false'>(</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>)</mo>   </mtd></mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'></mtd></mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'></mtd>
</mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1.1</mn><msqrt><mrow><mn>2</mn></mrow></msqrt> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>4.3</mn><msqrt><mrow><mn>2</mn></mrow></msqrt> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>3.5</mn><msqrt><mrow><mn>2</mn></mrow></msqrt> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>1.4</mn><msqrt><mrow><mn>2</mn></mrow></msqrt> </mtd></mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'></mtd></mtr>   <!-- *\c@MaxMatrixCols c --></mtable>                                                                              </mrow><mo fence='true' form='postfix'>]</mo></mrow> <mo class='MathClass-rel' stretchy='false'>=</mo>  <mrow><mo fence='true' form='prefix'>[</mo><mrow><mtable align='axis' class='array' columnlines='none none none none none none none none none' displaystyle='true' equalcolumns='false' equalrows='false' rowlines='none none none none none none none none none none' style=''> <mtr class='array-row'><mtd class='array-td' columnalign='center'>     <mn>2.3</mn>     </mtd></mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'></mtd></mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'></mtd>
</mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'> <mn>0.825</mn><msqrt><mrow><mn>2</mn></mrow></msqrt> </mtd></mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'></mtd></mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'></mtd>
</mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'>    <mn>1.45</mn>    </mtd></mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'></mtd></mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'></mtd>
</mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'> <mn>2.025</mn><msqrt><mrow><mn>2</mn></mrow></msqrt> </mtd></mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'></mtd></mtr>   <!-- *\c@MaxMatrixCols c --></mtable>                                                                                                                </mrow><mo fence='true' form='postfix'>]</mo></mrow> <mo class='MathClass-rel' stretchy='false'>≈</mo><mo class='MathClass-open' stretchy='false'>(</mo><mn>2.3</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><mn>1.1657</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><mn>1.45</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><mn>2.8638</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
</p><!-- l. 394 --><p class='indent'>   <!-- l. 394 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 396 --><p class='indent'>   Convert the real number vector <!-- l. 396 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mover accent='true'><mrow><mi>m</mi></mrow><mo accent='true'>→</mo></mover></math>
into a scaled integer vector <!-- l. 396 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi mathvariant='normal'>Δ</mi><mover accent='true'><mrow><mi>m</mi></mrow><mo accent='true'>→</mo></mover></mrow></math>
by <!-- l. 396 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi mathvariant='normal'>Δ</mi></math>-scaling
and rounding as follows:
</p><!-- l. 398 --><p class='indent'>   <!-- l. 398 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi mathvariant='normal'>Δ</mi><mover accent='true'><mrow><mi>m</mi></mrow><mo accent='true'>→</mo></mover> <mo class='MathClass-rel' stretchy='false'>≈</mo><mo class='MathClass-open' stretchy='false'>⌈</mo><mi mathvariant='normal'>Δ</mi><mover accent='true'><mrow><mi>m</mi></mrow><mo accent='true'>→</mo></mover><mo class='MathClass-close' stretchy='false'>⌋</mo><mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>⌈</mo><mn>1024</mn> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mo class='MathClass-open' stretchy='false'>(</mo><mn>2.3</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><mn>1.1657</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><mn>1.45</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><mn>2.8638</mn><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-close' stretchy='false'>⌋</mo><mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>(</mo><mn>2355</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><mn>1195</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><mn>1485</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><mn>2933</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
</p><!-- l. 400 --><p class='indent'>   <!-- l. 400 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 402 --><p class='indent'>   Finally, <!-- l. 402 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mover accent='true'><mrow><mi>v</mi></mrow><mo accent='true'>→</mo></mover> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>(</mo><mn>1.1</mn> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>4.3</mn><mi>i</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><mn>3.5</mn> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1.4</mn><mi>i</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math> has been encoded
into the plaintext polynomial <!-- l. 402 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>M</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
as follows:
</p><!-- l. 404 --><p class='indent'>   <!-- l. 404 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi mathvariant='normal'>Δ</mi><mi>M</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>2355</mn> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>1195</mn><mi>X</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>1485</mn><msup><mrow><mi>X</mi></mrow><mrow><mn>2</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>2933</mn><msup><mrow><mi>X</mi></mrow><mrow><mn>3</mn></mrow></msup> <mo class='MathClass-rel' stretchy='false'>∈</mo><msub><mrow><mstyle mathvariant='script'><mi>R</mi></mstyle></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>4</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msub></mrow></math>
                                                                                         
                                                                                         
</p><!-- l. 406 --><p class='indent'>   <!-- l. 406 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 409 --><p class='indent'>   To decode <!-- l. 409 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mover accent='true'><mrow><mi>m</mi></mrow><mo accent='true'>→</mo></mover></math>,
we compute:
</p><!-- l. 411 --><p class='indent'>   <!-- l. 411 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mover accent='true'><mrow><mi>v</mi></mrow><mo accent='true'>→</mo></mover></mrow><mrow><msup><mrow></mrow><mrow><mi>′</mi></mrow></msup></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo> <mstyle displaystyle='true'><mfrac><mrow><msup><mrow><mi>W</mi></mrow><mrow><mi>T</mi> </mrow></msup> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mi mathvariant='normal'>Δ</mi><mover accent='true'><mrow><mi>m</mi></mrow><mo accent='true'>→</mo></mover>
     </mrow><mrow><mi mathvariant='normal'>Δ</mi>     </mrow></mfrac></mstyle> <mo class='MathClass-rel' stretchy='false'>=</mo>  <mrow><mo fence='true' form='prefix'>[</mo><mrow><mtable align='axis' class='array' columnlines='none none none none none none none none none' displaystyle='true' equalcolumns='false' equalrows='false' rowlines='none none none none none none none none' style=''> <mtr class='array-row'><mtd class='array-td' columnalign='center'> <mn>1</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mi>ω</mi><mo class='MathClass-punc' stretchy='false'>,</mo><msup><mrow><mi>ω</mi></mrow><mrow><mn>2</mn></mrow></msup><mo class='MathClass-punc' stretchy='false'>,</mo><msup><mrow><mi>ω</mi></mrow><mrow><mn>3</mn></mrow></msup>  </mtd></mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'></mtd></mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'></mtd>
</mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'>  <mn>1</mn><mo class='MathClass-punc' stretchy='false'>,</mo><msup><mrow><mi>ω</mi></mrow><mrow><mn>3</mn></mrow></msup><mo class='MathClass-punc' stretchy='false'>,</mo><msup><mrow><mi>ω</mi></mrow><mrow><mn>6</mn></mrow></msup><mo class='MathClass-punc' stretchy='false'>,</mo><mi>ω</mi> </mtd></mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'></mtd></mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'></mtd>
</mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'> <mn>1</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mover accent='false' class='mml-overline'><mrow><mi>ω</mi></mrow><mo accent='true'>¯</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mover accent='false' class='mml-overline'><mrow><msup><mrow><mi>ω</mi></mrow><mrow><mn>2</mn></mrow></msup></mrow><mo accent='true'>¯</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mover accent='false' class='mml-overline'><mrow><msup><mrow><mi>ω</mi></mrow><mrow><mn>3</mn></mrow></msup></mrow><mo accent='true'>¯</mo></mover>  </mtd></mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'></mtd></mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'></mtd>
</mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'>  <mn>1</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mover accent='false' class='mml-overline'><mrow><msup><mrow><mi>ω</mi></mrow><mrow><mn>3</mn></mrow></msup></mrow><mo accent='true'>¯</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mover accent='false' class='mml-overline'><mrow><msup><mrow><mi>ω</mi></mrow><mrow><mn>6</mn></mrow></msup></mrow><mo accent='true'>¯</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mover accent='false' class='mml-overline'><mrow><mi>ω</mi></mrow><mo accent='true'>¯</mo></mover> </mtd></mtr> <!-- *\c@MaxMatrixCols c --></mtable>                                                                                            </mrow><mo fence='true' form='postfix'>]</mo></mrow></mrow></math>
<!-- l. 417 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-bin' stretchy='false'>⋅</mo> <mrow><mo fence='true' form='prefix'>[</mo><mrow><mtable align='axis' class='array' columnlines='none none none none none none none none none' displaystyle='true' equalcolumns='false' equalrows='false' rowlines='none none none none none none none none' style=''><mtr class='array-row'><mtd class='array-td' columnalign='center'> <mn>2355</mn> </mtd></mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'></mtd></mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'></mtd></mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'> <mn>1195</mn></mtd></mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'></mtd></mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'></mtd>
</mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'> <mn>1485</mn> </mtd></mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'></mtd></mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'></mtd></mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'> <mn>2933</mn></mtd></mtr> <!-- *\c@MaxMatrixCols c --></mtable>                                                                                                                     </mrow><mo fence='true' form='postfix'>]</mo></mrow> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mstyle displaystyle='true'><mfrac><mrow> <mn>1</mn>
</mrow><mrow><mn>1024</mn></mrow></mfrac></mstyle></mrow></math>
</p><!-- l. 421 --><p class='indent'>   <!-- l. 421 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo>  <mrow><mo fence='true' form='prefix'>[</mo><mrow><mtable align='axis' class='array' columnlines='none none none none none none none none none' displaystyle='true' equalcolumns='false' equalrows='false' rowlines='none none none none none none none none' style=''> <mtr class='array-row'><mtd class='array-td' columnalign='center'>   <mn>1</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle displaystyle='true'><mfrac><mrow><msqrt><mrow><mn>2</mn></mrow></msqrt>
 </mrow><mrow><mn>2</mn>  </mrow></mfrac></mstyle> <mo class='MathClass-bin' stretchy='false'>+</mo> <mstyle displaystyle='true'><mfrac><mrow><mi>i</mi><msqrt><mrow><mn>2</mn></mrow></msqrt>
  </mrow><mrow><mn>2</mn>  </mrow></mfrac></mstyle><mo class='MathClass-punc' stretchy='false'>,</mo><mi>i</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-bin' stretchy='false'>−</mo><mstyle displaystyle='true'><mfrac><mrow><msqrt><mrow><mn>2</mn></mrow></msqrt>
 </mrow><mrow><mn>2</mn>  </mrow></mfrac></mstyle> <mo class='MathClass-bin' stretchy='false'>+</mo> <mstyle displaystyle='true'><mfrac><mrow><mi>i</mi><msqrt><mrow><mn>2</mn></mrow></msqrt>
  </mrow><mrow><mn>2</mn>  </mrow></mfrac></mstyle>   </mtd></mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'></mtd></mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'></mtd>
</mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'> <mn>1</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-bin' stretchy='false'>−</mo><mstyle displaystyle='true'><mfrac><mrow><msqrt><mrow><mn>2</mn></mrow></msqrt>
 </mrow><mrow><mn>2</mn>  </mrow></mfrac></mstyle> <mo class='MathClass-bin' stretchy='false'>+</mo> <mstyle displaystyle='true'><mfrac><mrow><mi>i</mi><msqrt><mrow><mn>2</mn></mrow></msqrt>
  </mrow><mrow><mn>2</mn>  </mrow></mfrac></mstyle><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-bin' stretchy='false'>−</mo><mi>i</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle displaystyle='true'><mfrac><mrow><msqrt><mrow><mn>2</mn></mrow></msqrt>
 </mrow><mrow><mn>2</mn>  </mrow></mfrac></mstyle> <mo class='MathClass-bin' stretchy='false'>+</mo> <mstyle displaystyle='true'><mfrac><mrow><mi>i</mi><msqrt><mrow><mn>2</mn></mrow></msqrt>
  </mrow><mrow><mn>2</mn>  </mrow></mfrac></mstyle> </mtd></mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'></mtd></mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'></mtd>
</mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'> <mn>1</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle displaystyle='true'><mfrac><mrow><msqrt><mrow><mn>2</mn></mrow></msqrt>
 </mrow><mrow><mn>2</mn>  </mrow></mfrac></mstyle> <mo class='MathClass-bin' stretchy='false'>−</mo><mstyle displaystyle='true'><mfrac><mrow><mi>i</mi><msqrt><mrow><mn>2</mn></mrow></msqrt>
  </mrow><mrow><mn>2</mn>  </mrow></mfrac></mstyle><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-bin' stretchy='false'>−</mo><mi>i</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-bin' stretchy='false'>−</mo><mstyle displaystyle='true'><mfrac><mrow><msqrt><mrow><mn>2</mn></mrow></msqrt>
 </mrow><mrow><mn>2</mn>  </mrow></mfrac></mstyle> <mo class='MathClass-bin' stretchy='false'>−</mo><mstyle displaystyle='true'><mfrac><mrow><mi>i</mi><msqrt><mrow><mn>2</mn></mrow></msqrt>
  </mrow><mrow><mn>2</mn>  </mrow></mfrac></mstyle> </mtd></mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'></mtd></mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'></mtd>
</mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'>   <mn>1</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-bin' stretchy='false'>−</mo><mstyle displaystyle='true'><mfrac><mrow><msqrt><mrow><mn>2</mn></mrow></msqrt>
 </mrow><mrow><mn>2</mn>  </mrow></mfrac></mstyle> <mo class='MathClass-bin' stretchy='false'>−</mo><mstyle displaystyle='true'><mfrac><mrow><mi>i</mi><msqrt><mrow><mn>2</mn></mrow></msqrt>
  </mrow><mrow><mn>2</mn>  </mrow></mfrac></mstyle><mo class='MathClass-punc' stretchy='false'>,</mo><mi>i</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle displaystyle='true'><mfrac><mrow><msqrt><mrow><mn>2</mn></mrow></msqrt>
 </mrow><mrow><mn>2</mn>  </mrow></mfrac></mstyle> <mo class='MathClass-bin' stretchy='false'>−</mo><mstyle displaystyle='true'><mfrac><mrow><mi>i</mi><msqrt><mrow><mn>2</mn></mrow></msqrt>
  </mrow><mrow><mn>2</mn>  </mrow></mfrac></mstyle>   </mtd></mtr> <!-- *\c@MaxMatrixCols c --></mtable>                                                                                    </mrow><mo fence='true' form='postfix'>]</mo></mrow></mrow></math>
<!-- l. 428 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-bin' stretchy='false'>⋅</mo> <mrow><mo fence='true' form='prefix'>[</mo><mrow><mtable align='axis' class='array' columnlines='none none none none none none none none none' displaystyle='true' equalcolumns='false' equalrows='false' rowlines='none none none none none none none none' style=''><mtr class='array-row'><mtd class='array-td' columnalign='center'> <mn>2.2998046875</mn> </mtd></mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'></mtd></mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'></mtd></mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'> <mn>1.1669921875</mn></mtd></mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'></mtd></mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'></mtd>
</mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'> <mn>1.4501953125</mn> </mtd></mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'></mtd></mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'></mtd></mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'> <mn>2.8642578125</mn></mtd></mtr> <!-- *\c@MaxMatrixCols c --></mtable>                                                                                                          </mrow><mo fence='true' form='postfix'>]</mo></mrow></mrow></math>
</p><!-- l. 432 --><p class='indent'>   <!-- l. 432 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 434 --><p class='indent'>   <!-- l. 434 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>≈</mo><mo class='MathClass-open' stretchy='false'>(</mo><mn>1.0997</mn> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>4.3007</mn><mi>i</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><mn>3.5000</mn> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1.4003</mn><mi>i</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><mn>1.0997</mn> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>4.3007</mn><mi>i</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><mn>3.5000</mn> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>1.4003</mn><mi>i</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
</p><!-- l. 436 --><p class='indent'>   <!-- l. 436 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 438 --><p class='indent'>   Extract the first <!-- l. 438 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mstyle displaystyle='true'><mfrac><mrow><mi>n</mi>
</mrow><mrow><mn>2</mn></mrow></mfrac></mstyle> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>2</mn></mrow></math> elements
in the Hermitian vector <!-- l. 438 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mover accent='true'><mrow><mi>v</mi></mrow><mo accent='true'>→</mo></mover></mrow><mrow><msup><mrow></mrow><mrow><mi>′</mi></mrow></msup></mrow></msub></math>
to recover the input vector:
</p><!-- l. 440 --><p class='indent'>   <!-- l. 440 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><mn>1.0997</mn> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>4.3007</mn><mi>i</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><mn>3.5000</mn> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1.4003</mn><mi>i</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
</p><!-- l. 442 --><p class='indent'>   <!-- l. 442 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>≈</mo><mo class='MathClass-open' stretchy='false'>(</mo><mn>1.1</mn> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>4.3</mn><mi>i</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><mn>3.5</mn> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1.4</mn><mi>i</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo> <mover accent='true'><mrow><mi>v</mi></mrow><mo accent='true'>→</mo></mover></mrow></math> <span id='textcolor128'>  #
The original input vector</span>
</p><!-- l. 444 --><p class='indent'>   <!-- l. 444 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 446 --><p class='indent'>   Because of the rounding drifts for converting square roots into integers, the decoded value is slightly
different from the original input complex values. This is why CKKS is called an approximate
homomorphic encryption.
</p><!-- l. 448 --><p class='indent'>   <!-- l. 448 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 450 --><p class='noindent'><span class='rm-lmbx-10x-x-109'>Source Code: </span>Examples of CKKS encoding can be executed by running  <a href='https://github.com/fhetextbook/fhe-textbook/blob/main/source%20code/ckks.py'><span class='underline'>this Python script</span></a>.
                                                                                         
                                                                                         
</p>
   <!-- l. 454 --><div class='crosslinks'><p class='noindent'>[<a href='EncryptionandDecryption2.html'>next</a>] [<a href='EncodingandDecoding.html'>front</a>] [<a href='CKKSScheme.html#EncodingandDecoding.html'>up</a>] </p></div>
<!-- l. 454 --><p class='indent'>   <a id='tailEncodingandDecoding.html'></a>  </p> 
</body> 
</html>