<!DOCTYPE html> 
<html lang='en-US' xml:lang='en-US'> 
<head> <title>The Beginner’s Textbook
for Fully Homomorphic Encryption</title> 
<meta charset='utf-8' /> 
<meta content='TeX4ht (https://tug.org/tex4ht/)' name='generator' /> 
<meta content='width=device-width,initial-scale=1' name='viewport' /> 
<link href='00-main.css' rel='stylesheet' type='text/css' /> 
<meta content='00-main.tex' name='src' /> 
 <script async='async' id='MathJax-script' src='https://cdn.jsdelivr.net/npm/mathjax@3/es5/mml-chtml.js' type='text/javascript'></script>  
</head><body>
   <div class='maketitle'>                                                                                      
                                                                                         
                                                                                         
                                                                                         

<h2 class='titleHead'>The Beginner’s Textbook<br />
for Fully Homomorphic Encryption</h2>
     <div class='author'><span class='rm-lmbx-12'>Ronny Ko</span><br /><br />
<br /> <span class='rm-lmr-12'>LG Electronics Inc.</span></div><br />
<div class='date'><span class='rm-lmr-12'>January 1, 2025</span></div>
   </div>
                                                                                         
                                                                                         
                                                                                         
                                                                                         
   <section class='abstract' role='doc-abstract'> 
<h3 class='abstracttitle'>
<span class='rm-lmbx-10'>Abstract</span>
</h3>
     <!-- l. 261 --><p class='noindent'><span class='rm-lmr-10'>Fully Homomorphic Encryption (FHE) is a cryptographic scheme that enables computations to
     be performed directly on encrypted data, as if the data were in plaintext. After all computations
     are performed on the encrypted data, it can be decrypted to reveal the result. The decrypted
     value matches the result that would have been obtained if the same computations were applied
     to the plaintext data.</span>
     </p><!-- l. 263 --><p class='indent'>   <span class='rm-lmr-10'>FHE supports basic operations such as addition and multiplication on encrypted numbers.
     Using these fundamental operations, more complex computations can be constructed, including
     subtraction, division, logic gates (e.g., AND, OR, XOR, NAND, MUX), and even advanced
     mathematical functions such as ReLU, sigmoid, and trigonometric functions (e.g., sin, cos).
     These functions can be implemented either as exact formulas or as approximations, depending
     on the trade-off between computational efficiency and accuracy.</span>
     </p><!-- l. 265 --><p class='indent'>   <span class='rm-lmr-10'>Fully  Homomorphic  Encryption  (FHE)  enables  privacy-preserving  machine  learning  by
     allowing a server to process the client’s data in its encrypted form through an ML model. With
     FHE, the server learns neither the plaintext version of the input features nor the inference
     results. Only the client, using their secret key, can decrypt and access the results at the end
     of the service protocol. FHE can also be applied to confidential blockchain services, ensuring
     that sensitive data in smart contracts remains encrypted and confidential while maintaining the
     transparency and integrity of the execution process. Other applications of FHE include secure
     outsourcing of data analytics, encrypted database queries, privacy-preserving searches, efficient
     multi-party computation for digital signatures, and more.</span>
     </p><!-- l. 269 --><p class='indent'>   <span class='rm-lmr-10'>This book is designed to help the reader understand how FHE works from the mathematical
     level. The book comprises the following four parts:</span>
     </p><!-- l. 271 --><p class='indent'>   <!-- l. 271 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p>
   <ul class='itemize1'>
   <li class='itemize'><a href='#basic-math'><span class='rm-lmbx-10'>Part I</span></a><span class='rm-lmbx-10'>: </span><a href='#basic-math'><span class='rm-lmbx-10'>Basic Math</span><!-- tex4ht:ref: part:basicmmath  --></a> <span class='rm-lmr-10'>explains necessary background concepts for FHE, such as Group,
   Field,  Order,  Polynomial  Ring,  Cyclotomic  Polynomial,  Vectors  and  Matrices,  Chinese
   Remainder Theorem, Taylor Series, Polynomial Interpolation, and Fast Fourier Transform.</span>
   </li>
   <li class='itemize'><span class='rm-lmbx-10'>??: ?? </span><span class='rm-lmr-10'>explains well-known lattice-based cryptographic schemes, which are LWE, RLWE,
   GLWE, GLev, and GGSW cryptosystems.</span>
   </li>
   <li class='itemize'><span class='rm-lmbx-10'>??: ?? </span><span class='rm-lmr-10'>explains the generic techniques of FHE adopted by many existing schemes, such as
   homomorphic addition, multiplication, modulus switching, and key switching.</span>
   </li>
   <li class='itemize'><a href='#fully-homomorphic-encryption-schemes'><span class='rm-lmbx-10'>Part II</span></a><span class='rm-lmbx-10'>: </span><a href='#fully-homomorphic-encryption-schemes'><span class='rm-lmbx-10'>Fully Homomorphic Encryption Schemes</span><!-- tex4ht:ref: part:fhesschemes  --></a> <span class='rm-lmr-10'>explains four widely used FHE
   schemes: TFHE, BFV, CKKS, and BGV, as well as their RNS-variant versions.</span></li></ul>
     <!-- l. 284 --><p class='indent'>     <!-- l. 284 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
                                                                                         
                                                                                         
     </p><!-- l. 286 --><p class='indent'>   <span class='rm-lmr-10'>These parts are designed in an incremental manner, and therefore understanding each part requires
     the understanding of its prior part(s).</span>
     </p><!-- l. 288 --><p class='indent'>   <!-- l. 288 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
     </p><!-- l. 290 --><p class='indent'>   <span class='rm-lmr-10'>Please report any bugs or suggestions regarding the draft to the  </span><a href='https://github.com/gogo9th/fhe-textbook/issues'><span class='rm-lmbx-10'>GitHub Issues
     Board</span></a><span class='rm-lmr-10'>.</span>
</p>
</section>
   
   <h5 class='likesubsubsectionHead' id='acknowledgments'><a id='x1-1000'></a>Acknowledgments</h5>
<!-- l. 295 --><p class='noindent'>Special thanks are extended to Robin Geelen (KU Leuven) for his thoughtful and dedicated comments,
and to Yongwoo Lee (Inha University) for his general advice.
</p><!-- l. 299 --><p class='indent'>
                                                                                         
                                                                                         
   
</p>
   <h3 class='likesectionHead' id='contents'><a id='x1-2000'></a>Contents</h3>
   <div class='tableofcontents'>
   <span class='partToc'>I  <a href='#basic-math' id='QQ2-1-3'>Basic Math</a></span>
<br />   <span class='sectionToc'>A-1 <a href='#modulo-arithmetic' id='QQ2-1-4'>Modulo Arithmetic</a></span>
<br />   <span class='subsectionToc'>A-1.1 <a href='#overview' id='QQ2-1-5'>Overview</a></span>
<br />   <span class='subsectionToc'>A-1.2 <a href='#modulo-arithmetic1' id='QQ2-1-6'>Modulo Arithmetic</a></span>
<br />   <span class='subsubsectionToc'>A-1.2.1 <a href='#inverse' id='QQ2-1-7'>Inverse</a></span>
<br />   <span class='subsubsectionToc'>A-1.2.2 <a href='#modulo-division' id='QQ2-1-8'>Modulo Division</a></span>
<br />   <span class='subsubsectionToc'>A-1.2.3 <a href='#centered-residue-representation' id='QQ2-1-9'>Centered Residue Representation</a></span>
<br />   <span class='sectionToc'>A-2 <a href='#group' id='QQ2-1-10'>Group</a></span>
<br />   <span class='subsectionToc'>A-2.1 <a href='#definitions' id='QQ2-1-11'>Definitions</a></span>
<br />   <span class='subsectionToc'>A-2.2 <a href='#examples' id='QQ2-1-12'>Examples</a></span>
<br />   <span class='sectionToc'>A-3 <a href='#field' id='QQ2-1-13'>Field</a></span>
<br />   <span class='subsectionToc'>A-3.1 <a href='#definitions1' id='QQ2-1-14'>Definitions</a></span>
<br />   <span class='subsectionToc'>A-3.2 <a href='#examples1' id='QQ2-1-15'>Examples</a></span>
<br />   <span class='subsectionToc'>A-3.3 <a href='#theorems' id='QQ2-1-16'>Theorems</a></span>
<br />   <span class='sectionToc'>A-4 <a href='#order' id='QQ2-1-17'>Order</a></span>
<br />   <span class='subsectionToc'>A-4.1 <a href='#definitions2' id='QQ2-1-18'>Definitions</a></span>
<br />   <span class='subsectionToc'>A-4.2 <a href='#theorems1' id='QQ2-1-19'>Theorems</a></span>
<br />   <span class='partToc'>II  <a href='#fully-homomorphic-encryption-schemes' id='QQ2-1-20'>Fully Homomorphic Encryption Schemes</a></span>
<br />   <span class='sectionToc'>D-1 <a href='#tfhe-scheme' id='QQ2-1-21'>TFHE Scheme</a></span>
<br />   <span class='subsectionToc'>D-1.1 <a href='#encryption-and-decryption' id='QQ2-1-22'>Encryption and Decryption</a></span>
<br />   <span class='subsectionToc'>D-1.2 <a href='#homomorphic-ciphertexttociphertext-addition' id='QQ2-1-23'>Homomorphic Ciphertext-to-Ciphertext Addition</a></span>
<br />   <span class='subsectionToc'>D-1.3 <a href='#homomorphic-ciphertexttoplaintext-addition' id='QQ2-1-24'>Homomorphic Ciphertext-to-Plaintext Addition</a></span>
<br />   <span class='subsectionToc'>D-1.4 <a href='#homomorphic-ciphertexttoplaintext-multiplication' id='QQ2-1-25'>Homomorphic Ciphertext-to-Plaintext Multiplication</a></span>
<br />   <span class='subsectionToc'>D-1.5 <a href='#homomorphic-key-switching' id='QQ2-1-26'>Homomorphic Key Switching</a></span>
<br />   <span class='subsectionToc'>D-1.6 <a href='#homomorphic-ciphertexttociphertext-multiplication' id='QQ2-1-27'>Homomorphic Ciphertext-to-Ciphertext Multiplication</a></span>
<br />   <span class='subsubsectionToc'>D-1.6.1 <a href='#discussion-on-the-noise-growth' id='QQ2-1-28'>Discussion on the Noise Growth</a></span>
<br />   <span class='subsubsectionToc'>D-1.6.2 <a href='#generalization-to-glwetoggsw-multiplication' id='QQ2-1-29'>Generalization to GLWE-to-GGSW Multiplication</a></span>
<br />   <span class='subsectionToc'>D-1.7 <a href='#coefficient-extraction' id='QQ2-1-30'>Coefficient Extraction</a></span>
<br />   <span class='subsectionToc'>D-1.8 <a href='#noise-bootstrapping' id='QQ2-1-31'>Noise Bootstrapping</a></span>
<br />   <span class='subsubsectionToc'>D-1.8.1 <a href='#overview1' id='QQ2-1-32'>Overview</a></span>
<br />   <span class='subsubsectionToc'>D-1.8.2 <a href='#modulus-switch-for-noise-boootstrapping' id='QQ2-1-33'>Modulus Switch for Noise Boootstrapping</a></span>
<br />   <span class='subsubsectionToc'>D-1.8.3 <a href='#halving-the-plaintext-space-to-be-used' id='QQ2-1-34'>Halving the Plaintext Space To be Used</a></span>
<br />   <span class='subsubsectionToc'>D-1.8.4 <a href='#blind-rotation' id='QQ2-1-35'>Blind Rotation</a></span>
<br />   <span class='subsubsectionToc'>D-1.8.5 <a href='#coefficient-extraction1' id='QQ2-1-37'>Coefficient Extraction</a></span>
<br />   <span class='subsubsectionToc'>D-1.8.6 <a href='#noise-bootstrapping-summary' id='QQ2-1-38'>Noise Bootstrapping Summary</a></span>
<br />   <span class='subsubsectionToc'>D-1.8.7 <a href='#example-noise-bootstrapping' id='QQ2-1-39'>Example: Noise Bootstrapping</a></span>
<br />   <span class='subsubsectionToc'>D-1.8.8 <a href='#discussion' id='QQ2-1-41'>Discussion</a></span>
<br />   <span class='subsubsectionToc'>D-1.8.9 <a href='#application-gate-bootstrapping' id='QQ2-1-42'>Application: Gate Bootstrapping</a></span>
<br />   <span class='subsubsectionToc'>D-1.8.10 <a href='#application-neural-networks-bootstrapping' id='QQ2-1-44'>Application: Neural Networks Bootstrapping</a></span>
                                                                                         
                                                                                         
<br />   <span class='subsectionToc'>D-1.9 <a href='#tfhe-on-a-discrete-torus' id='QQ2-1-47'>TFHE on a Discrete Torus</a></span>
<br />   <span class='sectionToc'>D-2 <a href='#roots-of-unity' id='QQ2-1-48'>Roots of Unity</a></span>
<br />   <span class='subsectionToc'>D-2.1 <a href='#definitions3' id='QQ2-1-49'>Definitions</a></span>
<br />   <span class='subsectionToc'>D-2.2 <a href='#theorems2' id='QQ2-1-50'>Theorems</a></span>
   </div>
                                                                                         
                                                                                         
   <h1 class='partHead' id='basic-math'><span class='titlemark'>Part I<br /></span><a id='x1-3000I'></a>Basic Math</h1>
<!-- l. 355 --><p class='noindent'>This chapter explains the basic mathematical components of the Number theory: group, field, order, roots
of unity, cyclotomic polynomial, polynomial ring, and decomposition. These are essential building blocks
for post-quantum cryptography.
                                                                                         
                                                                                         
   
</p>
   <h3 class='sectionHead' id='modulo-arithmetic'><span class='titlemark'>A-1   </span> <a id='x1-4000A-1'></a>Modulo Arithmetic</h3>
<!-- l. 1 --><p class='noindent'><span class='rm-lmbx-10x-x-109'>- Reference:  </span><a href='https://www.youtube.com/watch?v=fz1vxq5ts5I'>YouTube – Extended Euclidean Algorithm Tutorial</a>
   
</p>
   <h4 class='subsectionHead' id='overview'><span class='titlemark'>A-1.1   </span> <a id='x1-5000A-1.1'></a>Overview</h4>
   <div class='tcolorbox tcolorbox' id='tcolobox-1'>     
<div class='tcolorbox-title'>
<!-- l. 37 --><p class='indent'>   <!-- l. 37 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mstyle mathvariant='bold'><mo class='MathClass-open' stretchy='false'>⟨</mo></mstyle></math><span class='rm-lmbx-10x-x-109'>Definition </span><a href='#definitions'><span class='rm-lmbx-10x-x-109'>A-2.1</span><!-- tex4ht:ref: subsec:groupddef  --></a><!-- l. 37 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mstyle mathvariant='bold'><mo class='MathClass-close' stretchy='false'>⟩</mo></mstyle></math>
                                                                                         
                                                                                         
<span class='rm-lmbx-10x-x-109'>Integer Modulo</span></p></div> 
<div class='tcolorbox-content'>   <ul class='itemize1'>
   <li class='itemize'>
   <!-- l. 11 --><p class='noindent'><span class='rm-lmbx-10x-x-109'>modulo </span>is an operation of computing the remainder after dividing a number by another
    number. <span class='rm-lmbx-10x-x-109'>modulo </span>is often abbreviated as <span class='rm-lmbx-10x-x-109'>mod</span>.
    </p><!-- l. 13 --><p class='noindent'><!-- l. 13 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
    </p></li>
    <li class='itemize'>
    <!-- l. 15 --><p class='noindent'><!-- l. 15 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mstyle mathvariant='bold'><mi>𝐚</mi></mstyle></math>
   <span class='rm-lmbx-10x-x-109'>mod </span><!-- l. 15 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mstyle mathvariant='bold'><mi>𝐪</mi></mstyle></math>
   <span class='rm-lmbx-10x-x-109'>(i.e., </span><!-- l. 15 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mstyle mathvariant='bold'><mi>𝐚</mi></mstyle><mstyle mathvariant='bold'><mstyle class='text'><mtext> 𝐦𝐨𝐝𝐮𝐥𝐨 </mtext></mstyle><mi>𝐪</mi></mstyle></mrow></math><span class='rm-lmbx-10x-x-109'>)</span>
   is the remainder after dividing <!-- l. 15 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>a</mi></math>
   by <!-- l. 15 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>q</mi></math>,
    which is always one element among <!-- l. 15 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>{</mo><mn>0</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>1</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>2</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>3</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace><mo class='MathClass-punc' stretchy='false'>,</mo><mi>q</mi> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>}</mo></mrow></math>.
    For example, <!-- l. 15 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mn>7</mn><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mn>5</mn> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>2</mn></mrow></math>,
    because the remainder of dividing 7 by 5 is 2.
    </p><!-- l. 17 --><p class='noindent'><!-- l. 17 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
    </p></li>
    <li class='itemize'>
    <!-- l. 19 --><p class='noindent'><span class='rm-lmbx-10x-x-109'>modulus: </span>Given <!-- l. 19 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mstyle mathvariant='bold'><mi>𝐚</mi></mstyle></math>
   mod <!-- l. 19 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mstyle mathvariant='bold'><mi>𝐪</mi></mstyle></math>,
    we call the divider <!-- l. 19 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>q</mi></math>
   the modulus, whereas modulo is an operation.
    </p><!-- l. 21 --><p class='noindent'><!-- l. 21 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
    </p></li>
    <li class='itemize'>
    <!-- l. 23 --><p class='noindent'><span class='rm-lmbx-10x-x-109'>Modulo Congruence (</span><!-- l. 23 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mstyle mathvariant='bold'><mo class='MathClass-rel' stretchy='false'>≡</mo></mstyle></math><span class='rm-lmbx-10x-x-109'>):</span>
   <!-- l. 23 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>a</mi></math>
   is congruent with <!-- l. 23 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>b</mi></math>
   modulo <!-- l. 23 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>a</mi></math>
   (i.e., <!-- l. 23 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>a</mi> <mo class='MathClass-rel' stretchy='false'>≡</mo><mi>b</mi><mstyle class='text'><mtext class='textbf' mathvariant='bold'> 𝐦𝐨𝐝 </mtext></mstyle><mi>q</mi></mrow></math>)
    if       they       have       the       same       remainder       when       divided       by
    <!-- l. 23 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>a</mi></math>.
    For example, <!-- l. 23 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mn>5</mn> <mo class='MathClass-rel' stretchy='false'>≡</mo><mn>12</mn><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mn>7</mn></mrow></math>,
    because <!-- l. 23 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mn>5</mn><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mn>7</mn> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>5</mn></mrow></math>
    and <!-- l. 23 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mn>12</mn><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mn>7</mn> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>5</mn></mrow></math>.
    In mathematics, the notation <!-- l. 23 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>a</mi> <mo class='MathClass-rel' stretchy='false'>≡</mo><mi>b</mi><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi>q</mi></mrow></math>
   is identical to <!-- l. 23 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>a</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mi>b</mi><mspace width='0.3em'></mspace><mo class='MathClass-open' stretchy='false'>(</mo><mi mathvariant='italic'>𝑚𝑜𝑑</mi><mspace width='0.3em'></mspace><mi>q</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>,
    meaning that the remainder of <!-- l. 23 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>a</mi></math>
   divided by <!-- l. 23 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>q</mi></math>
   is the same as the remainder of <!-- l. 23 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>b</mi></math>
   divided by <!-- l. 23 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>q</mi></math>.
    Note that this notation is different from <!-- l. 23 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>a</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mi>b</mi><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi>q</mi></mrow></math>,
    meaning that <!-- l. 23 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>a</mi></math>
   is identical to the remainder of <!-- l. 23 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>b</mi></math>
   divided by <!-- l. 23 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>q</mi></math>,
    </p><!-- l. 25 --><p class='noindent'><!-- l. 25 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
    </p></li>
    <li class='itemize'>
    <!-- l. 27 --><p class='noindent'><span class='rm-lmbx-10x-x-109'>Congruence </span><span class='rm-lmbxi-10x-x-109'>v.s. </span><span class='rm-lmbx-10x-x-109'>Equality:</span>
   </p><!-- l. 29 --><p class='noindent'><!-- l. 29 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>a</mi> <mo class='MathClass-rel' stretchy='false'>≡</mo><mi>b</mi><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi>q</mi><mo class='MathClass-rel' stretchy='false'>⟺</mo><mi>a</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mi>b</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>k</mi> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mi>q</mi></mrow></math>
     (for some integer <!-- l. 29 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>k</mi></math>)
    </p><!-- l. 31 --><p class='noindent'><!-- l. 31 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
    </p><!-- l. 33 --><p class='noindent'>This means that <!-- l. 33 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>a</mi></math>
   and <!-- l. 33 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>b</mi></math>
   are congruent modulo <!-- l. 33 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>q</mi></math>
   if and only if <!-- l. 33 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>a</mi></math>
   and <!-- l. 33 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>b</mi></math>
   are different by some multiple of <!-- l. 33 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>q</mi></math>.
    For example, <!-- l. 33 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mn>5</mn> <mo class='MathClass-rel' stretchy='false'>≡</mo><mn>12</mn><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mn>7</mn><mo class='MathClass-rel' stretchy='false'>⟺</mo><mn>5</mn> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>12</mn> <mo class='MathClass-bin' stretchy='false'>+</mo> <mo class='MathClass-open' stretchy='false'>(</mo><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mn>7</mn></mrow></math>
</p>
    </li></ul>
 
</div> 
</div>                                                                         
                                                                                         
   
   <h4 class='subsectionHead' id='modulo-arithmetic1'><span class='titlemark'>A-1.2   </span> <a id='x1-6000A-1.2'></a>Modulo Arithmetic</h4>
<!-- l. 44 --><p class='noindent'>The supported modulo operations are addition, subtraction, and multiplication. The properties of these
modulo operations are as follows:
</p>
   <div class='tcolorbox tcolorbox' id='tcolobox-2'>     
<div class='tcolorbox-title'>
<!-- l. 58 --><p class='indent'>   <!-- l. 58 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mstyle mathvariant='bold'><mo class='MathClass-open' stretchy='false'>⟨</mo></mstyle></math><span class='rm-lmbx-10x-x-109'>Theorem </span><a href='#definitions'><span class='rm-lmbx-10x-x-109'>A-2.1</span><!-- tex4ht:ref: subsec:groupddef  --></a><span class='rm-lmbx-10x-x-109'>.1</span><!-- l. 58 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mstyle mathvariant='bold'><mo class='MathClass-close' stretchy='false'>⟩</mo></mstyle></math>
<span class='rm-lmbx-10x-x-109'>Properties of Modulo Operations</span></p></div> 
<div class='tcolorbox-content'><!-- l. 47 --><p class='noindent'>For any integer <!-- l. 47 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>x</mi></math>,
the following is true:
    </p><dl class='enumerate-enumitem'><dt class='enumerate-enumitem'>
1.  </dt><dd class='enumerate-enumitem'><span class='rm-lmbx-10x-x-109'>Addition: </span><!-- l. 50 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>a</mi> <mo class='MathClass-rel' stretchy='false'>≡</mo><mi>b</mi><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi>q</mi><mo class='MathClass-rel' stretchy='false'>⟺</mo><mi>a</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>x</mi> <mo class='MathClass-rel' stretchy='false'>≡</mo><mi>b</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>x</mi><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi>q</mi></mrow></math>
   </dd><dt class='enumerate-enumitem'>
2.  </dt><dd class='enumerate-enumitem'><span class='rm-lmbx-10x-x-109'>Subtraction: </span><!-- l. 52 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>a</mi> <mo class='MathClass-rel' stretchy='false'>≡</mo><mi>b</mi><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi>q</mi><mo class='MathClass-rel' stretchy='false'>⟺</mo><mi>a</mi> <mo class='MathClass-bin' stretchy='false'>−</mo><mi>x</mi> <mo class='MathClass-rel' stretchy='false'>≡</mo><mi>b</mi> <mo class='MathClass-bin' stretchy='false'>−</mo><mi>x</mi><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi>q</mi></mrow></math>
   </dd><dt class='enumerate-enumitem'>
3.  </dt><dd class='enumerate-enumitem'><span class='rm-lmbx-10x-x-109'>Multiplication: </span><!-- l. 54 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>a</mi> <mo class='MathClass-rel' stretchy='false'>≡</mo><mi>b</mi><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi>q</mi><mo class='MathClass-rel' stretchy='false'>⟺</mo><mi>a</mi> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mi>x</mi> <mo class='MathClass-rel' stretchy='false'>≡</mo><mi>b</mi> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mi>x</mi><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi>q</mi></mrow></math>
   </dd></dl>
 
</div> 
</div>
   <div class='proof'>
<!-- l. 61 --><p class='indent'>   <span class='head'>
<span class='rm-lmri-10x-x-109'>Proof.</span> </span>
</p><!-- l. 62 --><p class='indent'>
<!-- l. 62 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 64 --><p class='indent'>   For any integer <!-- l. 64 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>x</mi></math>,
</p><!-- l. 67 --><p class='indent'>
   </p><dl class='enumerate-enumitem'><dt class='enumerate-enumitem'>
1. </dt><dd class='enumerate-enumitem'><span class='rm-lmbx-10x-x-109'>Addition: </span><!-- l. 69 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>a</mi> <mo class='MathClass-rel' stretchy='false'>≡</mo><mi>b</mi><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi>q</mi><mo class='MathClass-rel' stretchy='false'>⟺</mo><mi>a</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mi>b</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi mathvariant='italic'>𝑘𝑞</mi></mrow></math>
   (for some <!-- l. 69 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>k</mi></math>)
   <span id='textcolor1'>  # <!-- l. 69 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>a</mi></math>
   and <!-- l. 69 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>b</mi></math>
   differ by some multiple of <!-- l. 69 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>q</mi></math></span>
   <!-- l. 71 --><p class='noindent'><!-- l. 71 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-rel' stretchy='false'>⟺</mo><mi>a</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>x</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mi>b</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>k</mi> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mi>q</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>x</mi></mrow></math>
   </p><!-- l. 73 --><p class='noindent'><!-- l. 73 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-rel' stretchy='false'>⟺</mo><mi>a</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>x</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mi>b</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>x</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>k</mi> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mi>q</mi></mrow></math>
   <span id='textcolor2'> # <!-- l. 73 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>a</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>x</mi></mrow></math>
   and <!-- l. 73 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>b</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>x</mi></mrow></math>
   differ by some multiple of <!-- l. 73 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>q</mi></math></span>
   </p><!-- l. 75 --><p class='noindent'><!-- l. 75 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-rel' stretchy='false'>⟺</mo><mi>a</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>x</mi> <mo class='MathClass-rel' stretchy='false'>≡</mo><mi>b</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>x</mi><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi>q</mi></mrow></math>
   </p><!-- l. 77 --><p class='noindent'><!-- l. 77 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
   </p></dd><dt class='enumerate-enumitem'>
2. </dt><dd class='enumerate-enumitem'><span class='rm-lmbx-10x-x-109'>Subtraction: </span><!-- l. 79 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>a</mi> <mo class='MathClass-rel' stretchy='false'>≡</mo><mi>b</mi><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi>q</mi><mo class='MathClass-rel' stretchy='false'>⟺</mo><mi>a</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mi>b</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi mathvariant='italic'>𝑘𝑞</mi></mrow></math>
   (for some <!-- l. 79 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>k</mi></math>)
   <!-- l. 81 --><p class='noindent'><!-- l. 81 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-rel' stretchy='false'>⟺</mo><mi>a</mi> <mo class='MathClass-bin' stretchy='false'>−</mo><mi>x</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mi>b</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>k</mi> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mi>q</mi> <mo class='MathClass-bin' stretchy='false'>−</mo><mi>x</mi></mrow></math>
                                                                                         
                                                                                         
   </p><!-- l. 83 --><p class='noindent'><!-- l. 83 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-rel' stretchy='false'>⟺</mo><mi>a</mi> <mo class='MathClass-bin' stretchy='false'>−</mo><mi>x</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mi>b</mi> <mo class='MathClass-bin' stretchy='false'>−</mo><mi>x</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>k</mi> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mi>q</mi></mrow></math>
   <span id='textcolor3'> # <!-- l. 83 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>a</mi> <mo class='MathClass-bin' stretchy='false'>−</mo><mi>x</mi></mrow></math>
   and <!-- l. 83 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>b</mi> <mo class='MathClass-bin' stretchy='false'>−</mo><mi>x</mi></mrow></math>
   differ by some multiple of <!-- l. 83 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>q</mi></math></span>
   </p><!-- l. 85 --><p class='noindent'><!-- l. 85 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-rel' stretchy='false'>⟺</mo><mi>a</mi> <mo class='MathClass-bin' stretchy='false'>−</mo><mi>x</mi> <mo class='MathClass-rel' stretchy='false'>≡</mo><mi>b</mi> <mo class='MathClass-bin' stretchy='false'>−</mo><mi>x</mi><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi>q</mi></mrow></math>
   </p><!-- l. 87 --><p class='noindent'><!-- l. 87 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
   </p></dd><dt class='enumerate-enumitem'>
3. </dt><dd class='enumerate-enumitem'><span class='rm-lmbx-10x-x-109'>Multiplication: </span><!-- l. 89 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>a</mi> <mo class='MathClass-rel' stretchy='false'>≡</mo><mi>b</mi><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi>q</mi><mo class='MathClass-rel' stretchy='false'>⟺</mo><mi>a</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mi>b</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi mathvariant='italic'>𝑘𝑞</mi></mrow></math>
   (for some <!-- l. 89 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>k</mi></math>)
   <!-- l. 91 --><p class='noindent'><!-- l. 91 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-rel' stretchy='false'>⟺</mo><mi>a</mi> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mi>x</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mi>b</mi> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mi>x</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>k</mi> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mi>q</mi> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mi>x</mi></mrow></math>
   </p><!-- l. 93 --><p class='noindent'><!-- l. 93 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-rel' stretchy='false'>⟺</mo><mi>a</mi> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mi>x</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mi>b</mi> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mi>x</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>k</mi></mrow><mrow><mi>x</mi></mrow></msub> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mi>q</mi></mrow></math>
   (where <!-- l. 93 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>k</mi></mrow><mrow><mi>x</mi></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo> <mi>k</mi> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mi>x</mi></mrow></math>)
   <span id='textcolor4'>  # <!-- l. 93 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>a</mi> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mi>x</mi></mrow></math>
   and <!-- l. 93 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>b</mi> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mi>x</mi></mrow></math>
   differ by some multiple of <!-- l. 93 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>q</mi></math></span>
   </p><!-- l. 95 --><p class='noindent'><!-- l. 95 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-rel' stretchy='false'>⟺</mo><mi>a</mi> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mi>x</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mi>b</mi> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mi>x</mi><mspace width='0.3em'></mspace><mo class='MathClass-open' stretchy='false'>(</mo><mi mathvariant='italic'>𝑚𝑜𝑑</mi><mspace width='0.3em'></mspace><mi>q</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
</p>
   </dd></dl>
                                                                                        □
   </div>
<!-- l. 100 --><p class='indent'>   Based on the modulo operations in Theorem<a href='#definitions'>A-2.1<!-- tex4ht:ref: subsec:groupddef  --></a>.1, we can also derive the following properties of
modulo arithmetic.
</p>
   <div class='tcolorbox tcolorbox' id='tcolobox-3'>     
<div class='tcolorbox-title'>
<!-- l. 123 --><p class='indent'>   <!-- l. 123 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mstyle mathvariant='bold'><mo class='MathClass-open' stretchy='false'>⟨</mo></mstyle></math><span class='rm-lmbx-10x-x-109'>Theorem </span><a href='#definitions'><span class='rm-lmbx-10x-x-109'>A-2.1</span><!-- tex4ht:ref: subsec:groupddef  --></a><span class='rm-lmbx-10x-x-109'>.2</span><!-- l. 123 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mstyle mathvariant='bold'><mo class='MathClass-close' stretchy='false'>⟩</mo></mstyle></math>
<span class='rm-lmbx-10x-x-109'>Properties of Modulo Arithmetic</span></p></div> 
<div class='tcolorbox-content'>   <dl class='enumerate-enumitem'><dt class='enumerate-enumitem'>
1.  </dt><dd class='enumerate-enumitem'><span class='rm-lmbx-10x-x-109'>Associative: </span><!-- l. 105 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><mi>a</mi> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mi>b</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mi>c</mi> <mo class='MathClass-rel' stretchy='false'>≡</mo><mi>a</mi> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mo class='MathClass-open' stretchy='false'>(</mo><mi>b</mi> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mi>c</mi><mo class='MathClass-close' stretchy='false'>)</mo><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi>q</mi></mrow></math>
   </dd><dt class='enumerate-enumitem'>
2.  </dt><dd class='enumerate-enumitem'><span class='rm-lmbx-10x-x-109'>Commutative: </span><!-- l. 107 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><mi>a</mi> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mi>b</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>≡</mo><mo class='MathClass-open' stretchy='false'>(</mo><mi>b</mi> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mi>a</mi><mo class='MathClass-close' stretchy='false'>)</mo><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi>q</mi></mrow></math>
   </dd><dt class='enumerate-enumitem'>
3.  </dt><dd class='enumerate-enumitem'><span class='rm-lmbx-10x-x-109'>Distributive: </span><!-- l. 109 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><mi>a</mi> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mo class='MathClass-open' stretchy='false'>(</mo><mi>b</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>c</mi><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>≡</mo><mo class='MathClass-open' stretchy='false'>(</mo><mo class='MathClass-open' stretchy='false'>(</mo><mi>a</mi> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mi>b</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>+</mo> <mo class='MathClass-open' stretchy='false'>(</mo><mi>a</mi> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mi>c</mi><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-close' stretchy='false'>)</mo><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi>q</mi></mrow></math>
   </dd><dt class='enumerate-enumitem'>
4.  </dt><dd class='enumerate-enumitem'><span class='rm-lmbx-10x-x-109'>Interchangeable: </span>Congruent values are interchangeable in the modulo arithmetic.
    <!-- l. 113 --><p class='noindent'>For example, suppose <!-- l. 113 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><mi>a</mi> <mo class='MathClass-rel' stretchy='false'>≡</mo><mi>b</mi><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi>q</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
    and <!-- l. 113 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><mi>c</mi> <mo class='MathClass-rel' stretchy='false'>≡</mo><mi>d</mi><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi>q</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>.
    Then, <!-- l. 113 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>a</mi></math>
   and <!-- l. 113 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>c</mi></math>
   are interchangeable, and <!-- l. 113 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>b</mi></math>
   and <!-- l. 113 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>d</mi></math>
   are interchangeable in modulo arithmetic as follows:
    </p><!-- l. 115 --><p class='noindent'><!-- l. 115 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><mi>a</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>c</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>≡</mo><mo class='MathClass-open' stretchy='false'>(</mo><mi>c</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>d</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>≡</mo><mo class='MathClass-open' stretchy='false'>(</mo><mi>a</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>d</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>≡</mo><mo class='MathClass-open' stretchy='false'>(</mo><mi>b</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>c</mi><mo class='MathClass-close' stretchy='false'>)</mo><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi>q</mi></mrow></math>
   </p><!-- l. 117 --><p class='noindent'><!-- l. 117 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><mi>a</mi> <mo class='MathClass-bin' stretchy='false'>−</mo><mi>c</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>≡</mo><mo class='MathClass-open' stretchy='false'>(</mo><mi>c</mi> <mo class='MathClass-bin' stretchy='false'>−</mo><mi>d</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>≡</mo><mo class='MathClass-open' stretchy='false'>(</mo><mi>a</mi> <mo class='MathClass-bin' stretchy='false'>−</mo><mi>d</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>≡</mo><mo class='MathClass-open' stretchy='false'>(</mo><mi>b</mi> <mo class='MathClass-bin' stretchy='false'>−</mo><mi>c</mi><mo class='MathClass-close' stretchy='false'>)</mo><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi>q</mi></mrow></math>
   </p><!-- l. 119 --><p class='noindent'><!-- l. 119 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><mi>a</mi> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mi>c</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>≡</mo><mo class='MathClass-open' stretchy='false'>(</mo><mi>c</mi> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mi>d</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>≡</mo><mo class='MathClass-open' stretchy='false'>(</mo><mi>a</mi> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mi>d</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>≡</mo><mo class='MathClass-open' stretchy='false'>(</mo><mi>b</mi> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mi>c</mi><mo class='MathClass-close' stretchy='false'>)</mo><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi>q</mi></mrow></math>
</p>
   </dd></dl>
 
</div> 
</div>
                                                                                         
                                                                                         
<!-- l. 125 --><p class='indent'>   The proof of Theorem <a href='#definitions'>A-2.1<!-- tex4ht:ref: subsec:groupddef  --></a>.2 is similar to that of Theorem <a href='#definitions'>A-2.1<!-- tex4ht:ref: subsec:groupddef  --></a>.1, which we leave as an exercise for
the reader.
   
</p>
   <h5 class='subsubsectionHead' id='inverse'><span class='titlemark'>A-1.2.1   </span> <a id='x1-7000A-1.2.1'></a>Inverse</h5>
   <div class='tcolorbox tcolorbox' id='tcolobox-4'>     
<div class='tcolorbox-title'>
<!-- l. 144 --><p class='indent'>   <!-- l. 144 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mstyle mathvariant='bold'><mo class='MathClass-open' stretchy='false'>⟨</mo></mstyle></math><span class='rm-lmbx-10x-x-109'>Definition </span><a href='#inverse'><span class='rm-lmbx-10x-x-109'>A-1.2.1</span><!-- tex4ht:ref: subsec:moduloiinverse  --></a><!-- l. 144 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mstyle mathvariant='bold'><mo class='MathClass-close' stretchy='false'>⟩</mo></mstyle></math>
<span class='rm-lmbx-10x-x-109'>Inverse in Modulo Arithmetic</span></p></div> 
<div class='tcolorbox-content'><!-- l. 134 --><p class='noindent'>In modulo <!-- l. 134 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>q</mi></math>
(i.e.,   in   the   world   of   remainders   where   all   numbers   have   been   divided   by
<!-- l. 134 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>q</mi></math>),
for each <!-- l. 134 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>a</mi> <mo class='MathClass-rel' stretchy='false'>∈</mo><mo class='MathClass-open' stretchy='false'>{</mo><mn>0</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>1</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>2</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace><mo class='MathClass-punc' stretchy='false'>,</mo><mi>q</mi> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>}</mo></mrow></math>:
</p>
    <ul class='itemize1'>
    <li class='itemize'><span class='rm-lmbx-10x-x-109'>Additive Inverse </span>of <!-- l. 138 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>a</mi></math>
   is denoted as <!-- l. 138 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msubsup><mrow><mi>a</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>+</mo></mrow><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msubsup></math>
     that satisfies <!-- l. 138 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>a</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msubsup><mrow><mi>a</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>+</mo></mrow><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msubsup> <mo class='MathClass-rel' stretchy='false'>≡</mo><mn>0</mn><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi>q</mi></mrow></math>.
    For example, in modulo 11, <!-- l. 138 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msubsup><mrow><mn>3</mn></mrow><mrow><mo class='MathClass-bin' stretchy='false'>+</mo></mrow><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msubsup> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>8</mn></mrow></math>,
    because <!-- l. 138 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mn>3</mn> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>8</mn> <mo class='MathClass-rel' stretchy='false'>≡</mo><mn>0</mn><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mn>11</mn></mrow></math>.
    </li>
    <li class='itemize'><span class='rm-lmbx-10x-x-109'>Multiplicative Inverse </span>of <!-- l. 140 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>a</mi></math>
   is denoted as <!-- l. 140 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msubsup><mrow><mi>a</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msubsup></math>
     that satisfies <!-- l. 140 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>a</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msubsup><mrow><mi>a</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msubsup> <mo class='MathClass-rel' stretchy='false'>≡</mo><mn>1</mn><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi>q</mi></mrow></math>.
    For example, in modulo 11, <!-- l. 140 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msubsup><mrow><mn>3</mn></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msubsup> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>4</mn></mrow></math>,
    because <!-- l. 140 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mn>3</mn> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mn>4</mn> <mo class='MathClass-rel' stretchy='false'>≡</mo><mn>1</mn><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mn>11</mn></mrow></math>.
</li></ul>
 
</div> 
</div>
   
   <h5 class='subsubsectionHead' id='modulo-division'><span class='titlemark'>A-1.2.2   </span> <a id='x1-8000A-1.2.2'></a>Modulo Division</h5>
<!-- l. 149 --><p class='noindent'>In modulo arithmetic, <span class='rm-lmri-10x-x-109'>modulo division </span>is different from regular numeric division. In fact, there is no such thing
as <span class='rm-lmri-10x-x-109'>modulo division</span>, because modulo is already a division operation that outputs a remainder. <span class='rm-lmri-10x-x-109'>modulo division</span>
of <!-- l. 149 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>b</mi></math> by
<!-- l. 149 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>a</mi><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi>q</mi></mrow></math> is equivalent to computing
the modulo multiplication <!-- l. 149 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>b</mi> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msubsup><mrow><mi>a</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msubsup><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi>q</mi></mrow></math>.
The result of <span class='rm-lmri-10x-x-109'>modulo division </span>is different from that of numeric division, because
<span class='rm-lmri-10x-x-109'>modulo division </span>always gives some integer (as it multiplies two integers modulo
<!-- l. 149 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>q</mi></math>),
whereas numeric division gives a real number. The inverse of an integer modulo
<!-- l. 149 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>q</mi></math> can be
                                                                                         
                                                                                         
computed by the extended Euclidean algorithm ( <a href='https://www.youtube.com/watch?v=fz1vxq5ts5I'>YouTube tutorial</a>)
   
</p>
   <h5 class='subsubsectionHead' id='centered-residue-representation'><span class='titlemark'>A-1.2.3   </span> <a id='x1-9000A-1.2.3'></a>Centered Residue Representation</h5>
<!-- l. 154 --><p class='noindent'>Throughout this section, we have assumed that the residues are positive integers. For example, the possible
residues for <!-- l. 154 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mstyle class='text'><mtext> </mtext></mstyle><mi>q</mi></mrow></math> are
assumed to be <!-- l. 154 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>{</mo><mn>0</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>1</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace><mo class='MathClass-punc' stretchy='false'>,</mo><mi>q</mi> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>}</mo></mrow></math>.
This system is called canonical (i.e., unsigned) residue representation. On the other
hand, there is also a counterpart system that assumes signed (i.e., centered) residues
<!-- l. 154 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'> <mrow><mo fence='true' form='prefix'>{</mo><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mstyle displaystyle='true'><mfrac><mrow><mi>q</mi>
</mrow><mrow><mn>2</mn></mrow></mfrac></mstyle><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-bin' stretchy='false'>−</mo><mstyle displaystyle='true'><mfrac><mrow><mi>q</mi>
</mrow><mrow><mn>2</mn></mrow></mfrac></mstyle> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>1</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace><mo class='MathClass-punc' stretchy='false'>,</mo><mn>0</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle displaystyle='true'><mfrac><mrow><mi>q</mi>
</mrow><mrow><mn>2</mn></mrow></mfrac></mstyle> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>2</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle displaystyle='true'><mfrac><mrow><mi>q</mi>
</mrow><mrow><mn>2</mn></mrow></mfrac></mstyle> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow><mo fence='true' form='postfix'>}</mo></mrow></math>, where the residues are centered
around <!-- l. 154 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mn>0</mn></math> and the number of
total residues is the same: <!-- l. 154 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>q</mi></math>.
In both systems, a modulo operation changes a given value to another value within the system’s residue range
such that: (1) if the given value is bigger than the upper bound of the residue range, the value is subtracted by
the modulus <!-- l. 154 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>q</mi></math>;
(2) if the value is smaller than the lower bound of the residue range, the value is added by the modulus
<!-- l. 154 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>q</mi></math>. The only
difference between these two (canonical and centered) systems is their upper bounds and lower bounds:
<!-- l. 154 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mn>0</mn></math> and
<!-- l. 154 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>q</mi> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></math> in the canonical residue
system, whereas <!-- l. 154 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-bin' stretchy='false'>−</mo><mstyle displaystyle='true'><mfrac><mrow><mi>q</mi>
</mrow><mrow><mn>2</mn></mrow></mfrac></mstyle></mrow></math>
and <!-- l. 154 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mstyle displaystyle='true'><mfrac><mrow><mi>q</mi>
</mrow><mrow><mn>2</mn></mrow></mfrac></mstyle> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></math>
in the centered residue system. The canonical residue representation assumes that
<!-- l. 154 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>ℤ</mi></mrow><mrow><mi>q</mi></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>{</mo><mn>0</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>1</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace><mo class='MathClass-punc' stretchy='false'>,</mo><mi>q</mi> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>}</mo></mrow></math>, whereas the centered
residue system assumes that <!-- l. 154 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>ℤ</mi></mrow><mrow><mi>q</mi></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo> <mrow><mo fence='true' form='prefix'>{</mo><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mstyle displaystyle='true'><mfrac><mrow><mi>q</mi>
</mrow><mrow><mn>2</mn></mrow></mfrac></mstyle><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-bin' stretchy='false'>−</mo><mstyle displaystyle='true'><mfrac><mrow><mi>q</mi>
</mrow><mrow><mn>2</mn></mrow></mfrac></mstyle> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>1</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace><mo class='MathClass-punc' stretchy='false'>,</mo><mn>0</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle displaystyle='true'><mfrac><mrow><mi>q</mi>
</mrow><mrow><mn>2</mn></mrow></mfrac></mstyle> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>2</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle displaystyle='true'><mfrac><mrow><mi>q</mi>
</mrow><mrow><mn>2</mn></mrow></mfrac></mstyle> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow><mo fence='true' form='postfix'>}</mo></mrow></mrow></math>.
</p><!-- l. 156 --><p class='indent'>   In both systems, the same modulo property of addition, subtraction, multiplication, and division
holds, which can be proved by applying the same reasoning described in <a href='#modulo-arithmetic1'><span class='ts1-lmr10-x-x-109'>§</span>A-1.2<!-- tex4ht:ref: subsec:groupddef  --></a>: the same properties hold
in both systems because any two congruent residues in the centered system are separated by the
<!-- l. 156 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi mathvariant='italic'>𝑘𝑞</mi></mrow></math> gaps (for
some integer <!-- l. 156 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>k</mi></math>)
in both systems.
</p><!-- l. 158 --><p class='indent'>   Also, the same property holds for an inverse: an inverse of
<!-- l. 158 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>a</mi></math> modulo
<!-- l. 158 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>q</mi></math> is
<!-- l. 158 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>a</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msup></math> such
that <!-- l. 158 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>a</mi> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>a</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msup> <mo class='MathClass-rel' stretchy='false'>≡</mo><mn>1</mn><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi>q</mi></mrow></math>.
</p><!-- l. 160 --><p class='indent'>   Using a signed residue representation is useful in certain cases. In an example
of canonical (i.e., unsigned) residue representation, suppose we have the relation
<!-- l. 160 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>a</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>b</mi><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi>q</mi></mrow></math> and we know that in
a given application, <!-- l. 160 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>a</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>b</mi></mrow></math> is
guaranteed to be within the <!-- l. 160 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>[</mo><mn>0</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mi>q</mi> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>]</mo></mrow></math>
range (i.e., <!-- l. 160 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mn>0</mn> <mo class='MathClass-rel' stretchy='false'>≤</mo><mi>a</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>b</mi> <mo class='MathClass-rel' stretchy='false'>≤</mo><mi>q</mi> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></math>).
                                                                                         
                                                                                         
Then, <!-- l. 160 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><mi>a</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>b</mi><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi>q</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
= <!-- l. 160 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>a</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>b</mi></mrow></math>,
and thus we can remove the modulo operation, simplifying the relation. Now, suppose a
different example of centered (i.e., signed) residue representation where we have the relation
<!-- l. 160 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>a</mi> <mo class='MathClass-bin' stretchy='false'>−</mo><mi>b</mi><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi>q</mi></mrow></math>, and we know that in a given
application, <!-- l. 160 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>a</mi> <mo class='MathClass-bin' stretchy='false'>−</mo><mi>b</mi></mrow></math> is guaranteed
to be within the range <!-- l. 160 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'> <mrow><mo fence='true' form='prefix'>[</mo><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mstyle displaystyle='true'><mfrac><mrow><mi>q</mi>
</mrow><mrow><mn>2</mn></mrow></mfrac></mstyle><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle displaystyle='true'><mfrac><mrow><mi>q</mi>
</mrow><mrow><mn>2</mn></mrow></mfrac></mstyle> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow><mo fence='true' form='postfix'>]</mo></mrow></math>.
Then, <!-- l. 160 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><mi>a</mi> <mo class='MathClass-bin' stretchy='false'>−</mo><mi>b</mi><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi>q</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo> <mi>a</mi> <mo class='MathClass-bin' stretchy='false'>−</mo><mi>b</mi></mrow></math>. However, notice
that if the relation <!-- l. 160 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>a</mi> <mo class='MathClass-bin' stretchy='false'>−</mo><mi>b</mi><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi>q</mi></mrow></math>
were in a canonical residue representation, then we cannot remove the modulo operation, because if
<!-- l. 160 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>a</mi> <mo class='MathClass-bin' stretchy='false'>−</mo><mi>b</mi></mrow></math> is
negative, then this becomes smaller than the lower bound of the canonical residue system (i.e.,
<!-- l. 160 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mn>0</mn></math>), and thus a modulo reduction
(i.e., addition by one or more <!-- l. 160 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>q</mi></math>)
is needed.
</p><!-- l. 162 --><p class='indent'>   In <span class='rm-lmbx-10x-x-109'>??</span>, we design the <span class='rm-lmss-10x-x-109'>FastBConvEx </span>operation based on this beneficial property
of centered residue representation: in this algorithm design, we can simplify
<!-- l. 162 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><mi>μ</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>u</mi><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <msub><mrow><mi>b</mi></mrow><mrow><mi>α</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math> to
<!-- l. 162 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>μ</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>u</mi></mrow></math>, because we
know that <!-- l. 162 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mstyle displaystyle='true'><mfrac><mrow><msub><mrow><mi>b</mi></mrow><mrow><mi>α</mi></mrow></msub>
 </mrow><mrow><mn>2</mn> </mrow></mfrac></mstyle> <mo class='MathClass-rel' stretchy='false'>≤</mo><mi>μ</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>u</mi> <mo class='MathClass-rel' stretchy='false'><mfrac><mrow><msub><mrow><mi>b</mi></mrow><mrow><mi>α</mi></mrow></msub>
 </mrow><mrow><mn>2</mn> </mrow></mfrac></mo>.
                                                                                         
                                                                                         
   
</mrow></math></p>
   <h3 class='sectionHead' id='group'><span class='titlemark'>A-2   </span> <a id='x1-10000A-2'></a>Group</h3>
   
   <h4 class='subsectionHead' id='definitions'><span class='titlemark'>A-2.1   </span> <a id='x1-11000A-2.1'></a>Definitions</h4>
   <div class='tcolorbox tcolorbox' id='tcolobox-5'>     
<div class='tcolorbox-title'>
<!-- l. 41 --><p class='indent'>   <!-- l. 41 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mstyle mathvariant='bold'><mo class='MathClass-open' stretchy='false'>⟨</mo></mstyle></math><span class='rm-lmbx-10x-x-109'>Definition </span><a href='#definitions'><span class='rm-lmbx-10x-x-109'>A-2.1</span><!-- tex4ht:ref: subsec:groupddef  --></a><!-- l. 41 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mstyle mathvariant='bold'><mo class='MathClass-close' stretchy='false'>⟩</mo></mstyle></math>
                                                                                         
                                                                                         
<span class='rm-lmbx-10x-x-109'>Group</span></p></div> 
<div class='tcolorbox-content'><!-- l. 9 --><p class='noindent'><span class='underline'><span class='rm-lmbx-10x-x-109'>Set Elements</span></span> </p>
   <ul class='itemize1'>
   <li class='itemize'><span class='rm-lmbx-10x-x-109'>Set (</span><!-- l. 11 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>𝕊</mi></math><span class='rm-lmbx-10x-x-109'>):</span>
   A bundle of elements: <!-- l. 11 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>𝕊</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>{</mo><mi>a</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>b</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>c</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><mstyle class='text'><mtext></mtext><mstyle class='math'><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace></mstyle><mtext></mtext></mstyle><mstyle class='text'><mtext> </mtext></mstyle><mo class='MathClass-punc' stretchy='false'>,</mo><mi>n</mi><mo class='MathClass-close' stretchy='false'>}</mo></mrow></math>
  </li>
  <li class='itemize'><span class='rm-lmbx-10x-x-109'>Set Operations </span><!-- l. 12 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mstyle mathvariant='bold'><mtext class='MathClass-open' stretchy='false'>(+,⋅)</mtext></mstyle></math><span class='rm-lmbx-10x-x-109'>:</span>
   A       set       defines       two       operations       between       any       two       elements
    <!-- l. 12 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>a</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>b</mi> <mo class='MathClass-rel' stretchy='false'>∈</mo> <mi>𝕊</mi></mrow></math>
    as operands: addition <!-- l. 12 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mtext class='MathClass-open' stretchy='false'>(+)</mtext></mrow></math>
    and multiplication <!-- l. 12 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mtext class='MathClass-open' stretchy='false'>(⋅)</mtext></mrow></math>
    </li>
    <li class='itemize'><span class='rm-lmbx-10x-x-109'>Additive Identity (</span><!-- l. 13 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mn>1</mn></mrow><mrow><mtext class='MathClass-open' stretchy='false'>(+)</mtext></mrow></msub></math><span class='rm-lmbx-10x-x-109'>):</span>
   An element <!-- l. 13 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>i</mi> <mo class='MathClass-rel' stretchy='false'>∈</mo> <mi>𝕊</mi></mrow></math>
    is an additive identity if for all <!-- l. 13 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>a</mi> <mo class='MathClass-rel' stretchy='false'>∈</mo> <mi>𝕊</mi></mrow></math>,
    <!-- l. 13 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>i</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>a</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mi>a</mi></mrow></math>.
    </li>
    <li class='itemize'><span class='rm-lmbx-10x-x-109'>Multiplicative Identity (</span><!-- l. 14 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mn>1</mn></mrow><mrow><mtext class='MathClass-open' stretchy='false'>(⋅)</mtext></mrow></msub></math><span class='rm-lmbx-10x-x-109'>):</span>
   An element <!-- l. 14 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>i</mi> <mo class='MathClass-rel' stretchy='false'>∈</mo> <mi>𝕊</mi></mrow></math>
    is an additive identity if for all <!-- l. 14 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>a</mi> <mo class='MathClass-rel' stretchy='false'>∈</mo> <mi>𝕊</mi></mrow></math>,
    <!-- l. 14 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>i</mi> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mi>a</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mi>a</mi></mrow></math>
   </li>
   <li class='itemize'><span class='rm-lmbx-10x-x-109'>Additive Inverse (</span><!-- l. 15 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>a</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msup></math><span class='rm-lmbx-10x-x-109'>):</span>
   For each <!-- l. 15 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>a</mi> <mo class='MathClass-rel' stretchy='false'>∈</mo> <mi>𝕊</mi></mrow></math>,
    its additive inverse <!-- l. 15 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>a</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msup></math>
     is defined as an element such that <!-- l. 15 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>a</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>a</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mn>1</mn></mrow><mrow><mtext class='MathClass-open' stretchy='false'>(+)</mtext></mrow></msub></mrow></math>
     (i.e., additive identity)
    </li>
    <li class='itemize'><span class='rm-lmbx-10x-x-109'>Multiplicative Inverse (</span><!-- l. 16 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>a</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msup></math><span class='rm-lmbx-10x-x-109'>):</span>
   For each <!-- l. 16 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>a</mi> <mo class='MathClass-rel' stretchy='false'>∈</mo> <mi>𝕊</mi></mrow></math>
    except for <!-- l. 16 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>a</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>0</mn></mrow></math>,
    its multiplicative inverse <!-- l. 16 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>a</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msup></math>
     is defined as an element such that <!-- l. 16 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>a</mi> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>a</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mn>1</mn></mrow><mrow><mtext class='MathClass-open' stretchy='false'>(⋅)</mtext></mrow></msub></mrow></math>
     (i.e., multiplicative identity)</li></ul>
<!-- l. 19 --><p class='noindent'><!-- l. 19 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 21 --><p class='noindent'><span class='underline'><span class='rm-lmbx-10x-x-109'>Element Operation Features</span></span> </p>
   <ul class='itemize1'>
   <li class='itemize'><span class='rm-lmbx-10x-x-109'>Closed: </span>A set <!-- l. 23 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>𝕊</mi></math>
    is closed under the <!-- l. 23 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mtext class='MathClass-open' stretchy='false'>(+)</mtext></mrow></math>
    operation if for every <!-- l. 23 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>a</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>b</mi> <mo class='MathClass-rel' stretchy='false'>∈</mo> <mi>𝕊</mi></mrow></math>,
    it is the case that <!-- l. 23 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>a</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>b</mi> <mo class='MathClass-rel' stretchy='false'>∈</mo> <mi>𝕊</mi></mrow></math>.
    Likewise, a set <!-- l. 23 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>𝕊</mi></math>
    is closed under the <!-- l. 23 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mtext class='MathClass-open' stretchy='false'>(⋅)</mtext></mrow></math>
    operation if for every <!-- l. 23 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>a</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>b</mi> <mo class='MathClass-rel' stretchy='false'>∈</mo> <mi>𝕊</mi></mrow></math>,
    it is the case that <!-- l. 23 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>a</mi> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mi>b</mi> <mo class='MathClass-rel' stretchy='false'>∈</mo> <mi>𝕊</mi></mrow></math>.
    </li>
    <li class='itemize'><span class='rm-lmbx-10x-x-109'>Associative: </span><!-- l. 24 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><mi>a</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>b</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>c</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mi>a</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mo class='MathClass-open' stretchy='false'>(</mo><mi>b</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>c</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
    </li>
    <li class='itemize'><span class='rm-lmbx-10x-x-109'>Commutative: </span><!-- l. 25 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>a</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>b</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mi>b</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>a</mi></mrow></math>
   </li>
   <li class='itemize'><span class='rm-lmbx-10x-x-109'>Distributive: </span><!-- l. 26 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>a</mi> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mo class='MathClass-open' stretchy='false'>(</mo><mi>b</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>c</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>(</mo><mi>a</mi> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mi>b</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>+</mo> <mo class='MathClass-open' stretchy='false'>(</mo><mi>a</mi> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mi>c</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math></li></ul>
<!-- l. 30 --><p class='noindent'><!-- l. 30 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 32 --><p class='noindent'><span class='underline'><span class='rm-lmbx-10x-x-109'>Group Types</span></span> </p>
   <ul class='itemize1'>
   <li class='itemize'><span class='rm-lmbx-10x-x-109'>Semigroup: </span>A semigroup is a set of elements which is closed and associative on a single
    operation (<!-- l. 34 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mo class='MathClass-bin' stretchy='false'>+</mo></math>
    or <!-- l. 34 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mo class='MathClass-bin' stretchy='false'>⋅</mo></math>)
    </li>
    <li class='itemize'>
    <!-- l. 35 --><p class='noindent'><span class='rm-lmbx-10x-x-109'>Monoid: </span>A monoid is a semigroup, plus it has an identity element, which returns the
    other operand over the set operation.
    </p><!-- l. 37 --><p class='noindent'>(e.g., <!-- l. 37 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mn>0</mn></math>
    is the identity element for <!-- l. 37 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mo class='MathClass-bin' stretchy='false'>+</mo></math>
    operator, <!-- l. 37 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mn>1</mn></math>
    is the identity element for the <!-- l. 37 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mo class='MathClass-bin' stretchy='false'>⋅</mo></math>
  operator)
    </p></li>
    <li class='itemize'><span class='rm-lmbx-10x-x-109'>Group: </span>A group is a monoid, plus every element has an inverse (except for that of 0, the
    identity)
    </li>
    <li class='itemize'><span class='rm-lmbx-10x-x-109'>Abelian Group: </span>An abelian group is a group, plus its operation is commutative.</li></ul>
 
</div> 
</div>                                                                                   
                                                                                         
   
   <h4 class='subsectionHead' id='examples'><span class='titlemark'>A-2.2   </span> <a id='x1-12000A-2.2'></a>Examples</h4>
<!-- l. 46 --><p class='noindent'><!-- l. 46 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>ℤ</mi></math>
(i.e., a set of all integers) is an abelian group under addition
(<!-- l. 46 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mo class='MathClass-bin' stretchy='false'>+</mo></math>),
because: </p>
   <ul class='itemize1'>
   <li class='itemize'><span class='rm-lmbx-10x-x-109'>Closed: </span>For any integer <!-- l. 48 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>a</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>b</mi> <mo class='MathClass-rel' stretchy='false'>∈</mo> <mi>ℤ</mi></mrow></math>,
   <!-- l. 48 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>a</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>b</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mi>c</mi></mrow></math>
   is also an integer (<!-- l. 48 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>∈</mo> <mi>ℤ</mi></mrow></math>).
   </li>
   <li class='itemize'><span class='rm-lmbx-10x-x-109'>Associative: </span>For any integer <!-- l. 49 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>a</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>b</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>c</mi> <mo class='MathClass-rel' stretchy='false'>∈</mo> <mi>ℤ</mi></mrow></math>,
   <!-- l. 49 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><mi>a</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>b</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>c</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mi>a</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mo class='MathClass-open' stretchy='false'>(</mo><mi>b</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>c</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>.
   </li>
   <li class='itemize'><span class='rm-lmbx-10x-x-109'>Identity: </span>The additive identity is 0, because for any <!-- l. 50 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>a</mi> <mo class='MathClass-rel' stretchy='false'>∈</mo> <mi>ℤ</mi></mrow></math>,
   <!-- l. 50 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>a</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>0</mn> <mo class='MathClass-rel' stretchy='false'>=</mo> <mi>a</mi></mrow></math>.
   </li>
   <li class='itemize'><span class='rm-lmbx-10x-x-109'>Inverse: </span>For each <!-- l. 51 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>a</mi> <mo class='MathClass-rel' stretchy='false'>∈</mo> <mi>ℤ</mi></mrow></math>,
   its additive inverse is <!-- l. 51 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-bin' stretchy='false'>−</mo><mi>a</mi></mrow></math>,
   as <!-- l. 51 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>a</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mo class='MathClass-open' stretchy='false'>(</mo><mo class='MathClass-bin' stretchy='false'>−</mo><mi>a</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>0</mn></mrow></math>.
   </li>
   <li class='itemize'><span class='rm-lmbx-10x-x-109'>Commutative: </span>For any integer <!-- l. 52 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>a</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>b</mi> <mo class='MathClass-rel' stretchy='false'>∈</mo> <mi>ℤ</mi></mrow></math>,
   <!-- l. 52 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>a</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>b</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mi>b</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>a</mi></mrow></math>.</li></ul>
<!-- l. 55 --><p class='indent'>   <!-- l. 55 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 57 --><p class='noindent'><!-- l. 57 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>ℤ</mi></math> is a monoid under
multiplication (<!-- l. 57 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mo class='MathClass-bin' stretchy='false'>⋅</mo></math>),
because: </p>
   <ul class='itemize1'>
   <li class='itemize'><span class='rm-lmbx-10x-x-109'>Closed: </span>For any integer <!-- l. 59 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>a</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>b</mi> <mo class='MathClass-rel' stretchy='false'>∈</mo> <mi>ℤ</mi></mrow></math>,
   <!-- l. 59 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>a</mi> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mi>b</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mi>c</mi></mrow></math>
   is also an integer (<!-- l. 59 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>∈</mo> <mi>ℤ</mi></mrow></math>).
   </li>
   <li class='itemize'><span class='rm-lmbx-10x-x-109'>Associative: </span>For any integer <!-- l. 60 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>a</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>b</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>c</mi> <mo class='MathClass-rel' stretchy='false'>∈</mo> <mi>ℤ</mi></mrow></math>,
   <!-- l. 60 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><mi>a</mi> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mi>b</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mi>c</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mi>a</mi> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mo class='MathClass-open' stretchy='false'>(</mo><mi>b</mi> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mi>c</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>.
   </li>
   <li class='itemize'><span class='rm-lmbx-10x-x-109'>Identity: </span>The multiplicative identity is 1, because for any <!-- l. 61 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>a</mi> <mo class='MathClass-rel' stretchy='false'>∈</mo> <mi>ℤ</mi></mrow></math>,
   <!-- l. 61 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>a</mi> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mn>1</mn> <mo class='MathClass-rel' stretchy='false'>=</mo> <mi>a</mi></mrow></math>.
   </li>
   <li class='itemize'><span class='rm-lmbx-10x-x-109'>NO Inverse: </span>For an integer <!-- l. 62 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>a</mi> <mo class='MathClass-rel' stretchy='false'>∈</mo> <mi>ℤ</mi></mrow></math>,
   its multiplicative inverse is <!-- l. 62 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mstyle displaystyle='true'><mfrac><mrow><mn>1</mn>
</mrow><mrow><mi>a</mi></mrow></mfrac></mstyle></math>,
   but this is not necessarily an integer (<!-- l. 62 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-rel' stretchy='false'>∉</mo><mi>ℤ</mi></mrow></math>),
   and thus breaks the closure property.</li></ul>
<!-- l. 64 --><p class='noindent'><!-- l. 64 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 66 --><p class='noindent'><!-- l. 66 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>ℝ</mi></math>
(i.e., a set of all real numbers) is an abelian group under multiplication
(<!-- l. 66 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mo class='MathClass-bin' stretchy='false'>⋅</mo></math>),
because: </p>
   <ul class='itemize1'>
   <li class='itemize'><span class='rm-lmbx-10x-x-109'>Closed: </span>For any real number <!-- l. 68 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>a</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>b</mi> <mo class='MathClass-rel' stretchy='false'>∈</mo> <mi>ℝ</mi></mrow></math>,
   <!-- l. 68 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>a</mi> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mi>b</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mi>c</mi></mrow></math>
   is also a real number (<!-- l. 68 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>∈</mo> <mi>ℝ</mi></mrow></math>).
   </li>
   <li class='itemize'><span class='rm-lmbx-10x-x-109'>Associative: </span>For any real number <!-- l. 69 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>a</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>b</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>c</mi> <mo class='MathClass-rel' stretchy='false'>∈</mo> <mi>ℝ</mi></mrow></math>,
   <!-- l. 69 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><mi>a</mi> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mi>b</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mi>c</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mi>a</mi> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mo class='MathClass-open' stretchy='false'>(</mo><mi>b</mi> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mi>c</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>.
   </li>
   <li class='itemize'><span class='rm-lmbx-10x-x-109'>Identity: </span>The multiplicative identity is 1, as for any real number <!-- l. 70 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>a</mi> <mo class='MathClass-rel' stretchy='false'>∈</mo> <mi>ℝ</mi></mrow></math>,
   <!-- l. 70 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>a</mi> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mn>1</mn> <mo class='MathClass-rel' stretchy='false'>=</mo> <mi>a</mi></mrow></math>.
   </li>
   <li class='itemize'><span class='rm-lmbx-10x-x-109'>Inverse: </span>For each real number <!-- l. 71 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>a</mi> <mo class='MathClass-rel' stretchy='false'>∈</mo> <mi>ℝ</mi></mrow></math>
   (except for 0, the identity), its multiplicative inverse is <!-- l. 71 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mstyle displaystyle='true'><mfrac><mrow><mn>1</mn>
</mrow><mrow><mi>a</mi></mrow></mfrac></mstyle></math>,
   which is a real number (<!-- l. 71 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>∈</mo> <mi>ℝ</mi></mrow></math>).</li></ul>
                                                                                         
                                                                                         
   
   <h3 class='sectionHead' id='field'><span class='titlemark'>A-3   </span> <a id='x1-13000A-3'></a>Field</h3>
<!-- l. 1 --><p class='noindent'><span class='rm-lmbx-10x-x-109'>- Reference:  </span><a href='https://e.math.cornell.edu/people/belk/numbertheory/CyclotomicPolynomials.pdf'>Fields and Cyclotomic Polynomials</a> <span class='cite'>[<span class='rm-lmbx-10x-x-109'>?</span>]</span>
   
</p>
   <h4 class='subsectionHead' id='definitions1'><span class='titlemark'>A-3.1   </span> <a id='x1-14000A-3.1'></a>Definitions</h4>
   <div class='tcolorbox tcolorbox' id='tcolobox-6'>     
<div class='tcolorbox-title'>
<!-- l. 14 --><p class='indent'>   <!-- l. 14 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mstyle mathvariant='bold'><mo class='MathClass-open' stretchy='false'>⟨</mo></mstyle></math><span class='rm-lmbx-10x-x-109'>Definition </span><a href='#definitions1'><span class='rm-lmbx-10x-x-109'>A-3.1</span><!-- tex4ht:ref: subsec:fieldddef  --></a><!-- l. 14 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mstyle mathvariant='bold'><mo class='MathClass-close' stretchy='false'>⟩</mo></mstyle></math>
<span class='rm-lmbx-10x-x-109'>Field Definitions</span></p></div> 
<div class='tcolorbox-content'>   <ul class='itemize1'>
   <li class='itemize'><span class='rm-lmbx-10x-x-109'>Ring:    </span>A     set     of     elements     which     is     an     abelian     group     under
    the     +     operator,     and     closed,     associative,     and     distributive     on     the
    (<!-- l. 9 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mtext class='MathClass-bin' stretchy='false'>+,⋅</mtext></mrow></math>)
    operators.
    </li>
    <li class='itemize'><span class='rm-lmbx-10x-x-109'>Field:   </span>A   set   of   elements   which   is   an   abelian   group   under   both   the
    <!-- l. 10 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mtext class='MathClass-open' stretchy='false'>(+,⋅)</mtext></mrow></math>
    operators  (i.e.,  the  set  has  an  identity  element  and  multiplicative  inverses  for  all
    elements), and distributive on those operators.
    </li>
    <li class='itemize'><span class='rm-lmbx-10x-x-109'>Galois Field (</span><!-- l. 11 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mstyle class='text'><mtext>GF</mtext></mstyle><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>p</mi></mrow><mrow><mi>n</mi></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math><span class='rm-lmbx-10x-x-109'>):</span>
   A    field    with    a    finite    number    of    elements    (whose    number    must    be
    <!-- l. 11 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>p</mi></mrow><mrow><mi>n</mi></mrow></msup></math>
    for some prime <!-- l. 11 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>p</mi></math>
   and a positive integer <!-- l. 11 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>n</mi></math>).
    </li>
    <li class='itemize'><!-- l. 12 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>ℤ</mi></mrow><mrow><mi>p</mi></mrow></msub></math>
    <span class='rm-lmbx-10x-x-109'>(</span><!-- l. 12 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>ℤ</mi><mo class='MathClass-bin' stretchy='false'>∕</mo><mi mathvariant='italic'>𝑝ℤ</mi></mrow></math><span class='rm-lmbx-10x-x-109'>):</span>
   The finite field of integer modulo <!-- l. 12 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>p</mi></math>,
    which is <!-- l. 12 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>{</mo><mn>0</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>1</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>2</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace><mo class='MathClass-punc' stretchy='false'>.</mo><mo class='MathClass-punc' stretchy='false'>.</mo><mo class='MathClass-punc' stretchy='false'>.</mo><mstyle class='text'><mtext> </mtext></mstyle><mi>p</mi> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>}</mo></mrow></math>
  where <!-- l. 12 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>p</mi></math>
   is a prime number. If <!-- l. 12 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>p</mi></math>
   is a prime number, <!-- l. 12 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>ℤ</mi></mrow><mrow><mi>p</mi></mrow></msub></math>
    is    always    a    finite    field.    This    is    also    called    a    quotient    ring    of
    <!-- l. 12 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>p</mi></math>.</li></ul>
 
</div> 
</div>
<!-- l. 15 --><p><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
   
                                                                                         
                                                                                         
   </p><h4 class='subsectionHead' id='examples1'><span class='titlemark'>A-3.2   </span> <a id='x1-15000A-3.2'></a>Examples</h4>
<!-- l. 20 --><p class='noindent'><!-- l. 20 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>ℤ</mi></math> (a set
of all integers) is a ring, but not a field, because not all of its elements have a multiplicative inverse (as
shown in <a href='#examples'><span class='ts1-lmr10-x-x-109'>§</span>A-2.2<!-- tex4ht:ref: subsec:groupddef  --></a>).
</p><!-- l. 22 --><p class='indent'>   <!-- l. 22 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 24 --><p class='noindent'><!-- l. 24 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>ℝ</mi></math> (a
set of all real numbers) is a field. As shown in <a href='#examples'><span class='ts1-lmr10-x-x-109'>§</span>A-2.2<!-- tex4ht:ref: subsec:groupddef  --></a>, it is an abelian group over the
<!-- l. 24 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mtext class='MathClass-open' stretchy='false'>(+)</mtext></mrow></math> and
<!-- l. 24 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mtext class='MathClass-open' stretchy='false'>(⋅)</mtext></mrow></math> operators, and its elements
are distributive over the <!-- l. 24 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mtext class='MathClass-open' stretchy='false'>(+,⋅)</mtext></mrow></math>
operators.
</p><!-- l. 27 --><p class='indent'>   <!-- l. 27 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 29 --><p class='noindent'><!-- l. 29 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>ℤ</mi></mrow><mrow><mn>7</mn></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>{</mo><mn>0</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>1</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>2</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>3</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>4</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>5</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>6</mn><mo class='MathClass-close' stretchy='false'>}</mo></mrow></math> is a
finite field because: </p>
   <ul class='itemize1'>
   <li class='itemize'><span class='rm-lmbx-10x-x-109'>Closed: </span>For any <!-- l. 31 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>a</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>b</mi> <mo class='MathClass-rel' stretchy='false'>∈</mo> <msub><mrow><mi>ℤ</mi></mrow><mrow><mn>7</mn></mrow></msub></mrow></math>,
   there exists some <!-- l. 31 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>c</mi></mrow><mrow><mn>1</mn></mrow></msub> <mo class='MathClass-rel' stretchy='false'>∈</mo> <msub><mrow><mi>ℤ</mi></mrow><mrow><mn>7</mn></mrow></msub></mrow></math>
   such that <!-- l. 31 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>a</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>b</mi> <mo class='MathClass-rel' stretchy='false'>≡</mo><msub><mrow><mi>c</mi></mrow><mrow><mn>1</mn></mrow></msub><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mn>7</mn></mrow></math>
   and, some <!-- l. 31 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>c</mi></mrow><mrow><mn>2</mn></mrow></msub> <mo class='MathClass-rel' stretchy='false'>∈</mo> <msub><mrow><mi>ℤ</mi></mrow><mrow><mn>7</mn></mrow></msub></mrow></math>
   such that <!-- l. 31 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>a</mi> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mi>b</mi> <mo class='MathClass-rel' stretchy='false'>≡</mo><msub><mrow><mi>c</mi></mrow><mrow><mn>2</mn></mrow></msub><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mn>7</mn></mrow></math>.
   </li>
   <li class='itemize'><span class='rm-lmbx-10x-x-109'>Associative: </span>For any <!-- l. 32 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>a</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>b</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>c</mi> <mo class='MathClass-rel' stretchy='false'>∈</mo> <msub><mrow><mi>ℤ</mi></mrow><mrow><mn>7</mn></mrow></msub></mrow></math>,
   <!-- l. 32 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><mi>a</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>b</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>c</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mi>a</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mo class='MathClass-open' stretchy='false'>(</mo><mi>b</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>c</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
   and <!-- l. 32 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><mi>a</mi> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mi>b</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mi>c</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mi>a</mi> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mo class='MathClass-open' stretchy='false'>(</mo><mi>b</mi> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mi>c</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>.
   </li>
   <li class='itemize'><span class='rm-lmbx-10x-x-109'>Commutative: </span>For any <!-- l. 33 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>a</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>b</mi> <mo class='MathClass-rel' stretchy='false'>∈</mo> <msub><mrow><mi>ℤ</mi></mrow><mrow><mn>7</mn></mrow></msub></mrow></math>,
   <!-- l. 33 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>a</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>b</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mi>b</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>a</mi></mrow></math>,
   and <!-- l. 33 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>a</mi> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mi>b</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mi>b</mi> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mi>a</mi></mrow></math>.
   </li>
   <li class='itemize'><span class='rm-lmbx-10x-x-109'>Distributive: </span>For any <!-- l. 34 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>a</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>b</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>c</mi> <mo class='MathClass-rel' stretchy='false'>∈</mo> <msub><mrow><mi>ℤ</mi></mrow><mrow><mn>7</mn></mrow></msub></mrow></math>,
   <!-- l. 34 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><mi>a</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>b</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mi>c</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mi>a</mi> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mi>c</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>b</mi> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mi>c</mi></mrow></math>.
   </li>
   <li class='itemize'><span class='rm-lmbx-10x-x-109'>Identity: </span>For any <!-- l. 35 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>a</mi> <mo class='MathClass-rel' stretchy='false'>∈</mo> <msub><mrow><mi>ℤ</mi></mrow><mrow><mn>7</mn></mrow></msub></mrow></math>,
   its additive identity is <!-- l. 35 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mn>0</mn></math>,
   and its multiplicative identity is <!-- l. 35 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mn>1</mn></math>.
   </li>
   <li class='itemize'><span class='rm-lmbx-10x-x-109'>Inverse: </span>For any <!-- l. 36 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>a</mi> <mo class='MathClass-rel' stretchy='false'>∈</mo> <msub><mrow><mi>ℤ</mi></mrow><mrow><mn>7</mn></mrow></msub></mrow></math>,
   there exists an additive inverse <!-- l. 36 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msubsup><mrow><mi>a</mi></mrow><mrow><mn>1</mn></mrow><mrow><mi>′</mi></mrow></msubsup> <mo class='MathClass-rel' stretchy='false'>∈</mo> <msub><mrow><mi>ℤ</mi></mrow><mrow><mn>7</mn></mrow></msub></mrow></math>
                                                                                         
                                                                                         
   such that <!-- l. 36 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>a</mi></mrow><mrow><mn>1</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <msubsup><mrow><mi>a</mi></mrow><mrow><mn>1</mn></mrow><mrow><mi>′</mi></mrow></msubsup> <mo class='MathClass-rel' stretchy='false'>≡</mo><mn>0</mn><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mn>7</mn></mrow></math>.
   For example, if <!-- l. 36 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>a</mi></mrow><mrow><mn>1</mn></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>3</mn></mrow></math>,
   then its additive inverse <!-- l. 36 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msubsup><mrow><mi>a</mi></mrow><mrow><mn>1</mn></mrow><mrow><mi>′</mi></mrow></msubsup> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>4</mn></mrow></math>,
   because <!-- l. 36 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mn>3</mn> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>4</mn> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>7</mn> <mo class='MathClass-rel' stretchy='false'>≡</mo><mn>0</mn><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mn>7</mn></mrow></math>.
   Also, for any <!-- l. 36 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>a</mi></mrow><mrow><mn>2</mn></mrow></msub> <mo class='MathClass-rel' stretchy='false'>∈</mo> <msub><mrow><mi>ℤ</mi></mrow><mrow><mn>7</mn></mrow></msub></mrow></math>
   (except for 0), there exists a multiplicative inverse <!-- l. 36 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msubsup><mrow><mi>a</mi></mrow><mrow><mn>2</mn></mrow><mrow><mi>′</mi></mrow></msubsup> <mo class='MathClass-rel' stretchy='false'>∈</mo> <msub><mrow><mi>ℤ</mi></mrow><mrow><mn>7</mn></mrow></msub></mrow></math>
   such that <!-- l. 36 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>a</mi></mrow><mrow><mn>2</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msubsup><mrow><mi>a</mi></mrow><mrow><mn>2</mn></mrow><mrow><mi>′</mi></mrow></msubsup> <mo class='MathClass-rel' stretchy='false'>≡</mo><mn>1</mn><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mn>7</mn></mrow></math>.
   For example, if <!-- l. 36 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>a</mi></mrow><mrow><mn>2</mn></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>3</mn></mrow></math>,
   then its multiplicative inverse <!-- l. 36 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msubsup><mrow><mi>a</mi></mrow><mrow><mn>2</mn></mrow><mrow><mi>′</mi></mrow></msubsup> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>5</mn></mrow></math>,
   because <!-- l. 36 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mn>3</mn> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mn>5</mn> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>15</mn> <mo class='MathClass-rel' stretchy='false'>≡</mo><mn>1</mn><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mn>7</mn></mrow></math>.</li></ul>
   
   <h4 class='subsectionHead' id='theorems'><span class='titlemark'>A-3.3   </span> <a id='x1-16000A-3.3'></a>Theorems</h4>
   <div class='tcolorbox tcolorbox' id='tcolobox-7'>     
<div class='tcolorbox-title'>
<!-- l. 47 --><p class='indent'>   <!-- l. 47 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mstyle mathvariant='bold'><mo class='MathClass-open' stretchy='false'>⟨</mo></mstyle></math><span class='rm-lmbx-10x-x-109'>Theorem </span><a href='#theorems'><span class='rm-lmbx-10x-x-109'>A-3.3</span><!-- tex4ht:ref: subsec:fieldttheorem  --></a><!-- l. 47 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mstyle mathvariant='bold'><mo class='MathClass-close' stretchy='false'>⟩</mo></mstyle></math>
<span class='rm-lmbx-10x-x-109'>Field Theorems</span></p></div> 
<div class='tcolorbox-content'>   <dl class='enumerate-enumitem'><dt class='enumerate-enumitem'>
1.  </dt><dd class='enumerate-enumitem'><span class='rm-lmbx-10x-x-109'>Size   of   Finite   Field:  </span>A   finite   field   is   called   Galois   field   and   always   has
    <!-- l. 44 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>p</mi></mrow><mrow><mi>n</mi></mrow></msup></math>
    elements (where <!-- l. 44 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>p</mi></math>
   is a prime and <!-- l. 44 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>n</mi></math>
   is a positive integer).
    </dd><dt class='enumerate-enumitem'>
2.  </dt><dd class='enumerate-enumitem'><span class='rm-lmbx-10x-x-109'>Isomorphic Fields: </span>Any two finite fields, <!-- l. 45 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>𝔽</mi></mrow><mrow><mn>1</mn></mrow></msub></math>
     and <!-- l. 45 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>𝔽</mi></mrow><mrow><mn>2</mn></mrow></msub></math>
     with       the       same       number       of       elements       are       isomorphic       (i.e.,
    there         exists         a         bi-jective         one-to-one         mapping         function
    <!-- l. 45 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>f</mi> <mo class='MathClass-punc' stretchy='false'>:</mo> <msub><mrow><mi>𝔽</mi></mrow><mrow><mn>1</mn></mrow></msub> <mo class='MathClass-rel' stretchy='false'>→</mo> <msub><mrow><mi>𝔽</mi></mrow><mrow><mn>2</mn></mrow></msub></mrow></math>
     and the algebraic operations <!-- l. 45 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mtext class='MathClass-open' stretchy='false'>(+,⋅)</mtext></mrow></math>
    preserve          correctness          among          newly          mapped          elements).
    In         other         words,         there         exists         a         mapping         function
    <!-- l. 45 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>f</mi> <mo class='MathClass-punc' stretchy='false'>:</mo> <msub><mrow><mi>𝔽</mi></mrow><mrow><mn>1</mn></mrow></msub> <mo class='MathClass-rel' stretchy='false'>→</mo> <msub><mrow><mi>𝔽</mi></mrow><mrow><mn>2</mn></mrow></msub></mrow></math>
     comprised of the field operators (<!-- l. 45 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mo class='MathClass-bin' stretchy='false'>+</mo></math>,
    <!-- l. 45 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mo class='MathClass-bin' stretchy='false'>⋅</mo></math>).
    For such an isomorphic function <!-- l. 45 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>f</mi></math>,
    for any <!-- l. 45 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>a</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>b</mi> <mo class='MathClass-rel' stretchy='false'>∈</mo> <msub><mrow><mi>𝔽</mi></mrow><mrow><mn>1</mn></mrow></msub></mrow></math>,
    <!-- l. 45 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>f</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>a</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>b</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo> <mi>f</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>a</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>f</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>b</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
    and <!-- l. 45 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>f</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>a</mi> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mi>b</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo> <mi>f</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>a</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mi>f</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>b</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math></dd></dl>
 
</div> 
</div>
                                                                                         
                                                                                         
   
   <h3 class='sectionHead' id='order'><span class='titlemark'>A-4   </span> <a id='x1-17000A-4'></a>Order</h3>
<!-- l. 1 --><p class='noindent'><span class='rm-lmbx-10x-x-109'>- Reference:  </span><a href='https://e.math.cornell.edu/people/belk/numbertheory/CyclotomicPolynomials.pdf'>Fields and Cyclotomic Polynomials</a> <span class='cite'>[<span class='rm-lmbx-10x-x-109'>?</span>]</span>
   
</p>
   <h4 class='subsectionHead' id='definitions2'><span class='titlemark'>A-4.1   </span> <a id='x1-18000A-4.1'></a>Definitions</h4>
   <div class='tcolorbox tcolorbox' id='tcolobox-8'>     
<div class='tcolorbox-title'>
<!-- l. 13 --><p class='indent'>   <!-- l. 13 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mstyle mathvariant='bold'><mo class='MathClass-open' stretchy='false'>⟨</mo></mstyle></math><span class='rm-lmbx-10x-x-109'>Definition </span><a href='#definitions2'><span class='rm-lmbx-10x-x-109'>A-4.1</span><!-- tex4ht:ref: subsec:orderddef  --></a><!-- l. 13 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mstyle mathvariant='bold'><mo class='MathClass-close' stretchy='false'>⟩</mo></mstyle></math>
<span class='rm-lmbx-10x-x-109'>Order Definition</span></p></div> 
<div class='tcolorbox-content'><!-- l. 8 --><p class='noindent'><!-- l. 8 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mstyle mathvariant='bold'><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝗈𝗋𝖽</mtext></mstyle></mrow><mrow><mi>𝔽</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mi>𝐚</mi><mo class='MathClass-close' stretchy='false'>)</mo></mstyle></math>:
For <!-- l. 8 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>a</mi> <mo class='MathClass-rel' stretchy='false'>∈</mo> <mi>𝔽</mi></mrow></math>
(a finite field, <a href='#definitions1'><span class='ts1-lmr10-x-x-109'>§</span>A-3.1<!-- tex4ht:ref: subsec:groupddef  --></a>), <!-- l. 8 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>a</mi></math>’s
order is the smallest positive integer <!-- l. 8 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>k</mi></math>
such that <!-- l. 8 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>a</mi></mrow><mrow><mi>k</mi></mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>1</mn></mrow></math>.
</p><!-- l. 10 --><p class='noindent'><!-- l. 10 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p>
 
</div> 
</div>
<!-- l. 15 --><p class='noindent'>Note that the multiplicative group generated by <!-- l. 15 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>a</mi></math>
as a generator excludes <!-- l. 15 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>{</mo><mn>0</mn><mo class='MathClass-close' stretchy='false'>}</mo></mrow></math>,
the identity, because <!-- l. 15 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mn>0</mn></mrow><mrow><mi>k</mi></mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>0</mn></mrow></math>
for all <!-- l. 15 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>k</mi></math>
values.
   
</p>
   <h4 class='subsectionHead' id='theorems1'><span class='titlemark'>A-4.2   </span> <a id='x1-19000A-4.2'></a>Theorems</h4>
   <div class='tcolorbox tcolorbox' id='tcolobox-9'>     
<div class='tcolorbox-title'>
<!-- l. 26 --><p class='indent'>   <!-- l. 26 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mstyle mathvariant='bold'><mo class='MathClass-open' stretchy='false'>⟨</mo></mstyle></math><span class='rm-lmbx-10x-x-109'>Theorem </span><a href='#theorems1'><span class='rm-lmbx-10x-x-109'>A-4.2</span><!-- tex4ht:ref: subsec:orderttheorem  --></a><span class='rm-lmbx-10x-x-109'>.1</span><!-- l. 26 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mstyle mathvariant='bold'><mo class='MathClass-close' stretchy='false'>⟩</mo></mstyle></math>
<span class='rm-lmbx-10x-x-109'>Order Property (I)</span></p></div> 
<div class='tcolorbox-content'><!-- l. 23 --><p class='noindent'>For <!-- l. 23 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>a</mi> <mo class='MathClass-rel' stretchy='false'>∈</mo> <mi>𝔽</mi></mrow></math>,
and <!-- l. 23 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>n</mi> <mo class='MathClass-rel' stretchy='false'>≥</mo><mn>1</mn></mrow></math>,
<!-- l. 23 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>a</mi></mrow><mrow><mi>n</mi></mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>1</mn></mrow></math>
if and only if <span class='rm-lmssbx-10x-x-109'>ord</span><!-- l. 23 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow></mrow><mrow><mi>𝔽</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mi>a</mi><mo class='MathClass-close' stretchy='false'>)</mo><mi>n</mi></mrow></math>
</p><!-- l. 25 --><p class='noindent'>(i.e., <!-- l. 25 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝗈𝗋𝖽</mtext></mstyle></mrow><mrow><mi>𝔽</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mi>a</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
divides <!-- l. 25 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>n</mi></math>).
</p> 
</div> 
</div>
   <div class='proof'>
<!-- l. 29 --><p class='indent'>   <span class='head'>
<span class='rm-lmri-10x-x-109'>Proof.</span>
                                                                                         
                                                                                         
</span><!-- l. 29 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 30 --><p class='indent'>
   </p><dl class='enumerate-enumitem'><dt class='enumerate-enumitem'>
1. </dt><dd class='enumerate-enumitem'><span class='rm-lmri-10x-x-109'>Forward Proof: </span>If <!-- l. 30 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝗈𝗋𝖽</mtext></mstyle></mrow><mrow><mi>𝔽</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mi>a</mi><mo class='MathClass-close' stretchy='false'>)</mo><mstyle class='text'><mtext> </mtext></mstyle><mo class='MathClass-rel' stretchy='false'>|</mo><mstyle class='text'><mtext> </mtext></mstyle><mi>n</mi></mrow></math>,
   then for <!-- l. 30 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝗈𝗋𝖽</mtext></mstyle></mrow><mrow><mi>𝔽</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mi>a</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo> <mi>k</mi></mrow></math>
   where <!-- l. 30 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>k</mi></math>
   is <!-- l. 30 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>a</mi></math>’s
   order, and <!-- l. 30 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>n</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mi mathvariant='italic'>𝑙𝑘</mi></mrow></math>
   for some integer <!-- l. 30 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>l</mi></math>.
   <!-- l. 32 --><p class='noindent'>Then, <!-- l. 32 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>a</mi></mrow><mrow><mi>n</mi></mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo> <msup><mrow><mi>a</mi></mrow><mrow><mi mathvariant='italic'>𝑙𝑘</mi></mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo> <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>a</mi></mrow><mrow><mi>k</mi></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mi>l</mi></mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo> <msup><mrow><mn>1</mn></mrow><mrow><mi>l</mi></mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>1</mn></mrow></math>.
   </p></dd><dt class='enumerate-enumitem'>
2. </dt><dd class='enumerate-enumitem'><span class='rm-lmri-10x-x-109'>Backward Proof: </span>If <!-- l. 33 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>a</mi></mrow><mrow><mi>n</mi></mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>1</mn></mrow></math>,
   then for <!-- l. 33 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝗈𝗋𝖽</mtext></mstyle></mrow><mrow><mi>𝔽</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mi>a</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo> <mi>k</mi></mrow></math>,
   <!-- l. 33 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>n</mi> <mo class='MathClass-rel' stretchy='false'>≥</mo><mi>k</mi></mrow></math>,
   because by definition of order, <!-- l. 33 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>k</mi></math>
   is the smallest value that satisfies <!-- l. 33 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>a</mi></mrow><mrow><mi>k</mi></mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>1</mn></mrow></math>.
   For any <!-- l. 33 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>n</mi> <mstyle class='MathClass-rel' stretchy='false'>/mo&gt; <mi>k</mi></mstyle>,
   <!-- l. 33 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>n</mi></math>
   has to be a multiple of <!-- l. 33 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>k</mi></math>,
   because in order to satisfy <!-- l. 33 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>a</mi></mrow><mrow><mi>n</mi></mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo> <msup><mrow><mi>a</mi></mrow><mrow><mi>k</mi></mrow></msup> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>a</mi></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mi>k</mi></mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>1</mn> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>a</mi></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mi>k</mi></mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>1</mn></math>,
   the next smallest possible value for <!-- l. 33 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>n</mi></math>
   is <!-- l. 33 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mn>2</mn><mi>k</mi></math>
   (as <!-- l. 33 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>a</mi></mrow><mrow><mi>k</mi></mrow></msup></math>
   is the smallest value that is equal to 1). By induction, the possible values of <!-- l. 33 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>n</mi></math>
   are <!-- l. 33 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>n</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mi>k</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mn>2</mn><mi>k</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mn>3</mn><mi>k</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace></math>.</mrow></math></dd></dl>
                                                                                        □
   </div>
   <div class='tcolorbox tcolorbox' id='tcolobox-10'>     
<div class='tcolorbox-title'>
<!-- l. 40 --><p class='indent'>   <!-- l. 40 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mstyle mathvariant='bold'><mo class='MathClass-open' stretchy='false'>⟨</mo></mstyle></math><span class='rm-lmbx-10x-x-109'>Theorem </span><a href='#theorems1'><span class='rm-lmbx-10x-x-109'>A-4.2</span><!-- tex4ht:ref: subsec:orderttheorem  --></a><span class='rm-lmbx-10x-x-109'>.2</span><!-- l. 40 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mstyle mathvariant='bold'><mo class='MathClass-close' stretchy='false'>⟩</mo></mstyle></math>
<span class='rm-lmbx-10x-x-109'>Order Property (II)</span></p></div> 
<div class='tcolorbox-content'><!-- l. 39 --><p class='noindent'>If <!-- l. 39 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝗈𝗋𝖽</mtext></mstyle></mrow><mrow><mi>𝔽</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mi>a</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo> <mi>k</mi></mrow></math>,
then for any <!-- l. 39 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>n</mi> <mo class='MathClass-rel' stretchy='false'>≥</mo><mn>1</mn></mrow></math>,
<!-- l. 39 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝗈𝗋𝖽</mtext></mstyle></mrow><mrow><mi>𝔽</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>a</mi></mrow><mrow><mi>n</mi></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo> <mstyle displaystyle='true'><mfrac><mrow>     <mi>k</mi>
</mrow><mrow><mstyle class='text'><mtext>gcd</mtext></mstyle><mo class='MathClass-open' stretchy='false'>(</mo><mi>k</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>n</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></mfrac></mstyle></mrow></math>.
</p> 
</div> 
</div>
   <div class='proof'>
<!-- l. 42 --><p class='indent'>   <span class='head'>
<span class='rm-lmri-10x-x-109'>Proof.</span>
</span><!-- l. 42 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 43 --><p class='indent'>
   </p><dl class='enumerate-enumitem'><dt class='enumerate-enumitem'>
1. </dt><dd class='enumerate-enumitem'><!-- l. 43 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>a</mi></mrow><mrow><mi>k</mi></mrow></msup><mo class='MathClass-punc' stretchy='false'>,</mo><msup><mrow><mi>a</mi></mrow><mrow><mn>2</mn><mi>k</mi></mrow></msup><mo class='MathClass-punc' stretchy='false'>,</mo><msup><mrow><mi>a</mi></mrow><mrow><mn>3</mn><mi>k</mi></mrow></msup><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-punc' stretchy='false'>.</mo><mo class='MathClass-punc' stretchy='false'>.</mo><mo class='MathClass-punc' stretchy='false'>.</mo><mstyle class='text'><mtext> </mtext></mstyle> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>1</mn></mrow></math>.
   </dd><dt class='enumerate-enumitem'>
2. </dt><dd class='enumerate-enumitem'>Given <!-- l. 44 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝗈𝗋𝖽</mtext></mstyle></mrow><mrow><mi>𝔽</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>a</mi></mrow><mrow><mi>n</mi></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo> <mi>m</mi></mrow></math>,
                                                                                         
                                                                                         
   <!-- l. 44 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>a</mi></mrow><mrow><mi>n</mi></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mi>m</mi></mrow></msup><mo class='MathClass-punc' stretchy='false'>,</mo><msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>a</mi></mrow><mrow><mi>n</mi></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>2</mn><mi>m</mi></mrow></msup><mo class='MathClass-punc' stretchy='false'>,</mo><msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>a</mi></mrow><mrow><mi>n</mi></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>3</mn><mi>m</mi></mrow></msup><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-punc' stretchy='false'>.</mo><mo class='MathClass-punc' stretchy='false'>.</mo><mo class='MathClass-punc' stretchy='false'>.</mo><mstyle class='text'><mtext> </mtext></mstyle> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>1</mn></mrow></math>
   </dd><dt class='enumerate-enumitem'>
3. </dt><dd class='enumerate-enumitem'>Note that by definition of order, <!-- l. 45 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>x</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mi>k</mi></mrow></math>
   is the smallest value that satisfies <!-- l. 45 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>a</mi></mrow><mrow><mi>x</mi></mrow></msup></math>
   = 1. Thus, given <!-- l. 45 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝗈𝗋𝖽</mtext></mstyle></mrow><mrow><mi>𝔽</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>a</mi></mrow><mrow><mi>n</mi></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo> <mi>m</mi></mrow></math>,
   then <!-- l. 45 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>m</mi></math>
   is the smallest integer that makes <!-- l. 45 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>a</mi></mrow><mrow><mi>n</mi></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mi>m</mi></mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>1</mn></mrow></math>.
   Note that <!-- l. 45 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>a</mi></mrow><mrow><mi>n</mi></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mi>m</mi></mrow></msup></math>
   should be a multiple of <!-- l. 45 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>a</mi></mrow><mrow><mi>k</mi></mrow></msup></math>,
   which means <!-- l. 45 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi mathvariant='italic'>𝑚𝑛</mi></mrow></math>
   should a multiple of <!-- l. 45 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>k</mi></math>.
   The smallest possible integer <!-- l. 45 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>m</mi></math>
   that makes <!-- l. 45 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi mathvariant='italic'>𝑚𝑛</mi></mrow></math>
   a multiple of <!-- l. 45 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>k</mi></math>
   is <!-- l. 45 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>m</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mstyle displaystyle='true'><mfrac><mrow>     <mi>k</mi>
</mrow><mrow><mstyle class='text'><mtext>gcd</mtext></mstyle><mo class='MathClass-open' stretchy='false'>(</mo><mi>k</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>n</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></mfrac></mstyle></mrow></math>.</dd></dl>
                                                                                        □
   </div>
   <div class='tcolorbox tcolorbox' id='tcolobox-11'>     
<div class='tcolorbox-title'>
<!-- l. 51 --><p class='indent'>   <!-- l. 51 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mstyle mathvariant='bold'><mo class='MathClass-open' stretchy='false'>⟨</mo></mstyle></math><span class='rm-lmbx-10x-x-109'>Theorem </span><a href='#theorems1'><span class='rm-lmbx-10x-x-109'>A-4.2</span><!-- tex4ht:ref: subsec:orderttheorem  --></a><span class='rm-lmbx-10x-x-109'>.3</span><!-- l. 51 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mstyle mathvariant='bold'><mo class='MathClass-close' stretchy='false'>⟩</mo></mstyle></math>
<span class='rm-lmbx-10x-x-109'>Order Property (III)</span></p></div> 
<div class='tcolorbox-content'><!-- l. 50 --><p class='noindent'>Given <!-- l. 50 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>k</mi><mstyle class='text'><mtext> </mtext></mstyle><mo class='MathClass-rel' stretchy='false'>|</mo><mstyle class='text'><mtext> </mtext></mstyle><mi>n</mi></mrow></math>,
<!-- l. 50 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝗈𝗋𝖽</mtext></mstyle></mrow><mrow><mi>𝔽</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mi>a</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo> <mi mathvariant='italic'>𝑘𝑛</mi></mrow></math>
if and only if <!-- l. 50 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝗈𝗋𝖽</mtext></mstyle></mrow><mrow><mi>𝔽</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>a</mi></mrow><mrow><mi>k</mi></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo> <mi>n</mi></mrow></math>.
</p> 
</div> 
</div>
   <div class='proof'>
<!-- l. 53 --><p class='indent'>   <span class='head'>
<span class='rm-lmri-10x-x-109'>Proof.</span>
</span><!-- l. 53 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 54 --><p class='indent'>
   </p><dl class='enumerate-enumitem'><dt class='enumerate-enumitem'>
1. </dt><dd class='enumerate-enumitem'><span class='rm-lmri-10x-x-109'>Forward Proof: </span>Given <!-- l. 54 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝗈𝗋𝖽</mtext></mstyle></mrow><mrow><mi>𝔽</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mi>a</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo> <mi mathvariant='italic'>𝑘𝑛</mi></mrow></math>,
   and given Theorem <a href='#theorems1'>A-4.2<!-- tex4ht:ref: subsec:orderttheorem  --></a>.2, <!-- l. 54 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝗈𝗋𝖽</mtext></mstyle></mrow><mrow><mi>𝔽</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>a</mi></mrow><mrow><mi>k</mi></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo> <mstyle displaystyle='true'><mfrac><mrow>     <mi mathvariant='italic'>𝑛𝑘</mi>
</mrow><mrow><mstyle class='text'><mtext>gcd</mtext></mstyle><mo class='MathClass-open' stretchy='false'>(</mo><mi>k</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi mathvariant='italic'>𝑛𝑘</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></mfrac></mstyle> <mo class='MathClass-rel' stretchy='false'>=</mo> <mstyle displaystyle='true'><mfrac><mrow><mi mathvariant='italic'>𝑛𝑘</mi>
 </mrow><mrow><mi>k</mi> </mrow></mfrac></mstyle> <mo class='MathClass-rel' stretchy='false'>=</mo> <mi>n</mi></mrow></math>.
   </dd><dt class='enumerate-enumitem'>
2. </dt><dd class='enumerate-enumitem'><span class='rm-lmri-10x-x-109'>Backward Proof: </span>Given <!-- l. 55 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝗈𝗋𝖽</mtext></mstyle></mrow><mrow><mi>𝔽</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>a</mi></mrow><mrow><mi>k</mi></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo> <mi>n</mi></mrow></math>,
   we should prove that <!-- l. 55 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝗈𝗋𝖽</mtext></mstyle></mrow><mrow><mi>𝔽</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mi>a</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo> <mi mathvariant='italic'>𝑛𝑘</mi></mrow></math>.
   Let <!-- l. 55 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝗈𝗋𝖽</mtext></mstyle></mrow><mrow><mi>𝔽</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mi>a</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo> <mi>m</mi></mrow></math>.
   Then, by Theorem<a href='#theorems1'>A-4.2<!-- tex4ht:ref: subsec:orderttheorem  --></a>.2, <!-- l. 55 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝗈𝗋𝖽</mtext></mstyle></mrow><mrow><mi>𝔽</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>a</mi></mrow><mrow><mi>k</mi></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo> <mstyle displaystyle='true'><mfrac><mrow>     <mi>m</mi>
</mrow><mrow><mstyle class='text'><mtext>gcd</mtext></mstyle><mo class='MathClass-open' stretchy='false'>(</mo><mi>m</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>k</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></mfrac></mstyle></mrow></math>,
   which is <!-- l. 55 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>n</mi></math>.
   In other words, <!-- l. 55 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>m</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mi>n</mi> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mstyle class='text'><mtext>gcd</mtext></mstyle><mo class='MathClass-open' stretchy='false'>(</mo><mi>m</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>k</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>.
   But as <!-- l. 55 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>k</mi><mstyle class='text'><mtext> </mtext></mstyle><mo class='MathClass-rel' stretchy='false'>|</mo><mstyle class='text'><mtext> </mtext></mstyle><mi>n</mi></mrow></math>,
   it is also true that <!-- l. 55 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>k</mi><mstyle class='text'><mtext> </mtext></mstyle><mo class='MathClass-rel' stretchy='false'>|</mo><mstyle class='text'><mtext> </mtext></mstyle><mi>m</mi></mrow></math>.
   Then, <!-- l. 55 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mstyle class='text'><mtext>gcd</mtext></mstyle><mo class='MathClass-open' stretchy='false'>(</mo><mi>m</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>k</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo> <mi>k</mi></mrow></math>.
                                                                                         
                                                                                         
   Therefore, <!-- l. 55 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>m</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mi>n</mi> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mstyle class='text'><mtext>gcd</mtext></mstyle><mo class='MathClass-open' stretchy='false'>(</mo><mi>m</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>k</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo> <mi mathvariant='italic'>𝑛𝑘</mi></mrow></math>.</dd></dl>
                                                                                        □
   </div>
   <div class='tcolorbox tcolorbox' id='tcolobox-12'>     
<div class='tcolorbox-title'>
<!-- l. 61 --><p class='indent'>   <!-- l. 61 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mstyle mathvariant='bold'><mo class='MathClass-open' stretchy='false'>⟨</mo></mstyle></math><span class='rm-lmbx-10x-x-109'>Theorem </span><a href='#theorems1'><span class='rm-lmbx-10x-x-109'>A-4.2</span><!-- tex4ht:ref: subsec:orderttheorem  --></a><span class='rm-lmbx-10x-x-109'>.4</span><!-- l. 61 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mstyle mathvariant='bold'><mo class='MathClass-close' stretchy='false'>⟩</mo></mstyle></math>
<span class='rm-lmbx-10x-x-109'>Fermat’s Little Theorem</span></p></div> 
<div class='tcolorbox-content'><!-- l. 60 --><p class='noindent'>Given <!-- l. 60 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-rel' stretchy='false'>|</mo><mi>𝔽</mi><mo class='MathClass-rel' stretchy='false'>|</mo><mo class='MathClass-rel' stretchy='false'>=</mo> <mi>p</mi></mrow></math>
(a prime) and <!-- l. 60 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>a</mi> <mo class='MathClass-rel' stretchy='false'>∈</mo> <mi>𝔽</mi></mrow></math>,
<!-- l. 60 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>a</mi></mrow><mrow><mi>p</mi></mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo> <mi>a</mi></mrow></math>.
</p> 
</div> 
</div>
   <div class='proof'>
<!-- l. 63 --><p class='indent'>   <span class='head'>
<span class='rm-lmri-10x-x-109'>Proof.</span>
</span><!-- l. 63 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 64 --><p class='indent'>
   </p><dl class='enumerate-enumitem'><dt class='enumerate-enumitem'>
1. </dt><dd class='enumerate-enumitem'><!-- l. 64 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>{</mo><msup><mrow><mi>a</mi></mrow><mrow><mn>1</mn></mrow></msup><mo class='MathClass-punc' stretchy='false'>,</mo><msup><mrow><mi>a</mi></mrow><mrow><mn>2</mn></mrow></msup><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-punc' stretchy='false'>.</mo><mo class='MathClass-punc' stretchy='false'>.</mo><mo class='MathClass-punc' stretchy='false'>.</mo><mstyle class='text'><mtext> </mtext></mstyle><msup><mrow><mi>a</mi></mrow><mrow><mi>p</mi></mrow></msup><mo class='MathClass-close' stretchy='false'>}</mo></mrow></math>
   forms a multiplicative subgroup <!-- l. 64 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>H</mi></math>
   of the group <!-- l. 64 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>G</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <msup><mrow><mi>𝔽</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>×</mo></mrow></msup></mrow></math>
   (i.e., <!-- l. 64 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>𝔽</mi></math>
   without <!-- l. 64 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>{</mo><mn>0</mn><mo class='MathClass-close' stretchy='false'>}</mo></mrow></math>).
   </dd><dt class='enumerate-enumitem'>
2. </dt><dd class='enumerate-enumitem'>Lagrange’s Group Theory states that for any subgroup <!-- l. 65 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>H</mi></math>
   in a group <!-- l. 65 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>G</mi></math>,
   <!-- l. 65 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-rel' stretchy='false'>|</mo><mi>H</mi><mo class='MathClass-rel' stretchy='false'>|</mo></mrow></math>
   divides <!-- l. 65 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-rel' stretchy='false'>|</mo><mi>G</mi><mo class='MathClass-rel' stretchy='false'>|</mo></mrow></math>.
   This means that given <!-- l. 65 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝗈𝗋𝖽</mtext></mstyle></mrow><mrow><mi>G</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mi>a</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo> <mi>k</mi></mrow></math>
   (where <!-- l. 65 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>a</mi></mrow><mrow><mi>k</mi></mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>1</mn></mrow></math>),
   <!-- l. 65 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>k</mi></math>
   divides <!-- l. 65 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-rel' stretchy='false'>|</mo><mi>G</mi><mo class='MathClass-rel' stretchy='false'>|</mo></mrow></math>
   (where <!-- l. 65 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-rel' stretchy='false'>|</mo><mi>G</mi><mo class='MathClass-rel' stretchy='false'>|</mo><mo class='MathClass-rel' stretchy='false'>=</mo> <mi>p</mi> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></math>).
   </dd><dt class='enumerate-enumitem'>
3. </dt><dd class='enumerate-enumitem'>Therefore, given <!-- l. 66 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi mathvariant='italic'>𝑘𝑙</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mi>p</mi> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></math>
   for some integer <!-- l. 66 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>l</mi></math>,
   <!-- l. 66 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>a</mi></mrow><mrow><mi>p</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo> <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>a</mi></mrow><mrow><mi>k</mi></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mi>l</mi></mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo> <msup><mrow><mn>1</mn></mrow><mrow><mi>l</mi></mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>1</mn></mrow></math>.
   Thus, <!-- l. 66 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>a</mi></mrow><mrow><mi>p</mi></mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo> <mi>a</mi></mrow></math>.</dd></dl>
                                                                                        □
   </div>
<!-- l. 391 --><p class='noindent'>
</p>
   <h1 class='partHead' id='fully-homomorphic-encryption-schemes'><span class='titlemark'>Part II<br /></span><a id='x1-20000II'></a>Fully Homomorphic Encryption Schemes</h1>
<!-- l. 397 --><p class='noindent'>This chapter explains the four most well-known FHE schemes: TFHE, CKKS, BGV, and BFV, as well as
                                                                                         
                                                                                         
their RNS-variant versions.
</p><!-- l. 399 --><p class='indent'>
                                                                                         
                                                                                         
   
</p>
   <h3 class='sectionHead' id='tfhe-scheme'><span class='titlemark'>D-1   </span> <a id='x1-21000D-1'></a>TFHE Scheme</h3>
<!-- l. 2 --><p class='noindent'>The TFHE scheme is designed for homomorphic addition and multiplication on integers (especially
bit-wise computation, like logic circuits). Unlike BFV, GBV, or CKKS, TFHE is characterized by fast
noise bootstrapping; therefore, it is efficient for processing deep multiplication depths. TFHE’s noise
bootstrapping technique can be further applied to functional encryption.
</p><!-- l. 4 --><p class='indent'>   In TFHE, each plaintext is encrypted as an LWE ciphertext. Therefore, TFHE’s ciphertext-to-ciphertext
addition, ciphertext-to-plaintext addition, and ciphertext-to-plaintext multiplication are
implemented based on GLWE’s homomorphic addition and multiplication described in
<!-- l. 4 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mstyle class='text'><mtext>??</mtext></mstyle></math>, with
<!-- l. 4 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>n</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>1</mn></mrow></math> to
make GLWE an LWE.
</p><!-- l. 6 --><p class='indent'>   This section will explain TFHE’s novel components: key switching, ciphertext-to-ciphertext
multiplication, coefficient extraction, and noise bootstrapping.
</p><!-- l. 8 --><p class='indent'>   <!-- l. 8 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 10 --><p class='noindent'><span class='underline'><span class='rm-lmbx-10x-x-109'>Required Background</span></span>
</p>
   <ul class='itemize1'>
   <li class='itemize'><a href='#modulo-arithmetic'><span class='ts1-lmr10-x-x-109'>§</span>A-1<!-- tex4ht:ref: subsec:groupddef  --></a>: <a href='#modulo-arithmetic'>Modulo Arithmetic<!-- tex4ht:ref: sec:modulo  --></a>
   </li>
   <li class='itemize'><a href='#group'><span class='ts1-lmr10-x-x-109'>§</span>A-2<!-- tex4ht:ref: subsec:groupddef  --></a>: <a href='#group'>Group<!-- tex4ht:ref: sec:group  --></a>
   </li>
   <li class='itemize'><a href='#field'><span class='ts1-lmr10-x-x-109'>§</span>A-3<!-- tex4ht:ref: subsec:groupddef  --></a>: <a href='#field'>Field<!-- tex4ht:ref: sec:field  --></a>
   </li>
   <li class='itemize'><a href='#order'><span class='ts1-lmr10-x-x-109'>§</span>A-4<!-- tex4ht:ref: subsec:groupddef  --></a>: <a href='#order'>Order<!-- tex4ht:ref: sec:order  --></a>
   </li>
   <li class='itemize'><span class='rm-lmbx-10x-x-109'>??</span>: <span class='rm-lmbx-10x-x-109'>??</span>
   </li>
   <li class='itemize'><span class='rm-lmbx-10x-x-109'>??</span>: <span class='rm-lmbx-10x-x-109'>??</span>
   </li>
   <li class='itemize'><span class='rm-lmbx-10x-x-109'>??</span>: <span class='rm-lmbx-10x-x-109'>??</span>
   </li>
   <li class='itemize'><span class='rm-lmbx-10x-x-109'>??</span>: <span class='rm-lmbx-10x-x-109'>??</span>
                                                                                         
                                                                                         
   </li>
   <li class='itemize'><span class='rm-lmbx-10x-x-109'>??</span>: <span class='rm-lmbx-10x-x-109'>??</span>
   </li>
   <li class='itemize'><span class='rm-lmbx-10x-x-109'>??</span>: <span class='rm-lmbx-10x-x-109'>??</span>
   </li>
   <li class='itemize'><span class='rm-lmbx-10x-x-109'>??</span>: <span class='rm-lmbx-10x-x-109'>??</span>
   </li>
   <li class='itemize'><span class='rm-lmbx-10x-x-109'>??</span>: <span class='rm-lmbx-10x-x-109'>??</span>
   </li>
   <li class='itemize'><span class='rm-lmbx-10x-x-109'>??</span>: <span class='rm-lmbx-10x-x-109'>??</span>
   </li>
   <li class='itemize'><span class='rm-lmbx-10x-x-109'>??</span>: <span class='rm-lmbx-10x-x-109'>??</span>
   </li>
   <li class='itemize'><span class='rm-lmbx-10x-x-109'>??</span>: <span class='rm-lmbx-10x-x-109'>??</span>
   </li>
   <li class='itemize'><span class='rm-lmbx-10x-x-109'>??</span>: <span class='rm-lmbx-10x-x-109'>??</span>
   </li>
   <li class='itemize'><span class='rm-lmbx-10x-x-109'>??</span>: <span class='rm-lmbx-10x-x-109'>??</span>
   </li>
   <li class='itemize'><span class='rm-lmbx-10x-x-109'>??</span>: <span class='rm-lmbx-10x-x-109'>??</span></li></ul>
   
   <h4 class='subsectionHead' id='encryption-and-decryption'><span class='titlemark'>D-1.1   </span> <a id='x1-22000D-1.1'></a>Encryption and Decryption</h4>
<!-- l. 38 --><p class='noindent'>TFHE encrypts and decrypts ciphertexts based on the LWE cryptosystem (<span class='rm-lmbx-10x-x-109'>??</span>), which is equivalent to the GLWE
cryptosystem (<span class='rm-lmbx-10x-x-109'>??</span>) with <!-- l. 38 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>n</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>1</mn></mrow></math>.
</p>
   <div class='tcolorbox tcolorbox' id='tcolobox-13'>     
<div class='tcolorbox-title'>
<!-- l. 72 --><p class='indent'>   <!-- l. 72 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mstyle mathvariant='bold'><mo class='MathClass-open' stretchy='false'>⟨</mo></mstyle></math><span class='rm-lmbx-10x-x-109'>Summary </span><a href='#encryption-and-decryption'><span class='rm-lmbx-10x-x-109'>D-1.1</span><!-- tex4ht:ref: subsec:tfheeencddec  --></a><!-- l. 72 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mstyle mathvariant='bold'><mo class='MathClass-close' stretchy='false'>⟩</mo></mstyle></math>
                                                                                         
                                                                                         
<span class='rm-lmbx-10x-x-109'>TFHE Encryption and Decryption</span></p></div> 
<div class='tcolorbox-content'><!-- l. 42 --><p class='noindent'><span class='underline'><span class='rm-lmbx-10x-x-109'>Initial Setup</span></span><span class='rm-lmbx-10x-x-109'>: </span><!-- l. 42 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi mathvariant='normal'>Δ</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mstyle displaystyle='true'><mfrac><mrow><mi>q</mi>
</mrow><mrow><mi>t</mi></mrow></mfrac></mstyle></mrow></math>,
<!-- l. 42 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mover accent='true'><mrow><mi>s</mi></mrow><mo accent='true'>→</mo></mover><munderover> <mo class='MathClass-rel' stretchy='false'>←</mo><mrow></mrow><mrow><mi>$</mi></mrow></munderover><msubsup><mrow><mi>ℤ</mi></mrow><mrow><mn>2</mn></mrow><mrow><mi>k</mi></mrow></msubsup></mrow></math>
<span id='textcolor5'># where <!-- l. 42 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>t</mi></math>
divides <!-- l. 42 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>q</mi></math>,
and each element of <!-- l. 42 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mover accent='true'><mrow><mi>s</mi></mrow><mo accent='true'>→</mo></mover></math>
is a 0-degree polynomial</span>
</p><!-- l. 44 --><p class='noindent'><!-- l. 44 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 46 --><p class='noindent'>________________________________________________________________________________________________________________________
</p><!-- l. 48 --><p class='noindent'><span class='underline'><span class='rm-lmbx-10x-x-109'>Encryption Input</span></span><span class='rm-lmbx-10x-x-109'>: </span><!-- l. 48 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>m</mi> <mo class='MathClass-rel' stretchy='false'>∈</mo> <msub><mrow><mi>ℤ</mi></mrow><mrow><mi>t</mi></mrow></msub></mrow></math>,
<!-- l. 48 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mover accent='true'><mrow><mi>a</mi></mrow><mo accent='true'>→</mo></mover><munderover> <mo class='MathClass-rel' stretchy='false'>←</mo><mrow></mrow><mrow><mi>$</mi></mrow></munderover><msubsup><mrow><mi>ℤ</mi></mrow><mrow><mi>q</mi></mrow><mrow><mi>k</mi></mrow></msubsup></mrow></math>,
<!-- l. 48 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>e</mi><munderover> <mo class='MathClass-rel' stretchy='false'>←</mo><mrow></mrow><mrow><msub><mrow><mi>χ</mi></mrow><mrow><mi>σ</mi></mrow></msub></mrow></munderover><msub><mrow><mi>ℤ</mi></mrow><mrow><mi>q</mi></mrow></msub></mrow></math> <span id='textcolor6'># each
element of <!-- l. 48 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mover accent='true'><mrow><mi>a</mi></mrow><mo accent='true'>→</mo></mover></math>
is a 0-degree polynomial</span>
    </p><dl class='enumerate-enumitem'><dt class='enumerate-enumitem'>
1.  </dt><dd class='enumerate-enumitem'>Scale up <!-- l. 50 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>m</mi><mo class='MathClass-rel' stretchy='false'>→</mo><mi mathvariant='normal'>Δ</mi> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mi>m</mi><mstyle class='text'><mtext> </mtext></mstyle> <mo class='MathClass-rel' stretchy='false'>∈</mo> <msub><mrow><mi>ℤ</mi></mrow><mrow><mi>q</mi></mrow></msub></mrow></math>
    </dd><dt class='enumerate-enumitem'>
2.  </dt><dd class='enumerate-enumitem'>Compute <!-- l. 52 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>b</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mover accent='true'><mrow><mi>a</mi></mrow><mo accent='true'>→</mo></mover> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mover accent='true'><mrow><mi>s</mi></mrow><mo accent='true'>→</mo></mover> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi mathvariant='normal'>Δ</mi><mi>m</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>e</mi><mstyle class='text'><mtext> </mtext></mstyle><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi>q</mi></mrow></math>
   </dd><dt class='enumerate-enumitem'>
3.  </dt><dd class='enumerate-enumitem'><!-- l. 53 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mover accent='true'><mrow><mi>s</mi></mrow><mo accent='true'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mi mathvariant='normal'>Δ</mi><mi>m</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>(</mo><mover accent='true'><mrow><mi>a</mi></mrow><mo accent='true'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mi>b</mi><mo class='MathClass-close' stretchy='false'>)</mo><mstyle class='text'><mtext> </mtext></mstyle> <mo class='MathClass-rel' stretchy='false'>∈</mo> <msubsup><mrow><mi>ℤ</mi></mrow><mrow><mi>q</mi></mrow><mrow><mi>k</mi><mo class='MathClass-bin' stretchy='false'>+</mo><mn>1</mn></mrow></msubsup></mrow></math></dd></dl>
<!-- l. 56 --><p class='noindent'>___________________________________________________________________________________________________________________________________________________________
</p><!-- l. 58 --><p class='noindent'><span class='underline'><span class='rm-lmbx-10x-x-109'>Decryption Input</span></span><span class='rm-lmbx-10x-x-109'>: </span><!-- l. 58 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖼𝗍</mtext></mstyle> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>(</mo><mover accent='true'><mrow><mi>a</mi></mrow><mo accent='true'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mi>b</mi><mo class='MathClass-close' stretchy='false'>)</mo><mstyle class='text'><mtext> </mtext></mstyle> <mo class='MathClass-rel' stretchy='false'>∈</mo> <msubsup><mrow><mi>ℤ</mi></mrow><mrow><mi>q</mi></mrow><mrow><mi>k</mi><mo class='MathClass-bin' stretchy='false'>+</mo><mn>1</mn></mrow></msubsup></mrow></math>
     </p><dl class='enumerate-enumitem'><dt class='enumerate-enumitem'>
1.  </dt><dd class='enumerate-enumitem'><!-- l. 60 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msubsup><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mover accent='true'><mrow><mi>s</mi></mrow><mo accent='true'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msubsup><mo class='MathClass-open' stretchy='false'>(</mo><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖼𝗍</mtext></mstyle><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo> <mi>b</mi> <mo class='MathClass-bin' stretchy='false'>−</mo><mover accent='true'><mrow><mi>a</mi></mrow><mo accent='true'>→</mo></mover> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mover accent='true'><mrow><mi>s</mi></mrow><mo accent='true'>→</mo></mover> <mo class='MathClass-rel' stretchy='false'>=</mo> <mi mathvariant='normal'>Δ</mi><mi>m</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>e</mi><mspace width='0.3em'></mspace><mo class='MathClass-open' stretchy='false'>(</mo><mi mathvariant='italic'>𝑚𝑜𝑑</mi><mspace width='0.3em'></mspace><mi>q</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
    </dd><dt class='enumerate-enumitem'>
2.  </dt><dd class='enumerate-enumitem'>Scale down <!-- l. 62 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mstyle mathsize='2.45em'><mrow><mo fence='true' form='prefix'>⌈</mo><mrow></mrow><mo fence='true' form='postfix'></mo></mrow></mstyle><mstyle displaystyle='true'><mfrac><mrow><mi mathvariant='normal'>Δ</mi><mi>m</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>e</mi>
   </mrow><mrow><mi mathvariant='normal'>Δ</mi>    </mrow></mfrac></mstyle><mstyle mathsize='2.45em'><mrow><mo fence='true' form='prefix'>⌋</mo><mrow></mrow><mo fence='true' form='postfix'></mo></mrow></mstyle> <mo class='MathClass-rel' stretchy='false'>=</mo> <mi>m</mi><mstyle class='text'><mtext> </mtext></mstyle> <mo class='MathClass-rel' stretchy='false'>∈</mo> <msub><mrow><mi>ℤ</mi></mrow><mrow><mi>t</mi></mrow></msub></mrow></math>
    <span id='textcolor7'># i.e., modulus switch from <!-- l. 62 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>q</mi> <mo class='MathClass-rel' stretchy='false'>→</mo><mi>t</mi></mrow></math></span></dd></dl>
<!-- l. 65 --><p class='noindent'><!-- l. 65 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 67 --><p class='noindent'><span class='rm-lmbx-10x-x-109'>Condition for Correct Decryption:</span> </p>
   <ul class='itemize1'>
   <li class='itemize'>The noise <!-- l. 69 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>e</mi></math>
   grown over homomorphic operations should be: <!-- l. 69 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>e</mi> <mo class='MathClass-rel' stretchy='false'><mfrac><mrow><mi mathvariant='normal'>Δ</mi>
</mrow><mrow><mn>2</mn></mrow></mfrac></mo>.</mrow></math></li></ul>
 
</div> 
</div>
   
   <h4 class='subsectionHead' id='homomorphic-ciphertexttociphertext-addition'><span class='titlemark'>D-1.2   </span> <a id='x1-23000D-1.2'></a>Homomorphic Ciphertext-to-Ciphertext Addition</h4>
<!-- l. 77 --><p class='noindent'>TFHE’s ciphertext-to-ciphertext addition uses LWE’s ciphertext-to-ciphertext addition
scheme, which is equivalent to GLWE’s ciphertext-to-ciphertext addition scheme (<span class='rm-lmbx-10x-x-109'>??</span>) with
<!-- l. 77 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>n</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>1</mn></mrow></math>.
</p>
   <div class='tcolorbox tcolorbox' id='tcolobox-14'>     
<div class='tcolorbox-title'>
<!-- l. 89 --><p class='indent'>   <!-- l. 89 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mstyle mathvariant='bold'><mo class='MathClass-open' stretchy='false'>⟨</mo></mstyle></math><span class='rm-lmbx-10x-x-109'>Summary </span><a href='#homomorphic-ciphertexttociphertext-addition'><span class='rm-lmbx-10x-x-109'>D-1.2</span><!-- tex4ht:ref: subsec:tfheaaddccipher  --></a><!-- l. 89 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mstyle mathvariant='bold'><mo class='MathClass-close' stretchy='false'>⟩</mo></mstyle></math>
                                                                                         
                                                                                         
<span class='rm-lmbx-10x-x-109'>TFHE Ciphertext-to-Ciphertext Addition</span></p></div> 
<div class='tcolorbox-content'><!-- l. 81 --><p class='noindent'><!-- l. 81 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mover accent='true'><mrow><mi>s</mi></mrow><mo accent='true'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mi mathvariant='normal'>Δ</mi><msup><mrow><mi>m</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>+</mo><msub><mrow> <mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mover accent='true'><mrow><mi>s</mi></mrow><mo accent='true'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mi mathvariant='normal'>Δ</mi><msup><mrow><mi>m</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
</p><!-- l. 83 --><p class='noindent'><!-- l. 83 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mover accent='true'><mrow><mi>a</mi></mrow><mo accent='true'>→</mo></mover></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><msup><mrow><mi>b</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>+</mo> <mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mover accent='true'><mrow><mi>a</mi></mrow><mo accent='true'>→</mo></mover></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><msup><mrow><mi>b</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
</p><!-- l. 85 --><p class='noindent'><!-- l. 85 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mover accent='true'><mrow><mi>a</mi></mrow><mo accent='true'>→</mo></mover></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo><msup><mrow> <mover accent='true'><mrow><mi>a</mi></mrow><mo accent='true'>→</mo></mover></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><msup><mrow><mi>b</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>b</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
</p><!-- l. 87 --><p class='noindent'><!-- l. 87 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo><msub><mrow> <mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mover accent='true'><mrow><mi>s</mi></mrow><mo accent='true'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mi mathvariant='normal'>Δ</mi><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>m</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>m</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
 </p> 
</div> 
</div>
   
   <h4 class='subsectionHead' id='homomorphic-ciphertexttoplaintext-addition'><span class='titlemark'>D-1.3   </span> <a id='x1-24000D-1.3'></a>Homomorphic Ciphertext-to-Plaintext Addition</h4>
<!-- l. 95 --><p class='noindent'>TFHE’s ciphertext-to-plaintext addition (where <!-- l. 95 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>λ</mi></math>
is a constant to add) uses LWE’s ciphertext-to-plaintext addition scheme, which
is equivalent to GLWE’s ciphertext-to-plaintext addition scheme (<span class='rm-lmbx-10x-x-109'>??</span>) with
<!-- l. 95 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>n</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>1</mn></mrow></math>.
</p>
   <div class='tcolorbox tcolorbox' id='tcolobox-15'>     
<div class='tcolorbox-title'>
<!-- l. 105 --><p class='indent'>   <!-- l. 105 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mstyle mathvariant='bold'><mo class='MathClass-open' stretchy='false'>⟨</mo></mstyle></math><span class='rm-lmbx-10x-x-109'>Summary </span><a href='#homomorphic-ciphertexttoplaintext-addition'><span class='rm-lmbx-10x-x-109'>D-1.3</span><!-- tex4ht:ref: subsec:tfheaaddpplain  --></a><!-- l. 105 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mstyle mathvariant='bold'><mo class='MathClass-close' stretchy='false'>⟩</mo></mstyle></math>
<span class='rm-lmbx-10x-x-109'>TFHE Ciphertext-to-Plaintext Addition</span></p></div> 
<div class='tcolorbox-content'><!-- l. 98 --><p class='noindent'><!-- l. 98 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mover accent='true'><mrow><mi>s</mi></mrow><mo accent='true'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mi mathvariant='normal'>Δ</mi><mi>m</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi mathvariant='normal'>Δ</mi><mi>λ</mi></mrow></math>
</p><!-- l. 100 --><p class='noindent'><!-- l. 100 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>(</mo><mover accent='true'><mrow><mi>a</mi></mrow><mo accent='true'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><mi>B</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi mathvariant='normal'>Δ</mi><mi>λ</mi></mrow></math>
</p><!-- l. 102 --><p class='noindent'><!-- l. 102 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>(</mo><mover accent='true'><mrow><mi>a</mi></mrow><mo accent='true'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><mi>B</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi mathvariant='normal'>Δ</mi><mi>λ</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
</p><!-- l. 104 --><p class='noindent'><!-- l. 104 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo><msub><mrow> <mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mover accent='true'><mrow><mi>s</mi></mrow><mo accent='true'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mi mathvariant='normal'>Δ</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>m</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>λ</mi><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
</p> 
</div> 
</div>
   
   <h4 class='subsectionHead' id='homomorphic-ciphertexttoplaintext-multiplication'><span class='titlemark'>D-1.4   </span> <a id='x1-25000D-1.4'></a>Homomorphic Ciphertext-to-Plaintext Multiplication</h4>
<!-- l. 111 --><p class='noindent'>TFHE’s ciphertext-to-plaintext multiplication uses LWE’s ciphertext-to-plaintext multiplication
scheme, which is equivalent to GLWE’s ciphertext-to-plaintext multiplication scheme (<span class='rm-lmbx-10x-x-109'>??</span>) with
<!-- l. 111 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>n</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>1</mn></mrow></math>.
</p>
   <div class='tcolorbox tcolorbox' id='tcolobox-16'>     
<div class='tcolorbox-title'>
<!-- l. 121 --><p class='indent'>   <!-- l. 121 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mstyle mathvariant='bold'><mo class='MathClass-open' stretchy='false'>⟨</mo></mstyle></math><span class='rm-lmbx-10x-x-109'>Summary </span><a href='#homomorphic-ciphertexttoplaintext-multiplication'><span class='rm-lmbx-10x-x-109'>D-1.4</span><!-- tex4ht:ref: subsec:tfhemmultpplain  --></a><!-- l. 121 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mstyle mathvariant='bold'><mo class='MathClass-close' stretchy='false'>⟩</mo></mstyle></math>
<span class='rm-lmbx-10x-x-109'>TFHE Ciphertext-to-Plaintext Multiplication</span></p></div> 
<div class='tcolorbox-content'><!-- l. 114 --><p class='noindent'><!-- l. 114 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mover accent='true'><mrow><mi>s</mi></mrow><mo accent='true'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mi mathvariant='normal'>Δ</mi><mi>m</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mi>λ</mi></mrow></math>
</p><!-- l. 116 --><p class='noindent'><!-- l. 116 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>(</mo><mover accent='true'><mrow><mi>a</mi></mrow><mo accent='true'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><mi>b</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mi>λ</mi></mrow></math>
</p><!-- l. 118 --><p class='noindent'><!-- l. 118 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>(</mo><mi>λ</mi> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mover accent='true'><mrow><mi>a</mi></mrow><mo accent='true'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><mi>λ</mi> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mi>b</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
</p><!-- l. 120 --><p class='noindent'><!-- l. 120 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo><msub><mrow> <mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mover accent='true'><mrow><mi>s</mi></mrow><mo accent='true'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mi mathvariant='normal'>Δ</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>m</mi> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mi>λ</mi><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
</p> 
</div> 
</div>
   
   <h4 class='subsectionHead' id='homomorphic-key-switching'><span class='titlemark'>D-1.5   </span> <a id='x1-26000D-1.5'></a>Homomorphic Key Switching</h4>
<!-- l. 127 --><p class='noindent'><span class='rm-lmbx-10x-x-109'>- Reference:  </span><a href='https://www.zama.ai/post/tfhe-deep-dive-part-3'>TFHE Deep Dive - Part III - Key switching and leveled multiplications</a> <span class='cite'>[<span class='rm-lmbx-10x-x-109'>?</span>]</span>
</p><!-- l. 130 --><p class='indent'>   TFHE’s key switching scheme changes an LWE ciphertext’s the secret key from
<!-- l. 130 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mover accent='true'><mrow><mi>s</mi></mrow><mo accent='true'>→</mo></mover></math> to
<!-- l. 130 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mover accent='true'><mrow><mi>s</mi></mrow><mo accent='true'>→</mo></mover></mrow><mrow><msup><mrow></mrow><mrow><mi>′</mi>
 </mrow></msup></mrow></msub></math>.
This scheme is essentially LWE’s key switching scheme. Specifically, this is
                                                                                         
                                                                                         
equivalent to the alternative GLWE version’s (<span class='rm-lmbx-10x-x-109'>??</span>) key switching scheme (<span class='rm-lmbx-10x-x-109'>??</span>) with
<!-- l. 130 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>n</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>1</mn></mrow></math> as
follows:
</p>
   <div class='tcolorbox tcolorbox' id='tcolobox-17'>     
<div class='tcolorbox-title'>
<!-- l. 134 --><p class='indent'>   <!-- l. 134 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mstyle mathvariant='bold'><mo class='MathClass-open' stretchy='false'>⟨</mo></mstyle></math><span class='rm-lmbx-10x-x-109'>Summary </span><a href='#homomorphic-key-switching'><span class='rm-lmbx-10x-x-109'>D-1.5</span><!-- tex4ht:ref: subsec:tfhekkeysswitching  --></a><!-- l. 134 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mstyle mathvariant='bold'><mo class='MathClass-close' stretchy='false'>⟩</mo></mstyle></math>
<span class='rm-lmbx-10x-x-109'>TFHE Key Switching</span></p></div> 
<div class='tcolorbox-content'><!-- l. 133 --><p class='noindent'><!-- l. 133 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><msub><mrow><mover accent='true'><mrow><mi>s</mi></mrow><mo accent='true'>→</mo></mover></mrow><mrow><msup><mrow></mrow><mrow><mi>′</mi></mrow></msup></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mi mathvariant='normal'>Δ</mi><mi>m</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>(</mo><mn>0</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mi>b</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>+</mo> <mstyle mathvariant='bold'><mo class='MathClass-open' stretchy='false'>⟨</mo></mstyle><msup><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖣𝖾𝖼𝗈𝗆𝗉</mtext></mstyle></mrow><mrow><mi>β</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>l</mi></mrow></msup><mo class='MathClass-open' stretchy='false'>(</mo><mover accent='true'><mrow><mi>a</mi></mrow><mo accent='true'>→</mo></mover><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><msubsup><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖫𝖾𝗏</mtext></mstyle></mrow><mrow><msub><mrow><mover accent='true'><mrow><mi>s</mi></mrow><mo accent='true'>→</mo></mover></mrow><mrow><msup><mrow></mrow><mrow><mi>′</mi></mrow></msup></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow><mrow><mi>β</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>l</mi></mrow></msubsup><mo class='MathClass-open' stretchy='false'>(</mo><mover accent='true'><mrow><mi>s</mi></mrow><mo accent='true'>→</mo></mover><mo class='MathClass-close' stretchy='false'>)</mo><mstyle mathvariant='bold'><mo class='MathClass-close' stretchy='false'>⟩</mo></mstyle></mrow></math>
</p> 
</div> 
</div>
   
   <h4 class='subsectionHead' id='homomorphic-ciphertexttociphertext-multiplication'><span class='titlemark'>D-1.6   </span> <a id='x1-27000D-1.6'></a>Homomorphic Ciphertext-to-Ciphertext Multiplication</h4>
<!-- l. 140 --><p class='noindent'><span class='rm-lmbx-10x-x-109'>- Reference:  </span><a href='https://www.zama.ai/post/tfhe-deep-dive-part-3'>TFHE Deep Dive - Part III - Key switching and leveled multiplications</a> <span class='cite'>[<span class='rm-lmbx-10x-x-109'>?</span>]</span>
</p><!-- l. 143 --><p class='indent'>   <!-- l. 143 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 145 --><p class='indent'>   TFHE supports multiplication of two ciphertexts in the form:
<!-- l. 145 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mover accent='true'><mrow><mi>s</mi></mrow><mo accent='true'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mi mathvariant='normal'>Δ</mi><msub><mrow><mi>m</mi></mrow><mrow><mn>1</mn></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msubsup><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖦𝖲𝖶</mtext></mstyle></mrow><mrow><mover accent='true'><mrow><mi>s</mi></mrow><mo accent='true'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow><mrow><mi>β</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>l</mi></mrow></msubsup><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>m</mi></mrow><mrow><mn>2</mn></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>.
</p><!-- l. 147 --><p class='indent'>   <!-- l. 147 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 149 --><p class='noindent'>The 1st term <!-- l. 149 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mover accent='true'><mrow><mi>s</mi></mrow><mo accent='true'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mi mathvariant='normal'>Δ</mi><msub><mrow><mi>m</mi></mrow><mrow><mn>1</mn></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
comes from one of the followings: </p>
   <ul class='itemize1'>
   <li class='itemize'>A fresh LWE encryption (<span class='rm-lmbx-10x-x-109'>??</span>) of plaintext <!-- l. 151 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>m</mi></mrow><mrow><mn>1</mn></mrow></msub></math>.
   </li>
   <li class='itemize'>A homomorphically added result of two LWE ciphertexts (<span class='rm-lmbx-10x-x-109'>??</span>).
   </li>
   <li class='itemize'>A homomorphically multiplied result of a LWE ciphertext with a plaintext (<span class='rm-lmbx-10x-x-109'>??</span>).</li></ul>
<!-- l. 156 --><p class='indent'>   <!-- l. 156 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 158 --><p class='noindent'>The 2nd term <!-- l. 158 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msubsup><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖦𝖲𝖶</mtext></mstyle></mrow><mrow><mover accent='true'><mrow><mi>s</mi></mrow><mo accent='true'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow><mrow><mi>β</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>l</mi></mrow></msubsup><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>m</mi></mrow><mrow><mn>2</mn></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
comes from one of the followings: </p>
   <ul class='itemize1'>
   <li class='itemize'>A fresh GSW encryption (<span class='rm-lmbx-10x-x-109'>??</span>) of plaintext <!-- l. 160 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>m</mi></mrow><mrow><mn>2</mn></mrow></msub></math>.
   </li>
   <li class='itemize'>Converted from <!-- l. 161 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mover accent='true'><mrow><mi>s</mi></mrow><mo accent='true'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mi mathvariant='normal'>Δ</mi><msub><mrow><mi>m</mi></mrow><mrow><mn>2</mn></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
   into <!-- l. 161 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msubsup><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖦𝖲𝖶</mtext></mstyle></mrow><mrow><mover accent='true'><mrow><mi>s</mi></mrow><mo accent='true'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow><mrow><mi>β</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>l</mi></mrow></msubsup><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>m</mi></mrow><mrow><mn>2</mn></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
   by <span class='rm-lmri-10x-x-109'>circuit bootstrapping </span>(this will be covered in the future).</li></ul>
<!-- l. 164 --><p class='indent'>   <!-- l. 164 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 166 --><p class='noindent'>Remember the followings:
</p><!-- l. 168 --><p class='indent'>   <!-- l. 168 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mover accent='true'><mrow><mi>s</mi></mrow><mo accent='true'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mi mathvariant='normal'>Δ</mi><msub><mrow><mi>m</mi></mrow><mrow><mn>1</mn></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>(</mo><mover accent='true'><mrow><mi>a</mi></mrow><mo accent='true'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mi>b</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>∈</mo> <msubsup><mrow><mi>ℤ</mi></mrow><mrow><mi>q</mi></mrow><mrow><mi>k</mi><mo class='MathClass-bin' stretchy='false'>+</mo><mn>1</mn></mrow></msubsup></mrow></math>,
where <!-- l. 168 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>b</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mover accent='true'><mrow><mi>a</mi></mrow><mo accent='true'>→</mo></mover> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mover accent='true'><mrow><mi>s</mi></mrow><mo accent='true'>→</mo></mover> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi mathvariant='normal'>Δ</mi><msub><mrow><mi>m</mi></mrow><mrow><mn>1</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>e</mi></mrow></math>
</p><!-- l. 170 --><p class='indent'>   <!-- l. 170 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 172 --><p class='indent'>   <!-- l. 172 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msubsup><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖦𝖲𝖶</mtext></mstyle></mrow><mrow><mover accent='true'><mrow><mi>s</mi></mrow><mo accent='true'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow><mrow><mi>β</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>l</mi></mrow></msubsup><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>m</mi></mrow><mrow><mn>2</mn></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-close' fence='true' mathsize='1.61em'>{</mo><msubsup><mrow><mo class='MathClass-open' stretchy='false'>{</mo><msubsup><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖫𝖾𝗏</mtext></mstyle></mrow><mrow><mover accent='true'><mrow><mi>s</mi></mrow><mo accent='true'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow><mrow><mi>β</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>l</mi></mrow></msubsup><mo class='MathClass-open' stretchy='false'>(</mo><mo class='MathClass-bin' stretchy='false'>−</mo><msub><mrow><mi>s</mi></mrow><mrow><mi>i</mi></mrow></msub> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msub><mrow><mi>m</mi></mrow><mrow><mn>2</mn></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-close' stretchy='false'>}</mo></mrow><mrow><mi>i</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>0</mn></mrow><mrow><mi>k</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msubsup><mo class='MathClass-punc' stretchy='false'>,</mo><msubsup><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖫𝖾𝗏</mtext></mstyle></mrow><mrow><mover accent='true'><mrow><mi>s</mi></mrow><mo accent='true'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow><mrow><mi>β</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>l</mi></mrow></msubsup><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>m</mi></mrow><mrow><mn>2</mn></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo><mrow><mo class='MathClass-open' fence='true' mathsize='1.61em'>}</mo><mrow><mo class='MathClass-rel' stretchy='false'>∈</mo> <msubsup><mrow><mi>ℤ</mi></mrow><mrow><mi>q</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>(</mo><mi>k</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-bin' stretchy='false'>⋅</mo><mi>l</mi><mo class='MathClass-bin' stretchy='false'>⋅</mo><mo class='MathClass-open' stretchy='false'>(</mo><mi>k</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msubsup></mrow> <span id='textcolor8'>#
                                                                                         
                                                                                         
from <span class='rm-lmbx-10x-x-109'>??</span></span>
</mrow></mrow></math></p><!-- l. 174 --><p class='indent'>   <!-- l. 174 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 176 --><p class='noindent'>Let’s use the following notations:
</p><!-- l. 178 --><p class='indent'>   <!-- l. 178 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msubsup><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖦𝖲𝖶</mtext></mstyle></mrow><mrow><mover accent='true'><mrow><mi>s</mi></mrow><mo accent='true'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow><mrow><mi>β</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>l</mi></mrow></msubsup><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>m</mi></mrow><mrow><mn>2</mn></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo> <mover accent='true'><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖼𝗍</mtext></mstyle></mrow><mo accent='true'>¯</mo></mover> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mover accent='true'><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖼𝗍</mtext></mstyle></mrow><mo accent='true'>¯</mo></mover></mrow><mrow><mn>0</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-punc' stretchy='false'>.</mo><msub><mrow><mover accent='true'><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖼𝗍</mtext></mstyle></mrow><mo accent='true'>¯</mo></mover></mrow><mrow><mn>1</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><mstyle class='text'><mtext></mtext><mstyle class='math'><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace></mstyle><mtext></mtext></mstyle><mstyle class='text'><mtext> </mtext></mstyle><msub><mrow><mover accent='true'><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖼𝗍</mtext></mstyle></mrow><mo accent='true'>¯</mo></mover></mrow><mrow><mi>k</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
</p><!-- l. 180 --><p class='indent'>   <!-- l. 180 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mover accent='true'><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖼𝗍</mtext></mstyle></mrow><mo accent='true'>¯</mo></mover></mrow><mrow><mi>i</mi></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo><msubsup><mrow> <mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖫𝖾𝗏</mtext></mstyle></mrow><mrow><mover accent='true'><mrow><mi>s</mi></mrow><mo accent='true'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow><mrow><mi>β</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>l</mi></mrow></msubsup><mo class='MathClass-open' stretchy='false'>(</mo><mo class='MathClass-bin' stretchy='false'>−</mo><msub><mrow><mi>s</mi></mrow><mrow><mi>i</mi></mrow></msub> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msub><mrow><mi>m</mi></mrow><mrow><mn>2</mn></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math> for
<!-- l. 180 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mn>0</mn> <mo class='MathClass-rel' stretchy='false'>≤</mo><mi>i</mi> <mo class='MathClass-rel' stretchy='false'>≤</mo><mo class='MathClass-open' stretchy='false'>(</mo><mi>k</mi> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
</p><!-- l. 182 --><p class='indent'>   <!-- l. 182 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mover accent='true'><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖼𝗍</mtext></mstyle></mrow><mo accent='true'>¯</mo></mover></mrow><mrow><mi>k</mi></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo><msubsup><mrow> <mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖫𝖾𝗏</mtext></mstyle></mrow><mrow><mover accent='true'><mrow><mi>s</mi></mrow><mo accent='true'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow><mrow><mi>β</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>l</mi></mrow></msubsup><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>m</mi></mrow><mrow><mn>2</mn></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
</p><!-- l. 184 --><p class='indent'>   <!-- l. 184 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖼𝗍</mtext></mstyle> <mo class='MathClass-rel' stretchy='false'>=</mo><msub><mrow> <mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mover accent='true'><mrow><mi>s</mi></mrow><mo accent='true'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mi mathvariant='normal'>Δ</mi><msub><mrow><mi>m</mi></mrow><mrow><mn>1</mn></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>(</mo><mover accent='true'><mrow><mi>a</mi></mrow><mo accent='true'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mi>b</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>a</mi></mrow><mrow><mn>0</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>a</mi></mrow><mrow><mn>1</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><mstyle class='text'><mtext></mtext><mstyle class='math'><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace></mstyle><mtext></mtext></mstyle><mstyle class='text'><mtext> </mtext></mstyle><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>a</mi></mrow><mrow><mi>k</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><mi>b</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖼𝗍</mtext></mstyle></mrow><mrow><mn>0</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖼𝗍</mtext></mstyle></mrow><mrow><mn>1</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖼𝗍</mtext></mstyle></mrow><mrow><mi>k</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
</p><!-- l. 186 --><p class='indent'>   <!-- l. 186 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 188 --><p class='noindent'>Let’s define the following TFHE ciphertext multiplication operation:
</p><!-- l. 190 --><p class='indent'>   <!-- l. 190 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖼𝗍</mtext></mstyle> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mover accent='true'><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖼𝗍</mtext></mstyle></mrow><mo accent='true'>¯</mo></mover> <mo class='MathClass-rel' stretchy='false'>=</mo><munderover accent='false' accentunder='false'><mrow> <mi class='MathClass-op'>∑</mi><mo> ⁡<!-- FUNCTION APPLICATION --></mo>
  </mrow><mrow><mi>i</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>0</mn></mrow><mrow><mi>k</mi></mrow></munderover><mo class='MathClass-open' stretchy='false'>⟨</mo><msup><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖣𝖾𝖼𝗈𝗆𝗉</mtext></mstyle></mrow><mrow><mi>β</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>l</mi></mrow></msup><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖼𝗍</mtext></mstyle></mrow><mrow><mi>i</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mover accent='true'><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖼𝗍</mtext></mstyle></mrow><mo accent='true'>¯</mo></mover></mrow><mrow><mi>i</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></math>
</p><!-- l. 192 --><p class='indent'>   <!-- l. 192 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 194 --><p class='noindent'>Then, the following is true:
</p>
   <div class='tcolorbox tcolorbox' id='tcolobox-18'>     
<div class='tcolorbox-title'>
<!-- l. 202 --><p class='indent'>   <!-- l. 202 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mstyle mathvariant='bold'><mo class='MathClass-open' stretchy='false'>⟨</mo></mstyle></math><span class='rm-lmbx-10x-x-109'>Summary </span><a href='#homomorphic-ciphertexttociphertext-multiplication'><span class='rm-lmbx-10x-x-109'>D-1.6</span><!-- tex4ht:ref: subsec:tfhemmultccipher  --></a><!-- l. 202 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mstyle mathvariant='bold'><mo class='MathClass-close' stretchy='false'>⟩</mo></mstyle></math>
<span class='rm-lmbx-10x-x-109'>TFHE Ciphertext-to-Ciphertext Multiplication</span></p></div> 
<div class='tcolorbox-content'><!-- l. 197 --><p class='noindent'><!-- l. 197 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖼𝗍</mtext></mstyle> <mo class='MathClass-rel' stretchy='false'>=</mo><msub><mrow> <mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mover accent='true'><mrow><mi>s</mi></mrow><mo accent='true'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mi mathvariant='normal'>Δ</mi><msub><mrow><mi>m</mi></mrow><mrow><mn>1</mn></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>a</mi></mrow><mrow><mn>0</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>a</mi></mrow><mrow><mn>1</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>a</mi></mrow><mrow><mi>k</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><mi>b</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
</p><!-- l. 199 --><p class='noindent'><!-- l. 199 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mover accent='true'><mrow><mi>C</mi></mrow><mo accent='true'>¯</mo></mover> <mo class='MathClass-rel' stretchy='false'>=</mo><msubsup><mrow> <mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖦𝖲𝖶</mtext></mstyle></mrow><mrow><mover accent='true'><mrow><mi>s</mi></mrow><mo accent='true'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow><mrow><mi>β</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>l</mi></mrow></msubsup><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>m</mi></mrow><mrow><mn>2</mn></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo> <mstyle mathvariant='bold'><mo class='MathClass-open' stretchy='false'>(</mo></mstyle><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖫𝖾𝗏</mtext></mstyle></mrow><mrow><mover accent='true'><mrow><mi>s</mi></mrow><mo accent='true'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mo class='MathClass-bin' stretchy='false'>−</mo><msub><mrow><mi>s</mi></mrow><mrow><mn>0</mn></mrow></msub><mo class='MathClass-bin' stretchy='false'>⋅</mo><msub><mrow><mi>m</mi></mrow><mrow><mn>2</mn></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-punc' stretchy='false'>,</mo><msubsup><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖫𝖾𝗏</mtext></mstyle></mrow><mrow><mover accent='true'><mrow><mi>s</mi></mrow><mo accent='true'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow><mrow><mi>β</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>l</mi></mrow></msubsup><mo class='MathClass-open' stretchy='false'>(</mo><mo class='MathClass-bin' stretchy='false'>−</mo><msub><mrow><mi>s</mi></mrow><mrow><mn>1</mn></mrow></msub><mo class='MathClass-bin' stretchy='false'>⋅</mo><msub><mrow><mi>m</mi></mrow><mrow><mn>2</mn></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace><mo class='MathClass-punc' stretchy='false'>,</mo><msubsup><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖫𝖾𝗏</mtext></mstyle></mrow><mrow><mover accent='true'><mrow><mi>s</mi></mrow><mo accent='true'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow><mrow><mi>β</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>l</mi></mrow></msubsup><mo class='MathClass-open' stretchy='false'>(</mo><mo class='MathClass-bin' stretchy='false'>−</mo><msub><mrow><mi>s</mi></mrow><mrow><mi>k</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub><mo class='MathClass-bin' stretchy='false'>⋅</mo><msub><mrow><mi>m</mi></mrow><mrow><mn>2</mn></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-punc' stretchy='false'>,</mo><msubsup><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖫𝖾𝗏</mtext></mstyle></mrow><mrow><mover accent='true'><mrow><mi>s</mi></mrow><mo accent='true'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow><mrow><mi>β</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>l</mi></mrow></msubsup><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>m</mi></mrow><mrow><mn>2</mn></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo><mstyle mathvariant='bold'><mo class='MathClass-close' stretchy='false'>)</mo></mstyle></mrow></math>
</p><!-- l. 201 --><p class='noindent'><!-- l. 201 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mover accent='true'><mrow><mi>s</mi></mrow><mo accent='true'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mi mathvariant='normal'>Δ</mi><msub><mrow><mi>m</mi></mrow><mrow><mn>1</mn></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msubsup><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖦𝖲𝖶</mtext></mstyle></mrow><mrow><mover accent='true'><mrow><mi>s</mi></mrow><mo accent='true'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow><mrow><mi>β</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>l</mi></mrow></msubsup><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>m</mi></mrow><mrow><mn>2</mn></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo><munderover accent='false' accentunder='false'><mrow> <mi class='MathClass-op'>∑</mi><mo> ⁡<!-- FUNCTION APPLICATION --></mo>
  </mrow><mrow><mi>i</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>0</mn></mrow><mrow><mi>k</mi></mrow></munderover><mo class='MathClass-open' stretchy='false'>⟨</mo><msup><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖣𝖾𝖼𝗈𝗆𝗉</mtext></mstyle></mrow><mrow><mi>β</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>l</mi></mrow></msup><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖼𝗍</mtext></mstyle></mrow><mrow><mi>i</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mover accent='true'><mrow><mi>C</mi></mrow><mo accent='true'>¯</mo></mover></mrow><mrow><mi>i</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>⟩</mo><mo class='MathClass-rel' stretchy='false'>=</mo><msub><mrow> <mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mover accent='true'><mrow><mi>s</mi></mrow><mo accent='true'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mi mathvariant='normal'>Δ</mi><msub><mrow><mi>m</mi></mrow><mrow><mn>1</mn></mrow></msub><msub><mrow><mi>m</mi></mrow><mrow><mn>2</mn></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
</p> 
</div> 
</div>
<!-- l. 204 --><p class='indent'>   This means that multiplying two TFHE ciphertexts (one is in LWE and another in GSW) and
decrypting the resulting LWE ciphertext gives the same result as multiplying their two original
plaintexts.
</p><!-- l. 206 --><p class='indent'>   <!-- l. 206 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 208 --><p class='indent'>   <span class='underline'><span class='rm-lmbx-10x-x-109'>Proof</span></span>
   </p><dl class='enumerate-enumitem'><dt class='enumerate-enumitem'>
1. </dt><dd class='enumerate-enumitem'><!-- l. 210 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><munderover accent='false' accentunder='false'><mrow><mi class='MathClass-op'>∑</mi><mo> ⁡<!-- FUNCTION APPLICATION --></mo>
  </mrow><mrow><mi>i</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>0</mn></mrow><mrow><mi>k</mi></mrow></munderover><mo class='MathClass-open' stretchy='false'>⟨</mo><msup><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖣𝖾𝖼𝗈𝗆𝗉</mtext></mstyle></mrow><mrow><mi>β</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>l</mi></mrow></msup><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖼𝗍</mtext></mstyle></mrow><mrow><mi>i</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mover accent='true'><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖼𝗍</mtext></mstyle></mrow><mo accent='true'>¯</mo></mover></mrow><mrow><mi>i</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></math>
   <br class='newline' /><!-- l. 211 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>⟨</mo><msup><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖣𝖾𝖼𝗈𝗆𝗉</mtext></mstyle></mrow><mrow><mi>β</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>l</mi></mrow></msup><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>a</mi></mrow><mrow><mn>0</mn></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mover accent='true'><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖼𝗍</mtext></mstyle></mrow><mo accent='true'>¯</mo></mover></mrow><mrow><mn>0</mn></mrow></msub><mo class='MathClass-close' stretchy='false'>⟩</mo><mo class='MathClass-bin' stretchy='false'>+</mo><mo class='MathClass-open' stretchy='false'>⟨</mo><msup><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖣𝖾𝖼𝗈𝗆𝗉</mtext></mstyle></mrow><mrow><mi>β</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>l</mi></mrow></msup><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>a</mi></mrow><mrow><mn>1</mn></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mover accent='true'><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖼𝗍</mtext></mstyle></mrow><mo accent='true'>¯</mo></mover></mrow><mrow><mn>1</mn></mrow></msub><mo class='MathClass-close' stretchy='false'>⟩</mo><mo class='MathClass-bin' stretchy='false'>+</mo><mstyle class='text'><mtext> </mtext></mstyle><mstyle class='text'><mtext></mtext><mstyle class='math'><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace></mstyle><mtext></mtext></mstyle><mstyle class='text'><mtext> </mtext></mstyle><mo class='MathClass-bin' stretchy='false'>+</mo><mo class='MathClass-open' stretchy='false'>⟨</mo><msup><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖣𝖾𝖼𝗈𝗆𝗉</mtext></mstyle></mrow><mrow><mi>β</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>l</mi></mrow></msup><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>a</mi></mrow><mrow><mi>k</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mover accent='true'><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖼𝗍</mtext></mstyle></mrow><mo accent='true'>¯</mo></mover></mrow><mrow><mi>k</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub><mo class='MathClass-close' stretchy='false'>⟩</mo><mo class='MathClass-bin' stretchy='false'>+</mo><mo class='MathClass-open' stretchy='false'>⟨</mo><msup><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖣𝖾𝖼𝗈𝗆𝗉</mtext></mstyle></mrow><mrow><mi>β</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>l</mi></mrow></msup><mo class='MathClass-open' stretchy='false'>(</mo><mi>b</mi><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mover accent='true'><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖼𝗍</mtext></mstyle></mrow><mo accent='true'>¯</mo></mover></mrow><mrow><mi>k</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></math>
   <br class='newline' /><span id='textcolor9'># expanding the dot product of two vectors</span>
   </dd><dt class='enumerate-enumitem'>
2. </dt><dd class='enumerate-enumitem'>For <!-- l. 213 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>i</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mi>k</mi></mrow></math>:
   <br class='newline' /><!-- l. 214 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖣𝖾𝖼𝗈𝗆𝗉</mtext></mstyle></mrow><mrow><mi>β</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>l</mi></mrow></msup><mo class='MathClass-open' stretchy='false'>(</mo><mi>b</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>b</mi></mrow><mrow><mn>1</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>b</mi></mrow><mrow><mn>2</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><mstyle class='text'><mtext></mtext><mstyle class='math'><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace></mstyle><mtext></mtext></mstyle><mstyle class='text'><mtext> </mtext></mstyle><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>b</mi></mrow><mrow><mi>l</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>,
   where <!-- l. 214 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>b</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mi>b</mi></mrow><mrow><mn>1</mn></mrow></msub><mstyle displaystyle='true'><mfrac><mrow>  <mi>q</mi>
</mrow><mrow><msup><mrow><mi>β</mi></mrow><mrow><mn>1</mn></mrow></msup></mrow></mfrac></mstyle> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>b</mi></mrow><mrow><mn>2</mn></mrow></msub><mstyle displaystyle='true'><mfrac><mrow>  <mi>q</mi>
</mrow><mrow><msup><mrow><mi>β</mi></mrow><mrow><mn>2</mn></mrow></msup></mrow></mfrac></mstyle> <mo class='MathClass-bin' stretchy='false'>+</mo> <mstyle class='text'><mtext> </mtext></mstyle><mstyle class='text'><mtext></mtext><mstyle class='math'><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace></mstyle><mtext></mtext></mstyle><mstyle class='text'><mtext> </mtext></mstyle> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>b</mi></mrow><mrow><mi>l</mi></mrow></msub><mstyle displaystyle='true'><mfrac><mrow> <mi>q</mi>
</mrow><mrow><msup><mrow><mi>β</mi></mrow><mrow><mi>l</mi></mrow></msup></mrow></mfrac></mstyle></mrow></math>
   <span id='textcolor10'># from <span class='rm-lmbx-10x-x-109'>??</span></span><br class='newline' /><!-- l. 215 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mover accent='true'><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖼𝗍</mtext></mstyle></mrow><mo accent='true'>¯</mo></mover></mrow><mrow><mi>k</mi></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo><msubsup><mrow> <mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖫𝖾𝗏</mtext></mstyle></mrow><mrow><mover accent='true'><mrow><mi>s</mi></mrow><mo accent='true'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow><mrow><mi>β</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>l</mi></mrow></msubsup><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>m</mi></mrow><mrow><mn>2</mn></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo> <mrow><mo fence='true' form='prefix'>(</mo><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mover accent='true'><mrow><mi>s</mi></mrow><mo accent='true'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub> <mrow><mo fence='true' form='prefix'>(</mo><mrow><msub><mrow><mi>m</mi></mrow><mrow><mn>2</mn></mrow></msub><mstyle displaystyle='true'><mfrac><mrow>  <mi>q</mi>
</mrow><mrow><msup><mrow><mi>β</mi></mrow><mrow><mn>1</mn></mrow></msup></mrow></mfrac></mstyle></mrow><mo fence='true' form='postfix'>)</mo></mrow> <mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mover accent='true'><mrow><mi>s</mi></mrow><mo accent='true'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub> <mrow><mo fence='true' form='prefix'>(</mo><mrow><msub><mrow><mi>m</mi></mrow><mrow><mn>2</mn></mrow></msub><mstyle displaystyle='true'><mfrac><mrow>  <mi>q</mi>
</mrow><mrow><msup><mrow><mi>β</mi></mrow><mrow><mn>2</mn></mrow></msup></mrow></mfrac></mstyle></mrow><mo fence='true' form='postfix'>)</mo></mrow> <mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><mstyle class='text'><mtext></mtext><mstyle class='math'><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace></mstyle><mtext></mtext></mstyle><mstyle class='text'><mtext> </mtext></mstyle><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mover accent='true'><mrow><mi>s</mi></mrow><mo accent='true'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub> <mrow><mo fence='true' form='prefix'>(</mo><mrow><msub><mrow><mi>m</mi></mrow><mrow><mn>2</mn></mrow></msub><mstyle displaystyle='true'><mfrac><mrow> <mi>q</mi>
</mrow><mrow><msup><mrow><mi>β</mi></mrow><mrow><mi>l</mi></mrow></msup></mrow></mfrac></mstyle></mrow><mo fence='true' form='postfix'>)</mo></mrow></mrow><mo fence='true' form='postfix'>)</mo></mrow></mrow></math>
   <br class='newline' /><!-- l. 216 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
   <!-- l. 218 --><p class='noindent'>Therefore: <br class='newline' /><!-- l. 219 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><msup><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖣𝖾𝖼𝗈𝗆𝗉</mtext></mstyle></mrow><mrow><mi>β</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>l</mi></mrow></msup><mo class='MathClass-open' stretchy='false'>(</mo><mi>b</mi><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mover accent='true'><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖼𝗍</mtext></mstyle></mrow><mo accent='true'>¯</mo></mover></mrow><mrow><mi>k</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></math><br class='newline' /><!-- l. 220 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mi>b</mi></mrow><mrow><mn>1</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mover accent='true'><mrow><mi>s</mi></mrow><mo accent='true'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub> <mrow><mo fence='true' form='prefix'>(</mo><mrow><msub><mrow><mi>m</mi></mrow><mrow><mn>2</mn></mrow></msub><mstyle displaystyle='true'><mfrac><mrow>  <mi>q</mi>
</mrow><mrow><msup><mrow><mi>β</mi></mrow><mrow><mn>1</mn></mrow></msup></mrow></mfrac></mstyle></mrow><mo fence='true' form='postfix'>)</mo></mrow> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>b</mi></mrow><mrow><mn>2</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mover accent='true'><mrow><mi>s</mi></mrow><mo accent='true'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub> <mrow><mo fence='true' form='prefix'>(</mo><mrow><msub><mrow><mi>m</mi></mrow><mrow><mn>2</mn></mrow></msub><mstyle displaystyle='true'><mfrac><mrow>  <mi>q</mi>
</mrow><mrow><msup><mrow><mi>β</mi></mrow><mrow><mn>2</mn></mrow></msup></mrow></mfrac></mstyle></mrow><mo fence='true' form='postfix'>)</mo></mrow> <mo class='MathClass-bin' stretchy='false'>+</mo> <mstyle class='text'><mtext> </mtext></mstyle><mstyle class='text'><mtext></mtext><mstyle class='math'><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace></mstyle><mtext></mtext></mstyle><mstyle class='text'><mtext> </mtext></mstyle> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>b</mi></mrow><mrow><mi>l</mi></mrow></msub> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mover accent='true'><mrow><mi>s</mi></mrow><mo accent='true'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub> <mrow><mo fence='true' form='prefix'>(</mo><mrow><msub><mrow><mi>m</mi></mrow><mrow><mn>2</mn></mrow></msub><mstyle displaystyle='true'><mfrac><mrow> <mi>q</mi>
</mrow><mrow><msup><mrow><mi>β</mi></mrow><mrow><mi>l</mi></mrow></msup></mrow></mfrac></mstyle></mrow><mo fence='true' form='postfix'>)</mo></mrow></mrow></math>
   <br class='newline' /><!-- l. 221 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo><msub><mrow> <mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mover accent='true'><mrow><mi>s</mi></mrow><mo accent='true'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub> <mrow><mo fence='true' form='prefix'>(</mo><mrow><msub><mrow><mi>b</mi></mrow><mrow><mn>1</mn></mrow></msub><msub><mrow><mi>m</mi></mrow><mrow><mn>2</mn></mrow></msub><mstyle displaystyle='true'><mfrac><mrow>  <mi>q</mi>
</mrow><mrow><msup><mrow><mi>β</mi></mrow><mrow><mn>1</mn></mrow></msup></mrow></mfrac></mstyle></mrow><mo fence='true' form='postfix'>)</mo></mrow> <mo class='MathClass-bin' stretchy='false'>+</mo><msub><mrow> <mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mover accent='true'><mrow><mi>s</mi></mrow><mo accent='true'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub> <mrow><mo fence='true' form='prefix'>(</mo><mrow><msub><mrow><mi>b</mi></mrow><mrow><mn>2</mn></mrow></msub><msub><mrow><mi>m</mi></mrow><mrow><mn>2</mn></mrow></msub><mstyle displaystyle='true'><mfrac><mrow>  <mi>q</mi>
</mrow><mrow><msup><mrow><mi>β</mi></mrow><mrow><mn>2</mn></mrow></msup></mrow></mfrac></mstyle></mrow><mo fence='true' form='postfix'>)</mo></mrow> <mo class='MathClass-bin' stretchy='false'>+</mo> <mstyle class='text'><mtext> </mtext></mstyle><mstyle class='text'><mtext></mtext><mstyle class='math'><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace></mstyle><mtext></mtext></mstyle><mstyle class='text'><mtext> </mtext></mstyle> <mo class='MathClass-bin' stretchy='false'>+</mo><msub><mrow> <mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mover accent='true'><mrow><mi>s</mi></mrow><mo accent='true'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub> <mrow><mo fence='true' form='prefix'>(</mo><mrow><msub><mrow><mi>b</mi></mrow><mrow><mi>l</mi></mrow></msub><msub><mrow><mi>m</mi></mrow><mrow><mn>2</mn></mrow></msub><mstyle displaystyle='true'><mfrac><mrow> <mi>q</mi>
</mrow><mrow><msup><mrow><mi>β</mi></mrow><mrow><mi>l</mi></mrow></msup></mrow></mfrac></mstyle></mrow><mo fence='true' form='postfix'>)</mo></mrow></mrow></math>
   <span id='textcolor11'># from <span class='rm-lmbx-10x-x-109'>??</span></span> <br class='newline' /><!-- l. 222 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo><msub><mrow> <mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mover accent='true'><mrow><mi>s</mi></mrow><mo accent='true'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub> <mrow><mo fence='true' form='prefix'>(</mo><mrow><msub><mrow><mi>b</mi></mrow><mrow><mn>1</mn></mrow></msub><msub><mrow><mi>m</mi></mrow><mrow><mn>2</mn></mrow></msub><mstyle displaystyle='true'><mfrac><mrow>  <mi>q</mi>
</mrow><mrow><msup><mrow><mi>β</mi></mrow><mrow><mn>1</mn></mrow></msup></mrow></mfrac></mstyle> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>b</mi></mrow><mrow><mn>2</mn></mrow></msub><msub><mrow><mi>m</mi></mrow><mrow><mn>2</mn></mrow></msub><mstyle displaystyle='true'><mfrac><mrow>  <mi>q</mi>
</mrow><mrow><msup><mrow><mi>β</mi></mrow><mrow><mn>2</mn></mrow></msup></mrow></mfrac></mstyle> <mo class='MathClass-bin' stretchy='false'>+</mo> <mstyle class='text'><mtext> </mtext></mstyle><mstyle class='text'><mtext></mtext><mstyle class='math'><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace></mstyle><mtext></mtext></mstyle><mstyle class='text'><mtext> </mtext></mstyle> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>b</mi></mrow><mrow><mi>l</mi></mrow></msub><msub><mrow><mi>m</mi></mrow><mrow><mn>2</mn></mrow></msub><mstyle displaystyle='true'><mfrac><mrow> <mi>q</mi>
</mrow><mrow><msup><mrow><mi>β</mi></mrow><mrow><mi>l</mi></mrow></msup></mrow></mfrac></mstyle></mrow><mo fence='true' form='postfix'>)</mo></mrow></mrow></math>
   <span id='textcolor12'># from <span class='rm-lmbx-10x-x-109'>??</span></span><br class='newline' /><!-- l. 223 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo><msub><mrow> <mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mover accent='true'><mrow><mi>s</mi></mrow><mo accent='true'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub> <mrow><mo fence='true' form='prefix'>(</mo><mrow><msub><mrow><mi>m</mi></mrow><mrow><mn>2</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>⋅</mo> <mrow><mo fence='true' form='prefix'>(</mo><mrow><msub><mrow><mi>b</mi></mrow><mrow><mn>1</mn></mrow></msub><mstyle displaystyle='true'><mfrac><mrow>  <mi>q</mi>
</mrow><mrow><msup><mrow><mi>β</mi></mrow><mrow><mn>1</mn></mrow></msup></mrow></mfrac></mstyle> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>b</mi></mrow><mrow><mn>2</mn></mrow></msub><mstyle displaystyle='true'><mfrac><mrow>  <mi>q</mi>
</mrow><mrow><msup><mrow><mi>β</mi></mrow><mrow><mn>2</mn></mrow></msup></mrow></mfrac></mstyle> <mo class='MathClass-bin' stretchy='false'>+</mo> <mstyle class='text'><mtext> </mtext></mstyle><mstyle class='text'><mtext></mtext><mstyle class='math'><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace></mstyle><mtext></mtext></mstyle><mstyle class='text'><mtext> </mtext></mstyle> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>b</mi></mrow><mrow><mi>l</mi></mrow></msub><mstyle displaystyle='true'><mfrac><mrow> <mi>q</mi>
</mrow><mrow><msup><mrow><mi>β</mi></mrow><mrow><mi>l</mi></mrow></msup></mrow></mfrac></mstyle></mrow><mo fence='true' form='postfix'>)</mo></mrow></mrow><mo fence='true' form='postfix'>)</mo></mrow></mrow></math>
   <br class='newline' /><!-- l. 224 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo><msub><mrow> <mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mover accent='true'><mrow><mi>s</mi></mrow><mo accent='true'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>m</mi></mrow><mrow><mn>2</mn></mrow></msub><mi>b</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
   <span id='textcolor13'># from <span class='rm-lmbx-10x-x-109'>??</span></span>
   </p></dd><dt class='enumerate-enumitem'>
3. </dt><dd class='enumerate-enumitem'>For <!-- l. 226 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mn>0</mn> <mo class='MathClass-rel' stretchy='false'>≤</mo><mi>i</mi> <mo class='MathClass-rel' stretchy='false'>≤</mo><mo class='MathClass-open' stretchy='false'>(</mo><mi>k</mi> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>:
   <br class='newline' /><!-- l. 227 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖣𝖾𝖼𝗈𝗆𝗉</mtext></mstyle></mrow><mrow><mi>β</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>l</mi></mrow></msup><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>a</mi></mrow><mrow><mi>i</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>a</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mi>i</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>a</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mi>i</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><mstyle class='text'><mtext></mtext><mstyle class='math'><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace></mstyle><mtext></mtext></mstyle><mstyle class='text'><mtext> </mtext></mstyle><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>a</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mi>i</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>l</mi><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>,
   where <!-- l. 227 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>a</mi></mrow><mrow><mi>i</mi></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mi>a</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mi>i</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msub><mstyle displaystyle='true'><mfrac><mrow> <mi>q</mi>
</mrow><mrow><msup><mrow><mi>β</mi></mrow><mrow><mn>1</mn></mrow></msup></mrow></mfrac></mstyle> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>a</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mi>i</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msub><mstyle displaystyle='true'><mfrac><mrow> <mi>q</mi>
</mrow><mrow><msup><mrow><mi>β</mi></mrow><mrow><mn>2</mn></mrow></msup></mrow></mfrac></mstyle> <mo class='MathClass-bin' stretchy='false'>+</mo> <mstyle class='text'><mtext> </mtext></mstyle><mstyle class='text'><mtext></mtext><mstyle class='math'><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace></mstyle><mtext></mtext></mstyle><mstyle class='text'><mtext> </mtext></mstyle> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>a</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mi>i</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>l</mi><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msub><mstyle displaystyle='true'><mfrac><mrow> <mi>q</mi>
</mrow><mrow><msup><mrow><mi>β</mi></mrow><mrow><mi>l</mi></mrow></msup></mrow></mfrac></mstyle></mrow></math>
   <br class='newline' /><!-- l. 228 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mover accent='true'><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖼𝗍</mtext></mstyle></mrow><mo accent='true'>¯</mo></mover></mrow><mrow><mi>i</mi></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo><msubsup><mrow> <mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖫𝖾𝗏</mtext></mstyle></mrow><mrow><mover accent='true'><mrow><mi>s</mi></mrow><mo accent='true'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow><mrow><mi>β</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>l</mi></mrow></msubsup><mo class='MathClass-open' stretchy='false'>(</mo><mo class='MathClass-bin' stretchy='false'>−</mo><msub><mrow><mi>s</mi></mrow><mrow><mi>i</mi></mrow></msub><msub><mrow><mi>m</mi></mrow><mrow><mn>2</mn></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo> <mrow><mo fence='true' form='prefix'>(</mo><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mover accent='true'><mrow><mi>s</mi></mrow><mo accent='true'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub> <mrow><mo fence='true' form='prefix'>(</mo><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><msub><mrow><mi>s</mi></mrow><mrow><mi>i</mi></mrow></msub><msub><mrow><mi>m</mi></mrow><mrow><mn>2</mn></mrow></msub><mstyle displaystyle='true'><mfrac><mrow>  <mi>q</mi>
</mrow><mrow><msup><mrow><mi>β</mi></mrow><mrow><mn>1</mn></mrow></msup></mrow></mfrac></mstyle></mrow><mo fence='true' form='postfix'>)</mo></mrow> <mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mover accent='true'><mrow><mi>s</mi></mrow><mo accent='true'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub> <mrow><mo fence='true' form='prefix'>(</mo><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><msub><mrow><mi>s</mi></mrow><mrow><mi>i</mi></mrow></msub><msub><mrow><mi>m</mi></mrow><mrow><mn>2</mn></mrow></msub><mstyle displaystyle='true'><mfrac><mrow>  <mi>q</mi>
</mrow><mrow><msup><mrow><mi>β</mi></mrow><mrow><mn>2</mn></mrow></msup></mrow></mfrac></mstyle></mrow><mo fence='true' form='postfix'>)</mo></mrow> <mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><mstyle class='text'><mtext></mtext><mstyle class='math'><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace></mstyle><mtext></mtext></mstyle><mstyle class='text'><mtext> </mtext></mstyle><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mover accent='true'><mrow><mi>s</mi></mrow><mo accent='true'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub> <mrow><mo fence='true' form='prefix'>(</mo><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><msub><mrow><mi>s</mi></mrow><mrow><mi>i</mi></mrow></msub><msub><mrow><mi>m</mi></mrow><mrow><mn>2</mn></mrow></msub><mstyle displaystyle='true'><mfrac><mrow> <mi>q</mi>
</mrow><mrow><msup><mrow><mi>β</mi></mrow><mrow><mi>l</mi></mrow></msup></mrow></mfrac></mstyle></mrow><mo fence='true' form='postfix'>)</mo></mrow></mrow><mo fence='true' form='postfix'>)</mo></mrow></mrow></math>
   <br class='newline' />
   <!-- l. 230 --><p class='noindent'><!-- l. 230 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
   Therefore: <br class='newline' /><!-- l. 232 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><msup><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖣𝖾𝖼𝗈𝗆𝗉</mtext></mstyle></mrow><mrow><mi>β</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>l</mi></mrow></msup><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>a</mi></mrow><mrow><mn>0</mn></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mover accent='true'><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖼𝗍</mtext></mstyle></mrow><mo accent='true'>¯</mo></mover></mrow><mrow><mn>0</mn></mrow></msub><mo class='MathClass-close' stretchy='false'>⟩</mo><mo class='MathClass-bin' stretchy='false'>+</mo> <mo class='MathClass-open' stretchy='false'>⟨</mo><msup><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖣𝖾𝖼𝗈𝗆𝗉</mtext></mstyle></mrow><mrow><mi>β</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>l</mi></mrow></msup><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>a</mi></mrow><mrow><mn>1</mn></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mover accent='true'><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖼𝗍</mtext></mstyle></mrow><mo accent='true'>¯</mo></mover></mrow><mrow><mn>1</mn></mrow></msub><mo class='MathClass-close' stretchy='false'>⟩</mo><mo class='MathClass-bin' stretchy='false'>+</mo> <mstyle class='text'><mtext> </mtext></mstyle><mstyle class='text'><mtext></mtext><mstyle class='math'><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace></mstyle><mtext></mtext></mstyle><mstyle class='text'><mtext> </mtext></mstyle> <mo class='MathClass-bin' stretchy='false'>+</mo> <mo class='MathClass-open' stretchy='false'>⟨</mo><msup><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖣𝖾𝖼𝗈𝗆𝗉</mtext></mstyle></mrow><mrow><mi>β</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>l</mi></mrow></msup><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>a</mi></mrow><mrow><mi>k</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mover accent='true'><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖼𝗍</mtext></mstyle></mrow><mo accent='true'>¯</mo></mover></mrow><mrow><mi>k</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></math>
   <br class='newline' /><!-- l. 233 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-rel' stretchy='false'>=</mo><munderover accent='false' accentunder='false'><mrow> <mi class='MathClass-op'>∑</mi><mo> ⁡<!-- FUNCTION APPLICATION --></mo>
  </mrow><mrow><mi>i</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>0</mn></mrow><mrow><mi>k</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></munderover><mo class='MathClass-open' stretchy='false'>⟨</mo><msup><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖣𝖾𝖼𝗈𝗆𝗉</mtext></mstyle></mrow><mrow><mi>β</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>l</mi></mrow></msup><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>a</mi></mrow><mrow><mi>i</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mover accent='true'><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖼𝗍</mtext></mstyle></mrow><mo accent='true'>¯</mo></mover></mrow><mrow><mi>i</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></math>
   <br class='newline' /><!-- l. 234 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-rel' stretchy='false'>=</mo><munderover accent='false' accentunder='false'><mrow> <mi class='MathClass-op'>∑</mi><mo> ⁡<!-- FUNCTION APPLICATION --></mo>
  </mrow><mrow><mi>i</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>0</mn></mrow><mrow><mi>k</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></munderover> <mrow><mo fence='true' form='prefix'>(</mo><mrow><msub><mrow><mi>a</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mi>i</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msub><mo class='MathClass-bin' stretchy='false'>⋅</mo><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mover accent='true'><mrow><mi>s</mi></mrow><mo accent='true'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub> <mrow><mo fence='true' form='prefix'>(</mo><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><msub><mrow><mi>s</mi></mrow><mrow><mi>i</mi></mrow></msub><msub><mrow><mi>m</mi></mrow><mrow><mn>2</mn></mrow></msub><mstyle displaystyle='true'><mfrac><mrow>  <mi>q</mi>
</mrow><mrow><msup><mrow><mi>β</mi></mrow><mrow><mn>1</mn></mrow></msup></mrow></mfrac></mstyle></mrow><mo fence='true' form='postfix'>)</mo></mrow> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>a</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mi>i</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msub><mo class='MathClass-bin' stretchy='false'>⋅</mo><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mover accent='true'><mrow><mi>s</mi></mrow><mo accent='true'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub> <mrow><mo fence='true' form='prefix'>(</mo><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><msub><mrow><mi>s</mi></mrow><mrow><mi>i</mi></mrow></msub><msub><mrow><mi>m</mi></mrow><mrow><mn>2</mn></mrow></msub><mstyle displaystyle='true'><mfrac><mrow>  <mi>q</mi>
</mrow><mrow><msup><mrow><mi>β</mi></mrow><mrow><mn>2</mn></mrow></msup></mrow></mfrac></mstyle></mrow><mo fence='true' form='postfix'>)</mo></mrow> <mo class='MathClass-bin' stretchy='false'>+</mo> <mstyle class='text'><mtext> </mtext></mstyle><mstyle class='text'><mtext></mtext><mstyle class='math'><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace></mstyle><mtext></mtext></mstyle><mstyle class='text'><mtext> </mtext></mstyle> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>a</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mi>i</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>l</mi><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msub><mo class='MathClass-bin' stretchy='false'>⋅</mo><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mover accent='true'><mrow><mi>s</mi></mrow><mo accent='true'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub> <mrow><mo fence='true' form='prefix'>(</mo><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><msub><mrow><mi>s</mi></mrow><mrow><mi>i</mi></mrow></msub><msub><mrow><mi>m</mi></mrow><mrow><mn>2</mn></mrow></msub><mstyle displaystyle='true'><mfrac><mrow> <mi>q</mi>
</mrow><mrow><msup><mrow><mi>β</mi></mrow><mrow><mi>l</mi></mrow></msup></mrow></mfrac></mstyle></mrow><mo fence='true' form='postfix'>)</mo></mrow></mrow><mo fence='true' form='postfix'>)</mo></mrow></mrow></math>
   <br class='newline' /><!-- l. 235 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo><munderover accent='false' accentunder='false'><mrow> <mi class='MathClass-op'>∑</mi><mo> ⁡<!-- FUNCTION APPLICATION --></mo>
  </mrow><mrow><mi>i</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>0</mn></mrow><mrow><mi>k</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></munderover> <mrow><mo fence='true' form='prefix'>(</mo><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mover accent='true'><mrow><mi>s</mi></mrow><mo accent='true'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub> <mrow><mo fence='true' form='prefix'>(</mo><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><msub><mrow><mi>a</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mi>i</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msub><msub><mrow><mi>s</mi></mrow><mrow><mi>i</mi></mrow></msub><msub><mrow><mi>m</mi></mrow><mrow><mn>2</mn></mrow></msub><mstyle displaystyle='true'><mfrac><mrow>  <mi>q</mi>
</mrow><mrow><msup><mrow><mi>β</mi></mrow><mrow><mn>1</mn></mrow></msup></mrow></mfrac></mstyle></mrow><mo fence='true' form='postfix'>)</mo></mrow> <mo class='MathClass-bin' stretchy='false'>+</mo><msub><mrow> <mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mover accent='true'><mrow><mi>s</mi></mrow><mo accent='true'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub> <mrow><mo fence='true' form='prefix'>(</mo><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><msub><mrow><mi>a</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mi>i</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msub><msub><mrow><mi>s</mi></mrow><mrow><mi>i</mi></mrow></msub><msub><mrow><mi>m</mi></mrow><mrow><mn>2</mn></mrow></msub><mstyle displaystyle='true'><mfrac><mrow>  <mi>q</mi>
</mrow><mrow><msup><mrow><mi>β</mi></mrow><mrow><mn>2</mn></mrow></msup></mrow></mfrac></mstyle></mrow><mo fence='true' form='postfix'>)</mo></mrow> <mo class='MathClass-bin' stretchy='false'>+</mo> <mstyle class='text'><mtext> </mtext></mstyle><mstyle class='text'><mtext></mtext><mstyle class='math'><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace></mstyle><mtext></mtext></mstyle><mstyle class='text'><mtext> </mtext></mstyle> <mo class='MathClass-bin' stretchy='false'>+</mo><msub><mrow> <mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mover accent='true'><mrow><mi>s</mi></mrow><mo accent='true'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub> <mrow><mo fence='true' form='prefix'>(</mo><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><msub><mrow><mi>a</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mi>i</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>l</mi><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msub><msub><mrow><mi>s</mi></mrow><mrow><mi>i</mi></mrow></msub><msub><mrow><mi>m</mi></mrow><mrow><mn>2</mn></mrow></msub><mstyle displaystyle='true'><mfrac><mrow> <mi>q</mi>
</mrow><mrow><msup><mrow><mi>β</mi></mrow><mrow><mi>l</mi></mrow></msup></mrow></mfrac></mstyle></mrow><mo fence='true' form='postfix'>)</mo></mrow></mrow><mo fence='true' form='postfix'>)</mo></mrow></mrow></math>
   <br class='newline' /><!-- l. 236 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo><munderover accent='false' accentunder='false'><mrow> <mi class='MathClass-op'>∑</mi><mo> ⁡<!-- FUNCTION APPLICATION --></mo>
  </mrow><mrow><mi>i</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>0</mn></mrow><mrow><mi>k</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></munderover><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mover accent='true'><mrow><mi>s</mi></mrow><mo accent='true'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub> <mrow><mo fence='true' form='prefix'>(</mo><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><msub><mrow><mi>a</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mi>i</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msub><msub><mrow><mi>s</mi></mrow><mrow><mi>i</mi></mrow></msub><msub><mrow><mi>m</mi></mrow><mrow><mn>2</mn></mrow></msub><mstyle displaystyle='true'><mfrac><mrow>  <mi>q</mi>
</mrow><mrow><msup><mrow><mi>β</mi></mrow><mrow><mn>1</mn></mrow></msup></mrow></mfrac></mstyle> <mo class='MathClass-bin' stretchy='false'>+</mo> <mo class='MathClass-bin' stretchy='false'>−</mo><msub><mrow><mi>a</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mi>i</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msub><msub><mrow><mi>s</mi></mrow><mrow><mi>i</mi></mrow></msub><msub><mrow><mi>m</mi></mrow><mrow><mn>2</mn></mrow></msub><mstyle displaystyle='true'><mfrac><mrow>  <mi>q</mi>
</mrow><mrow><msup><mrow><mi>β</mi></mrow><mrow><mn>2</mn></mrow></msup></mrow></mfrac></mstyle> <mo class='MathClass-bin' stretchy='false'>+</mo> <mstyle class='text'><mtext> </mtext></mstyle><mstyle class='text'><mtext></mtext><mstyle class='math'><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace></mstyle><mtext></mtext></mstyle><mstyle class='text'><mtext> </mtext></mstyle> <mo class='MathClass-bin' stretchy='false'>+</mo> <mo class='MathClass-bin' stretchy='false'>−</mo><msub><mrow><mi>a</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mi>i</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>l</mi><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msub><msub><mrow><mi>s</mi></mrow><mrow><mi>i</mi></mrow></msub><msub><mrow><mi>m</mi></mrow><mrow><mn>2</mn></mrow></msub><mstyle displaystyle='true'><mfrac><mrow> <mi>q</mi>
</mrow><mrow><msup><mrow><mi>β</mi></mrow><mrow><mi>l</mi></mrow></msup></mrow></mfrac></mstyle></mrow><mo fence='true' form='postfix'>)</mo></mrow></mrow></math>
   <br class='newline' /><!-- l. 237 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo><munderover accent='false' accentunder='false'><mrow> <mi class='MathClass-op'>∑</mi><mo> ⁡<!-- FUNCTION APPLICATION --></mo>
  </mrow><mrow><mi>i</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>0</mn></mrow><mrow><mi>k</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></munderover><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mover accent='true'><mrow><mi>s</mi></mrow><mo accent='true'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub> <mrow><mo fence='true' form='prefix'>(</mo><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><msub><mrow><mi>s</mi></mrow><mrow><mi>i</mi></mrow></msub><msub><mrow><mi>m</mi></mrow><mrow><mn>2</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>⋅</mo> <mrow><mo fence='true' form='prefix'>(</mo><mrow><msub><mrow><mi>a</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mi>i</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msub><mstyle displaystyle='true'><mfrac><mrow> <mi>q</mi>
</mrow><mrow><msup><mrow><mi>β</mi></mrow><mrow><mn>1</mn></mrow></msup></mrow></mfrac></mstyle> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>a</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mi>i</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msub><mstyle displaystyle='true'><mfrac><mrow> <mi>q</mi>
</mrow><mrow><msup><mrow><mi>β</mi></mrow><mrow><mn>2</mn></mrow></msup></mrow></mfrac></mstyle> <mo class='MathClass-bin' stretchy='false'>+</mo> <mstyle class='text'><mtext> </mtext></mstyle><mstyle class='text'><mtext></mtext><mstyle class='math'><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace></mstyle><mtext></mtext></mstyle><mstyle class='text'><mtext> </mtext></mstyle> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>a</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mi>i</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>l</mi><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msub><mstyle displaystyle='true'><mfrac><mrow> <mi>q</mi>
</mrow><mrow><msup><mrow><mi>β</mi></mrow><mrow><mi>l</mi></mrow></msup></mrow></mfrac></mstyle></mrow><mo fence='true' form='postfix'>)</mo></mrow></mrow><mo fence='true' form='postfix'>)</mo></mrow></mrow></math>
   <br class='newline' /><!-- l. 238 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo><munderover accent='false' accentunder='false'><mrow> <mi class='MathClass-op'>∑</mi><mo> ⁡<!-- FUNCTION APPLICATION --></mo>
  </mrow><mrow><mi>i</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>0</mn></mrow><mrow><mi>k</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></munderover><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mover accent='true'><mrow><mi>s</mi></mrow><mo accent='true'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mo class='MathClass-bin' stretchy='false'>−</mo><msub><mrow><mi>s</mi></mrow><mrow><mi>i</mi></mrow></msub><msub><mrow><mi>m</mi></mrow><mrow><mn>2</mn></mrow></msub><msub><mrow><mi>a</mi></mrow><mrow><mi>i</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
   </p></dd><dt class='enumerate-enumitem'>
4. </dt><dd class='enumerate-enumitem'>According to step 2 and 3, <br class='newline' /><!-- l. 240 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><munderover accent='false' accentunder='false'><mrow><mi class='MathClass-op'>∑</mi><mo> ⁡<!-- FUNCTION APPLICATION --></mo>
  </mrow><mrow><mi>i</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>0</mn></mrow><mrow><mi>k</mi></mrow></munderover><mo class='MathClass-open' stretchy='false'>⟨</mo><msup><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖣𝖾𝖼𝗈𝗆𝗉</mtext></mstyle></mrow><mrow><mi>β</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>l</mi></mrow></msup><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖼𝗍</mtext></mstyle></mrow><mrow><mi>i</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mover accent='true'><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖼𝗍</mtext></mstyle></mrow><mo accent='true'>¯</mo></mover></mrow><mrow><mi>i</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></math>
   <br class='newline' /><!-- l. 241 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-rel' stretchy='false'>=</mo><munderover accent='false' accentunder='false'><mrow> <mi class='MathClass-op'>∑</mi><mo> ⁡<!-- FUNCTION APPLICATION --></mo>
  </mrow><mrow><mi>i</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>0</mn></mrow><mrow><mi>k</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></munderover><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mover accent='true'><mrow><mi>s</mi></mrow><mo accent='true'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mo class='MathClass-bin' stretchy='false'>−</mo><msub><mrow><mi>s</mi></mrow><mrow><mi>i</mi></mrow></msub><msub><mrow><mi>m</mi></mrow><mrow><mn>2</mn></mrow></msub><msub><mrow><mi>a</mi></mrow><mrow><mi>i</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>+</mo><msub><mrow> <mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mover accent='true'><mrow><mi>s</mi></mrow><mo accent='true'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>m</mi></mrow><mrow><mn>2</mn></mrow></msub><mi>b</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
   <br class='newline' /><!-- l. 242 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo><msub><mrow> <mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mover accent='true'><mrow><mi>s</mi></mrow><mo accent='true'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mstyle mathsize='1.61em'><mrow><mo fence='true' form='prefix'>(</mo><mrow></mrow><mo fence='true' form='postfix'></mo></mrow></mstyle><munderover accent='false' accentunder='false'><mrow> <mi class='MathClass-op'>∑</mi><mo> ⁡<!-- FUNCTION APPLICATION --></mo>
  </mrow><mrow><mi>i</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>0</mn></mrow><mrow><mi>k</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></munderover><mo class='MathClass-open' stretchy='false'>(</mo><mo class='MathClass-bin' stretchy='false'>−</mo><msub><mrow><mi>s</mi></mrow><mrow><mi>i</mi></mrow></msub><msub><mrow><mi>m</mi></mrow><mrow><mn>2</mn></mrow></msub><msub><mrow><mi>a</mi></mrow><mrow><mi>i</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>m</mi></mrow><mrow><mn>2</mn></mrow></msub><mi>b</mi><mstyle mathsize='1.61em'><mrow><mo fence='true' form='prefix'>)</mo><mrow></mrow><mo fence='true' form='postfix'></mo></mrow></mstyle></mrow></math>
   <span id='textcolor14'># addition of two GLWE ciphertexts</span> <br class='newline' /><!-- l. 243 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo><msub><mrow> <mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mover accent='true'><mrow><mi>s</mi></mrow><mo accent='true'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mstyle mathsize='1.61em'><mrow><mo fence='true' form='prefix'>(</mo><mrow></mrow><mo fence='true' form='postfix'></mo></mrow></mstyle><msub><mrow><mi>m</mi></mrow><mrow><mn>2</mn></mrow></msub><mi>b</mi> <mo class='MathClass-bin' stretchy='false'>−</mo><munderover accent='false' accentunder='false'><mrow><mi class='MathClass-op'>∑</mi><mo> ⁡<!-- FUNCTION APPLICATION --></mo>
  </mrow><mrow><mi>i</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>0</mn></mrow><mrow><mi>k</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></munderover><msub><mrow><mi>m</mi></mrow><mrow><mn>2</mn></mrow></msub><msub><mrow><mi>a</mi></mrow><mrow><mi>i</mi></mrow></msub><msub><mrow><mi>s</mi></mrow><mrow><mi>i</mi></mrow></msub><mstyle mathsize='1.61em'><mrow><mo fence='true' form='prefix'>)</mo><mrow></mrow><mo fence='true' form='postfix'></mo></mrow></mstyle></mrow></math>
   <br class='newline' /><!-- l. 244 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo><msub><mrow> <mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mover accent='true'><mrow><mi>s</mi></mrow><mo accent='true'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mstyle mathsize='1.61em'><mrow><mo fence='true' form='prefix'>(</mo><mrow></mrow><mo fence='true' form='postfix'></mo></mrow></mstyle><msub><mrow><mi>m</mi></mrow><mrow><mn>2</mn></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mi>b</mi> <mo class='MathClass-bin' stretchy='false'>−</mo><munderover accent='false' accentunder='false'><mrow><mi class='MathClass-op'>∑</mi><mo> ⁡<!-- FUNCTION APPLICATION --></mo>
  </mrow><mrow><mi>i</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>0</mn></mrow><mrow><mi>k</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></munderover><msub><mrow><mi>a</mi></mrow><mrow><mi>i</mi></mrow></msub><msub><mrow><mi>s</mi></mrow><mrow><mi>i</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo><mstyle mathsize='1.61em'><mrow><mo fence='true' form='prefix'>)</mo><mrow></mrow><mo fence='true' form='postfix'></mo></mrow></mstyle></mrow></math><br class='newline' /><!-- l. 245 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo><msub><mrow> <mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mover accent='true'><mrow><mi>s</mi></mrow><mo accent='true'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>m</mi></mrow><mrow><mn>2</mn></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mi mathvariant='normal'>Δ</mi><msub><mrow><mi>m</mi></mrow><mrow><mn>1</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>e</mi><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
                                                                                         
                                                                                         
   <br class='newline' /><!-- l. 246 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo><msub><mrow> <mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mover accent='true'><mrow><mi>s</mi></mrow><mo accent='true'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mi mathvariant='normal'>Δ</mi><msub><mrow><mi>m</mi></mrow><mrow><mn>1</mn></mrow></msub><msub><mrow><mi>m</mi></mrow><mrow><mn>2</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>m</mi></mrow><mrow><mn>2</mn></mrow></msub><mi>e</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
   <br class='newline' /><!-- l. 247 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>≈</mo><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mover accent='true'><mrow><mi>s</mi></mrow><mo accent='true'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mi mathvariant='normal'>Δ</mi><msub><mrow><mi>m</mi></mrow><mrow><mn>1</mn></mrow></msub><msub><mrow><mi>m</mi></mrow><mrow><mn>2</mn></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
   <span id='textcolor15'># given <!-- l. 247 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>e</mi></math>
   is small and thus <!-- l. 247 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>m</mi></mrow><mrow><mn>2</mn></mrow></msub><mi>e</mi></mrow></math>
   is also small</span></dd></dl>
   
   <h5 class='subsubsectionHead' id='discussion-on-the-noise-growth'><span class='titlemark'>D-1.6.1   </span> <a id='x1-28000D-1.6.1'></a>Discussion on the Noise Growth</h5>
<!-- l. 252 --><p class='noindent'>Note that after ciphertext-to-ciphertext multiplication, the noise grows to:
</p><!-- l. 254 --><p class='indent'>   <!-- l. 254 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 256 --><p class='indent'>   <!-- l. 256 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mover accent='true'><mrow><mi>s</mi></mrow><mo accent='true'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mi mathvariant='normal'>Δ</mi><msub><mrow><mi>m</mi></mrow><mrow><mn>1</mn></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msubsup><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖦𝖲𝖶</mtext></mstyle></mrow><mrow><mi>S</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow><mrow><mi>β</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>l</mi></mrow></msubsup><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>m</mi></mrow><mrow><mn>2</mn></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo><msub><mrow> <mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mover accent='true'><mrow><mi>s</mi></mrow><mo accent='true'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mi mathvariant='normal'>Δ</mi><msub><mrow><mi>m</mi></mrow><mrow><mn>1</mn></mrow></msub><msub><mrow><mi>m</mi></mrow><mrow><mn>2</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>m</mi></mrow><mrow><mn>2</mn></mrow></msub><mi>e</mi><mo class='MathClass-close' stretchy='false'>)</mo><mstyle class='text'><mtext> </mtext></mstyle><mo class='MathClass-open' stretchy='false'>(</mo><mo class='MathClass-rel' stretchy='false'>≈</mo><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mover accent='true'><mrow><mi>s</mi></mrow><mo accent='true'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mi mathvariant='normal'>Δ</mi><msub><mrow><mi>m</mi></mrow><mrow><mn>1</mn></mrow></msub><msub><mrow><mi>m</mi></mrow><mrow><mn>2</mn></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
</p><!-- l. 258 --><p class='indent'>   <!-- l. 258 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 260 --><p class='noindent'>To reduce the noise, noise bootstrapping is needed (will be discussed in <a href='#noise-bootstrapping'><span class='ts1-lmr10-x-x-109'>§</span>D-1.8<!-- tex4ht:ref: subsec:groupddef  --></a>).
   
</p>
   <h5 class='subsubsectionHead' id='generalization-to-glwetoggsw-multiplication'><span class='titlemark'>D-1.6.2   </span> <a id='x1-29000D-1.6.2'></a>Generalization to GLWE-to-GGSW Multiplication</h5>
<!-- l. 267 --><p class='noindent'>We can further generalize TFHE’s LWE-to-GSW multiplication to GLWE-to-GGSW multiplication between the following
two ciphertexts: <!-- l. 267 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖦𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mover accent='true'><mrow><mi>S</mi></mrow><mo accent='true'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mi mathvariant='normal'>Δ</mi><msub><mrow><mi>M</mi></mrow><mrow><mn>1</mn></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msubsup><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖦𝖦𝖲𝖶</mtext></mstyle></mrow><mrow><mover accent='true'><mrow><mi>S</mi></mrow><mo accent='true'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow><mrow><mi>β</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>l</mi></mrow></msubsup><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>M</mi></mrow><mrow><mn>2</mn></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>,
where <!-- l. 267 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>M</mi></mrow><mrow><mn>1</mn></mrow></msub></math>,
<!-- l. 267 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>M</mi></mrow><mrow><mn>2</mn></mrow></msub></math>, and
<!-- l. 267 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>S</mi></math> are
<!-- l. 267 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><mi>n</mi> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>-degree
polynomials.
</p><!-- l. 270 --><p class='indent'>   <!-- l. 270 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 272 --><p class='noindent'>The 1st term <!-- l. 272 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖦𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mover accent='true'><mrow><mi>S</mi></mrow><mo accent='true'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mi mathvariant='normal'>Δ</mi><msub><mrow><mi>M</mi></mrow><mrow><mn>1</mn></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
comes from one of the followings: </p>
   <ul class='itemize1'>
   <li class='itemize'>A fresh GLWE encryption (<span class='rm-lmbx-10x-x-109'>??</span>) of plaintext <!-- l. 274 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>M</mi></mrow><mrow><mn>1</mn></mrow></msub></math>.
   </li>
   <li class='itemize'>A homomorphically added result of two GLWE ciphertexts (<span class='rm-lmbx-10x-x-109'>??</span>).
   </li>
   <li class='itemize'>A homomorphically multiplied result of a GLWE ciphertext with a plaintext (<span class='rm-lmbx-10x-x-109'>??</span>).</li></ul>
<!-- l. 279 --><p class='indent'>   <!-- l. 279 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 281 --><p class='noindent'>The 2nd term <!-- l. 281 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msubsup><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖦𝖦𝖲𝖶</mtext></mstyle></mrow><mrow><mover accent='true'><mrow><mi>S</mi></mrow><mo accent='true'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow><mrow><mi>β</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>l</mi></mrow></msubsup><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>M</mi></mrow><mrow><mn>2</mn></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
comes from one of the followings: </p>
   <ul class='itemize1'>
   <li class='itemize'>A fresh GGSW encryption (<span class='rm-lmbx-10x-x-109'>??</span>) of plaintext <!-- l. 283 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>M</mi></mrow><mrow><mn>2</mn></mrow></msub></math>.
   </li>
   <li class='itemize'>Converted from <!-- l. 284 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖦𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mover accent='true'><mrow><mi>S</mi></mrow><mo accent='true'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mi mathvariant='normal'>Δ</mi><msub><mrow><mi>M</mi></mrow><mrow><mn>2</mn></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
   into <!-- l. 284 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msubsup><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖦𝖦𝖲𝖶</mtext></mstyle></mrow><mrow><mover accent='true'><mrow><mi>S</mi></mrow><mo accent='true'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow><mrow><mi>β</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>l</mi></mrow></msubsup><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>M</mi></mrow><mrow><mn>2</mn></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
   by <span class='rm-lmri-10x-x-109'>circuit bootstrapping </span>(this will be covered in the future).</li></ul>
<!-- l. 287 --><p class='indent'>   <!-- l. 287 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 289 --><p class='noindent'>Remember the followings:
</p><!-- l. 291 --><p class='indent'>   <!-- l. 291 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖦𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mover accent='true'><mrow><mi>S</mi></mrow><mo accent='true'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mi mathvariant='normal'>Δ</mi><msub><mrow><mi>M</mi></mrow><mrow><mn>1</mn></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>A</mi></mrow><mrow><mn>0</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>A</mi></mrow><mrow><mn>0</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><mstyle class='text'><mtext></mtext><mstyle class='math'><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace></mstyle><mtext></mtext></mstyle><mstyle class='text'><mtext> </mtext></mstyle><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>A</mi></mrow><mrow><mi>k</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><mi>B</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>∈</mo><msubsup><mrow><mstyle mathvariant='script'><mi>R</mi></mstyle></mrow><mrow><mi>n</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>q</mi></mrow><mrow><mi>k</mi><mo class='MathClass-bin' stretchy='false'>+</mo><mn>1</mn></mrow></msubsup></mrow></math>,
where <!-- l. 291 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>B</mi> <mo class='MathClass-rel' stretchy='false'>=</mo><munderover accent='false' accentunder='false'><mrow> <mi class='MathClass-op'>∑</mi><mo> ⁡<!-- FUNCTION APPLICATION --></mo>
  </mrow><mrow><mi>i</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>0</mn></mrow><mrow><mi>k</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></munderover><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>A</mi></mrow><mrow><mi>i</mi></mrow></msub> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msub><mrow><mi>S</mi></mrow><mrow><mi>i</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi mathvariant='normal'>Δ</mi><msub><mrow><mi>M</mi></mrow><mrow><mn>1</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>E</mi></mrow></math>
<br class='newline' /><span id='textcolor16'># from <span class='rm-lmbx-10x-x-109'>??</span></span>
</p><!-- l. 293 --><p class='indent'>   <!-- l. 293 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 295 --><p class='indent'>   <!-- l. 295 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msubsup><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖦𝖦𝖲𝖶</mtext></mstyle></mrow><mrow><mover accent='true'><mrow><mi>S</mi></mrow><mo accent='true'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow><mrow><mi>β</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>l</mi></mrow></msubsup><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>M</mi></mrow><mrow><mn>2</mn></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-close' fence='true' mathsize='1.61em'>{</mo><msubsup><mrow><mo class='MathClass-open' stretchy='false'>{</mo><msubsup><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖦𝖫𝖾𝗏</mtext></mstyle></mrow><mrow><mover accent='true'><mrow><mi>S</mi></mrow><mo accent='true'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow><mrow><mi>β</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>l</mi></mrow></msubsup><mo class='MathClass-open' stretchy='false'>(</mo><mo class='MathClass-bin' stretchy='false'>−</mo><msub><mrow><mi>S</mi></mrow><mrow><mi>i</mi></mrow></msub> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msub><mrow><mi>M</mi></mrow><mrow><mn>2</mn></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-close' stretchy='false'>}</mo></mrow><mrow><mi>i</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>0</mn></mrow><mrow><mi>k</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msubsup><mo class='MathClass-punc' stretchy='false'>,</mo><msubsup><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖦𝖫𝖾𝗏</mtext></mstyle></mrow><mrow><mover accent='true'><mrow><mi>S</mi></mrow><mo accent='true'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow><mrow><mi>β</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>l</mi></mrow></msubsup><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>M</mi></mrow><mrow><mn>2</mn></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo><mrow><mo class='MathClass-open' fence='true' mathsize='1.61em'>}</mo><mrow><mo class='MathClass-rel' stretchy='false'>∈</mo><msubsup><mrow><mstyle mathvariant='script'><mi>R</mi></mstyle></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mi>n</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>q</mi><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow><mrow><mo class='MathClass-open' stretchy='false'>(</mo><mi>k</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-bin' stretchy='false'>⋅</mo><mi>l</mi><mo class='MathClass-bin' stretchy='false'>⋅</mo><mo class='MathClass-open' stretchy='false'>(</mo><mi>k</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msubsup></mrow> <span id='textcolor17'>#
from <span class='rm-lmbx-10x-x-109'>??</span></span>
</mrow></mrow></math></p><!-- l. 297 --><p class='indent'>   <!-- l. 297 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 299 --><p class='noindent'>Let’s use the following notations:
</p><!-- l. 301 --><p class='indent'>   <!-- l. 301 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msubsup><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖦𝖦𝖲𝖶</mtext></mstyle></mrow><mrow><mover accent='true'><mrow><mi>S</mi></mrow><mo accent='true'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow><mrow><mi>β</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>l</mi></mrow></msubsup><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>M</mi></mrow><mrow><mn>2</mn></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo> <mover accent='true'><mrow><mi>C</mi></mrow><mo accent='true'>¯</mo></mover> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>(</mo><mover accent='true'><mrow><msub><mrow><mi>C</mi></mrow><mrow><mn>0</mn></mrow></msub></mrow><mo accent='true'>¯</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-punc' stretchy='false'>.</mo><mover accent='true'><mrow><msub><mrow><mi>C</mi></mrow><mrow><mn>1</mn></mrow></msub></mrow><mo accent='true'>¯</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><mstyle class='text'><mtext></mtext><mstyle class='math'><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace></mstyle><mtext></mtext></mstyle><mstyle class='text'><mtext> </mtext></mstyle><mover accent='true'><mrow><msub><mrow><mi>C</mi></mrow><mrow><mi>k</mi></mrow></msub></mrow><mo accent='true'>¯</mo></mover><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
</p><!-- l. 303 --><p class='indent'>   <!-- l. 303 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mover accent='true'><mrow><msub><mrow><mi>C</mi></mrow><mrow><mi>i</mi></mrow></msub></mrow><mo accent='true'>¯</mo></mover> <mo class='MathClass-rel' stretchy='false'>=</mo><msubsup><mrow> <mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖦𝖫𝖾𝗏</mtext></mstyle></mrow><mrow><mover accent='true'><mrow><mi>S</mi></mrow><mo accent='true'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow><mrow><mi>β</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>l</mi></mrow></msubsup><mo class='MathClass-open' stretchy='false'>(</mo><mo class='MathClass-bin' stretchy='false'>−</mo><msub><mrow><mi>S</mi></mrow><mrow><mi>i</mi></mrow></msub> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msub><mrow><mi>M</mi></mrow><mrow><mn>2</mn></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math> for
<!-- l. 303 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mn>0</mn> <mo class='MathClass-rel' stretchy='false'>≤</mo><mi>i</mi> <mo class='MathClass-rel' stretchy='false'>≤</mo><mo class='MathClass-open' stretchy='false'>(</mo><mi>k</mi> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
</p><!-- l. 305 --><p class='indent'>   <!-- l. 305 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mover accent='true'><mrow><msub><mrow><mi>C</mi></mrow><mrow><mi>k</mi></mrow></msub></mrow><mo accent='true'>¯</mo></mover> <mo class='MathClass-rel' stretchy='false'>=</mo><msubsup><mrow> <mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖦𝖫𝖾𝗏</mtext></mstyle></mrow><mrow><mover accent='true'><mrow><mi>S</mi></mrow><mo accent='true'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow><mrow><mi>β</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>l</mi></mrow></msubsup><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>M</mi></mrow><mrow><mn>2</mn></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
</p><!-- l. 307 --><p class='indent'>   <!-- l. 307 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖼𝗍</mtext></mstyle> <mo class='MathClass-rel' stretchy='false'>=</mo><msub><mrow> <mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖦𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mover accent='true'><mrow><mi>S</mi></mrow><mo accent='true'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mi mathvariant='normal'>Δ</mi><msub><mrow><mi>M</mi></mrow><mrow><mn>1</mn></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>C</mi></mrow><mrow><mn>0</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>C</mi></mrow><mrow><mn>1</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><mstyle class='text'><mtext></mtext><mstyle class='math'><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace></mstyle><mtext></mtext></mstyle><mstyle class='text'><mtext> </mtext></mstyle><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>C</mi></mrow><mrow><mi>k</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>A</mi></mrow><mrow><mn>0</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>A</mi></mrow><mrow><mn>1</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><mstyle class='text'><mtext></mtext><mstyle class='math'><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace></mstyle><mtext></mtext></mstyle><mstyle class='text'><mtext> </mtext></mstyle><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>A</mi></mrow><mrow><mi>k</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><mi>B</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
</p><!-- l. 309 --><p class='indent'>   <!-- l. 309 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 311 --><p class='noindent'>Let’s define the following TFHE ciphertext multiplication operation:
</p><!-- l. 313 --><p class='indent'>   <!-- l. 313 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖼𝗍</mtext></mstyle> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mover accent='true'><mrow><mi>C</mi></mrow><mo accent='true'>¯</mo></mover> <mo class='MathClass-rel' stretchy='false'>=</mo><munderover accent='false' accentunder='false'><mrow> <mi class='MathClass-op'>∑</mi><mo> ⁡<!-- FUNCTION APPLICATION --></mo>
  </mrow><mrow><mi>i</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>0</mn></mrow><mrow><mi>k</mi></mrow></munderover><mo class='MathClass-open' stretchy='false'>⟨</mo><msup><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖣𝖾𝖼𝗈𝗆𝗉</mtext></mstyle></mrow><mrow><mi>β</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>l</mi></mrow></msup><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>C</mi></mrow><mrow><mi>i</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-punc' stretchy='false'>,</mo><mover accent='true'><mrow><msub><mrow><mi>C</mi></mrow><mrow><mi>i</mi></mrow></msub></mrow><mo accent='true'>¯</mo></mover><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></math>
</p><!-- l. 315 --><p class='indent'>   <!-- l. 315 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 317 --><p class='noindent'>Then, the following is true:
</p>
   <div class='tcolorbox tcolorbox' id='tcolobox-19'>     
<div class='tcolorbox-title'>
<!-- l. 329 --><p class='indent'>   <!-- l. 329 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mstyle mathvariant='bold'><mo class='MathClass-open' stretchy='false'>⟨</mo></mstyle></math><span class='rm-lmbx-10x-x-109'>Summary </span><a href='#generalization-to-glwetoggsw-multiplication'><span class='rm-lmbx-10x-x-109'>D-1.6.2</span><!-- tex4ht:ref: subsubsec:tfhegglwettogggswmmultiplication  --></a><!-- l. 329 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mstyle mathvariant='bold'><mo class='MathClass-close' stretchy='false'>⟩</mo></mstyle></math>
<span class='rm-lmbx-10x-x-109'>Generalization  to  GLWE-to-GGSW
Multiplication</span></p></div> 
<div class='tcolorbox-content'><!-- l. 320 --><p class='noindent'><!-- l. 320 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖼𝗍</mtext></mstyle> <mo class='MathClass-rel' stretchy='false'>=</mo><msub><mrow> <mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖦𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mover accent='true'><mrow><mi>S</mi></mrow><mo accent='true'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mi mathvariant='normal'>Δ</mi><msub><mrow><mi>M</mi></mrow><mrow><mn>1</mn></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>A</mi></mrow><mrow><mn>0</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>A</mi></mrow><mrow><mn>1</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>A</mi></mrow><mrow><mi>k</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><mi>B</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
</p><!-- l. 322 --><p class='noindent'><!-- l. 322 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mover accent='true'><mrow><mi>C</mi></mrow><mo accent='true'>¯</mo></mover> <mo class='MathClass-rel' stretchy='false'>=</mo><msubsup><mrow> <mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖦𝖦𝖲𝖶</mtext></mstyle></mrow><mrow><mover accent='true'><mrow><mi>S</mi></mrow><mo accent='true'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow><mrow><mi>β</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>l</mi></mrow></msubsup><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>M</mi></mrow><mrow><mn>2</mn></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
</p><!-- l. 324 --><p class='noindent'><!-- l. 324 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo> <mstyle mathvariant='bold'><mo class='MathClass-open' stretchy='false'>(</mo></mstyle><msubsup><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖦𝖫𝖾𝗏</mtext></mstyle></mrow><mrow><mover accent='true'><mrow><mi>S</mi></mrow><mo accent='true'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow><mrow><mi>β</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>l</mi></mrow></msubsup><mo class='MathClass-open' stretchy='false'>(</mo><mo class='MathClass-bin' stretchy='false'>−</mo><msub><mrow><mi>S</mi></mrow><mrow><mn>0</mn></mrow></msub><mo class='MathClass-bin' stretchy='false'>⋅</mo><msub><mrow><mi>M</mi></mrow><mrow><mn>2</mn></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-punc' stretchy='false'>,</mo><msubsup><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖦𝖫𝖾𝗏</mtext></mstyle></mrow><mrow><mover accent='true'><mrow><mi>S</mi></mrow><mo accent='true'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow><mrow><mi>β</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>l</mi></mrow></msubsup><mo class='MathClass-open' stretchy='false'>(</mo><mo class='MathClass-bin' stretchy='false'>−</mo><msub><mrow><mi>S</mi></mrow><mrow><mn>1</mn></mrow></msub><mo class='MathClass-bin' stretchy='false'>⋅</mo><msub><mrow><mi>M</mi></mrow><mrow><mn>2</mn></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace><mo class='MathClass-punc' stretchy='false'>,</mo><msubsup><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖦𝖫𝖾𝗏</mtext></mstyle></mrow><mrow><mover accent='true'><mrow><mi>S</mi></mrow><mo accent='true'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow><mrow><mi>β</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>l</mi></mrow></msubsup><mo class='MathClass-open' stretchy='false'>(</mo><mo class='MathClass-bin' stretchy='false'>−</mo><msub><mrow><mi>S</mi></mrow><mrow><mi>k</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub><mo class='MathClass-bin' stretchy='false'>⋅</mo><msub><mrow><mi>M</mi></mrow><mrow><mn>2</mn></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-punc' stretchy='false'>,</mo><msubsup><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖦𝖫𝖾𝗏</mtext></mstyle></mrow><mrow><mover accent='true'><mrow><mi>S</mi></mrow><mo accent='true'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow><mrow><mi>β</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>l</mi></mrow></msubsup><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>M</mi></mrow><mrow><mn>2</mn></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo><mstyle mathvariant='bold'><mo class='MathClass-close' stretchy='false'>)</mo></mstyle></mrow></math>
</p><!-- l. 326 --><p class='noindent'><!-- l. 326 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 328 --><p class='noindent'><!-- l. 328 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖦𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mover accent='true'><mrow><mi>S</mi></mrow><mo accent='true'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mi mathvariant='normal'>Δ</mi><msub><mrow><mi>M</mi></mrow><mrow><mn>1</mn></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msubsup><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖦𝖦𝖲𝖶</mtext></mstyle></mrow><mrow><mover accent='true'><mrow><mi>S</mi></mrow><mo accent='true'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow><mrow><mi>β</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>l</mi></mrow></msubsup><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>M</mi></mrow><mrow><mn>2</mn></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo><munderover accent='false' accentunder='false'><mrow> <mi class='MathClass-op'>∑</mi><mo> ⁡<!-- FUNCTION APPLICATION --></mo>
  </mrow><mrow><mi>i</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>0</mn></mrow><mrow><mi>k</mi></mrow></munderover><mo class='MathClass-open' stretchy='false'>⟨</mo><msup><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖣𝖾𝖼𝗈𝗆𝗉</mtext></mstyle></mrow><mrow><mi>β</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>l</mi></mrow></msup><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>C</mi></mrow><mrow><mi>i</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-punc' stretchy='false'>,</mo><mover accent='true'><mrow><msub><mrow><mi>C</mi></mrow><mrow><mi>i</mi></mrow></msub></mrow><mo accent='true'>¯</mo></mover><mo class='MathClass-close' stretchy='false'>⟩</mo><mo class='MathClass-rel' stretchy='false'>=</mo><msub><mrow> <mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖦𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mover accent='true'><mrow><mi>S</mi></mrow><mo accent='true'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mi mathvariant='normal'>Δ</mi><msub><mrow><mi>M</mi></mrow><mrow><mn>1</mn></mrow></msub><msub><mrow><mi>M</mi></mrow><mrow><mn>2</mn></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
</p> 
</div> 
</div>
<!-- l. 331 --><p class='indent'>   This means that multiplying two TFHE ciphertexts (one is in GLWE and another in GGSW) and
decrypting the resulting GLWE ciphertext gives the same result as multiplying their two original
plaintexts.
</p><!-- l. 333 --><p class='indent'>   <!-- l. 333 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 335 --><p class='indent'>   <span class='underline'><span class='rm-lmbx-10x-x-109'>Proof</span></span>
   </p><dl class='enumerate-enumitem'><dt class='enumerate-enumitem'>
1. </dt><dd class='enumerate-enumitem'><!-- l. 337 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><munderover accent='false' accentunder='false'><mrow><mi class='MathClass-op'>∑</mi><mo> ⁡<!-- FUNCTION APPLICATION --></mo>
  </mrow><mrow><mi>i</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>0</mn></mrow><mrow><mi>k</mi></mrow></munderover><mo class='MathClass-open' stretchy='false'>⟨</mo><msup><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖣𝖾𝖼𝗈𝗆𝗉</mtext></mstyle></mrow><mrow><mi>β</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>l</mi></mrow></msup><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>C</mi></mrow><mrow><mi>i</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-punc' stretchy='false'>,</mo><mover accent='true'><mrow><msub><mrow><mi>C</mi></mrow><mrow><mi>i</mi></mrow></msub></mrow><mo accent='true'>¯</mo></mover><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></math>
   <br class='newline' /><!-- l. 338 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>⟨</mo><msup><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖣𝖾𝖼𝗈𝗆𝗉</mtext></mstyle></mrow><mrow><mi>β</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>l</mi></mrow></msup><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>A</mi></mrow><mrow><mn>0</mn></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-punc' stretchy='false'>,</mo><mover accent='true'><mrow><msub><mrow><mi>C</mi></mrow><mrow><mn>0</mn></mrow></msub></mrow><mo accent='true'>¯</mo></mover><mo class='MathClass-close' stretchy='false'>⟩</mo><mo class='MathClass-bin' stretchy='false'>+</mo><mo class='MathClass-open' stretchy='false'>⟨</mo><msup><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖣𝖾𝖼𝗈𝗆𝗉</mtext></mstyle></mrow><mrow><mi>β</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>l</mi></mrow></msup><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>A</mi></mrow><mrow><mn>1</mn></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-punc' stretchy='false'>,</mo><mover accent='true'><mrow><msub><mrow><mi>C</mi></mrow><mrow><mn>1</mn></mrow></msub></mrow><mo accent='true'>¯</mo></mover><mo class='MathClass-close' stretchy='false'>⟩</mo><mo class='MathClass-bin' stretchy='false'>+</mo><mstyle class='text'><mtext> </mtext></mstyle><mstyle class='text'><mtext></mtext><mstyle class='math'><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace></mstyle><mtext></mtext></mstyle><mstyle class='text'><mtext> </mtext></mstyle><mo class='MathClass-bin' stretchy='false'>+</mo><mo class='MathClass-open' stretchy='false'>⟨</mo><msup><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖣𝖾𝖼𝗈𝗆𝗉</mtext></mstyle></mrow><mrow><mi>β</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>l</mi></mrow></msup><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>A</mi></mrow><mrow><mi>k</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mover accent='true'><mrow><mi>C</mi></mrow><mo accent='true'>¯</mo></mover></mrow><mrow><mi>k</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub><mo class='MathClass-close' stretchy='false'>⟩</mo><mo class='MathClass-bin' stretchy='false'>+</mo><mo class='MathClass-open' stretchy='false'>⟨</mo><msup><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖣𝖾𝖼𝗈𝗆𝗉</mtext></mstyle></mrow><mrow><mi>β</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>l</mi></mrow></msup><mo class='MathClass-open' stretchy='false'>(</mo><mi>B</mi><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-punc' stretchy='false'>,</mo><mover accent='true'><mrow><msub><mrow><mi>C</mi></mrow><mrow><mi>k</mi></mrow></msub></mrow><mo accent='true'>¯</mo></mover><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></math>
                                                                                         
                                                                                         
   <br class='newline' /><span id='textcolor18'># expanding the dot product of two vectors</span>
   </dd><dt class='enumerate-enumitem'>
2. </dt><dd class='enumerate-enumitem'>For <!-- l. 340 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>i</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mi>k</mi></mrow></math>:
   <br class='newline' /><!-- l. 341 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖣𝖾𝖼𝗈𝗆𝗉</mtext></mstyle></mrow><mrow><mi>β</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>l</mi></mrow></msup><mo class='MathClass-open' stretchy='false'>(</mo><mi>B</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>B</mi></mrow><mrow><mn>1</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>B</mi></mrow><mrow><mn>2</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><mstyle class='text'><mtext></mtext><mstyle class='math'><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace></mstyle><mtext></mtext></mstyle><mstyle class='text'><mtext> </mtext></mstyle><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>B</mi></mrow><mrow><mi>l</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>,
   where <!-- l. 341 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>B</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mi>B</mi></mrow><mrow><mn>1</mn></mrow></msub><mstyle displaystyle='true'><mfrac><mrow>  <mi>q</mi>
</mrow><mrow><msup><mrow><mi>β</mi></mrow><mrow><mn>1</mn></mrow></msup></mrow></mfrac></mstyle> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>B</mi></mrow><mrow><mn>2</mn></mrow></msub><mstyle displaystyle='true'><mfrac><mrow>  <mi>q</mi>
</mrow><mrow><msup><mrow><mi>β</mi></mrow><mrow><mn>2</mn></mrow></msup></mrow></mfrac></mstyle> <mo class='MathClass-bin' stretchy='false'>+</mo> <mstyle class='text'><mtext> </mtext></mstyle><mstyle class='text'><mtext></mtext><mstyle class='math'><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace></mstyle><mtext></mtext></mstyle><mstyle class='text'><mtext> </mtext></mstyle> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>B</mi></mrow><mrow><mi>l</mi></mrow></msub><mstyle displaystyle='true'><mfrac><mrow> <mi>q</mi>
</mrow><mrow><msup><mrow><mi>β</mi></mrow><mrow><mi>l</mi></mrow></msup></mrow></mfrac></mstyle></mrow></math>
   <span id='textcolor19'># from <span class='rm-lmbx-10x-x-109'>??</span></span><br class='newline' /><!-- l. 342 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mover accent='true'><mrow><mi>C</mi></mrow><mo accent='true'>¯</mo></mover></mrow><mrow><mi>k</mi></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo><msubsup><mrow> <mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖦𝖫𝖾𝗏</mtext></mstyle></mrow><mrow><mover accent='true'><mrow><mi>S</mi></mrow><mo accent='true'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow><mrow><mi>β</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>l</mi></mrow></msubsup><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>M</mi></mrow><mrow><mn>2</mn></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo> <mrow><mo fence='true' form='prefix'>(</mo><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖦𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mover accent='true'><mrow><mi>S</mi></mrow><mo accent='true'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub> <mrow><mo fence='true' form='prefix'>(</mo><mrow><msub><mrow><mi>M</mi></mrow><mrow><mn>2</mn></mrow></msub><mstyle displaystyle='true'><mfrac><mrow>  <mi>q</mi>
</mrow><mrow><msup><mrow><mi>β</mi></mrow><mrow><mn>1</mn></mrow></msup></mrow></mfrac></mstyle></mrow><mo fence='true' form='postfix'>)</mo></mrow> <mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖦𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mover accent='true'><mrow><mi>S</mi></mrow><mo accent='true'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub> <mrow><mo fence='true' form='prefix'>(</mo><mrow><msub><mrow><mi>M</mi></mrow><mrow><mn>2</mn></mrow></msub><mstyle displaystyle='true'><mfrac><mrow>  <mi>q</mi>
</mrow><mrow><msup><mrow><mi>β</mi></mrow><mrow><mn>2</mn></mrow></msup></mrow></mfrac></mstyle></mrow><mo fence='true' form='postfix'>)</mo></mrow> <mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><mstyle class='text'><mtext></mtext><mstyle class='math'><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace></mstyle><mtext></mtext></mstyle><mstyle class='text'><mtext> </mtext></mstyle><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖦𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mover accent='true'><mrow><mi>S</mi></mrow><mo accent='true'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub> <mrow><mo fence='true' form='prefix'>(</mo><mrow><msub><mrow><mi>M</mi></mrow><mrow><mn>2</mn></mrow></msub><mstyle displaystyle='true'><mfrac><mrow> <mi>q</mi>
</mrow><mrow><msup><mrow><mi>β</mi></mrow><mrow><mi>l</mi></mrow></msup></mrow></mfrac></mstyle></mrow><mo fence='true' form='postfix'>)</mo></mrow></mrow><mo fence='true' form='postfix'>)</mo></mrow></mrow></math>
   <br class='newline' /><!-- l. 343 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
   <!-- l. 345 --><p class='noindent'>Therefore: <br class='newline' /><!-- l. 346 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><msup><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖣𝖾𝖼𝗈𝗆𝗉</mtext></mstyle></mrow><mrow><mi>β</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>l</mi></mrow></msup><mo class='MathClass-open' stretchy='false'>(</mo><mi>B</mi><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-punc' stretchy='false'>,</mo><mover accent='true'><mrow><msub><mrow><mi>C</mi></mrow><mrow><mi>k</mi></mrow></msub></mrow><mo accent='true'>¯</mo></mover><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></math><br class='newline' /><!-- l. 347 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mi>B</mi></mrow><mrow><mn>1</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖦𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mover accent='true'><mrow><mi>S</mi></mrow><mo accent='true'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub> <mrow><mo fence='true' form='prefix'>(</mo><mrow><msub><mrow><mi>M</mi></mrow><mrow><mn>2</mn></mrow></msub><mstyle displaystyle='true'><mfrac><mrow>  <mi>q</mi>
</mrow><mrow><msup><mrow><mi>β</mi></mrow><mrow><mn>1</mn></mrow></msup></mrow></mfrac></mstyle></mrow><mo fence='true' form='postfix'>)</mo></mrow> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>B</mi></mrow><mrow><mn>2</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖦𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mover accent='true'><mrow><mi>S</mi></mrow><mo accent='true'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub> <mrow><mo fence='true' form='prefix'>(</mo><mrow><msub><mrow><mi>M</mi></mrow><mrow><mn>2</mn></mrow></msub><mstyle displaystyle='true'><mfrac><mrow>  <mi>q</mi>
</mrow><mrow><msup><mrow><mi>β</mi></mrow><mrow><mn>2</mn></mrow></msup></mrow></mfrac></mstyle></mrow><mo fence='true' form='postfix'>)</mo></mrow> <mo class='MathClass-bin' stretchy='false'>+</mo> <mstyle class='text'><mtext> </mtext></mstyle><mstyle class='text'><mtext></mtext><mstyle class='math'><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace></mstyle><mtext></mtext></mstyle><mstyle class='text'><mtext> </mtext></mstyle> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>B</mi></mrow><mrow><mi>l</mi></mrow></msub> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖦𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mover accent='true'><mrow><mi>S</mi></mrow><mo accent='true'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub> <mrow><mo fence='true' form='prefix'>(</mo><mrow><msub><mrow><mi>M</mi></mrow><mrow><mn>2</mn></mrow></msub><mstyle displaystyle='true'><mfrac><mrow> <mi>q</mi>
</mrow><mrow><msup><mrow><mi>β</mi></mrow><mrow><mi>l</mi></mrow></msup></mrow></mfrac></mstyle></mrow><mo fence='true' form='postfix'>)</mo></mrow></mrow></math>
   <br class='newline' /><!-- l. 348 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo><msub><mrow> <mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖦𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mover accent='true'><mrow><mi>S</mi></mrow><mo accent='true'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub> <mrow><mo fence='true' form='prefix'>(</mo><mrow><msub><mrow><mi>B</mi></mrow><mrow><mn>1</mn></mrow></msub><msub><mrow><mi>M</mi></mrow><mrow><mn>2</mn></mrow></msub><mstyle displaystyle='true'><mfrac><mrow>  <mi>q</mi>
</mrow><mrow><msup><mrow><mi>β</mi></mrow><mrow><mn>1</mn></mrow></msup></mrow></mfrac></mstyle></mrow><mo fence='true' form='postfix'>)</mo></mrow> <mo class='MathClass-bin' stretchy='false'>+</mo><msub><mrow> <mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖦𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mover accent='true'><mrow><mi>S</mi></mrow><mo accent='true'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub> <mrow><mo fence='true' form='prefix'>(</mo><mrow><msub><mrow><mi>B</mi></mrow><mrow><mn>2</mn></mrow></msub><msub><mrow><mi>M</mi></mrow><mrow><mn>2</mn></mrow></msub><mstyle displaystyle='true'><mfrac><mrow>  <mi>q</mi>
</mrow><mrow><msup><mrow><mi>β</mi></mrow><mrow><mn>2</mn></mrow></msup></mrow></mfrac></mstyle></mrow><mo fence='true' form='postfix'>)</mo></mrow> <mo class='MathClass-bin' stretchy='false'>+</mo> <mstyle class='text'><mtext> </mtext></mstyle><mstyle class='text'><mtext></mtext><mstyle class='math'><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace></mstyle><mtext></mtext></mstyle><mstyle class='text'><mtext> </mtext></mstyle> <mo class='MathClass-bin' stretchy='false'>+</mo><msub><mrow> <mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖦𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mover accent='true'><mrow><mi>S</mi></mrow><mo accent='true'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub> <mrow><mo fence='true' form='prefix'>(</mo><mrow><msub><mrow><mi>B</mi></mrow><mrow><mi>l</mi></mrow></msub><msub><mrow><mi>M</mi></mrow><mrow><mn>2</mn></mrow></msub><mstyle displaystyle='true'><mfrac><mrow> <mi>q</mi>
</mrow><mrow><msup><mrow><mi>β</mi></mrow><mrow><mi>l</mi></mrow></msup></mrow></mfrac></mstyle></mrow><mo fence='true' form='postfix'>)</mo></mrow></mrow></math>
   <span id='textcolor20'># from <span class='rm-lmbx-10x-x-109'>??</span></span> <br class='newline' /><!-- l. 349 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo><msub><mrow> <mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖦𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mover accent='true'><mrow><mi>S</mi></mrow><mo accent='true'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub> <mrow><mo fence='true' form='prefix'>(</mo><mrow><msub><mrow><mi>B</mi></mrow><mrow><mn>1</mn></mrow></msub><msub><mrow><mi>M</mi></mrow><mrow><mn>2</mn></mrow></msub><mstyle displaystyle='true'><mfrac><mrow>  <mi>q</mi>
</mrow><mrow><msup><mrow><mi>β</mi></mrow><mrow><mn>1</mn></mrow></msup></mrow></mfrac></mstyle> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>B</mi></mrow><mrow><mn>2</mn></mrow></msub><msub><mrow><mi>M</mi></mrow><mrow><mn>2</mn></mrow></msub><mstyle displaystyle='true'><mfrac><mrow>  <mi>q</mi>
</mrow><mrow><msup><mrow><mi>β</mi></mrow><mrow><mn>2</mn></mrow></msup></mrow></mfrac></mstyle> <mo class='MathClass-bin' stretchy='false'>+</mo> <mstyle class='text'><mtext> </mtext></mstyle><mstyle class='text'><mtext></mtext><mstyle class='math'><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace></mstyle><mtext></mtext></mstyle><mstyle class='text'><mtext> </mtext></mstyle> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>B</mi></mrow><mrow><mi>l</mi></mrow></msub><msub><mrow><mi>M</mi></mrow><mrow><mn>2</mn></mrow></msub><mstyle displaystyle='true'><mfrac><mrow> <mi>q</mi>
</mrow><mrow><msup><mrow><mi>β</mi></mrow><mrow><mi>l</mi></mrow></msup></mrow></mfrac></mstyle></mrow><mo fence='true' form='postfix'>)</mo></mrow></mrow></math>
   <span id='textcolor21'># from <span class='rm-lmbx-10x-x-109'>??</span></span><br class='newline' /><!-- l. 350 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo><msub><mrow> <mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖦𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mover accent='true'><mrow><mi>S</mi></mrow><mo accent='true'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub> <mrow><mo fence='true' form='prefix'>(</mo><mrow><msub><mrow><mi>M</mi></mrow><mrow><mn>2</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>⋅</mo> <mrow><mo fence='true' form='prefix'>(</mo><mrow><msub><mrow><mi>B</mi></mrow><mrow><mn>1</mn></mrow></msub><mstyle displaystyle='true'><mfrac><mrow>  <mi>q</mi>
</mrow><mrow><msup><mrow><mi>β</mi></mrow><mrow><mn>1</mn></mrow></msup></mrow></mfrac></mstyle> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>B</mi></mrow><mrow><mn>2</mn></mrow></msub><mstyle displaystyle='true'><mfrac><mrow>  <mi>q</mi>
</mrow><mrow><msup><mrow><mi>β</mi></mrow><mrow><mn>2</mn></mrow></msup></mrow></mfrac></mstyle> <mo class='MathClass-bin' stretchy='false'>+</mo> <mstyle class='text'><mtext> </mtext></mstyle><mstyle class='text'><mtext></mtext><mstyle class='math'><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace></mstyle><mtext></mtext></mstyle><mstyle class='text'><mtext> </mtext></mstyle> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>B</mi></mrow><mrow><mi>l</mi></mrow></msub><mstyle displaystyle='true'><mfrac><mrow> <mi>q</mi>
</mrow><mrow><msup><mrow><mi>β</mi></mrow><mrow><mi>l</mi></mrow></msup></mrow></mfrac></mstyle></mrow><mo fence='true' form='postfix'>)</mo></mrow></mrow><mo fence='true' form='postfix'>)</mo></mrow></mrow></math>
   <br class='newline' /><!-- l. 351 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo><msub><mrow> <mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖦𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mover accent='true'><mrow><mi>S</mi></mrow><mo accent='true'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>M</mi></mrow><mrow><mn>2</mn></mrow></msub><mi>B</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
   <span id='textcolor22'># from <span class='rm-lmbx-10x-x-109'>??</span></span>
   </p></dd><dt class='enumerate-enumitem'>
3. </dt><dd class='enumerate-enumitem'>For <!-- l. 352 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mn>0</mn> <mo class='MathClass-rel' stretchy='false'>≤</mo><mi>i</mi> <mo class='MathClass-rel' stretchy='false'>≤</mo><mo class='MathClass-open' stretchy='false'>(</mo><mi>k</mi> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>:
   <br class='newline' /><!-- l. 353 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖣𝖾𝖼𝗈𝗆𝗉</mtext></mstyle></mrow><mrow><mi>β</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>l</mi></mrow></msup><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>A</mi></mrow><mrow><mi>i</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>A</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mi>i</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mn>0</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>A</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mi>i</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><mstyle class='text'><mtext></mtext><mstyle class='math'><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace></mstyle><mtext></mtext></mstyle><mstyle class='text'><mtext> </mtext></mstyle><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>A</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mi>i</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>l</mi><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>,
   where <!-- l. 353 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>A</mi></mrow><mrow><mi>i</mi></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mi>A</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mi>i</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mn>0</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msub><mstyle displaystyle='true'><mfrac><mrow> <mi>q</mi>
</mrow><mrow><msup><mrow><mi>β</mi></mrow><mrow><mn>1</mn></mrow></msup></mrow></mfrac></mstyle> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>A</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mi>i</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msub><mstyle displaystyle='true'><mfrac><mrow> <mi>q</mi>
</mrow><mrow><msup><mrow><mi>β</mi></mrow><mrow><mn>2</mn></mrow></msup></mrow></mfrac></mstyle> <mo class='MathClass-bin' stretchy='false'>+</mo> <mstyle class='text'><mtext> </mtext></mstyle><mstyle class='text'><mtext></mtext><mstyle class='math'><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace></mstyle><mtext></mtext></mstyle><mstyle class='text'><mtext> </mtext></mstyle> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>A</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mi>i</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>l</mi><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msub><mstyle displaystyle='true'><mfrac><mrow> <mi>q</mi>
</mrow><mrow><msup><mrow><mi>β</mi></mrow><mrow><mi>l</mi></mrow></msup></mrow></mfrac></mstyle></mrow></math>
   <br class='newline' /><!-- l. 354 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mover accent='true'><mrow><msub><mrow><mi>C</mi></mrow><mrow><mi>i</mi></mrow></msub></mrow><mo accent='true'>¯</mo></mover> <mo class='MathClass-rel' stretchy='false'>=</mo><msubsup><mrow> <mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖦𝖫𝖾𝗏</mtext></mstyle></mrow><mrow><mover accent='true'><mrow><mi>S</mi></mrow><mo accent='true'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow><mrow><mi>β</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>l</mi></mrow></msubsup><mo class='MathClass-open' stretchy='false'>(</mo><mo class='MathClass-bin' stretchy='false'>−</mo><msub><mrow><mi>S</mi></mrow><mrow><mi>i</mi></mrow></msub><msub><mrow><mi>M</mi></mrow><mrow><mn>2</mn></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo> <mrow><mo fence='true' form='prefix'>(</mo><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖦𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mover accent='true'><mrow><mi>S</mi></mrow><mo accent='true'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub> <mrow><mo fence='true' form='prefix'>(</mo><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><msub><mrow><mi>S</mi></mrow><mrow><mi>i</mi></mrow></msub><msub><mrow><mi>M</mi></mrow><mrow><mn>2</mn></mrow></msub><mstyle displaystyle='true'><mfrac><mrow>  <mi>q</mi>
</mrow><mrow><msup><mrow><mi>β</mi></mrow><mrow><mn>1</mn></mrow></msup></mrow></mfrac></mstyle></mrow><mo fence='true' form='postfix'>)</mo></mrow> <mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖦𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mover accent='true'><mrow><mi>S</mi></mrow><mo accent='true'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub> <mrow><mo fence='true' form='prefix'>(</mo><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><msub><mrow><mi>S</mi></mrow><mrow><mi>i</mi></mrow></msub><msub><mrow><mi>M</mi></mrow><mrow><mn>2</mn></mrow></msub><mstyle displaystyle='true'><mfrac><mrow>  <mi>q</mi>
</mrow><mrow><msup><mrow><mi>β</mi></mrow><mrow><mn>2</mn></mrow></msup></mrow></mfrac></mstyle></mrow><mo fence='true' form='postfix'>)</mo></mrow> <mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><mstyle class='text'><mtext></mtext><mstyle class='math'><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace></mstyle><mtext></mtext></mstyle><mstyle class='text'><mtext> </mtext></mstyle><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖦𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mover accent='true'><mrow><mi>S</mi></mrow><mo accent='true'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub> <mrow><mo fence='true' form='prefix'>(</mo><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><msub><mrow><mi>S</mi></mrow><mrow><mi>i</mi></mrow></msub><msub><mrow><mi>M</mi></mrow><mrow><mn>2</mn></mrow></msub><mstyle displaystyle='true'><mfrac><mrow> <mi>q</mi>
</mrow><mrow><msup><mrow><mi>β</mi></mrow><mrow><mi>l</mi></mrow></msup></mrow></mfrac></mstyle></mrow><mo fence='true' form='postfix'>)</mo></mrow></mrow><mo fence='true' form='postfix'>)</mo></mrow></mrow></math>
   <br class='newline' />
   <!-- l. 356 --><p class='noindent'><!-- l. 356 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
   Therefore: <br class='newline' /><!-- l. 358 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><msup><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖣𝖾𝖼𝗈𝗆𝗉</mtext></mstyle></mrow><mrow><mi>β</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>l</mi></mrow></msup><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>A</mi></mrow><mrow><mn>0</mn></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-punc' stretchy='false'>,</mo><mover accent='true'><mrow><msub><mrow><mi>C</mi></mrow><mrow><mn>0</mn></mrow></msub></mrow><mo accent='true'>¯</mo></mover><mo class='MathClass-close' stretchy='false'>⟩</mo><mo class='MathClass-bin' stretchy='false'>+</mo> <mo class='MathClass-open' stretchy='false'>⟨</mo><msup><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖣𝖾𝖼𝗈𝗆𝗉</mtext></mstyle></mrow><mrow><mi>β</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>l</mi></mrow></msup><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>A</mi></mrow><mrow><mn>1</mn></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-punc' stretchy='false'>,</mo><mover accent='true'><mrow><msub><mrow><mi>C</mi></mrow><mrow><mn>1</mn></mrow></msub></mrow><mo accent='true'>¯</mo></mover><mo class='MathClass-close' stretchy='false'>⟩</mo><mo class='MathClass-bin' stretchy='false'>+</mo> <mstyle class='text'><mtext> </mtext></mstyle><mstyle class='text'><mtext></mtext><mstyle class='math'><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace></mstyle><mtext></mtext></mstyle><mstyle class='text'><mtext> </mtext></mstyle> <mo class='MathClass-bin' stretchy='false'>+</mo> <mo class='MathClass-open' stretchy='false'>⟨</mo><msup><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖣𝖾𝖼𝗈𝗆𝗉</mtext></mstyle></mrow><mrow><mi>β</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>l</mi></mrow></msup><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>A</mi></mrow><mrow><mi>k</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mover accent='true'><mrow><mi>C</mi></mrow><mo accent='true'>¯</mo></mover></mrow><mrow><mi>k</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></math>
   <br class='newline' /><!-- l. 359 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-rel' stretchy='false'>=</mo><munderover accent='false' accentunder='false'><mrow> <mi class='MathClass-op'>∑</mi><mo> ⁡<!-- FUNCTION APPLICATION --></mo>
  </mrow><mrow><mi>i</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>0</mn></mrow><mrow><mi>k</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></munderover><mo class='MathClass-open' stretchy='false'>⟨</mo><msup><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖣𝖾𝖼𝗈𝗆𝗉</mtext></mstyle></mrow><mrow><mi>β</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>l</mi></mrow></msup><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>A</mi></mrow><mrow><mi>i</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-punc' stretchy='false'>,</mo><mover accent='true'><mrow><msub><mrow><mi>C</mi></mrow><mrow><mi>i</mi></mrow></msub></mrow><mo accent='true'>¯</mo></mover><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></math>
   <br class='newline' /><!-- l. 360 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-rel' stretchy='false'>=</mo><munderover accent='false' accentunder='false'><mrow> <mi class='MathClass-op'>∑</mi><mo> ⁡<!-- FUNCTION APPLICATION --></mo>
  </mrow><mrow><mi>i</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>0</mn></mrow><mrow><mi>k</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></munderover> <mrow><mo fence='true' form='prefix'>(</mo><mrow><msub><mrow><mi>A</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mi>i</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msub><mo class='MathClass-bin' stretchy='false'>⋅</mo><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖦𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mover accent='true'><mrow><mi>S</mi></mrow><mo accent='true'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub> <mrow><mo fence='true' form='prefix'>(</mo><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><msub><mrow><mi>S</mi></mrow><mrow><mi>i</mi></mrow></msub><msub><mrow><mi>M</mi></mrow><mrow><mn>2</mn></mrow></msub><mstyle displaystyle='true'><mfrac><mrow>  <mi>q</mi>
</mrow><mrow><msup><mrow><mi>β</mi></mrow><mrow><mn>1</mn></mrow></msup></mrow></mfrac></mstyle></mrow><mo fence='true' form='postfix'>)</mo></mrow> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>A</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mi>i</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msub><mo class='MathClass-bin' stretchy='false'>⋅</mo><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖦𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mover accent='true'><mrow><mi>S</mi></mrow><mo accent='true'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub> <mrow><mo fence='true' form='prefix'>(</mo><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><msub><mrow><mi>S</mi></mrow><mrow><mi>i</mi></mrow></msub><msub><mrow><mi>M</mi></mrow><mrow><mn>2</mn></mrow></msub><mstyle displaystyle='true'><mfrac><mrow>  <mi>q</mi>
</mrow><mrow><msup><mrow><mi>β</mi></mrow><mrow><mn>2</mn></mrow></msup></mrow></mfrac></mstyle></mrow><mo fence='true' form='postfix'>)</mo></mrow> <mo class='MathClass-bin' stretchy='false'>+</mo> <mstyle class='text'><mtext> </mtext></mstyle><mstyle class='text'><mtext></mtext><mstyle class='math'><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace></mstyle><mtext></mtext></mstyle><mstyle class='text'><mtext> </mtext></mstyle> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>A</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mi>i</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>l</mi><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msub><mo class='MathClass-bin' stretchy='false'>⋅</mo><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖦𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mover accent='true'><mrow><mi>S</mi></mrow><mo accent='true'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub> <mrow><mo fence='true' form='prefix'>(</mo><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><msub><mrow><mi>S</mi></mrow><mrow><mi>i</mi></mrow></msub><msub><mrow><mi>M</mi></mrow><mrow><mn>2</mn></mrow></msub><mstyle displaystyle='true'><mfrac><mrow> <mi>q</mi>
</mrow><mrow><msup><mrow><mi>β</mi></mrow><mrow><mi>l</mi></mrow></msup></mrow></mfrac></mstyle></mrow><mo fence='true' form='postfix'>)</mo></mrow></mrow><mo fence='true' form='postfix'>)</mo></mrow></mrow></math>
   <br class='newline' /><!-- l. 361 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo><munderover accent='false' accentunder='false'><mrow> <mi class='MathClass-op'>∑</mi><mo> ⁡<!-- FUNCTION APPLICATION --></mo>
  </mrow><mrow><mi>i</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>0</mn></mrow><mrow><mi>k</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></munderover> <mrow><mo fence='true' form='prefix'>(</mo><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖦𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mover accent='true'><mrow><mi>S</mi></mrow><mo accent='true'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub> <mrow><mo fence='true' form='prefix'>(</mo><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><msub><mrow><mi>A</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mi>i</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msub><msub><mrow><mi>S</mi></mrow><mrow><mi>i</mi></mrow></msub><msub><mrow><mi>M</mi></mrow><mrow><mn>2</mn></mrow></msub><mstyle displaystyle='true'><mfrac><mrow>  <mi>q</mi>
</mrow><mrow><msup><mrow><mi>β</mi></mrow><mrow><mn>1</mn></mrow></msup></mrow></mfrac></mstyle></mrow><mo fence='true' form='postfix'>)</mo></mrow> <mo class='MathClass-bin' stretchy='false'>+</mo><msub><mrow> <mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖦𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mover accent='true'><mrow><mi>S</mi></mrow><mo accent='true'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub> <mrow><mo fence='true' form='prefix'>(</mo><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><msub><mrow><mi>A</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mi>i</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msub><msub><mrow><mi>S</mi></mrow><mrow><mi>i</mi></mrow></msub><msub><mrow><mi>M</mi></mrow><mrow><mn>2</mn></mrow></msub><mstyle displaystyle='true'><mfrac><mrow>  <mi>q</mi>
</mrow><mrow><msup><mrow><mi>β</mi></mrow><mrow><mn>2</mn></mrow></msup></mrow></mfrac></mstyle></mrow><mo fence='true' form='postfix'>)</mo></mrow> <mo class='MathClass-bin' stretchy='false'>+</mo> <mstyle class='text'><mtext> </mtext></mstyle><mstyle class='text'><mtext></mtext><mstyle class='math'><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace></mstyle><mtext></mtext></mstyle><mstyle class='text'><mtext> </mtext></mstyle> <mo class='MathClass-bin' stretchy='false'>+</mo><msub><mrow> <mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖦𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mover accent='true'><mrow><mi>S</mi></mrow><mo accent='true'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub> <mrow><mo fence='true' form='prefix'>(</mo><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><msub><mrow><mi>A</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mi>i</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>l</mi><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msub><msub><mrow><mi>S</mi></mrow><mrow><mi>i</mi></mrow></msub><msub><mrow><mi>M</mi></mrow><mrow><mn>2</mn></mrow></msub><mstyle displaystyle='true'><mfrac><mrow> <mi>q</mi>
</mrow><mrow><msup><mrow><mi>β</mi></mrow><mrow><mi>l</mi></mrow></msup></mrow></mfrac></mstyle></mrow><mo fence='true' form='postfix'>)</mo></mrow></mrow><mo fence='true' form='postfix'>)</mo></mrow></mrow></math>
   <br class='newline' /><!-- l. 362 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo><munderover accent='false' accentunder='false'><mrow> <mi class='MathClass-op'>∑</mi><mo> ⁡<!-- FUNCTION APPLICATION --></mo>
  </mrow><mrow><mi>i</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>0</mn></mrow><mrow><mi>k</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></munderover><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖦𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mover accent='true'><mrow><mi>S</mi></mrow><mo accent='true'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub> <mrow><mo fence='true' form='prefix'>(</mo><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><msub><mrow><mi>A</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mi>i</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msub><msub><mrow><mi>S</mi></mrow><mrow><mi>i</mi></mrow></msub><msub><mrow><mi>M</mi></mrow><mrow><mn>2</mn></mrow></msub><mstyle displaystyle='true'><mfrac><mrow>  <mi>q</mi>
</mrow><mrow><msup><mrow><mi>β</mi></mrow><mrow><mn>1</mn></mrow></msup></mrow></mfrac></mstyle> <mo class='MathClass-bin' stretchy='false'>+</mo> <mo class='MathClass-bin' stretchy='false'>−</mo><msub><mrow><mi>A</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mi>i</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msub><msub><mrow><mi>S</mi></mrow><mrow><mi>i</mi></mrow></msub><msub><mrow><mi>M</mi></mrow><mrow><mn>2</mn></mrow></msub><mstyle displaystyle='true'><mfrac><mrow>  <mi>q</mi>
</mrow><mrow><msup><mrow><mi>β</mi></mrow><mrow><mn>2</mn></mrow></msup></mrow></mfrac></mstyle> <mo class='MathClass-bin' stretchy='false'>+</mo> <mstyle class='text'><mtext> </mtext></mstyle><mstyle class='text'><mtext></mtext><mstyle class='math'><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace></mstyle><mtext></mtext></mstyle><mstyle class='text'><mtext> </mtext></mstyle> <mo class='MathClass-bin' stretchy='false'>+</mo> <mo class='MathClass-bin' stretchy='false'>−</mo><msub><mrow><mi>A</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mi>i</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>l</mi><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msub><msub><mrow><mi>S</mi></mrow><mrow><mi>i</mi></mrow></msub><msub><mrow><mi>M</mi></mrow><mrow><mn>2</mn></mrow></msub><mstyle displaystyle='true'><mfrac><mrow> <mi>q</mi>
</mrow><mrow><msup><mrow><mi>β</mi></mrow><mrow><mi>l</mi></mrow></msup></mrow></mfrac></mstyle></mrow><mo fence='true' form='postfix'>)</mo></mrow></mrow></math>
                                                                                         
                                                                                         
   <br class='newline' /><!-- l. 363 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo><munderover accent='false' accentunder='false'><mrow> <mi class='MathClass-op'>∑</mi><mo> ⁡<!-- FUNCTION APPLICATION --></mo>
  </mrow><mrow><mi>i</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>0</mn></mrow><mrow><mi>k</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></munderover><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖦𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mover accent='true'><mrow><mi>S</mi></mrow><mo accent='true'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub> <mrow><mo fence='true' form='prefix'>(</mo><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><msub><mrow><mi>S</mi></mrow><mrow><mi>i</mi></mrow></msub><msub><mrow><mi>M</mi></mrow><mrow><mn>2</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>⋅</mo> <mrow><mo fence='true' form='prefix'>(</mo><mrow><msub><mrow><mi>A</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mi>i</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msub><mstyle displaystyle='true'><mfrac><mrow> <mi>q</mi>
</mrow><mrow><msup><mrow><mi>β</mi></mrow><mrow><mn>1</mn></mrow></msup></mrow></mfrac></mstyle> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>A</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mi>i</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msub><mstyle displaystyle='true'><mfrac><mrow> <mi>q</mi>
</mrow><mrow><msup><mrow><mi>β</mi></mrow><mrow><mn>2</mn></mrow></msup></mrow></mfrac></mstyle> <mo class='MathClass-bin' stretchy='false'>+</mo> <mstyle class='text'><mtext> </mtext></mstyle><mstyle class='text'><mtext></mtext><mstyle class='math'><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace></mstyle><mtext></mtext></mstyle><mstyle class='text'><mtext> </mtext></mstyle> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>A</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mi>i</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>l</mi><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msub><mstyle displaystyle='true'><mfrac><mrow> <mi>q</mi>
</mrow><mrow><msup><mrow><mi>β</mi></mrow><mrow><mi>l</mi></mrow></msup></mrow></mfrac></mstyle></mrow><mo fence='true' form='postfix'>)</mo></mrow></mrow><mo fence='true' form='postfix'>)</mo></mrow></mrow></math>
   <br class='newline' /><!-- l. 364 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo><munderover accent='false' accentunder='false'><mrow> <mi class='MathClass-op'>∑</mi><mo> ⁡<!-- FUNCTION APPLICATION --></mo>
  </mrow><mrow><mi>i</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>0</mn></mrow><mrow><mi>k</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></munderover><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖦𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mover accent='true'><mrow><mi>S</mi></mrow><mo accent='true'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mo class='MathClass-bin' stretchy='false'>−</mo><msub><mrow><mi>S</mi></mrow><mrow><mi>i</mi></mrow></msub><msub><mrow><mi>M</mi></mrow><mrow><mn>2</mn></mrow></msub><msub><mrow><mi>A</mi></mrow><mrow><mi>i</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
   </p></dd><dt class='enumerate-enumitem'>
4. </dt><dd class='enumerate-enumitem'>According to step 2 and 3, <br class='newline' /><!-- l. 366 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><munderover accent='false' accentunder='false'><mrow><mi class='MathClass-op'>∑</mi><mo> ⁡<!-- FUNCTION APPLICATION --></mo>
  </mrow><mrow><mi>i</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>0</mn></mrow><mrow><mi>k</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mi>k</mi></mrow></munderover><mo class='MathClass-open' stretchy='false'>⟨</mo><msup><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖣𝖾𝖼𝗈𝗆𝗉</mtext></mstyle></mrow><mrow><mi>β</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>l</mi></mrow></msup><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>C</mi></mrow><mrow><mi>i</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-punc' stretchy='false'>,</mo><mover accent='true'><mrow><msub><mrow><mi>C</mi></mrow><mrow><mi>i</mi></mrow></msub></mrow><mo accent='true'>¯</mo></mover><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></math>
   <br class='newline' /><!-- l. 367 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-rel' stretchy='false'>=</mo><munderover accent='false' accentunder='false'><mrow> <mi class='MathClass-op'>∑</mi><mo> ⁡<!-- FUNCTION APPLICATION --></mo>
  </mrow><mrow><mi>i</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>0</mn></mrow><mrow><mi>k</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></munderover><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖦𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mover accent='true'><mrow><mi>S</mi></mrow><mo accent='true'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mo class='MathClass-bin' stretchy='false'>−</mo><msub><mrow><mi>S</mi></mrow><mrow><mi>i</mi></mrow></msub><msub><mrow><mi>M</mi></mrow><mrow><mn>2</mn></mrow></msub><msub><mrow><mi>A</mi></mrow><mrow><mi>i</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>+</mo><msub><mrow> <mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖦𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mover accent='true'><mrow><mi>S</mi></mrow><mo accent='true'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>M</mi></mrow><mrow><mn>2</mn></mrow></msub><mi>B</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
   <br class='newline' /><!-- l. 368 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo><msub><mrow> <mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖦𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mover accent='true'><mrow><mi>S</mi></mrow><mo accent='true'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mstyle mathsize='1.61em'><mrow><mo fence='true' form='prefix'>(</mo><mrow></mrow><mo fence='true' form='postfix'></mo></mrow></mstyle><munderover accent='false' accentunder='false'><mrow> <mi class='MathClass-op'>∑</mi><mo> ⁡<!-- FUNCTION APPLICATION --></mo>
  </mrow><mrow><mi>i</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>0</mn></mrow><mrow><mi>k</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></munderover><mo class='MathClass-open' stretchy='false'>(</mo><mo class='MathClass-bin' stretchy='false'>−</mo><msub><mrow><mi>S</mi></mrow><mrow><mi>i</mi></mrow></msub><msub><mrow><mi>M</mi></mrow><mrow><mn>2</mn></mrow></msub><msub><mrow><mi>A</mi></mrow><mrow><mi>i</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>M</mi></mrow><mrow><mn>2</mn></mrow></msub><mi>B</mi><mstyle mathsize='1.61em'><mrow><mo fence='true' form='prefix'>)</mo><mrow></mrow><mo fence='true' form='postfix'></mo></mrow></mstyle></mrow></math>
   <span id='textcolor23'># addition of two GLWE ciphertexts</span> <br class='newline' /><!-- l. 369 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo><msub><mrow> <mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖦𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mover accent='true'><mrow><mi>S</mi></mrow><mo accent='true'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mstyle mathsize='1.61em'><mrow><mo fence='true' form='prefix'>(</mo><mrow></mrow><mo fence='true' form='postfix'></mo></mrow></mstyle><mi>B</mi><msub><mrow><mi>M</mi></mrow><mrow><mn>2</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>−</mo><munderover accent='false' accentunder='false'><mrow><mi class='MathClass-op'>∑</mi><mo> ⁡<!-- FUNCTION APPLICATION --></mo>
  </mrow><mrow><mi>i</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>0</mn></mrow><mrow><mi>k</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></munderover><msub><mrow><mi>M</mi></mrow><mrow><mn>2</mn></mrow></msub><msub><mrow><mi>A</mi></mrow><mrow><mi>i</mi></mrow></msub><msub><mrow><mi>S</mi></mrow><mrow><mi>i</mi></mrow></msub><mstyle mathsize='1.61em'><mrow><mo fence='true' form='prefix'>)</mo><mrow></mrow><mo fence='true' form='postfix'></mo></mrow></mstyle></mrow></math>
   <br class='newline' /><!-- l. 370 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo><msub><mrow> <mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖦𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mover accent='true'><mrow><mi>S</mi></mrow><mo accent='true'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mstyle mathsize='1.61em'><mrow><mo fence='true' form='prefix'>(</mo><mrow></mrow><mo fence='true' form='postfix'></mo></mrow></mstyle><msub><mrow><mi>M</mi></mrow><mrow><mn>2</mn></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mi>B</mi> <mo class='MathClass-bin' stretchy='false'>−</mo><munderover accent='false' accentunder='false'><mrow><mi class='MathClass-op'>∑</mi><mo> ⁡<!-- FUNCTION APPLICATION --></mo>
  </mrow><mrow><mi>i</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>0</mn></mrow><mrow><mi>k</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></munderover><msub><mrow><mi>A</mi></mrow><mrow><mi>i</mi></mrow></msub><msub><mrow><mi>S</mi></mrow><mrow><mi>i</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo><mstyle mathsize='1.61em'><mrow><mo fence='true' form='prefix'>)</mo><mrow></mrow><mo fence='true' form='postfix'></mo></mrow></mstyle></mrow></math><br class='newline' /><!-- l. 371 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo><msub><mrow> <mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖦𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mover accent='true'><mrow><mi>S</mi></mrow><mo accent='true'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>M</mi></mrow><mrow><mn>2</mn></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mi mathvariant='normal'>Δ</mi><msub><mrow><mi>M</mi></mrow><mrow><mn>1</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>E</mi><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
   <br class='newline' /><!-- l. 372 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo><msub><mrow> <mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖦𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mover accent='true'><mrow><mi>S</mi></mrow><mo accent='true'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mi mathvariant='normal'>Δ</mi><msub><mrow><mi>M</mi></mrow><mrow><mn>1</mn></mrow></msub><msub><mrow><mi>M</mi></mrow><mrow><mn>2</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>M</mi></mrow><mrow><mn>2</mn></mrow></msub><mi>E</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
   <br class='newline' /><!-- l. 373 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>≈</mo><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖦𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mover accent='true'><mrow><mi>S</mi></mrow><mo accent='true'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mi mathvariant='normal'>Δ</mi><msub><mrow><mi>M</mi></mrow><mrow><mn>1</mn></mrow></msub><msub><mrow><mi>M</mi></mrow><mrow><mn>2</mn></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
   <span id='textcolor24'># given <!-- l. 373 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>E</mi></math>
   is small and thus <!-- l. 373 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>M</mi></mrow><mrow><mn>2</mn></mrow></msub><mi>E</mi></mrow></math>
   is also small</span></dd></dl>
   
   <h4 class='subsectionHead' id='coefficient-extraction'><span class='titlemark'>D-1.7   </span> <a id='x1-30000D-1.7'></a>Coefficient Extraction</h4>
<!-- l. 380 --><p class='noindent'><span class='rm-lmbx-10x-x-109'>- Reference:  </span><a href='https://www.zama.ai/post/tfhe-deep-dive-part-4'>TFHE Deep Dive - Part IV - Programmable Bootstrapping</a> <span class='cite'>[<span class='rm-lmbx-10x-x-109'>?</span>]</span>
</p><!-- l. 383 --><p class='indent'>   <!-- l. 383 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 385 --><p class='indent'>   In TFHE, coefficient extraction is a process of extracting a coefficient of a polynomial which is
encrypted as GLWE ciphertext. The extracted coefficient is in a form of LWE ciphertext
(<span class='rm-lmbx-10x-x-109'>??</span>).
</p><!-- l. 391 --><p class='indent'>   Note that in the GLWE cryptosystem, plaintext
<!-- l. 391 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>M</mi></math>
is encoded as a polynomial, where each coefficient encodes the plaintext value
<!-- l. 391 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>m</mi></mrow><mrow><mn>0</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>m</mi></mrow><mrow><mn>1</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>m</mi></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub></mrow></math>.
</p><!-- l. 396 --><p class='indent'>   Suppose we have a GLWE ciphertext setup as the following: <br class='newline' /><!-- l. 397 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>M</mi> <mo class='MathClass-rel' stretchy='false'>=</mo><munderover accent='false' accentunder='false'><mrow> <mi class='MathClass-op'>∑</mi><mo> ⁡<!-- FUNCTION APPLICATION --></mo>
  </mrow><mrow><mi>j</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>0</mn></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></munderover><msub><mrow><mi>m</mi></mrow><mrow><mi>j</mi></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mi>j</mi></mrow></msup> <mo class='MathClass-rel' stretchy='false'>∈</mo><msub><mrow><mstyle mathvariant='script'><mi>R</mi></mstyle></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mi>n</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>q</mi><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msub></mrow></math>
</p><!-- l. 399 --><p class='indent'>   <!-- l. 399 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>S</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mrow><mo fence='true' form='prefix'>(</mo><mrow><msub><mrow><mi>S</mi></mrow><mrow><mn>0</mn></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo><munderover accent='false' accentunder='false'><mrow> <mi class='MathClass-op'>∑</mi><mo> ⁡<!-- FUNCTION APPLICATION --></mo>
  </mrow><mrow><mi>j</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>0</mn></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></munderover><msub><mrow><mi>s</mi></mrow><mrow><mn>0</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mi>j</mi></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mi>j</mi></mrow></msup><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>S</mi></mrow><mrow><mn>1</mn></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo><munderover accent='false' accentunder='false'><mrow><mo> ∑</mo>
</mrow><mrow><mi>j</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>0</mn></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></munderover><msub><mrow><mi>s</mi></mrow><mrow><mn>1</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mi>j</mi></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mi>j</mi></mrow></msup><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><mstyle class='text'><mtext></mtext><mstyle class='math'><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace></mstyle><mtext></mtext></mstyle><mstyle class='text'><mtext> </mtext></mstyle><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>S</mi></mrow><mrow><mi>k</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo><munderover accent='false' accentunder='false'><mrow><mo> ∑</mo>
</mrow><mrow><mi>j</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>0</mn></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></munderover><msub><mrow><mi>s</mi></mrow><mrow><mi>k</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mi>j</mi></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mi>j</mi></mrow></msup></mrow><mo fence='true' form='postfix'>)</mo></mrow></mrow></math>
</p><!-- l. 401 --><p class='indent'>   <!-- l. 401 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖦𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mover accent='true'><mrow><mi>S</mi></mrow><mo accent='true'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mi mathvariant='normal'>Δ</mi><mi>M</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo> <mrow><mo fence='true' form='prefix'>(</mo><mrow><msub><mrow><mi>A</mi></mrow><mrow><mn>0</mn></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo><munderover accent='false' accentunder='false'><mrow> <mi class='MathClass-op'>∑</mi><mo> ⁡<!-- FUNCTION APPLICATION --></mo>
  </mrow><mrow><mi>j</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>0</mn></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></munderover><msub><mrow><mi>a</mi></mrow><mrow><mn>0</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mi>j</mi></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mi>j</mi></mrow></msup><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>A</mi></mrow><mrow><mn>1</mn></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo><munderover accent='false' accentunder='false'><mrow><mo> ∑</mo>
  </mrow><mrow><mi>j</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>0</mn></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></munderover><msub><mrow><mi>a</mi></mrow><mrow><mn>1</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mi>j</mi></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mi>j</mi></mrow></msup><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><mstyle class='text'><mtext></mtext><mstyle class='math'><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace></mstyle><mtext></mtext></mstyle><mstyle class='text'><mtext> </mtext></mstyle><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>A</mi></mrow><mrow><mi>k</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo><munderover accent='false' accentunder='false'><mrow><mo> ∑</mo>
</mrow><mrow><mi>j</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>0</mn></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></munderover><msub><mrow><mi>a</mi></mrow><mrow><mi>k</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mi>j</mi></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mi>j</mi></mrow></msup><mo class='MathClass-punc' stretchy='false'>,</mo><mi>B</mi> <mo class='MathClass-rel' stretchy='false'>=</mo><munderover accent='false' accentunder='false'><mrow><mo> ∑</mo>
</mrow><mrow><mi>j</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>0</mn></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></munderover><msub><mrow><mi>b</mi></mrow><mrow><mi>j</mi></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mi>j</mi></mrow></msup></mrow><mo fence='true' form='postfix'>)</mo></mrow></mrow></math>
</p><!-- l. 403 --><p class='indent'>   <!-- l. 403 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>B</mi> <mo class='MathClass-rel' stretchy='false'>=</mo><munderover accent='false' accentunder='false'><mrow> <mi class='MathClass-op'>∑</mi><mo> ⁡<!-- FUNCTION APPLICATION --></mo>
  </mrow><mrow><mi>i</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>0</mn></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></munderover><msub><mrow><mi>A</mi></mrow><mrow><mi>i</mi></mrow></msub><msub><mrow><mi>S</mi></mrow><mrow><mi>i</mi></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi mathvariant='normal'>Δ</mi><mi>M</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>E</mi></mrow></math>
</p><!-- l. 405 --><p class='indent'>   <!-- l. 405 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>E</mi> <mo class='MathClass-rel' stretchy='false'>=</mo><munderover accent='false' accentunder='false'><mrow> <mi class='MathClass-op'>∑</mi><mo> ⁡<!-- FUNCTION APPLICATION --></mo>
  </mrow><mrow><mi>i</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>0</mn></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></munderover><msub><mrow><mi>e</mi></mrow><mrow><mi>i</mi></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mi>i</mi></mrow></msup></mrow></math>
</p><!-- l. 407 --><p class='indent'>   <!-- l. 407 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 409 --><p class='noindent'>Note that:
</p><!-- l. 411 --><p class='indent'>   <!-- l. 411 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi mathvariant='normal'>Δ</mi><mi>M</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>E</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mi>B</mi> <mo class='MathClass-bin' stretchy='false'>−</mo><munderover accent='false' accentunder='false'><mrow><mi class='MathClass-op'>∑</mi><mo> ⁡<!-- FUNCTION APPLICATION --></mo>
  </mrow><mrow><mi>i</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>0</mn></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></munderover><msub><mrow><mi>A</mi></mrow><mrow><mi>i</mi></mrow></msub><msub><mrow><mi>S</mi></mrow><mrow><mi>i</mi></mrow></msub></mrow></math>
                                                                                         
                                                                                         
</p><!-- l. 413 --><p class='indent'>   <!-- l. 413 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>(</mo><mi mathvariant='normal'>Δ</mi><msub><mrow><mi>m</mi></mrow><mrow><mn>0</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi mathvariant='normal'>Δ</mi><msub><mrow><mi>m</mi></mrow><mrow><mn>1</mn></mrow></msub><mi>X</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mstyle class='text'><mtext> </mtext></mstyle><mstyle class='text'><mtext></mtext><mstyle class='math'><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace></mstyle><mtext></mtext></mstyle><mstyle class='text'><mtext> </mtext></mstyle> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi mathvariant='normal'>Δ</mi><msub><mrow><mi>m</mi></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>+</mo> <mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>e</mi></mrow><mrow><mn>0</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>e</mi></mrow><mrow><mn>1</mn></mrow></msub><mi>X</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mstyle class='text'><mtext> </mtext></mstyle><mstyle class='text'><mtext></mtext><mstyle class='math'><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace></mstyle><mtext></mtext></mstyle><mstyle class='text'><mtext> </mtext></mstyle> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>e</mi></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
</p><!-- l. 415 --><p class='indent'>   <!-- l. 415 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>(</mo><mi mathvariant='normal'>Δ</mi><msub><mrow><mi>m</mi></mrow><mrow><mn>0</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>e</mi></mrow><mrow><mn>0</mn></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>+</mo> <mo class='MathClass-open' stretchy='false'>(</mo><mi mathvariant='normal'>Δ</mi><msub><mrow><mi>m</mi></mrow><mrow><mn>1</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>e</mi></mrow><mrow><mn>1</mn></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo><mi>X</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mstyle class='text'><mtext> </mtext></mstyle><mstyle class='text'><mtext></mtext><mstyle class='math'><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace></mstyle><mtext></mtext></mstyle><mstyle class='text'><mtext> </mtext></mstyle> <mo class='MathClass-bin' stretchy='false'>+</mo> <mo class='MathClass-open' stretchy='false'>(</mo><mi mathvariant='normal'>Δ</mi><msub><mrow><mi>m</mi></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>e</mi></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo><msup><mrow><mi>X</mi></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msup></mrow></math>
</p><!-- l. 417 --><p class='indent'>   <!-- l. 417 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 419 --><p class='noindent'>Another way to write the formula is:
</p><!-- l. 421 --><p class='indent'>   <!-- l. 421 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>B</mi> <mo class='MathClass-bin' stretchy='false'>−</mo><munderover accent='false' accentunder='false'><mrow><mi class='MathClass-op'>∑</mi><mo> ⁡<!-- FUNCTION APPLICATION --></mo>
  </mrow><mrow><mi>i</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>0</mn></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></munderover><msub><mrow><mi>A</mi></mrow><mrow><mi>i</mi></mrow></msub><msub><mrow><mi>S</mi></mrow><mrow><mi>i</mi></mrow></msub></mrow></math>
</p><!-- l. 423 --><p class='indent'>   <!-- l. 423 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>b</mi></mrow><mrow><mn>0</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>b</mi></mrow><mrow><mn>1</mn></mrow></msub><mi>X</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mstyle class='text'><mtext> </mtext></mstyle><mstyle class='text'><mtext></mtext><mstyle class='math'><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace></mstyle><mtext></mtext></mstyle><mstyle class='text'><mtext> </mtext></mstyle> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>b</mi></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
</p><!-- l. 425 --><p class='indent'>   <!-- l. 425 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-bin' stretchy='false'>−</mo><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>a</mi></mrow><mrow><mn>0</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>0</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>a</mi></mrow><mrow><mn>0</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>1</mn></mrow></msub><mi>X</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mstyle class='text'><mtext> </mtext></mstyle><mstyle class='text'><mtext></mtext><mstyle class='math'><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace></mstyle><mtext></mtext></mstyle><mstyle class='text'><mtext> </mtext></mstyle> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>a</mi></mrow><mrow><mn>0</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mi>n</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>s</mi></mrow><mrow><mn>0</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>0</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>s</mi></mrow><mrow><mn>0</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>1</mn></mrow></msub><mi>X</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mstyle class='text'><mtext> </mtext></mstyle><mstyle class='text'><mtext></mtext><mstyle class='math'><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace></mstyle><mtext></mtext></mstyle><mstyle class='text'><mtext> </mtext></mstyle> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>s</mi></mrow><mrow><mn>0</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mi>n</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
</p><!-- l. 427 --><p class='indent'>   <!-- l. 427 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-bin' stretchy='false'>−</mo><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>a</mi></mrow><mrow><mn>1</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>0</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>a</mi></mrow><mrow><mn>1</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>1</mn></mrow></msub><mi>X</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mstyle class='text'><mtext> </mtext></mstyle><mstyle class='text'><mtext></mtext><mstyle class='math'><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace></mstyle><mtext></mtext></mstyle><mstyle class='text'><mtext> </mtext></mstyle> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>a</mi></mrow><mrow><msub><mrow></mrow><mrow><mn>1</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><mi>n</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>s</mi></mrow><mrow><mn>1</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>0</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>s</mi></mrow><mrow><mn>1</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>1</mn></mrow></msub><mi>X</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mstyle class='text'><mtext> </mtext></mstyle><mstyle class='text'><mtext></mtext><mstyle class='math'><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace></mstyle><mtext></mtext></mstyle><mstyle class='text'><mtext> </mtext></mstyle> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>s</mi></mrow><mrow><mn>1</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mi>n</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
</p><!-- l. 429 --><p class='indent'>   <!-- l. 429 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-bin' stretchy='false'>−</mo><mstyle class='text'><mtext> </mtext></mstyle><mstyle class='text'><mtext></mtext><mstyle class='math'><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace></mstyle><mtext></mtext></mstyle><mstyle class='text'><mtext> </mtext></mstyle></mrow></math>
</p><!-- l. 431 --><p class='indent'>   <!-- l. 431 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-bin' stretchy='false'>−</mo><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>a</mi></mrow><mrow><mi>k</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>0</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>a</mi></mrow><mrow><mi>k</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>1</mn></mrow></msub><mi>X</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mstyle class='text'><mtext> </mtext></mstyle><mstyle class='text'><mtext></mtext><mstyle class='math'><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace></mstyle><mtext></mtext></mstyle><mstyle class='text'><mtext> </mtext></mstyle> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>a</mi></mrow><mrow><mi>k</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mi>n</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>s</mi></mrow><mrow><mi>k</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>0</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>s</mi></mrow><mrow><mi>k</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>1</mn></mrow></msub><mi>X</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mstyle class='text'><mtext> </mtext></mstyle><mstyle class='text'><mtext></mtext><mstyle class='math'><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace></mstyle><mtext></mtext></mstyle><mstyle class='text'><mtext> </mtext></mstyle> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>s</mi></mrow><mrow><mi>k</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mi>n</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
</p><!-- l. 433 --><p class='indent'>   <!-- l. 433 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 435 --><p class='indent'>   <!-- l. 435 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo> <mrow><mo fence='true' form='prefix'>(</mo><mrow><msub><mrow><mi>b</mi></mrow><mrow><mn>0</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>−</mo> <mrow><mo fence='true' form='prefix'>(</mo><mrow><munderover accent='false' accentunder='false'><mrow><mi class='MathClass-op'>∑</mi><mo> ⁡<!-- FUNCTION APPLICATION --></mo>
  </mrow><mrow><mi>i</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>0</mn></mrow><mrow><mi>k</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></munderover><munderover accent='false' accentunder='false'><mrow><mo> ∑</mo>
  </mrow><mrow><mi>j</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>0</mn></mrow><mrow><mn>0</mn></mrow></munderover><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>a</mi></mrow><mrow><mi>i</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mn>0</mn><mo class='MathClass-bin' stretchy='false'>−</mo><mi>j</mi></mrow></msub><msub><mrow><mi>s</mi></mrow><mrow><mi>i</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>j</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>−</mo><munderover accent='false' accentunder='false'><mrow><mo>∑</mo>
  </mrow><mrow><mi>i</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>0</mn></mrow><mrow><mi>k</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></munderover><munderover accent='false' accentunder='false'><mrow><mo> ∑</mo>
  </mrow><mrow><mi>j</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>1</mn></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></munderover><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>a</mi></mrow><mrow><mi>i</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>n</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mi>j</mi></mrow></msub><msub><mrow><mi>s</mi></mrow><mrow><mi>i</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>j</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mo fence='true' form='postfix'>)</mo></mrow></mrow><mo fence='true' form='postfix'>)</mo></mrow></mrow></math>
</p><!-- l. 437 --><p class='indent'>   <!-- l. 437 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-bin' stretchy='false'>+</mo> <mrow><mo fence='true' form='prefix'>(</mo><mrow><msub><mrow><mi>b</mi></mrow><mrow><mn>1</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>−</mo> <mrow><mo fence='true' form='prefix'>(</mo><mrow><munderover accent='false' accentunder='false'><mrow><mi class='MathClass-op'>∑</mi><mo> ⁡<!-- FUNCTION APPLICATION --></mo>
  </mrow><mrow><mi>i</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>0</mn></mrow><mrow><mi>k</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></munderover><munderover accent='false' accentunder='false'><mrow><mo> ∑</mo>
  </mrow><mrow><mi>j</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>0</mn></mrow><mrow><mn>1</mn></mrow></munderover><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>a</mi></mrow><mrow><mi>i</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mn>1</mn><mo class='MathClass-bin' stretchy='false'>−</mo><mi>j</mi></mrow></msub><msub><mrow><mi>s</mi></mrow><mrow><mi>i</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>j</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>−</mo><munderover accent='false' accentunder='false'><mrow><mo>∑</mo>
  </mrow><mrow><mi>i</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>0</mn></mrow><mrow><mi>k</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></munderover><munderover accent='false' accentunder='false'><mrow><mo> ∑</mo>
  </mrow><mrow><mi>j</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>2</mn></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></munderover><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>a</mi></mrow><mrow><mi>i</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>n</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mi>j</mi></mrow></msub><msub><mrow><mi>s</mi></mrow><mrow><mi>i</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>j</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mo fence='true' form='postfix'>)</mo></mrow></mrow><mo fence='true' form='postfix'>)</mo></mrow> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mi>X</mi></mrow></math>
</p><!-- l. 441 --><p class='indent'>   <!-- l. 441 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-bin' stretchy='false'>+</mo> <mrow><mo fence='true' form='prefix'>(</mo><mrow><msub><mrow><mi>b</mi></mrow><mrow><mn>2</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>−</mo> <mrow><mo fence='true' form='prefix'>(</mo><mrow><munderover accent='false' accentunder='false'><mrow><mi class='MathClass-op'>∑</mi><mo> ⁡<!-- FUNCTION APPLICATION --></mo>
  </mrow><mrow><mi>i</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>0</mn></mrow><mrow><mi>k</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></munderover><munderover accent='false' accentunder='false'><mrow><mo> ∑</mo>
  </mrow><mrow><mi>j</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>0</mn></mrow><mrow><mn>2</mn></mrow></munderover><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>a</mi></mrow><mrow><mi>i</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mn>2</mn><mo class='MathClass-bin' stretchy='false'>−</mo><mi>j</mi></mrow></msub><msub><mrow><mi>s</mi></mrow><mrow><mi>i</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>j</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>−</mo><munderover accent='false' accentunder='false'><mrow><mo>∑</mo>
  </mrow><mrow><mi>i</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>0</mn></mrow><mrow><mi>k</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></munderover><munderover accent='false' accentunder='false'><mrow><mo> ∑</mo>
  </mrow><mrow><mi>j</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>3</mn></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></munderover><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>a</mi></mrow><mrow><mi>i</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>n</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mi>j</mi></mrow></msub><msub><mrow><mi>s</mi></mrow><mrow><mi>i</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>j</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mo fence='true' form='postfix'>)</mo></mrow></mrow><mo fence='true' form='postfix'>)</mo></mrow> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>X</mi></mrow><mrow><mn>2</mn></mrow></msup></mrow></math>
</p><!-- l. 443 --><p class='indent'>   <!-- l. 443 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 445 --><p class='indent'>   <!-- l. 445 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mstyle class='text'><mtext> </mtext></mstyle><mstyle class='text'><mtext></mtext><mstyle class='math'><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace></mstyle><mtext></mtext></mstyle><mstyle class='text'><mtext> </mtext></mstyle></mrow></math>
</p><!-- l. 447 --><p class='indent'>   <!-- l. 447 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 449 --><p class='indent'>   <!-- l. 449 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-bin' stretchy='false'>+</mo> <mrow><mo fence='true' form='prefix'>(</mo><mrow><msub><mrow><mi>b</mi></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>−</mo> <mrow><mo fence='true' form='prefix'>(</mo><mrow><munderover accent='false' accentunder='false'><mrow><mi class='MathClass-op'>∑</mi><mo> ⁡<!-- FUNCTION APPLICATION --></mo>
  </mrow><mrow><mi>i</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>0</mn></mrow><mrow><mi>k</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></munderover><munderover accent='false' accentunder='false'><mrow><mo> ∑</mo>
  </mrow><mrow><mi>j</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>0</mn></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></munderover><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>a</mi></mrow><mrow><mi>i</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>n</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn><mo class='MathClass-bin' stretchy='false'>−</mo><mi>j</mi></mrow></msub><msub><mrow><mi>s</mi></mrow><mrow><mi>i</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>j</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>−</mo><munderover accent='false' accentunder='false'><mrow><mo>∑</mo>
  </mrow><mrow><mi>i</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>0</mn></mrow><mrow><mi>k</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></munderover><munderover accent='false' accentunder='false'><mrow><mo> ∑</mo>
  </mrow><mrow><mi>j</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mi>n</mi></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></munderover><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>a</mi></mrow><mrow><mi>i</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>n</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mi>j</mi></mrow></msub><msub><mrow><mi>s</mi></mrow><mrow><mi>i</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>j</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mo fence='true' form='postfix'>)</mo></mrow></mrow><mo fence='true' form='postfix'>)</mo></mrow> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>X</mi></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msup></mrow></math>
</p><!-- l. 451 --><p class='indent'>   <span id='textcolor25'># Grouping the terms by same exponents</span>
</p><!-- l. 453 --><p class='indent'>   <!-- l. 453 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 456 --><p class='indent'>   <!-- l. 456 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 458 --><p class='indent'>   <!-- l. 458 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo><munderover accent='false' accentunder='false'><mrow> <mi class='MathClass-op'>∑</mi><mo> ⁡<!-- FUNCTION APPLICATION --></mo>
  </mrow><mrow><mi>h</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>0</mn></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></munderover> <mrow><mo fence='true' form='prefix'>(</mo><mrow><msub><mrow><mi>b</mi></mrow><mrow><mi>h</mi></mrow></msub> <mo class='MathClass-bin' stretchy='false'>−</mo> <mrow><mo fence='true' form='prefix'>(</mo><mrow><munderover accent='false' accentunder='false'><mrow><mo>∑</mo>
  </mrow><mrow><mi>i</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>0</mn></mrow><mrow><mi>k</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></munderover><munderover accent='false' accentunder='false'><mrow><mo> ∑</mo>
  </mrow><mrow><mi>j</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>0</mn></mrow><mrow><mi>h</mi></mrow></munderover><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>a</mi></mrow><mrow><mi>i</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>h</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mi>j</mi></mrow></msub><msub><mrow><mi>s</mi></mrow><mrow><mi>i</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>j</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>−</mo><munderover accent='false' accentunder='false'><mrow><mo>∑</mo>
  </mrow><mrow><mi>i</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>0</mn></mrow><mrow><mi>k</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></munderover><munderover accent='false' accentunder='false'><mrow><mo> ∑</mo>
  </mrow><mrow><mi>j</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mi>h</mi><mo class='MathClass-bin' stretchy='false'>+</mo><mn>1</mn></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></munderover><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>a</mi></mrow><mrow><mi>i</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>n</mi><mo class='MathClass-bin' stretchy='false'>+</mo><mi>h</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mi>j</mi></mrow></msub><msub><mrow><mi>s</mi></mrow><mrow><mi>i</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>j</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mo fence='true' form='postfix'>)</mo></mrow></mrow><mo fence='true' form='postfix'>)</mo></mrow> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>X</mi></mrow><mrow><mi>h</mi></mrow></msup></mrow></math>
</p><!-- l. 461 --><p class='indent'>   <!-- l. 461 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 463 --><p class='indent'>   <!-- l. 463 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo><munderover accent='false' accentunder='false'><mrow> <mi class='MathClass-op'>∑</mi><mo> ⁡<!-- FUNCTION APPLICATION --></mo>
  </mrow><mrow><mi>h</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>0</mn></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></munderover><msub><mrow><mi>C</mi></mrow><mrow><mi>h</mi></mrow></msub> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>X</mi></mrow><mrow><mi>h</mi></mrow></msup></mrow></math>,
where <!-- l. 463 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>C</mi></mrow><mrow><mi>h</mi></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mi>b</mi></mrow><mrow><mi>h</mi></mrow></msub> <mo class='MathClass-bin' stretchy='false'>−</mo> <mrow><mo fence='true' form='prefix'>(</mo><mrow><munderover accent='false' accentunder='false'><mrow><mi class='MathClass-op'>∑</mi><mo> ⁡<!-- FUNCTION APPLICATION --></mo>
  </mrow><mrow><mi>i</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>0</mn></mrow><mrow><mi>k</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></munderover><munderover accent='false' accentunder='false'><mrow><mo> ∑</mo>
  </mrow><mrow><mi>j</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>0</mn></mrow><mrow><mi>h</mi></mrow></munderover><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>a</mi></mrow><mrow><mi>i</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>h</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mi>j</mi></mrow></msub><msub><mrow><mi>s</mi></mrow><mrow><mi>i</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>j</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>−</mo><munderover accent='false' accentunder='false'><mrow><mo>∑</mo>
  </mrow><mrow><mi>i</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>0</mn></mrow><mrow><mi>k</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></munderover><munderover accent='false' accentunder='false'><mrow><mo> ∑</mo>
  </mrow><mrow><mi>j</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mi>h</mi><mo class='MathClass-bin' stretchy='false'>+</mo><mn>1</mn></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></munderover><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>a</mi></mrow><mrow><mi>i</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>n</mi><mo class='MathClass-bin' stretchy='false'>+</mo><mi>h</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mi>j</mi></mrow></msub><msub><mrow><mi>s</mi></mrow><mrow><mi>i</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>j</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mo fence='true' form='postfix'>)</mo></mrow></mrow></math>
</p><!-- l. 465 --><p class='indent'>   <!-- l. 465 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 467 --><p class='noindent'>In the above <!-- l. 467 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><mi>n</mi> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>-degree polynomial,
notice that each <!-- l. 467 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>X</mi></mrow><mrow><mi>h</mi></mrow></msup></math> term’s
coefficient, <!-- l. 467 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>C</mi></mrow><mrow><mi>h</mi></mrow></msub></math>, can be expressed
as an LWE ciphertext <!-- l. 467 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖼𝗍</mtext></mstyle></mrow><mrow><mi>h</mi></mrow></msub></math>
as follows:
</p><!-- l. 469 --><p class='indent'>   <!-- l. 469 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>S</mi></mrow><mrow><mi>′</mi></mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>s</mi></mrow><mrow><mn>0</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>0</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>s</mi></mrow><mrow><mn>0</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>1</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><mstyle class='text'><mtext></mtext><mstyle class='math'><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace></mstyle><mtext></mtext></mstyle><mstyle class='text'><mtext> </mtext></mstyle><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>s</mi></mrow><mrow><mn>0</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mi>n</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>s</mi></mrow><mrow><mn>1</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>0</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>s</mi></mrow><mrow><mn>1</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>1</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><mstyle class='text'><mtext></mtext><mstyle class='math'><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace></mstyle><mtext></mtext></mstyle><mstyle class='text'><mtext> </mtext></mstyle><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>s</mi></mrow><mrow><mn>1</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mi>n</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><mstyle class='text'><mtext></mtext><mstyle class='math'><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace></mstyle><mtext></mtext></mstyle><mstyle class='text'><mtext> </mtext></mstyle><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>s</mi></mrow><mrow><mi>k</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mi>n</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>(</mo><msubsup><mrow><mi>s</mi></mrow><mrow><mn>0</mn></mrow><mrow><mi>′</mi></mrow></msubsup><mo class='MathClass-punc' stretchy='false'>,</mo><msubsup><mrow><mi>s</mi></mrow><mrow><mn>1</mn></mrow><mrow><mi>′</mi></mrow></msubsup><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><mstyle class='text'><mtext></mtext><mstyle class='math'><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace></mstyle><mtext></mtext></mstyle><mstyle class='text'><mtext> </mtext></mstyle><mo class='MathClass-punc' stretchy='false'>,</mo><msubsup><mrow><mi>s</mi></mrow><mrow><mi mathvariant='italic'>𝑛𝑘</mi></mrow><mrow><mi>′</mi></mrow></msubsup><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>∈</mo> <msubsup><mrow><mi>ℤ</mi></mrow><mrow><mi>q</mi></mrow><mrow><mi mathvariant='italic'>𝑛𝑘</mi></mrow></msubsup></mrow></math>
</p><!-- l. 472 --><p class='indent'>   <!-- l. 472 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>C</mi></mrow><mrow><mi>h</mi></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>(</mo><msubsup><mrow><mi>a</mi></mrow><mrow><mn>1</mn></mrow><mrow><mi>′</mi></mrow></msubsup><mo class='MathClass-punc' stretchy='false'>,</mo><msubsup><mrow><mi>a</mi></mrow><mrow><mn>2</mn></mrow><mrow><mi>′</mi></mrow></msubsup><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><mstyle class='text'><mtext></mtext><mstyle class='math'><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace></mstyle><mtext></mtext></mstyle><mstyle class='text'><mtext> </mtext></mstyle><mo class='MathClass-punc' stretchy='false'>,</mo><msubsup><mrow><mi>a</mi></mrow><mrow><mi mathvariant='italic'>𝑛𝑘</mi></mrow><mrow><mi>′</mi></mrow></msubsup><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>b</mi></mrow><mrow><mi>h</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>∈</mo> <msubsup><mrow><mi>ℤ</mi></mrow><mrow><mi>q</mi></mrow><mrow><mi mathvariant='italic'>𝑛𝑘</mi><mo class='MathClass-bin' stretchy='false'>+</mo><mn>1</mn></mrow></msubsup></mrow></math>
</p>
   <figure class='figure'> 

                                                                                         
                                                                                         
                                                                                         
                                                                                         
<table class='equation-star'><tr><td>
<!-- l. 476 --><math class='equation' display='block' xmlns='http://www.w3.org/1998/Math/MathML'><mrow>
<mstyle class='text'><mtext>, where </mtext></mstyle><msubsup><mrow><mi>a</mi></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>⋅</mo><mi>i</mi><mo class='MathClass-bin' stretchy='false'>+</mo><mi>j</mi></mrow><mrow><mi>′</mi></mrow></msubsup> <mo class='MathClass-rel' stretchy='false'>=</mo> <mrow class='cases'> <mrow><mo fence='true' form='prefix'>{</mo><mrow> <mtable align='axis' class='array' columnlines='none' displaystyle='true' equalcolumns='false' equalrows='false' rowlines='none none none none' style=''> <mtr class='array-row'><mtd class='array-td' columnalign='left'><msub><mrow><mi>a</mi></mrow><mrow><mi>i</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>h</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mi>j</mi></mrow></msub><mstyle class='text'><mtext> (if </mtext></mstyle><mn>0</mn> <mo class='MathClass-rel' stretchy='false'>≤</mo><mi>j</mi> <mo class='MathClass-rel' stretchy='false'>≤</mo><mi>h</mi><mstyle class='text'><mtext>)</mtext></mstyle>              <mspace class='quad' width='1em'></mspace></mtd></mtr>  <mtr class='array-row'><mtd class='array-td' columnalign='left'><mspace class='quad' width='1em'></mspace></mtd></mtr>  <mtr class='array-row'><mtd class='array-td' columnalign='left'><mspace class='quad' width='1em'></mspace></mtd>
</mtr>  <mtr class='array-row'><mtd class='array-td' columnalign='left'><msub><mrow><mi>a</mi></mrow><mrow><mi>i</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>n</mi><mo class='MathClass-bin' stretchy='false'>+</mo><mi>h</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mi>j</mi></mrow></msub><mstyle class='text'><mtext> (if </mtext></mstyle><mi>h</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>1</mn> <mo class='MathClass-rel' stretchy='false'>≤</mo><mi>j</mi> <mo class='MathClass-rel' stretchy='false'>≤</mo><mi>n</mi> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn><mstyle class='text'><mtext>)</mtext></mstyle><mspace class='quad' width='1em'></mspace></mtd></mtr>  <mtr class='array-row'><mtd class='array-td' columnalign='left'><mspace class='quad' width='1em'></mspace></mtd></mtr>    <!-- @{}l@{\quad }l@{} --></mtable>                                                                                       </mrow><mo fence='true' form='postfix'></mo></mrow></mrow><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>b</mi></mrow><mrow><mi>h</mi></mrow></msub><mstyle class='text'><mtext> is directly obtained from the polynomial </mtext></mstyle><mi>B</mi>
</mrow></math></td></tr></table>
                                                                                         
                                                                                         
   </figure>
<!-- l. 486 --><p class='noindent'>Note that <!-- l. 486 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>b</mi></mrow><mrow><mi>h</mi></mrow></msub> <mo class='MathClass-bin' stretchy='false'>−</mo><munderover accent='false' accentunder='false'><mrow><mi class='MathClass-op'>∑</mi><mo> ⁡<!-- FUNCTION APPLICATION --></mo>
  </mrow><mrow><mi>i</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>0</mn></mrow><mrow><mi mathvariant='italic'>𝑛𝑘</mi></mrow></munderover><msubsup><mrow><mi>s</mi></mrow><mrow><mi>i</mi></mrow><mrow><mi>′</mi></mrow></msubsup><msubsup><mrow><mi>a</mi></mrow><mrow><mi>i</mi></mrow><mrow><mi>′</mi></mrow></msubsup> <mo class='MathClass-rel' stretchy='false'>=</mo> <mi mathvariant='normal'>Δ</mi><msub><mrow><mi>m</mi></mrow><mrow><mi>h</mi></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>e</mi></mrow><mrow><mi>h</mi></mrow></msub></mrow></math>. This means
that <!-- l. 486 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>C</mi></mrow><mrow><mi>h</mi></mrow></msub></math> can be replaced by
its encrypted version, <!-- l. 486 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><msub><mrow><mover accent='true'><mrow><mi>s</mi></mrow><mo accent='true'>→</mo></mover></mrow><mrow><msup><mrow></mrow><mrow><mi>′</mi></mrow></msup></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mi mathvariant='normal'>Δ</mi><msub><mrow><mi>m</mi></mrow><mrow><mi>h</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>,
an LWE ciphertext <!-- l. 486 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖼𝗍</mtext></mstyle></mrow><mrow><mi>h</mi></mrow></msub></math>
encrypting the <!-- l. 486 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>h</mi></math>-th
coefficient of <!-- l. 486 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>M</mi></math>. Therefore,
we just extracted <!-- l. 486 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><msub><mrow><mover accent='true'><mrow><mi>s</mi></mrow><mo accent='true'>→</mo></mover></mrow><mrow><msup><mrow></mrow><mrow><mi>′</mi></mrow></msup></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mi mathvariant='normal'>Δ</mi><msub><mrow><mi>m</mi></mrow><mrow><mi>h</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
from <!-- l. 486 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖦𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mover accent='true'><mrow><mi>S</mi></mrow><mo accent='true'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mi mathvariant='normal'>Δ</mi><mi>M</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>.
This operation is called coefficient extraction, which does not add a noise, because it simply extracts an
LWE ciphertext by reordering the polynomial of the GLWE ciphertext.
</p><!-- l. 488 --><p class='indent'>   Once we have <!-- l. 488 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><msub><mrow><mover accent='true'><mrow><mi>s</mi></mrow><mo accent='true'>→</mo></mover></mrow><mrow><msup><mrow></mrow><mrow><mi>′</mi></mrow></msup></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mi mathvariant='normal'>Δ</mi><msub><mrow><mi>m</mi></mrow><mrow><mi>h</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>, we
can key-switch it from <!-- l. 488 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mover accent='true'><mrow><mi>s</mi></mrow><mo accent='true'>→</mo></mover></mrow><mrow><msup><mrow></mrow><mrow><mi>′</mi></mrow></msup></mrow></msub> <mo class='MathClass-rel' stretchy='false'>→</mo><mover accent='true'><mrow><mi>s</mi></mrow><mo accent='true'>→</mo></mover></mrow></math>
(<a href='#homomorphic-key-switching'><span class='ts1-lmr10-x-x-109'>§</span>D-1.5<!-- tex4ht:ref: subsec:groupddef  --></a>).
</p>
   <div class='tcolorbox tcolorbox' id='tcolobox-20'>     
<div class='tcolorbox-title'>
<!-- l. 523 --><p class='indent'>   <!-- l. 523 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mstyle mathvariant='bold'><mo class='MathClass-open' stretchy='false'>⟨</mo></mstyle></math><span class='rm-lmbx-10x-x-109'>Summary </span><a href='#coefficient-extraction'><span class='rm-lmbx-10x-x-109'>D-1.7</span><!-- tex4ht:ref: subsec:tfheeextraction  --></a><!-- l. 523 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mstyle mathvariant='bold'><mo class='MathClass-close' stretchy='false'>⟩</mo></mstyle></math>
                                                                                         
                                                                                         
<span class='rm-lmbx-10x-x-109'>GLWE Ciphertext’s Coefficient Extraction</span></p></div> 
<div class='tcolorbox-content'><!-- l. 491 --><p class='noindent'>Given the following GLWE ciphertext:
</p><!-- l. 493 --><p class='noindent'><!-- l. 493 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>M</mi> <mo class='MathClass-rel' stretchy='false'>=</mo><munderover accent='false' accentunder='false'><mrow> <mi class='MathClass-op'>∑</mi><mo> ⁡<!-- FUNCTION APPLICATION --></mo>
  </mrow><mrow><mi>j</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>0</mn></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></munderover><msub><mrow><mi>m</mi></mrow><mrow><mi>j</mi></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mi>j</mi></mrow></msup> <mo class='MathClass-rel' stretchy='false'>∈</mo><msub><mrow><mstyle mathvariant='script'><mi>R</mi></mstyle></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mi>n</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>p</mi><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msub></mrow></math>
</p><!-- l. 495 --><p class='noindent'><!-- l. 495 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mover accent='true'><mrow><mi>S</mi></mrow><mo accent='true'>→</mo></mover> <mo class='MathClass-rel' stretchy='false'>=</mo> <mrow><mo fence='true' form='prefix'>(</mo><mrow><msub><mrow><mi>S</mi></mrow><mrow><mn>0</mn></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo><munderover accent='false' accentunder='false'><mrow> <mi class='MathClass-op'>∑</mi><mo> ⁡<!-- FUNCTION APPLICATION --></mo>
  </mrow><mrow><mi>j</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>0</mn></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></munderover><msub><mrow><mi>s</mi></mrow><mrow><mn>0</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mi>j</mi></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mi>j</mi></mrow></msup><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>S</mi></mrow><mrow><mn>1</mn></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo><munderover accent='false' accentunder='false'><mrow><mo> ∑</mo>
</mrow><mrow><mi>j</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>0</mn></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></munderover><msub><mrow><mi>s</mi></mrow><mrow><mn>1</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mi>j</mi></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mi>j</mi></mrow></msup><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><mstyle class='text'><mtext></mtext><mstyle class='math'><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace></mstyle><mtext></mtext></mstyle><mstyle class='text'><mtext> </mtext></mstyle><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>S</mi></mrow><mrow><mi>k</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo><munderover accent='false' accentunder='false'><mrow><mo> ∑</mo>
</mrow><mrow><mi>j</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>0</mn></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></munderover><msub><mrow><mi>s</mi></mrow><mrow><mi>k</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mi>j</mi></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mi>j</mi></mrow></msup></mrow><mo fence='true' form='postfix'>)</mo></mrow></mrow></math>
</p><!-- l. 497 --><p class='noindent'><!-- l. 497 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖦𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mover accent='true'><mrow><mi>S</mi></mrow><mo accent='true'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mi mathvariant='normal'>Δ</mi><mi>M</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo> <mrow><mo fence='true' form='prefix'>(</mo><mrow><msub><mrow><mi>A</mi></mrow><mrow><mn>0</mn></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo><munderover accent='false' accentunder='false'><mrow> <mi class='MathClass-op'>∑</mi><mo> ⁡<!-- FUNCTION APPLICATION --></mo>
  </mrow><mrow><mi>j</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>0</mn></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></munderover><msub><mrow><mi>a</mi></mrow><mrow><mn>0</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mi>j</mi></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mi>j</mi></mrow></msup><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>A</mi></mrow><mrow><mn>1</mn></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo><munderover accent='false' accentunder='false'><mrow><mo> ∑</mo>
  </mrow><mrow><mi>j</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>0</mn></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></munderover><msub><mrow><mi>a</mi></mrow><mrow><mn>1</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mi>j</mi></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mi>j</mi></mrow></msup><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><mstyle class='text'><mtext></mtext><mstyle class='math'><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace></mstyle><mtext></mtext></mstyle><mstyle class='text'><mtext> </mtext></mstyle><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>A</mi></mrow><mrow><mi>k</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo><munderover accent='false' accentunder='false'><mrow><mo> ∑</mo>
</mrow><mrow><mi>j</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>0</mn></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></munderover><msub><mrow><mi>a</mi></mrow><mrow><mi>k</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mi>j</mi></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mi>j</mi></mrow></msup><mo class='MathClass-punc' stretchy='false'>,</mo><mi>B</mi> <mo class='MathClass-rel' stretchy='false'>=</mo><munderover accent='false' accentunder='false'><mrow><mo> ∑</mo>
</mrow><mrow><mi>j</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>0</mn></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></munderover><msub><mrow><mi>b</mi></mrow><mrow><mi>j</mi></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mi>j</mi></mrow></msup></mrow><mo fence='true' form='postfix'>)</mo></mrow></mrow></math>
</p><!-- l. 499 --><p class='noindent'><!-- l. 499 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>B</mi> <mo class='MathClass-rel' stretchy='false'>=</mo><munderover accent='false' accentunder='false'><mrow> <mi class='MathClass-op'>∑</mi><mo> ⁡<!-- FUNCTION APPLICATION --></mo>
  </mrow><mrow><mi>i</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>0</mn></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></munderover><msub><mrow><mi>A</mi></mrow><mrow><mi>i</mi></mrow></msub><msub><mrow><mi>S</mi></mrow><mrow><mi>i</mi></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi mathvariant='normal'>Δ</mi><mi>M</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>E</mi><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi>q</mi></mrow></math>,
  <!-- l. 499 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>E</mi> <mo class='MathClass-rel' stretchy='false'>=</mo><munderover accent='false' accentunder='false'><mrow> <mi class='MathClass-op'>∑</mi><mo> ⁡<!-- FUNCTION APPLICATION --></mo>
  </mrow><mrow><mi>i</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>0</mn></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></munderover><msub><mrow><mi>e</mi></mrow><mrow><mi>i</mi></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mi>i</mi></mrow></msup></mrow></math>
</p><!-- l. 501 --><p class='noindent'><!-- l. 501 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 503 --><p class='noindent'><!-- l. 503 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><msub><mrow><mover accent='true'><mrow><mi>s</mi></mrow><mo accent='true'>→</mo></mover></mrow><mrow><msup><mrow></mrow><mrow><mi>′</mi></mrow></msup></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mi mathvariant='normal'>Δ</mi><msub><mrow><mi>m</mi></mrow><mrow><mi>h</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
is an LWE ciphertext that encrypts <!-- l. 503 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi mathvariant='normal'>Δ</mi><mi>M</mi></mrow></math>’s
<!-- l. 503 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>h</mi></math>-th
coefficient (i.e., <!-- l. 503 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi mathvariant='normal'>Δ</mi><msub><mrow><mi>m</mi></mrow><mrow><mi>h</mi></mrow></msub></mrow></math>).
<!-- l. 503 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><msub><mrow><mover accent='true'><mrow><mi>s</mi></mrow><mo accent='true'>→</mo></mover></mrow><mrow><msup><mrow></mrow><mrow><mi>′</mi></mrow></msup></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mi mathvariant='normal'>Δ</mi><msub><mrow><mi>m</mi></mrow><mrow><mi>h</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
can be extracted from <!-- l. 503 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖦𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mover accent='true'><mrow><mi>S</mi></mrow><mo accent='true'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mi mathvariant='normal'>Δ</mi><mi>M</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
as follows:
</p><!-- l. 505 --><p class='noindent'><!-- l. 505 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 507 --><p class='noindent'><!-- l. 507 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mover accent='true'><mrow><mi>s</mi></mrow><mo accent='true'>→</mo></mover></mrow><mrow><msup><mrow></mrow><mrow><mi>′</mi></mrow></msup></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>s</mi></mrow><mrow><mn>0</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>0</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>s</mi></mrow><mrow><mn>0</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>1</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><mstyle class='text'><mtext></mtext><mstyle class='math'><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace></mstyle><mtext></mtext></mstyle><mstyle class='text'><mtext> </mtext></mstyle><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>s</mi></mrow><mrow><mn>0</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mi>n</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>s</mi></mrow><mrow><mn>1</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>0</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>s</mi></mrow><mrow><mn>1</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>1</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><mstyle class='text'><mtext></mtext><mstyle class='math'><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace></mstyle><mtext></mtext></mstyle><mstyle class='text'><mtext> </mtext></mstyle><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>s</mi></mrow><mrow><mn>1</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mi>n</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><mstyle class='text'><mtext></mtext><mstyle class='math'><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace></mstyle><mtext></mtext></mstyle><mstyle class='text'><mtext> </mtext></mstyle><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>s</mi></mrow><mrow><mi>k</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mi>n</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>(</mo><msubsup><mrow><mi>s</mi></mrow><mrow><mn>0</mn></mrow><mrow><mi>′</mi></mrow></msubsup><mo class='MathClass-punc' stretchy='false'>,</mo><msubsup><mrow><mi>s</mi></mrow><mrow><mn>1</mn></mrow><mrow><mi>′</mi></mrow></msubsup><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><mstyle class='text'><mtext></mtext><mstyle class='math'><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace></mstyle><mtext></mtext></mstyle><mstyle class='text'><mtext> </mtext></mstyle><mo class='MathClass-punc' stretchy='false'>,</mo><msubsup><mrow><mi>s</mi></mrow><mrow><mi mathvariant='italic'>𝑛𝑘</mi></mrow><mrow><mi>′</mi></mrow></msubsup><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>∈</mo> <msubsup><mrow><mi>ℤ</mi></mrow><mrow><mi>q</mi></mrow><mrow><mi mathvariant='italic'>𝑛𝑘</mi></mrow></msubsup></mrow></math>
</p><!-- l. 509 --><p class='noindent'><!-- l. 509 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><msub><mrow><mover accent='true'><mrow><mi>s</mi></mrow><mo accent='true'>→</mo></mover></mrow><mrow><msup><mrow></mrow><mrow><mi>′</mi></mrow></msup></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mi mathvariant='normal'>Δ</mi><msub><mrow><mi>m</mi></mrow><mrow><mi>h</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>(</mo><msubsup><mrow><mi>a</mi></mrow><mrow><mn>0</mn></mrow><mrow><mi>′</mi></mrow></msubsup><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>a</mi><msup><mrow></mrow><mrow><mn>1</mn></mrow></msup></mrow><mrow><mi>′</mi></mrow><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><mstyle class='text'><mtext></mtext><mstyle class='math'><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace></mstyle><mtext></mtext></mstyle><mstyle class='text'><mtext> </mtext></mstyle><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>a</mi><msup><mrow></mrow><mrow><mi mathvariant='italic'>𝑛𝑘</mi></mrow></msup></mrow><mrow><mi>′</mi></mrow><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>b</mi></mrow><mrow><mi>h</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>∈</mo> <msubsup><mrow><mi>ℤ</mi></mrow><mrow><mi>q</mi></mrow><mrow><mi mathvariant='italic'>𝑛𝑘</mi><mo class='MathClass-bin' stretchy='false'>+</mo><mn>1</mn></mrow></msubsup></msub>
</msub></mrow></math></p>
<table class='equation-star'><tr><td>
<!-- l. 512 --><math class='equation' display='block' xmlns='http://www.w3.org/1998/Math/MathML'><mrow>
<mstyle class='text'><mtext>, where </mtext></mstyle><msubsup><mrow><mi>a</mi></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>⋅</mo><mi>i</mi><mo class='MathClass-bin' stretchy='false'>+</mo><mi>j</mi></mrow><mrow><mi>′</mi></mrow></msubsup> <mo class='MathClass-rel' stretchy='false'>=</mo> <mrow class='cases'> <mrow><mo fence='true' form='prefix'>{</mo><mrow> <mtable align='axis' class='array' columnlines='none' displaystyle='true' equalcolumns='false' equalrows='false' rowlines='none none none none' style=''> <mtr class='array-row'><mtd class='array-td' columnalign='left'><msub><mrow><mi>a</mi></mrow><mrow><mi>i</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>h</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mi>j</mi></mrow></msub><mstyle class='text'><mtext> (if </mtext></mstyle><mn>0</mn> <mo class='MathClass-rel' stretchy='false'>≤</mo><mi>j</mi> <mo class='MathClass-rel' stretchy='false'>≤</mo><mi>h</mi><mstyle class='text'><mtext>)</mtext></mstyle>              <mspace class='quad' width='1em'></mspace></mtd></mtr>  <mtr class='array-row'><mtd class='array-td' columnalign='left'><mspace class='quad' width='1em'></mspace></mtd></mtr>  <mtr class='array-row'><mtd class='array-td' columnalign='left'><mspace class='quad' width='1em'></mspace></mtd>
</mtr>  <mtr class='array-row'><mtd class='array-td' columnalign='left'><msub><mrow><mi>a</mi></mrow><mrow><mi>i</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>n</mi><mo class='MathClass-bin' stretchy='false'>+</mo><mi>h</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mi>j</mi></mrow></msub><mstyle class='text'><mtext> (if </mtext></mstyle><mi>h</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>1</mn> <mo class='MathClass-rel' stretchy='false'>≤</mo><mi>j</mi> <mo class='MathClass-rel' stretchy='false'>≤</mo><mi>n</mi> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn><mstyle class='text'><mtext>)</mtext></mstyle><mspace class='quad' width='1em'></mspace></mtd></mtr>  <mtr class='array-row'><mtd class='array-td' columnalign='left'><mspace class='quad' width='1em'></mspace></mtd></mtr>    <!-- @{}l@{\quad }l@{} --></mtable>                                                                              </mrow><mo fence='true' form='postfix'></mo></mrow></mrow><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>b</mi></mrow><mrow><mi>h</mi></mrow></msub><mstyle class='text'><mtext> is obtained from the polynomial </mtext></mstyle><mi>B</mi>
</mrow></math></td></tr></table>
<!-- l. 521 --><p class='noindent'>Once we have <!-- l. 521 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><msub><mrow><mover accent='true'><mrow><mi>s</mi></mrow><mo accent='true'>→</mo></mover></mrow><mrow><msup><mrow></mrow><mrow><mi>′</mi></mrow></msup></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mi mathvariant='normal'>Δ</mi><msub><mrow><mi>m</mi></mrow><mrow><mi>h</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>,
key-switch it from <!-- l. 521 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mover accent='true'><mrow><mi>s</mi></mrow><mo accent='true'>→</mo></mover></mrow><mrow><msup><mrow></mrow><mrow><mi>′</mi></mrow></msup></mrow></msub> <mo class='MathClass-rel' stretchy='false'>→</mo><mover accent='true'><mrow><mi>s</mi></mrow><mo accent='true'>→</mo></mover></mrow></math>
(<a href='#homomorphic-key-switching'><span class='ts1-lmr10-x-x-109'>§</span>D-1.5<!-- tex4ht:ref: subsec:groupddef  --></a>).
</p>
 
</div> 
</div>
   
   <h4 class='subsectionHead' id='noise-bootstrapping'><span class='titlemark'>D-1.8   </span> <a id='x1-31000D-1.8'></a>Noise Bootstrapping</h4>
<!-- l. 531 --><p class='noindent'><span class='rm-lmbx-10x-x-109'>- Reference:  </span><a href='https://www.zama.ai/post/tfhe-deep-dive-part-4'>TFHE Deep Dive - Part IV - Programmable Bootstrapping</a> <span class='cite'>[<span class='rm-lmbx-10x-x-109'>?</span>]</span>
</p><!-- l. 534 --><p class='indent'>   <!-- l. 534 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 536 --><p class='indent'>   Continuing homomorphic additions of TFHE ciphertexts does not necessarily increase the noise
<!-- l. 536 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>e</mi></math>,
because <!-- l. 536 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>e</mi></math>
                                                                                         
                                                                                         
is randomly generated over the Gaussian distribution, thus adding up many noises would
give the mean value of 0. On the other hand, continuing homomorphic multiplications
increases the noise, because the noise terms get multiplied, growing its magnitude. Thus,
we need to somehow <span class='rm-lmri-10x-x-109'>reset </span>the noise before it trespasses on the higher bits where plaintext
<!-- l. 536 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>m</mi></math> resides
(i.e., preventing the red noise bits from overflowing to the blue plaintext bits as shown in <span class='rm-lmbx-10x-x-109'>??</span>). The process
of re-initializing the noise to a smaller value is called noise bootstrapping.
</p><!-- l. 538 --><p class='indent'>   As explained in the beginning of this section, TFHE uses LWE (which is GLWE with
<!-- l. 538 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>n</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>1</mn></mrow></math>) to encrypt &amp;decrypt a plaintext.
That is, each plaintext is <!-- l. 538 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>m</mi></math>
(a single number), encoded as a zero-degree polynomial. Further, the secret key S that encrypts each
<!-- l. 538 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>m</mi></math> is a
vector <!-- l. 538 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>{</mo><msub><mrow><mi>s</mi></mrow><mrow><mn>0</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>s</mi></mrow><mrow><mn>1</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><mo class='MathClass-rel' stretchy='false'>⋯</mo><mstyle class='text'><mtext> </mtext></mstyle><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>s</mi></mrow><mrow><mi>k</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub><mo class='MathClass-close' stretchy='false'>}</mo></mrow></math>
instead of a polynomial. On the other hand, TFHE’s noise bootstrapping uses homomorphic addition
between GLWE ciphertexts and homomorphic multiplication between GLWE and GGSW
ciphertexts.
</p><!-- l. 542 --><p class='indent'>   Suppose we have a TFHE ciphertext as follows:
</p><!-- l. 544 --><p class='indent'>   <!-- l. 544 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 546 --><p class='indent'>   <!-- l. 546 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mover accent='true'><mrow><mi>s</mi></mrow><mo accent='true'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mi mathvariant='normal'>Δ</mi><mi>m</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>a</mi></mrow><mrow><mn>0</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>a</mi></mrow><mrow><mn>1</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><mstyle class='text'><mtext></mtext><mstyle class='math'><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace></mstyle><mtext></mtext></mstyle><mstyle class='text'><mtext> </mtext></mstyle><msub><mrow><mi>a</mi></mrow><mrow><mi>k</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><mi>b</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
</p><!-- l. 548 --><p class='indent'>   <!-- l. 548 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>b</mi> <mo class='MathClass-rel' stretchy='false'>=</mo><munderover accent='false' accentunder='false'><mrow> <mi class='MathClass-op'>∑</mi><mo> ⁡<!-- FUNCTION APPLICATION --></mo>
  </mrow><mrow><mi>i</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>0</mn></mrow><mrow><mi>k</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></munderover><msub><mrow><mi>a</mi></mrow><mrow><mi>i</mi></mrow></msub><msub><mrow><mi>s</mi></mrow><mrow><mi>i</mi></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi mathvariant='normal'>Δ</mi><mi>m</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>e</mi></mrow><mrow><mi>b</mi></mrow></msub></mrow></math>
</p><!-- l. 550 --><p class='indent'>   <!-- l. 550 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mover accent='true'><mrow><mi>s</mi></mrow><mo accent='true'>→</mo></mover> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>s</mi></mrow><mrow><mn>0</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>s</mi></mrow><mrow><mn>1</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><mstyle class='text'><mtext></mtext><mstyle class='math'><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace></mstyle><mtext></mtext></mstyle><mstyle class='text'><mtext> </mtext></mstyle><msub><mrow><mi>s</mi></mrow><mrow><mi>k</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
</p><!-- l. 552 --><p class='indent'>   <!-- l. 552 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 554 --><p class='indent'>   , where <!-- l. 554 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>e</mi></mrow><mrow><mi>b</mi></mrow></msub></math> is a
big noise accumulated over a series of many ciphertext (or plaintext) multiplications. The goal of noise bootstrapping
is to convert <!-- l. 554 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>a</mi></mrow><mrow><mn>0</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>a</mi></mrow><mrow><mn>0</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><mstyle class='text'><mtext></mtext><mstyle class='math'><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace></mstyle><mtext></mtext></mstyle><mstyle class='text'><mtext> </mtext></mstyle><msub><mrow><mi>a</mi></mrow><mrow><mi>k</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><mi>b</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
into <!-- l. 554 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msubsup><mrow><mi>a</mi></mrow><mrow><mn>0</mn></mrow><mrow><mi>′</mi></mrow></msubsup><mo class='MathClass-punc' stretchy='false'>,</mo><msubsup><mrow><mi>a</mi></mrow><mrow><mn>1</mn></mrow><mrow><mi>′</mi></mrow></msubsup><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><mstyle class='text'><mtext></mtext><mstyle class='math'><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace></mstyle><mtext></mtext></mstyle><mstyle class='text'><mtext> </mtext></mstyle><msubsup><mrow><mi>a</mi></mrow><mrow><mi>k</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow><mrow><mi>′</mi></mrow></msubsup><mo class='MathClass-punc' stretchy='false'>,</mo><msup><mrow><mi>b</mi></mrow><mrow><mi>′</mi></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
such that:
</p><!-- l. 556 --><p class='indent'>   <!-- l. 556 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 558 --><p class='indent'>   <!-- l. 558 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>b</mi></mrow><mrow><mi>′</mi></mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo><munderover accent='false' accentunder='false'><mrow> <mi class='MathClass-op'>∑</mi><mo> ⁡<!-- FUNCTION APPLICATION --></mo>
  </mrow><mrow><mi>i</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>0</mn></mrow><mrow><mi>k</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></munderover><msubsup><mrow><mi>a</mi></mrow><mrow><mi>i</mi></mrow><mrow><mi>′</mi></mrow></msubsup><msub><mrow><mi>s</mi></mrow><mrow><mi>i</mi></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi mathvariant='normal'>Δ</mi><mi>m</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>e</mi></mrow><mrow><mi>s</mi></mrow></msub></mrow></math>
</p><!-- l. 560 --><p class='indent'>   <!-- l. 560 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 562 --><p class='indent'>   , where <!-- l. 562 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>e</mi></mrow><mrow><mi>s</mi></mrow></msub></math>
is a re-initialized noise.
</p><!-- l. 564 --><p class='indent'>   <!-- l. 564 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p>
   <h5 class='subsubsectionHead' id='overview1'><span class='titlemark'>D-1.8.1   </span> <a id='x1-32000D-1.8.1'></a>Overview</h5>
<!-- l. 568 --><p class='noindent'>To implement noise bootstrapping, we create a specially designed
<!-- l. 568 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><mi>n</mi> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>-degree polynomial
<!-- l. 568 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>V</mi> <mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math> called a Lookup Table (LUT).
The polynomial <!-- l. 568 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>V</mi> <mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>’s each
degree term <!-- l. 568 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>X</mi></mrow><mrow><msup><mrow><mi>i</mi></mrow><mrow><mi>′</mi></mrow></msup>
 </mrow></msup></math> has its exponent
<!-- l. 568 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>i</mi></mrow><mrow><mi>′</mi></mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo> <mi mathvariant='normal'>Δ</mi><msub><mrow><mi>m</mi></mrow><mrow><mi>i</mi></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>e</mi></mrow></math>, a noisy plaintext, and its
corresponding coefficient <!-- l. 568 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>v</mi></mrow><mrow><msup><mrow><mi>i</mi></mrow><mrow><mi>′</mi></mrow></msup></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo> <mi mathvariant='normal'>Δ</mi><msub><mrow><mi>m</mi></mrow><mrow><mi>i</mi></mrow></msub></mrow></math>, which is
a noise-free plaintext. Therefore, <!-- l. 568 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>V</mi> <mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
                                                                                         
                                                                                         
is defined as:
</p><!-- l. 570 --><p class='indent'>   <!-- l. 570 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>V</mi> <mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mi>v</mi></mrow><mrow><mn>0</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>v</mi></mrow><mrow><mn>1</mn></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mn>1</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>v</mi></mrow><mrow><mn>2</mn></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mn>2</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <mstyle class='text'><mtext> </mtext></mstyle><mstyle class='text'><mtext></mtext><mstyle class='math'><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace></mstyle><mtext></mtext></mstyle><mstyle class='text'><mtext> </mtext></mstyle> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>v</mi></mrow><mrow><mi>n</mi></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msup></mrow></math>
</p><!-- l. 572 --><p class='indent'>     <!-- l. 572 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mi>m</mi></mrow><mrow><mn>0</mn></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mi mathvariant='normal'>Δ</mi><msub><mrow><mi>m</mi></mrow><mrow><mn>0</mn></mrow></msub><mo class='MathClass-bin' stretchy='false'>+</mo><msub><mrow><mi>e</mi></mrow><mrow><mn>0</mn></mrow></msub></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>m</mi></mrow><mrow><mn>0</mn></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mi mathvariant='normal'>Δ</mi><msub><mrow><mi>m</mi></mrow><mrow><mn>0</mn></mrow></msub><mo class='MathClass-bin' stretchy='false'>+</mo><msub><mrow><mi>e</mi></mrow><mrow><mn>1</mn></mrow></msub></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>m</mi></mrow><mrow><mn>0</mn></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mi mathvariant='normal'>Δ</mi><msub><mrow><mi>m</mi></mrow><mrow><mn>0</mn></mrow></msub><mo class='MathClass-bin' stretchy='false'>+</mo><msub><mrow><mi>e</mi></mrow><mrow><mn>2</mn></mrow></msub></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <mstyle class='text'><mtext> </mtext></mstyle><mstyle class='text'><mtext></mtext><mstyle class='math'><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace></mstyle><mtext></mtext></mstyle><mstyle class='text'><mtext> </mtext></mstyle> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>m</mi></mrow><mrow><mn>0</mn></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mi mathvariant='normal'>Δ</mi><msub><mrow><mi>m</mi></mrow><mrow><mn>0</mn></mrow></msub><mo class='MathClass-bin' stretchy='false'>+</mo><msub><mrow><mi>e</mi></mrow><mrow><mi mathvariant='normal'>Δ</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub></mrow></msup></mrow></math>
</p><!-- l. 574 --><p class='indent'>     <!-- l. 574 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-bin' stretchy='false'>+</mo> <mstyle class='text'><mtext> </mtext></mstyle><msub><mrow><mi>m</mi></mrow><mrow><mn>1</mn></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mi mathvariant='normal'>Δ</mi><msub><mrow><mi>m</mi></mrow><mrow><mn>1</mn></mrow></msub><mo class='MathClass-bin' stretchy='false'>+</mo><msub><mrow><mi>e</mi></mrow><mrow><mn>0</mn></mrow></msub></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>m</mi></mrow><mrow><mn>1</mn></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mi mathvariant='normal'>Δ</mi><msub><mrow><mi>m</mi></mrow><mrow><mn>1</mn></mrow></msub><mo class='MathClass-bin' stretchy='false'>+</mo><msub><mrow><mi>e</mi></mrow><mrow><mn>1</mn></mrow></msub></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>m</mi></mrow><mrow><mn>1</mn></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mi mathvariant='normal'>Δ</mi><msub><mrow><mi>m</mi></mrow><mrow><mn>1</mn></mrow></msub><mo class='MathClass-bin' stretchy='false'>+</mo><msub><mrow><mi>e</mi></mrow><mrow><mn>2</mn></mrow></msub></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <mstyle class='text'><mtext> </mtext></mstyle><mstyle class='text'><mtext></mtext><mstyle class='math'><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace></mstyle><mtext></mtext></mstyle><mstyle class='text'><mtext> </mtext></mstyle> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>m</mi></mrow><mrow><mn>1</mn></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mi mathvariant='normal'>Δ</mi><msub><mrow><mi>m</mi></mrow><mrow><mn>1</mn></mrow></msub><mo class='MathClass-bin' stretchy='false'>+</mo><msub><mrow><mi>e</mi></mrow><mrow><mi mathvariant='normal'>Δ</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub></mrow></msup></mrow></math>
</p><!-- l. 576 --><p class='indent'>     <!-- l. 576 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-bin' stretchy='false'>+</mo> <mstyle class='text'><mtext> </mtext></mstyle><mstyle class='text'><mtext></mtext><mstyle class='math'><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace></mstyle><mtext></mtext></mstyle><mstyle class='text'><mtext> </mtext></mstyle></mrow></math>
</p><!-- l. 578 --><p class='indent'>     <!-- l. 578 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-bin' stretchy='false'>+</mo> <mstyle class='text'><mtext> </mtext></mstyle><msub><mrow><mi>m</mi></mrow><mrow><mi>t</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mi mathvariant='normal'>Δ</mi><msub><mrow><mi>m</mi></mrow><mrow><mi>t</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub><mo class='MathClass-bin' stretchy='false'>+</mo><msub><mrow><mi>e</mi></mrow><mrow><mn>0</mn></mrow></msub></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>m</mi></mrow><mrow><mi>t</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mi mathvariant='normal'>Δ</mi><msub><mrow><mi>m</mi></mrow><mrow><mi>t</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub><mo class='MathClass-bin' stretchy='false'>+</mo><msub><mrow><mi>e</mi></mrow><mrow><mn>1</mn></mrow></msub></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>m</mi></mrow><mrow><mi>t</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mi mathvariant='normal'>Δ</mi><msub><mrow><mi>m</mi></mrow><mrow><mi>t</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub><mo class='MathClass-bin' stretchy='false'>+</mo><msub><mrow><mi>e</mi></mrow><mrow><mn>2</mn></mrow></msub></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <mstyle class='text'><mtext> </mtext></mstyle><mstyle class='text'><mtext></mtext><mstyle class='math'><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace></mstyle><mtext></mtext></mstyle><mstyle class='text'><mtext> </mtext></mstyle> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>m</mi></mrow><mrow><mi>t</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mi mathvariant='normal'>Δ</mi><msub><mrow><mi>m</mi></mrow><mrow><mi>t</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub><mo class='MathClass-bin' stretchy='false'>+</mo><msub><mrow><mi>e</mi></mrow><mrow><mi mathvariant='normal'>Δ</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub></mrow></msup></mrow></math>
</p><!-- l. 580 --><p class='indent'>   <!-- l. 580 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 582 --><p class='indent'>   We design <!-- l. 582 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>V</mi> </mrow></math> to have the
special property that its each <!-- l. 582 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>v</mi></mrow><mrow><msup><mrow><mi>i</mi></mrow><mrow><mi>′</mi></mrow></msup></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><msup><mrow><mi>i</mi></mrow><mrow><mi>′</mi></mrow></msup>
 </mrow></msup></mrow></math>
term has the special mapping of (exponent, coefficient)
<!-- l. 582 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>(</mo><mi mathvariant='normal'>Δ</mi><msub><mrow><mi>m</mi></mrow><mrow><mi>i</mi></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>e</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>m</mi></mrow><mrow><mi>i</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>. During the TFHE setup stage,
we GLWE-encrypt <!-- l. 582 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>V</mi> <mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math> by using
our newly defined GLWE key <!-- l. 582 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mover accent='true'><mrow><mi>S</mi></mrow><mo accent='true'>→</mo></mover></mrow><mrow><mi mathvariant='italic'>𝑘𝑏</mi></mrow></msub></math>,
a <span class='rm-lmri-10x-x-109'>bootstrapping key</span>, which is different from the LWE secret key
<!-- l. 582 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mover accent='true'><mrow><mi>s</mi></mrow><mo accent='true'>→</mo></mover></math>.
<!-- l. 582 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mover accent='true'><mrow><mi>S</mi></mrow><mo accent='true'>→</mo></mover></mrow><mrow><mi mathvariant='italic'>𝑘𝑏</mi></mrow></msub></math> is a list of
<!-- l. 582 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><mi>n</mi> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>-degree
polynomials with binary coefficients. Later, during the noise bootstrapping stage, we rotate the the coefficients
of <!-- l. 582 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>V</mi> </mrow></math> by
<!-- l. 582 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi mathvariant='normal'>Δ</mi><mi>m</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>e</mi></mrow></math> positions to the
left by computing <!-- l. 582 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>V</mi> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>X</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mo class='MathClass-open' stretchy='false'>(</mo><mi mathvariant='normal'>Δ</mi><mi>m</mi><mo class='MathClass-bin' stretchy='false'>+</mo><mi>e</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo> <msup><mrow><mi>V</mi> </mrow><mrow><mi>′</mi></mrow></msup></mrow></math>,
by using the polynomial coefficient rotation method 1 technique (Summary <span class='rm-lmbx-10x-x-109'>??</span>.1 in <span class='rm-lmbx-10x-x-109'>??</span>). Then, we will extract
the polynomial’s constant term’s coefficient (i.e., the left-most 0-degree term’s coefficient in the rotated
<!-- l. 582 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>V</mi> </mrow><mrow><mi>′</mi></mrow></msup></math>)
by using the coefficient extraction technique (<a href='#coefficient-extraction'><span class='ts1-lmr10-x-x-109'>§</span>D-1.7<!-- tex4ht:ref: subsec:coeffrrotation  --></a>). Further, we will encrypt
<!-- l. 582 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>V</mi> <mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
as a GLWE ciphertext at the TFHE setup stage, and thus the rotated
<!-- l. 582 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>V</mi> </mrow><mrow><mi>′</mi></mrow></msup><mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>’s
extracted constant term’s coefficient is an LWE encryption of
<!-- l. 582 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>m</mi></math> (i.e.,
<!-- l. 582 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mover accent='true'><mrow><mi>s</mi></mrow><mo accent='true'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mi mathvariant='normal'>Δ</mi><mi>m</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>) with a
re-initialized noise.
</p><!-- l. 584 --><p class='indent'>   To summarize, the noise bootstrapping procedure can be conceptually understood (at least for now) as
follows:
</p><!-- l. 586 --><p class='indent'>   <!-- l. 586 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 589 --><p class='indent'>
   </p><dl class='enumerate-enumitem'><dt class='enumerate-enumitem'>
1. </dt><dd class='enumerate-enumitem'><span class='rm-lmbx-10x-x-109'>Input: </span><!-- l. 589 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mover accent='true'><mrow><mi>s</mi></mrow><mo accent='true'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mi mathvariant='normal'>Δ</mi><mi>m</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>e</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
   as a noisy ciphertext encrypting <!-- l. 589 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>m</mi></math>
   </dd><dt class='enumerate-enumitem'>
2. </dt><dd class='enumerate-enumitem'>Convert the input into the form of <!-- l. 590 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>X</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mo class='MathClass-open' stretchy='false'>(</mo><mi mathvariant='normal'>Δ</mi><mi>m</mi><mo class='MathClass-bin' stretchy='false'>+</mo><mi>e</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup></math>
   as a rotator of <!-- l. 590 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>V</mi> <mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
   (Lookup Table)
   </dd><dt class='enumerate-enumitem'>
3. </dt><dd class='enumerate-enumitem'>Rotate <!-- l. 591 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>V</mi> </mrow></math>
                                                                                         
                                                                                         
   to the left by <!-- l. 591 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi mathvariant='normal'>Δ</mi><mi>m</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>e</mi></mrow></math>
   positions by computing <!-- l. 591 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>V</mi> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>X</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mo class='MathClass-open' stretchy='false'>(</mo><mi mathvariant='normal'>Δ</mi><mi>m</mi><mo class='MathClass-bin' stretchy='false'>+</mo><mi>e</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo> <msup><mrow><mi>V</mi> </mrow><mrow><mi>′</mi></mrow></msup></mrow></math>
   </dd><dt class='enumerate-enumitem'>
4. </dt><dd class='enumerate-enumitem'>Extract the rotated <!-- l. 592 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>V</mi> </mrow><mrow><mi>′</mi></mrow></msup><mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>’s
   constant term’s coefficient <!-- l. 592 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>m</mi></math>
   as an LWE encryption, which is <!-- l. 592 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mover accent='true'><mrow><mi>s</mi></mrow><mo accent='true'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mi mathvariant='normal'>Δ</mi><mi>m</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
   </dd><dt class='enumerate-enumitem'>
5. </dt><dd class='enumerate-enumitem'><span class='rm-lmbx-10x-x-109'>Output: </span><!-- l. 593 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mover accent='true'><mrow><mi>s</mi></mrow><mo accent='true'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mi mathvariant='normal'>Δ</mi><mi>m</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
   as an LWE encryption of the plaintext <!-- l. 593 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>m</mi></math>
   with a re-initialized noise.</dd></dl>
<!-- l. 596 --><p class='indent'>   <!-- l. 596 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 598 --><p class='indent'>   The final <!-- l. 598 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mover accent='true'><mrow><mi>s</mi></mrow><mo accent='true'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mi mathvariant='normal'>Δ</mi><mi>m</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
can be used for subsequent TFHE homomorphic operations (e.g., addition
or multiplication). During this noise bootstrapping process, the polynomial
<!-- l. 598 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>V</mi> </mrow></math>
is used as a <span class='rm-lmri-10x-x-109'>dictionary </span>that contains the mappings from the noisy plaintext
<!-- l. 598 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi mathvariant='normal'>Δ</mi><mi>m</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>e</mi></mrow></math> (i.e., as
<!-- l. 598 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>i</mi></math> in
<!-- l. 598 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>v</mi></mrow><mrow><mi>i</mi></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mi>i</mi></mrow></msup></mrow></math>) to the noise-free
plaintext <!-- l. 598 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>m</mi></math>
(i.e., as <!-- l. 598 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>v</mi></mrow><mrow><mi>i</mi></mrow></msub></math>
in <!-- l. 598 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>v</mi></mrow><mrow><mi>i</mi></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mi>i</mi></mrow></msup></mrow></math>).
Therefore, <!-- l. 598 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>V</mi> </mrow></math>
is called Lookup Table (LUT).
</p><!-- l. 600 --><p class='indent'>   Then, what should be the degree of <!-- l. 600 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>V</mi> </mrow></math>?
In order for <!-- l. 600 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>V</mi> </mrow></math> to encode all
possible mappings from <!-- l. 600 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi mathvariant='normal'>Δ</mi><mi>m</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>e</mi> <mo class='MathClass-rel' stretchy='false'>∈</mo> <msub><mrow><mi>ℤ</mi></mrow><mrow><mi>q</mi></mrow></msub></mrow></math>
to <!-- l. 600 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>m</mi> <mo class='MathClass-rel' stretchy='false'>∈</mo> <msub><mrow><mi>ℤ</mi></mrow><mrow><mi>t</mi></mrow></msub></mrow></math>, it should be a
<!-- l. 600 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><mi>q</mi> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>-degree polynomial.
However, <!-- l. 600 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>q</mi></math>
is a very big number and it is computationally infeasible to manage a
<!-- l. 600 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><mi>q</mi> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>-degree
polynomial. Thus, in practice, we instead use a much smaller polynomial
<!-- l. 600 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>V</mi> </mrow></math> whose degree is
<!-- l. 600 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>n</mi> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></math>. Remember that according
to our TFHE setup, <!-- l. 600 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>n</mi> <mstyle class='MathClass-rel' stretchy='false'>/mo&gt; <mi>q</mi></mstyle>.
Therefore, we need a way to <span class='rm-lmri-10x-x-109'>compress </span>the big ciphertext space
<!-- l. 600 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi mathvariant='normal'>Δ</mi><mi>m</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>e</mi> <mo class='MathClass-rel' stretchy='false'>∈</mo> <msub><mrow><mi>ℤ</mi></mrow><mrow><mi>q</mi></mrow></msub></math> into the smaller space
<!-- l. 600 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>ℤ</mi></mrow><mrow><mi>n</mi></mrow></msub></math> and encode them
as the exponents of <!-- l. 600 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>X</mi></mrow><mrow><mi>i</mi></mrow></msup></math>
in a <span class='rm-lmri-10x-x-109'>proportionally </span>correct way. For this proportional compression from
<!-- l. 600 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>ℤ</mi></mrow><mrow><mi>q</mi></mrow></msub> <mo class='MathClass-rel' stretchy='false'>→</mo> <msub><mrow><mi>ℤ</mi></mrow><mrow><mi>n</mi></mrow></msub></math>, we will
use the LWE modulus switching technique learned from <span class='rm-lmbx-10x-x-109'>??</span>.
   
                                                                                         
                                                                                         
</mrow></math></p>
   <h5 class='subsubsectionHead' id='modulus-switch-for-noise-boootstrapping'><span class='titlemark'>D-1.8.2   </span> <a id='x1-33000D-1.8.2'></a>Modulus Switch for Noise Boootstrapping</h5>
<!-- l. 605 --><p class='noindent'>We need to compress <!-- l. 605 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>q</mi></math>
possible plaintext elements (<!-- l. 605 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi mathvariant='normal'>Δ</mi><mi>m</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>e</mi> <mo class='MathClass-rel' stretchy='false'>∈</mo> <msub><mrow><mi>ℤ</mi></mrow><mrow><mi>q</mi></mrow></msub></mrow></math>)
as <!-- l. 605 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>n</mi></math> distinct exponents
of the <!-- l. 605 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><mi>n</mi> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>-degree
polynomial <!-- l. 605 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>V</mi> </mrow></math>,
where each <!-- l. 605 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>v</mi></mrow><mrow><mi>i</mi></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mi>i</mi></mrow></msup></mrow></math> term
in <!-- l. 605 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>V</mi> </mrow></math> represents a
mapping from <!-- l. 605 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>i</mi> <mo class='MathClass-rel' stretchy='false'>→</mo><msub><mrow><mi>v</mi></mrow><mrow><mi>i</mi></mrow></msub></mrow></math>
(i.e., noisy plaintext to noise-free plaintext). However, notice that when we rotate the coefficients of the
<!-- l. 605 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><mi>n</mi> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>-degree polynomial
<!-- l. 605 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>V</mi> </mrow></math> to the left, as
<!-- l. 605 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>v</mi></mrow><mrow><mi>i</mi></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mi>i</mi></mrow></msup></mrow></math> rotates around the
boundary between <!-- l. 605 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>X</mi></mrow><mrow><mn>0</mn></mrow></msup></math>
and <!-- l. 605 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>X</mi></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msup></math> degree
terms, <!-- l. 605 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>v</mi></mrow><mrow><mi>i</mi></mrow></msub></math>’s
sign flips to <!-- l. 605 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-bin' stretchy='false'>−</mo><msub><mrow><mi>v</mi></mrow><mrow><mi>i</mi></mrow></msub></mrow></math>
(as shown in the example of <span class='rm-lmbx-10x-x-109'>??</span>). Due to this coefficient sign flip, the
<!-- l. 605 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><mi>n</mi> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>-degree polynomial
<!-- l. 605 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>V</mi> </mrow></math> can encode total
<!-- l. 605 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mn>2</mn><mi>n</mi></mrow></math> distinct coefficient
states as follows: <!-- l. 605 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>v</mi></mrow><mrow><mn>0</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>v</mi></mrow><mrow><mn>1</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>v</mi></mrow><mrow><mn>2</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><mstyle class='text'><mtext></mtext><mstyle class='math'><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace></mstyle><mtext></mtext></mstyle><mstyle class='text'><mtext> </mtext></mstyle><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>v</mi></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-bin' stretchy='false'>−</mo><msub><mrow><mi>v</mi></mrow><mrow><mn>0</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-bin' stretchy='false'>−</mo><msub><mrow><mi>v</mi></mrow><mrow><mn>1</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><mstyle class='text'><mtext></mtext><mstyle class='math'><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace></mstyle><mtext></mtext></mstyle><mstyle class='text'><mtext> </mtext></mstyle><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-bin' stretchy='false'>−</mo><msub><mrow><mi>v</mi></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>. To
move each of these <!-- l. 605 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mn>2</mn><mi>n</mi></mrow></math>
distinct coefficients to the constant term’s position in
<!-- l. 605 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>V</mi> </mrow></math> (i.e., , shifting the coefficient
<!-- l. 605 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>v</mi></mrow><mrow><mi>i</mi></mrow></msub></math> to the leftmost position),
the rotating computation of <!-- l. 605 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>V</mi> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>X</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mi>i</mi></mrow></msup></mrow></math>
can use <!-- l. 605 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mn>2</mn><mi>n</mi></mrow></math> distinct
<!-- l. 605 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>i</mi></math> values, which
are <!-- l. 605 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>{</mo><mn>0</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>1</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>2</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><mstyle class='text'><mtext></mtext><mstyle class='math'><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace></mstyle><mtext></mtext></mstyle><mstyle class='text'><mtext> </mtext></mstyle><mo class='MathClass-punc' stretchy='false'>,</mo><mi>n</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>n</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>1</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><mstyle class='text'><mtext></mtext><mstyle class='math'><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace></mstyle><mtext></mtext></mstyle><mstyle class='text'><mtext> </mtext></mstyle><mo class='MathClass-punc' stretchy='false'>,</mo><mn>2</mn><mi>n</mi><mo class='MathClass-close' stretchy='false'>}</mo></mrow></math>, to move
each of <!-- l. 605 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>v</mi></mrow><mrow><mn>0</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>v</mi></mrow><mrow><mn>1</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>v</mi></mrow><mrow><mn>2</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><mstyle class='text'><mtext></mtext><mstyle class='math'><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace></mstyle><mtext></mtext></mstyle><mstyle class='text'><mtext> </mtext></mstyle><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>v</mi></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-bin' stretchy='false'>−</mo><msub><mrow><mi>v</mi></mrow><mrow><mn>0</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-bin' stretchy='false'>−</mo><msub><mrow><mi>v</mi></mrow><mrow><mn>1</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><mstyle class='text'><mtext></mtext><mstyle class='math'><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace></mstyle><mtext></mtext></mstyle><mstyle class='text'><mtext> </mtext></mstyle><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-bin' stretchy='false'>−</mo><msub><mrow><mi>v</mi></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
coefficients to the constant term’s position. This implies that the exponent
<!-- l. 605 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>i</mi></math> in
<!-- l. 605 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>V</mi> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>X</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mi>i</mi></mrow></msup></mrow></math> can take in
<!-- l. 605 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mn>2</mn><mi>n</mi></mrow></math> distinct values to cover all
possible <!-- l. 605 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mn>2</mn><mi>n</mi></mrow></math> coefficient states. Also,
remember that <!-- l. 605 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>i</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mi mathvariant='normal'>Δ</mi><mi>m</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>e</mi></mrow></math>. Therefore,
we will switch the modulo of <!-- l. 605 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi mathvariant='normal'>Δ</mi><mi>m</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>e</mi></mrow></math>
from <!-- l. 605 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>q</mi> <mo class='MathClass-rel' stretchy='false'>→</mo><mn>2</mn><mi>n</mi></mrow></math>.
Using the LWE modulus switching technique (<span class='rm-lmbx-10x-x-109'>??</span>), our original LWE ciphertext
<!-- l. 605 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mover accent='true'><mrow><mi>s</mi></mrow><mo accent='true'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mi mathvariant='normal'>Δ</mi><mi>m</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>e</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>a</mi></mrow><mrow><mn>0</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>a</mi></mrow><mrow><mn>1</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><mstyle class='text'><mtext></mtext><mstyle class='math'><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace></mstyle><mtext></mtext></mstyle><mstyle class='text'><mtext> </mtext></mstyle><msub><mrow><mi>a</mi></mrow><mrow><mi>k</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><mi>b</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>∈</mo> <msubsup><mrow><mi>ℤ</mi></mrow><mrow><mi>q</mi></mrow><mrow><mi>k</mi><mo class='MathClass-bin' stretchy='false'>+</mo><mn>1</mn></mrow></msubsup></mrow></math> (i.e.,
the initial input to the noise bootstrapping procedure) will be converted into the following:
</p><!-- l. 607 --><p class='indent'>   <!-- l. 607 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
                                                                                         
                                                                                         
</p><!-- l. 609 --><p class='indent'>   <!-- l. 609 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mover accent='true'><mrow><mi>s</mi></mrow><mo accent='true'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true'>^</mo></mover><mi>m</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>â</mi></mrow><mrow><mn>0</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>â</mi></mrow><mrow><mn>1</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><mstyle class='text'><mtext></mtext><mstyle class='math'><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace></mstyle><mtext></mtext></mstyle><mstyle class='text'><mtext> </mtext></mstyle><msub><mrow><mi>â</mi></mrow><mrow><mi>k</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><mover accent='true'><mrow><mi>b</mi></mrow><mo accent='true'>^</mo></mover><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>∈</mo> <msubsup><mrow><mi>ℤ</mi></mrow><mrow><mn>2</mn><mi>n</mi></mrow><mrow><mi>k</mi><mo class='MathClass-bin' stretchy='false'>+</mo><mn>1</mn></mrow></msubsup></mrow></math>
</p><!-- l. 611 --><p class='indent'>   <!-- l. 611 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mover accent='true'><mrow><mi>s</mi></mrow><mo accent='true'>→</mo></mover> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>s</mi></mrow><mrow><mn>0</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>s</mi></mrow><mrow><mn>1</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><mstyle class='text'><mtext></mtext><mstyle class='math'><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace></mstyle><mtext></mtext></mstyle><mstyle class='text'><mtext> </mtext></mstyle><msub><mrow><mi>s</mi></mrow><mrow><mi>k</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>∈</mo> <msubsup><mrow><mi>ℤ</mi></mrow><mrow><mn>2</mn></mrow><mrow><mi>k</mi><mo class='MathClass-bin' stretchy='false'>+</mo><mn>1</mn></mrow></msubsup></mrow></math> <span id='textcolor26'># the secret key
stays the same, as each <!-- l. 611 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>s</mi></mrow><mrow><mi>i</mi></mrow></msub></math>
is binary</span>
</p><!-- l. 613 --><p class='indent'>   <!-- l. 613 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true'>^</mo></mover> <mo class='MathClass-rel' stretchy='false'>=</mo> <mi mathvariant='normal'>Δ</mi><mstyle displaystyle='true'><mfrac><mrow><mn>2</mn><mi>n</mi>
 </mrow><mrow><mi>q</mi> </mrow></mfrac></mstyle> <mo class='MathClass-rel' stretchy='false'>∈</mo> <msub><mrow><mi>ℤ</mi></mrow><mrow><mn>2</mn><mi>n</mi></mrow></msub></mrow></math>
</p><!-- l. 615 --><p class='indent'>   <!-- l. 615 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>â</mi></mrow><mrow><mi>i</mi></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo> <mrow><mo fence='true' form='prefix'>⌈</mo><mrow><msub><mrow><mi>a</mi></mrow><mrow><mi>i</mi></mrow></msub><mstyle displaystyle='true'><mfrac><mrow><mn>2</mn><mi>n</mi>
 </mrow><mrow><mi>q</mi> </mrow></mfrac></mstyle></mrow><mo fence='true' form='postfix'>⌋</mo></mrow> <mo class='MathClass-rel' stretchy='false'>∈</mo> <msub><mrow><mi>ℤ</mi></mrow><mrow><mn>2</mn><mi>n</mi></mrow></msub></mrow></math>
</p><!-- l. 617 --><p class='indent'>   <!-- l. 617 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>ê</mi></mrow><mrow><mi>b</mi></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo> <mrow><mo fence='true' form='prefix'>⌈</mo><mrow><msub><mrow><mi>e</mi></mrow><mrow><mi>b</mi></mrow></msub><mstyle displaystyle='true'><mfrac><mrow><mn>2</mn><mi>n</mi>
 </mrow><mrow><mi>q</mi> </mrow></mfrac></mstyle></mrow><mo fence='true' form='postfix'>⌋</mo></mrow> <mo class='MathClass-rel' stretchy='false'>∈</mo> <msub><mrow><mi>ℤ</mi></mrow><mrow><mn>2</mn><mi>n</mi></mrow></msub></mrow></math>
</p><!-- l. 619 --><p class='indent'>   <!-- l. 619 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mover accent='true'><mrow><mi>b</mi></mrow><mo accent='true'>^</mo></mover> <mo class='MathClass-rel' stretchy='false'>=</mo> <mrow><mo fence='true' form='prefix'>⌈</mo><mrow><mi>b</mi><mstyle displaystyle='true'><mfrac><mrow><mn>2</mn><mi>n</mi>
 </mrow><mrow><mi>q</mi> </mrow></mfrac></mstyle></mrow><mo fence='true' form='postfix'>⌋</mo></mrow> <mo class='MathClass-rel' stretchy='false'>≈</mo><munderover accent='false' accentunder='false'><mrow><mi class='MathClass-op'>∑</mi><mo> ⁡<!-- FUNCTION APPLICATION --></mo>
  </mrow><mrow><mi>i</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>0</mn></mrow><mrow><mi>k</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></munderover><msub><mrow><mi>â</mi></mrow><mrow><mi>i</mi></mrow></msub><msub><mrow><mi>s</mi></mrow><mrow><mi>i</mi></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true'>^</mo></mover><mi>m</mi> <mo class='MathClass-bin' stretchy='false'>+</mo><msub><mrow> <mi>ê</mi></mrow><mrow><mi>b</mi></mrow></msub> <mo class='MathClass-rel' stretchy='false'>∈</mo> <msub><mrow><mi>ℤ</mi></mrow><mrow><mn>2</mn><mi>n</mi></mrow></msub></mrow></math>
</p><!-- l. 623 --><p class='indent'>   <!-- l. 623 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 625 --><p class='noindent'><span class='rm-lmbx-10x-x-109'>The degree of </span><!-- l. 625 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>V</mi> <mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
<span class='rm-lmbx-10x-x-109'>and Security</span>: If our goal were to design the minimal-degree polynomial
<!-- l. 625 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>V</mi> </mrow></math>
whose coefficients map all possible values of the plaintext
<!-- l. 625 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>m</mi></math>, then it would be sufficient
to design a <!-- l. 625 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>t</mi></math>-degree
polynomial <!-- l. 625 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>V</mi> </mrow></math>.
Nonetheless, there are two reasons why we choose the degree of
<!-- l. 625 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>V</mi> </mrow></math> to be
<!-- l. 625 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mn>2</mn><mi>n</mi></mrow></math> instead
of <!-- l. 625 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>t</mi></math>: (1)
greater gap of modulus switch creates more noise, due to the decreasing distance between the plaintext bits
and the noise bits in the ciphertext; (2) to guarantee an enough security level– the higher the polynomial
degree <!-- l. 625 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>n</mi></math>
is, the safer our scheme is against attacks.
   
</p>
   <h5 class='subsubsectionHead' id='halving-the-plaintext-space-to-be-used'><span class='titlemark'>D-1.8.3   </span> <a id='x1-34000D-1.8.3'></a>Halving the Plaintext Space To be Used</h5>
<!-- l. 632 --><p class='noindent'>Problematically, Lookup Table <!-- l. 632 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>V</mi> <mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
polynomial rotates <span class='rm-lmri-10x-x-109'>negacyclically</span>, that is, <!-- l. 632 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>V</mi> <mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo><msup><mrow><mi>X</mi></mrow><mrow><mi>n</mi></mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-bin' stretchy='false'>−</mo><mi>V</mi> <mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
(i.e., coefficients flip their signs with the rotating period of
<!-- l. 632 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>n</mi></math>). More
generally:
</p>
   <figure class='figure'> 

                                                                                         
                                                                                         
                                                                                         
                                                                                         
<table class='equation-star'><tr><td>
<!-- l. 635 --><math class='equation' display='block' xmlns='http://www.w3.org/1998/Math/MathML'><mrow>
<mi>V</mi> <mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>X</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mi>i</mi></mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo> <mi>V</mi> <mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>X</mi></mrow><mrow><mn>2</mn><mi>n</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mi>i</mi></mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo> <mi>V</mi> <mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>X</mi></mrow><mrow><mn>4</mn><mi>n</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mi>i</mi></mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-rel' stretchy='false'>⋯</mo> <mo class='MathClass-rel' stretchy='false'>=</mo> <mi>V</mi> <mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>X</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mo class='MathClass-open' stretchy='false'>(</mo><mi>i</mi><mstyle class='text'><mtext> </mtext></mstyle><mstyle class='text'><mtext>mod 2n)</mtext></mstyle><mstyle class='text'><mtext> </mtext></mstyle></mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo> <mrow class='cases'> <mrow><mo fence='true' form='prefix'>{</mo><mrow> <mtable align='axis' class='array' columnlines='none' displaystyle='true' equalcolumns='false' equalrows='false' rowlines='none none' style=''> <mtr class='array-row'><mtd class='array-td' columnalign='left'><msub><mrow><mi>v</mi></mrow><mrow><mi>i</mi></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>v</mi></mrow><mrow><mi>i</mi><mo class='MathClass-bin' stretchy='false'>+</mo><mn>1</mn></mrow></msub><mi>X</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext>for </mtext></mstyle><mn>0</mn> <mo class='MathClass-rel' stretchy='false'>≤</mo><mi>i</mi> <mstyle class='MathClass-rel' stretchy='false'>/mo&gt; <mi>n</mi>    <mspace class='quad' width='1em'></mspace></mstyle></mtd>  <mtr class='array-row'><mtd class='array-td' columnalign='left'><mspace class='quad' width='1em'></mspace></mtd></mtr>  <mtr class='array-row'><mtd class='array-td' columnalign='left'><mspace class='quad' width='1em'></mspace></mtd>
</mtr>  <mtr class='array-row'><mtd class='array-td' columnalign='left'><mo class='MathClass-bin' stretchy='false'>−</mo><msub><mrow><mi>v</mi></mrow><mrow><mi>i</mi></mrow></msub> <mo class='MathClass-bin' stretchy='false'>−</mo><msub><mrow><mi>v</mi></mrow><mrow><mi>i</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub><mi>X</mi> <mo class='MathClass-bin' stretchy='false'>−</mo><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext>for </mtext></mstyle><mi>n</mi> <mo class='MathClass-rel' stretchy='false'>≤</mo><mi>i</mi> <mstyle class='MathClass-rel' stretchy='false'>/mo&gt; <mn>2</mn><mi>n</mi><mspace class='quad' width='1em'></mspace></mstyle></mtd><!-- @{}l@{\quad }l@{} --></mtr>                                                                        </mtr><mo fence='true' form='postfix'></mo></mtable></mrow>
</mrow></mrow></mrow></math></td>
                                                                                         
                                                                                         
   </tr></table></figure>
<!-- l. 644 --><p class='noindent'>, where <!-- l. 644 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>v</mi></mrow><mrow><mi>i</mi></mrow></msub></math>
denotes the constant term’s coefficient after rotating the polynomial
<!-- l. 644 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>V</mi> <mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math> by
<!-- l. 644 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>i</mi></math> positions to the left.
Problematically, <!-- l. 644 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>v</mi></mrow><mrow><mi>i</mi></mrow></msub></math>
flips its sign whenever its rotation passes the boundary between
<!-- l. 644 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>X</mi></mrow><mrow><mn>0</mn></mrow></msup></math> and
<!-- l. 644 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>X</mi></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msup></math>. After applying modulus
switch (<a href='#modulus-switch-for-noise-boootstrapping'><span class='ts1-lmr10-x-x-109'>§</span>D-1.8.2<!-- tex4ht:ref: subsec:coeffrrotation  --></a>) to <!-- l. 644 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>V</mi> <mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>,
it becomes the following polynomial:
</p><!-- l. 646 --><p class='indent'>   <!-- l. 646 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 648 --><p class='indent'>   <!-- l. 648 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>V</mi> <mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mi>v</mi></mrow><mrow><mn>0</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>v</mi></mrow><mrow><mn>1</mn></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mn>1</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>v</mi></mrow><mrow><mn>2</mn></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mn>2</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <mstyle class='text'><mtext> </mtext></mstyle><mstyle class='text'><mtext></mtext><mstyle class='math'><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace></mstyle><mtext></mtext></mstyle><mstyle class='text'><mtext> </mtext></mstyle> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>v</mi></mrow><mrow><mi>n</mi></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msup></mrow></math>
</p><!-- l. 650 --><p class='indent'>     <!-- l. 650 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mi>m</mi></mrow><mrow><mn>0</mn></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true'>^</mo></mover><msub><mrow><mi>m</mi></mrow><mrow><mn>0</mn></mrow></msub><mo class='MathClass-bin' stretchy='false'>+</mo><mover accent='true'><mrow><msub><mrow><mi>e</mi></mrow><mrow><mn>0</mn></mrow></msub></mrow><mo accent='true'>^</mo></mover></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>m</mi></mrow><mrow><mn>0</mn></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true'>^</mo></mover><msub><mrow><mi>m</mi></mrow><mrow><mn>0</mn></mrow></msub><mo class='MathClass-bin' stretchy='false'>+</mo><mover accent='true'><mrow><msub><mrow><mi>e</mi></mrow><mrow><mn>1</mn></mrow></msub></mrow><mo accent='true'>^</mo></mover></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>m</mi></mrow><mrow><mn>0</mn></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true'>^</mo></mover><msub><mrow><mi>m</mi></mrow><mrow><mn>0</mn></mrow></msub><mo class='MathClass-bin' stretchy='false'>+</mo><mover accent='true'><mrow><msub><mrow><mi>e</mi></mrow><mrow><mn>2</mn></mrow></msub></mrow><mo accent='true'>^</mo></mover></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <mstyle class='text'><mtext> </mtext></mstyle><mstyle class='text'><mtext></mtext><mstyle class='math'><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace></mstyle><mtext></mtext></mstyle><mstyle class='text'><mtext> </mtext></mstyle> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>m</mi></mrow><mrow><mn>0</mn></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true'>^</mo></mover><msub><mrow><mi>m</mi></mrow><mrow><mn>0</mn></mrow></msub><mo class='MathClass-bin' stretchy='false'>+</mo><msub><mrow><mi>ê</mi></mrow><mrow><mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true'>^</mo></mover><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub></mrow></msup></mrow></math>
</p><!-- l. 652 --><p class='indent'>     <!-- l. 652 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-bin' stretchy='false'>+</mo> <mstyle class='text'><mtext> </mtext></mstyle><msub><mrow><mi>m</mi></mrow><mrow><mn>1</mn></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true'>^</mo></mover><msub><mrow><mi>m</mi></mrow><mrow><mn>1</mn></mrow></msub><mo class='MathClass-bin' stretchy='false'>+</mo><mover accent='true'><mrow><msub><mrow><mi>e</mi></mrow><mrow><mn>0</mn></mrow></msub></mrow><mo accent='true'>^</mo></mover></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>m</mi></mrow><mrow><mn>1</mn></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true'>^</mo></mover><msub><mrow><mi>m</mi></mrow><mrow><mn>1</mn></mrow></msub><mo class='MathClass-bin' stretchy='false'>+</mo><mover accent='true'><mrow><msub><mrow><mi>e</mi></mrow><mrow><mn>1</mn></mrow></msub></mrow><mo accent='true'>^</mo></mover></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>m</mi></mrow><mrow><mn>1</mn></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true'>^</mo></mover><msub><mrow><mi>m</mi></mrow><mrow><mn>1</mn></mrow></msub><mo class='MathClass-bin' stretchy='false'>+</mo><mover accent='true'><mrow><msub><mrow><mi>e</mi></mrow><mrow><mn>2</mn></mrow></msub></mrow><mo accent='true'>^</mo></mover></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <mstyle class='text'><mtext> </mtext></mstyle><mstyle class='text'><mtext></mtext><mstyle class='math'><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace></mstyle><mtext></mtext></mstyle><mstyle class='text'><mtext> </mtext></mstyle> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>m</mi></mrow><mrow><mn>1</mn></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true'>^</mo></mover><msub><mrow><mi>m</mi></mrow><mrow><mn>1</mn></mrow></msub><mo class='MathClass-bin' stretchy='false'>+</mo><msub><mrow><mi>ê</mi></mrow><mrow><mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true'>^</mo></mover><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub></mrow></msup></mrow></math>
</p><!-- l. 654 --><p class='indent'>     <!-- l. 654 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-bin' stretchy='false'>+</mo> <mstyle class='text'><mtext> </mtext></mstyle><mstyle class='text'><mtext></mtext><mstyle class='math'><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace></mstyle><mtext></mtext></mstyle><mstyle class='text'><mtext> </mtext></mstyle></mrow></math>
</p><!-- l. 656 --><p class='indent'>     <!-- l. 656 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-bin' stretchy='false'>+</mo> <mstyle class='text'><mtext> </mtext></mstyle><msub><mrow><mi>m</mi></mrow><mrow><mi>t</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true'>^</mo></mover><msub><mrow><mi>m</mi></mrow><mrow><mi>t</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub><mo class='MathClass-bin' stretchy='false'>+</mo><mover accent='true'><mrow><msub><mrow><mi>e</mi></mrow><mrow><mn>0</mn></mrow></msub></mrow><mo accent='true'>^</mo></mover></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>m</mi></mrow><mrow><mi>t</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true'>^</mo></mover><msub><mrow><mi>m</mi></mrow><mrow><mi>t</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub><mo class='MathClass-bin' stretchy='false'>+</mo><mover accent='true'><mrow><msub><mrow><mi>e</mi></mrow><mrow><mn>1</mn></mrow></msub></mrow><mo accent='true'>^</mo></mover></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>m</mi></mrow><mrow><mi>t</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true'>^</mo></mover><msub><mrow><mi>m</mi></mrow><mrow><mi>t</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub><mo class='MathClass-bin' stretchy='false'>+</mo><mover accent='true'><mrow><msub><mrow><mi>e</mi></mrow><mrow><mn>2</mn></mrow></msub></mrow><mo accent='true'>^</mo></mover></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <mstyle class='text'><mtext> </mtext></mstyle><mstyle class='text'><mtext></mtext><mstyle class='math'><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace></mstyle><mtext></mtext></mstyle><mstyle class='text'><mtext> </mtext></mstyle> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>m</mi></mrow><mrow><mi>t</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true'>^</mo></mover><msub><mrow><mi>m</mi></mrow><mrow><mi>t</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub><mo class='MathClass-bin' stretchy='false'>+</mo><msub><mrow><mi>ê</mi></mrow><mrow><mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true'>^</mo></mover><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub></mrow></msup></mrow></math>
</p><!-- l. 658 --><p class='indent'>   <!-- l. 658 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 660 --><p class='noindent'>, where <!-- l. 660 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true'>^</mo></mover><msub><mrow><mi>m</mi></mrow><mrow><mi>t</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo><msub><mrow> <mi>ê</mi></mrow><mrow><mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true'>^</mo></mover><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub> <mo class='MathClass-rel' stretchy='false'>∈</mo> <msub><mrow><mi>ℤ</mi></mrow><mrow><mn>2</mn><mi>n</mi></mrow></msub></mrow></math>
</p><!-- l. 662 --><p class='indent'>   <!-- l. 662 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 664 --><p class='indent'>   Remember that by computing <!-- l. 664 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>V</mi> <mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>X</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><msup><mrow><mi>i</mi></mrow><mrow><mi>′</mi></mrow></msup>
   </mrow></msup></mrow></math>
for <!-- l. 664 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>i</mi></mrow><mrow><mi>′</mi></mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>{</mo><mn>0</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>1</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace><mo class='MathClass-punc' stretchy='false'>,</mo><mi>n</mi> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>}</mo></mrow></math>, we can rotate
<!-- l. 664 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>V</mi> <mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>’s coefficients to the
left by <!-- l. 664 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>{</mo><mn>0</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>1</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-rel' stretchy='false'>⋯</mo><mi>n</mi> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>}</mo></mrow></math> positions.
Also, remember that <!-- l. 664 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>i</mi></mrow><mrow><mi>′</mi></mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo> <mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true'>^</mo></mover><msub><mrow><mi>m</mi></mrow><mrow><mi>t</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo><msub><mrow> <mi>ê</mi></mrow><mrow><mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true'>^</mo></mover><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub></mrow></math>.
For each rotation of <!-- l. 664 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>i</mi></mrow><mrow><mi>′</mi></mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>{</mo><mn>0</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>1</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace><mo class='MathClass-punc' stretchy='false'>,</mo><mi>n</mi> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>}</mo></mrow></math>,
we get the following values as the constant-term coefficient:
</p><!-- l. 666 --><p class='indent'>   <!-- l. 666 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 669 --><p class='indent'>   <!-- l. 669 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 671 --><p class='indent'>   In the above expression, <!-- l. 671 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>e</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msub></math>
is a noise that can range from <!-- l. 671 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>[</mo><mn>0</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true'>^</mo></mover><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>.
Note that all of <!-- l. 671 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true'>^</mo></mover><msub><mrow><mi>m</mi></mrow><mrow><mi>i</mi></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>e</mi></mrow><mrow><mn>0</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true'>^</mo></mover><msub><mrow><mi>m</mi></mrow><mrow><mi>i</mi></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>e</mi></mrow><mrow><mn>1</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace><mo class='MathClass-punc' stretchy='false'>,</mo><mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true'>^</mo></mover><msub><mrow><mi>m</mi></mrow><mrow><mi>i</mi></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>e</mi></mrow><mrow><mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true'>^</mo></mover><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub></mrow></math>
exponents are associated with the same coefficient value,
<!-- l. 671 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>m</mi></mrow><mrow><mi>i</mi></mrow></msub></math>, because their underlying
plaintext <!-- l. 671 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>m</mi></mrow><mrow><mi>i</mi></mrow></msub></math> is the same. This is
why the coefficients for each <!-- l. 671 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>m</mi></mrow><mrow><mi>i</mi></mrow></msub></math>
are redundantly used <!-- l. 671 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true'>^</mo></mover></math>
times in <!-- l. 671 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>V</mi> <mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>.
</p><!-- l. 673 --><p class='indent'>   So far, the above sequence of <!-- l. 673 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>m</mi></mrow><mrow><mn>0</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>m</mi></mrow><mrow><mn>1</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>m</mi></mrow><mrow><mi>t</mi><mo class='MathClass-bin' stretchy='false'>∕</mo><mn>2</mn><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub></mrow></math>
coefficients is what we expect <!-- l. 673 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>V</mi> </mrow><mrow><mi>′</mi></mrow></msup><mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math> to
return for each of <!-- l. 673 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>[</mo><mn>0</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mi>n</mi> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math> rotations (where
each <!-- l. 673 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>m</mi></mrow><mrow><mi>i</mi></mrow></msub> <mo class='MathClass-rel' stretchy='false'>/mo&gt; <msub><mrow><mi>m</mi></mrow><mrow><mi>i</mi><mo class='MathClass-bin' stretchy='false'>+</mo><mn>1</mn></mrow></msub></mo>). However, the coefficient
mappings all break between <!-- l. 673 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mo class='MathClass-open' stretchy='false'>[</mo><mi>n</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mn>2</mn><mi>n</mi> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></math>
rotations, because their coefficients get flipped signs as they pass the term’s boundary from
<!-- l. 673 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>X</mi></mrow><mrow><mn>0</mn></mrow></msup></math> to
                                                                                         
                                                                                         
<!-- l. 673 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>X</mi></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msup></math>, due to the nature of a
polynomial ring modulo <!-- l. 673 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>x</mi></mrow><mrow><mi>n</mi></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></math>:
</mrow></math></p><!-- l. 675 --><p class='indent'>   <!-- l. 675 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 677 --><p class='indent'>   <!-- l. 677 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mover class='msup'><mrow><mover accent='false'><mrow><mover class='msup'><mrow><mover accent='false'><mrow><munder class='msub'><mrow><munder accentunder='false'><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><msub><mrow><mi>m</mi></mrow><mrow><mi>t</mi><mo class='MathClass-bin' stretchy='false'>∕</mo><mn>2</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-bin' stretchy='false'>−</mo><msub><mrow><mi>m</mi></mrow><mrow><mi>t</mi><mo class='MathClass-bin' stretchy='false'>∕</mo><mn>2</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><mstyle class='text'><mtext></mtext><mstyle class='math'><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace></mstyle><mtext></mtext></mstyle><mstyle class='text'><mtext> </mtext></mstyle></mrow><mo>⏟</mo></munder></mrow><mrow><mstyle class='text'><mtext>coeff. of </mtext></mstyle><msup><mrow><mi>X</mi></mrow><mrow><mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true'>^</mo></mover>
   <msub><mrow><mi>m</mi></mrow><mrow><mi>t</mi><mo class='MathClass-bin' stretchy='false'>∕</mo><mn>2</mn></mrow></msub><mo class='MathClass-bin' stretchy='false'>+</mo><msub><mrow><mi>e</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msub>
         </mrow></msup></mrow></munder></mrow><mo>︷</mo></mover></mrow><mrow><mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true'>^</mo></mover><mstyle class='text'><mtext> repetitions</mtext></mstyle></mrow></mover><mover class='msup'><mrow><mover accent='false'><mrow><munder class='msub'><mrow><munder accentunder='false'><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><msub><mrow><mi>m</mi></mrow><mrow>
<mi>t</mi><mo class='MathClass-bin' stretchy='false'>∕</mo><mn>2</mn><mo class='MathClass-bin' stretchy='false'>+</mo><mn>1</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-bin' stretchy='false'>−</mo><msub><mrow><mi>m</mi></mrow><mrow><mi>t</mi><mo class='MathClass-bin' stretchy='false'>∕</mo><mn>2</mn><mo class='MathClass-bin' stretchy='false'>+</mo><mn>1</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><mstyle class='text'><mtext></mtext><mstyle class='math'><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace></mstyle><mtext></mtext></mstyle><mstyle class='text'><mtext> </mtext></mstyle></mrow><mo>⏟</mo></munder></mrow><mrow><mstyle class='text'><mtext>coeff. of </mtext></mstyle><msup><mrow><mi>X</mi></mrow><mrow><mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true'>^</mo></mover><msub><mrow><mi>m</mi></mrow><mrow><mi>t</mi><mo class='MathClass-bin' stretchy='false'>∕</mo><mn>2</mn><mo class='MathClass-bin' stretchy='false'>+</mo><mn>1</mn></mrow></msub><mo class='MathClass-bin' stretchy='false'>+</mo><msub><mrow><mi>e</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msub></mrow></msup></mrow></munder></mrow><mo>︷</mo></mover></mrow><mrow><mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true'>^</mo></mover><mstyle class='text'><mtext> repetitions</mtext></mstyle></mrow></mover><mstyle class='text'><mtext> </mtext></mstyle><mstyle class='text'><mtext></mtext><mstyle class='math'><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace></mstyle><mtext></mtext></mstyle><mstyle class='text'><mtext> </mtext></mstyle><mover class='msup'><mrow><mover accent='false'><mrow><munder class='msub'><mrow><munder accentunder='false'><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><msub><mrow><mi>m</mi></mrow><mrow>
<mi>t</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-bin' stretchy='false'>−</mo><msub><mrow><mi>m</mi></mrow><mrow><mi>t</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><mstyle class='text'><mtext></mtext><mstyle class='math'><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace></mstyle><mtext></mtext></mstyle><mstyle class='text'><mtext> </mtext></mstyle></mrow><mo>⏟</mo></munder></mrow><mrow><mstyle class='text'><mtext>coeff. of </mtext></mstyle><msup><mrow><mi>X</mi></mrow><mrow><mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true'>^</mo></mover><msub><mrow><mi>m</mi></mrow><mrow><mi>t</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub><mo class='MathClass-bin' stretchy='false'>+</mo><msub><mrow><mi>e</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msub></mrow></msup></mrow></munder></mrow><mo>︷</mo></mover></mrow><mrow><mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true'>^</mo></mover><mstyle class='text'><mtext> repetitions</mtext></mstyle></mrow></mover></mrow><mo>︷</mo></mover></mrow><mrow><mstyle class='text'><mtext></mtext><mstyle class='math'><mi>V</mi> <mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo></mstyle><mtext>’s constant term coefficient after each of </mtext><mstyle class='math'><mi>n</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>n</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>1</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-rel' stretchy='false'>⋯</mo><mn>2</mn><mi>n</mi> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mstyle><mtext> rotations</mtext></mstyle></mrow></mover></math>
</p><!-- l. 679 --><p class='indent'>   <!-- l. 679 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 681 --><p class='indent'>   As you see above, the rotated <!-- l. 681 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>V</mi> </mrow><mrow><mi>′</mi></mrow></msup><mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>’s
constant term coefficient shows a negacyclic pattern with the period of
<!-- l. 681 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>n</mi></math>, where the
second <!-- l. 681 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>n</mi></math>
rotation group’s coefficients are the exactly negatived values of the first
<!-- l. 681 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>n</mi></math> rotation
group’s values. Let’s understand why this negacyclic behavior breaks the (exponent, coefficient) =
<!-- l. 681 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true'>^</mo></mover><mi>m</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>ê</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>m</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math> mappings. The semantic
meaning of rotating <!-- l. 681 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>V</mi> <mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
to the left by 1 position means that we increase the value of
<!-- l. 681 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true'>^</mo></mover><msub><mrow><mi>m</mi></mrow><mrow><mi>i</mi></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>e</mi></mrow></math> (i.e., noisy plaintext’s value)
by 1 when we compute <!-- l. 681 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>V</mi> <mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>X</mi></mrow><mrow><mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true'>^</mo></mover><msub><mrow><mi>m</mi></mrow><mrow><mi>i</mi></mrow></msub><mo class='MathClass-bin' stretchy='false'>+</mo><mi>e</mi></mrow></msup></mrow></math>,
and get the rotated <!-- l. 681 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>V</mi> </mrow><mrow><msup><mrow></mrow><mrow><mi>′</mi></mrow></msup></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>’s
constant term coefficient <!-- l. 681 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>m</mi></mrow><mrow><mi>i</mi></mrow></msub></math>
(i.e, the mapped noise-free plaintext). Therefore, as we gradually increase the rotation count of
<!-- l. 681 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>V</mi> </mrow></math> from
<!-- l. 681 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>[</mo><mn>0</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>2</mn><mi>n</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>, the returned
<!-- l. 681 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>m</mi></mrow><mrow><mi>i</mi></mrow></msub></math> should be a value that is either
the same or greater than <!-- l. 681 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>m</mi></mrow><mrow><mi>i</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub></math>, all
the way to <!-- l. 681 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>m</mi></mrow><mrow><mi>t</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub></math>. This constraint
holds for the first-half <!-- l. 681 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>i</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>[</mo><mn>0</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mi>n</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>, as
the rotated <!-- l. 681 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>V</mi> </mrow><mrow><mi>′</mi></mrow></msup><mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>’s constant term
coefficient is <!-- l. 681 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>m</mi></mrow><mrow><mn>0</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>m</mi></mrow><mrow><mn>1</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>m</mi></mrow><mrow><mi>t</mi><mo class='MathClass-bin' stretchy='false'>∕</mo><mn>2</mn><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub></mrow></math>. However,
for the second-half <!-- l. 681 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>i</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>[</mo><mi>n</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mn>2</mn><mi>n</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>, the
rotated <!-- l. 681 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>V</mi> </mrow><mrow><mi>′</mi></mrow></msup><mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>’s constant term
coefficient is <!-- l. 681 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-bin' stretchy='false'>−</mo><msub><mrow><mi>m</mi></mrow><mrow><mn>0</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-bin' stretchy='false'>−</mo><msub><mrow><mi>m</mi></mrow><mrow><mn>1</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-bin' stretchy='false'>−</mo><msub><mrow><mi>m</mi></mrow><mrow><mi>t</mi><mo class='MathClass-bin' stretchy='false'>∕</mo><mn>2</mn><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub></mrow></math>, which violates
our constraint that <!-- l. 681 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>m</mi></mrow><mrow><mi>i</mi></mrow></msub> <mo class='MathClass-rel' stretchy='false'>≤</mo><msub><mrow><mi>m</mi></mrow><mrow><mi>i</mi><mo class='MathClass-bin' stretchy='false'>+</mo><mn>1</mn></mrow></msub></mrow></math>.
Therefore, the combination of the first-half and the second-half domains of
<!-- l. 681 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>i</mi></math>
cannot mathematically implement a continuous modulo value range
<!-- l. 681 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>ℤ</mi></mrow><mrow><mi>t</mi></mrow></msub></math>.
</p><!-- l. 683 --><p class='indent'>   To summarize the problem, <!-- l. 683 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>V</mi> <mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
cannot be used as a complete bootstrapping LUT, because it preserves the correct mappings of (exponent, coefficient)
= <!-- l. 683 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true'>^</mo></mover><mi>m</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>ê</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>m</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math> only for
one half of <!-- l. 683 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>i</mi> <mo class='MathClass-rel' stretchy='false'>∈</mo> <msub><mrow><mi>ℤ</mi></mrow><mrow><mi>t</mi></mrow></msub></mrow></math>,
not for the other half.
</p><!-- l. 685 --><p class='noindent'><span class='rm-lmbx-10x-x-109'>Solution: </span>Fortunately, we have verified that <!-- l. 686 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>V</mi> <mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>’s
mappings of (exponent, coefficient) = <!-- l. 686 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true'>^</mo></mover><mi>m</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>ê</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi mathvariant='normal'>Δ</mi><mi>m</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
preserve their consistency if <!-- l. 686 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>V</mi> <mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
is rotated no more than <!-- l. 686 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>n</mi> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></math>
                                                                                         
                                                                                         
positions. Therefore, the most practical solution for the negacyclic problem of polynomial rotation is to restrict
<!-- l. 686 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>V</mi> <mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math> to be rotated
no more than <!-- l. 686 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>n</mi> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></math>
positions during the noise bootstrapping. To enforce this, we can require the TFHE application
such that while it processes plaintext numbers (in its original plaintext computation logic
without homomorphic computation), the application should ensure to use only some continuous
<!-- l. 686 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mstyle displaystyle='true'><mfrac><mrow> <mi>t</mi>
</mrow><mrow><mn>2</mn></mrow></mfrac></mstyle></math> modulo values within
<!-- l. 686 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>ℤ</mi></mrow><mrow><mi>t</mi></mrow></msub></math>. This enforces the
possible values of <!-- l. 686 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true'>^</mo></mover><mi>m</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>ê</mi></mrow></math>
to be continuous <!-- l. 686 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>n</mi></math>
modulo values within <!-- l. 686 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>ℤ</mi></mrow><mrow><mn>2</mn><mi>n</mi></mrow></msub></math>.
Since LUT <!-- l. 686 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>V</mi> <mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math> is rotated
by computing <!-- l. 686 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>V</mi> <mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>X</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mo class='MathClass-open' stretchy='false'>(</mo><mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true'>^</mo></mover><mi>m</mi><mo class='MathClass-bin' stretchy='false'>+</mo><mi>ê</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup></mrow></math>,
as we restrict <!-- l. 686 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true'>^</mo></mover><mi>m</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>ê</mi></mrow></math>
to be at most <!-- l. 686 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>n</mi> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></math>,
<!-- l. 686 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>V</mi> <mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math> will be rotated
at most <!-- l. 686 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>n</mi> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></math>
positions during the noise bootstrapping. Thus, we can prevent the occurrences of the problematic
<!-- l. 686 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>{</mo><mi>n</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>n</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>1</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><mstyle class='text'><mtext></mtext><mstyle class='math'><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace></mstyle><mtext></mtext></mstyle><mstyle class='text'><mtext> </mtext></mstyle><mo class='MathClass-punc' stretchy='false'>,</mo><mn>2</mn><mi>n</mi> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>}</mo></mrow></math>
rotations that cause coefficient extraction of double-signed contradicting coefficients.
</p><!-- l. 688 --><p class='indent'>   To summarize, at the cost of halving the application’s usable plaintext values to some continuous
<!-- l. 688 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mstyle displaystyle='true'><mfrac><mrow> <mi>t</mi>
</mrow><mrow><mn>2</mn></mrow></mfrac></mstyle></math> modulo values within
<!-- l. 688 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>ℤ</mi></mrow><mrow><mi>t</mi></mrow></msub></math>, we can prevent
<!-- l. 688 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>V</mi> <mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>’s negacyclic rotation problem, and
thereby preserve <!-- l. 688 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>V</mi> <mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>’s correct mappings
of (exponent, coefficient) = <!-- l. 688 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true'>^</mo></mover><mi>m</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>ê</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi mathvariant='normal'>Δ</mi><mi>m</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>.
</p><!-- l. 711 --><p class='indent'>   Considering all these, our final LUT polynomial
<!-- l. 711 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>V</mi> <mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math> is as
follows:
</p>
   <div class='tcolorbox tcolorbox' id='tcolobox-21'>     
<div class='tcolorbox-title'>
<!-- l. 734 --><p class='indent'>   <!-- l. 734 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mstyle mathvariant='bold'><mo class='MathClass-open' stretchy='false'>⟨</mo></mstyle></math><span class='rm-lmbx-10x-x-109'>Summary </span><a href='#halving-the-plaintext-space-to-be-used'><span class='rm-lmbx-10x-x-109'>D-1.8.3</span><!-- tex4ht:ref: subsec:tfhezzeroppadding  --></a><!-- l. 734 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mstyle mathvariant='bold'><mo class='MathClass-close' stretchy='false'>⟩</mo></mstyle></math>
<span class='rm-lmbx-10x-x-109'>Structure  of  Lookup  Table  Polynomial</span>
                                                                                         
                                                                                         
<!-- l. 734 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mstyle mathvariant='bold'><mi>𝐕</mi> <mo class='MathClass-open' stretchy='false'>(</mo><mi>𝐗</mi><mo class='MathClass-close' stretchy='false'>)</mo></mstyle></math></p></div> 
<div class='tcolorbox-content'><!-- l. 715 --><p class='noindent'><!-- l. 715 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 717 --><p class='noindent'><!-- l. 717 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>V</mi> <mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mi>v</mi></mrow><mrow><mn>0</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>v</mi></mrow><mrow><mn>1</mn></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mn>1</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>v</mi></mrow><mrow><mn>2</mn></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mn>2</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <mstyle class='text'><mtext> </mtext></mstyle><mstyle class='text'><mtext></mtext><mstyle class='math'><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace></mstyle><mtext></mtext></mstyle><mstyle class='text'><mtext> </mtext></mstyle> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>v</mi></mrow><mrow><mi>n</mi></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msup></mrow></math>
</p><!-- l. 719 --><p class='noindent'>
<!-- l. 719 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mi>m</mi></mrow><mrow><mn>0</mn></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true'>^</mo></mover><msub><mrow><mi>m</mi></mrow><mrow><mn>0</mn></mrow></msub><mo class='MathClass-bin' stretchy='false'>+</mo><mover accent='true'><mrow><msub><mrow><mi>e</mi></mrow><mrow><mn>0</mn></mrow></msub></mrow><mo accent='true'>^</mo></mover></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>m</mi></mrow><mrow><mn>0</mn></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true'>^</mo></mover><msub><mrow><mi>m</mi></mrow><mrow><mn>0</mn></mrow></msub><mo class='MathClass-bin' stretchy='false'>+</mo><mover accent='true'><mrow><msub><mrow><mi>e</mi></mrow><mrow><mn>1</mn></mrow></msub></mrow><mo accent='true'>^</mo></mover></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>m</mi></mrow><mrow><mn>0</mn></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true'>^</mo></mover><msub><mrow><mi>m</mi></mrow><mrow><mn>0</mn></mrow></msub><mo class='MathClass-bin' stretchy='false'>+</mo><mover accent='true'><mrow><msub><mrow><mi>e</mi></mrow><mrow><mn>2</mn></mrow></msub></mrow><mo accent='true'>^</mo></mover></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <mstyle class='text'><mtext> </mtext></mstyle><mstyle class='text'><mtext></mtext><mstyle class='math'><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace></mstyle><mtext></mtext></mstyle><mstyle class='text'><mtext> </mtext></mstyle> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>m</mi></mrow><mrow><mn>0</mn></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true'>^</mo></mover><msub><mrow><mi>m</mi></mrow><mrow><mn>0</mn></mrow></msub><mo class='MathClass-bin' stretchy='false'>+</mo><msub><mrow><mi>ê</mi></mrow><mrow><mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true'>^</mo></mover><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub></mrow></msup></mrow></math>
</p><!-- l. 721 --><p class='noindent'>
<!-- l. 721 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-bin' stretchy='false'>+</mo> <mstyle class='text'><mtext> </mtext></mstyle><msub><mrow><mi>m</mi></mrow><mrow><mn>1</mn></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true'>^</mo></mover><msub><mrow><mi>m</mi></mrow><mrow><mn>1</mn></mrow></msub><mo class='MathClass-bin' stretchy='false'>+</mo><mover accent='true'><mrow><msub><mrow><mi>e</mi></mrow><mrow><mn>0</mn></mrow></msub></mrow><mo accent='true'>^</mo></mover></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>m</mi></mrow><mrow><mn>1</mn></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true'>^</mo></mover><msub><mrow><mi>m</mi></mrow><mrow><mn>1</mn></mrow></msub><mo class='MathClass-bin' stretchy='false'>+</mo><mover accent='true'><mrow><msub><mrow><mi>e</mi></mrow><mrow><mn>1</mn></mrow></msub></mrow><mo accent='true'>^</mo></mover></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>m</mi></mrow><mrow><mn>1</mn></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true'>^</mo></mover><msub><mrow><mi>m</mi></mrow><mrow><mn>1</mn></mrow></msub><mo class='MathClass-bin' stretchy='false'>+</mo><mover accent='true'><mrow><msub><mrow><mi>e</mi></mrow><mrow><mn>2</mn></mrow></msub></mrow><mo accent='true'>^</mo></mover></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <mstyle class='text'><mtext> </mtext></mstyle><mstyle class='text'><mtext></mtext><mstyle class='math'><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace></mstyle><mtext></mtext></mstyle><mstyle class='text'><mtext> </mtext></mstyle> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>m</mi></mrow><mrow><mn>1</mn></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true'>^</mo></mover><msub><mrow><mi>m</mi></mrow><mrow><mn>1</mn></mrow></msub><mo class='MathClass-bin' stretchy='false'>+</mo><msub><mrow><mi>ê</mi></mrow><mrow><mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true'>^</mo></mover><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub></mrow></msup></mrow></math>
</p><!-- l. 723 --><p class='noindent'>
<!-- l. 723 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-bin' stretchy='false'>+</mo> <mstyle class='text'><mtext> </mtext></mstyle><mstyle class='text'><mtext></mtext><mstyle class='math'><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace></mstyle><mtext></mtext></mstyle><mstyle class='text'><mtext> </mtext></mstyle></mrow></math>
</p><!-- l. 725 --><p class='noindent'>
<!-- l. 725 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>m</mi></mrow><mrow><mi>t</mi><mo class='MathClass-bin' stretchy='false'>∕</mo><mn>2</mn><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true'>^</mo></mover><msub><mrow><mi>m</mi></mrow><mrow><mi>t</mi><mo class='MathClass-bin' stretchy='false'>∕</mo><mn>2</mn><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub><mo class='MathClass-bin' stretchy='false'>+</mo><mover accent='true'><mrow><msub><mrow><mi>e</mi></mrow><mrow><mn>0</mn></mrow></msub></mrow><mo accent='true'>^</mo></mover></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>m</mi></mrow><mrow>
<mi>t</mi><mo class='MathClass-bin' stretchy='false'>∕</mo><mn>2</mn><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true'>^</mo></mover><msub><mrow><mi>m</mi></mrow><mrow><mi>t</mi><mo class='MathClass-bin' stretchy='false'>∕</mo><mn>2</mn><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub><mo class='MathClass-bin' stretchy='false'>+</mo><mover accent='true'><mrow><msub><mrow><mi>e</mi></mrow><mrow><mn>1</mn></mrow></msub></mrow><mo accent='true'>^</mo></mover></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>m</mi></mrow><mrow>
<mi>t</mi><mo class='MathClass-bin' stretchy='false'>∕</mo><mn>2</mn><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true'>^</mo></mover><msub><mrow><mi>m</mi></mrow><mrow><mi>t</mi><mo class='MathClass-bin' stretchy='false'>∕</mo><mn>2</mn><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub><mo class='MathClass-bin' stretchy='false'>+</mo><mover accent='true'><mrow><msub><mrow><mi>e</mi></mrow><mrow><mn>2</mn></mrow></msub></mrow><mo accent='true'>^</mo></mover></mrow></msup></mrow></math>
</p><!-- l. 727 --><p class='noindent'>
<!-- l. 727 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-bin' stretchy='false'>+</mo> <mstyle class='text'><mtext> </mtext></mstyle><mstyle class='text'><mtext></mtext><mstyle class='math'><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace></mstyle><mtext></mtext></mstyle><mstyle class='text'><mtext> </mtext></mstyle> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>m</mi></mrow><mrow><mi>t</mi><mo class='MathClass-bin' stretchy='false'>∕</mo><mn>2</mn><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true'>^</mo></mover><msub><mrow><mi>m</mi></mrow><mrow><mi>t</mi><mo class='MathClass-bin' stretchy='false'>∕</mo><mn>2</mn><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub><mo class='MathClass-bin' stretchy='false'>+</mo><msub><mrow><mi>ê</mi></mrow><mrow><mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true'>^</mo></mover><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub>
                             </mrow></msup></mrow></math>
</p><!-- l. 729 --><p class='noindent'><!-- l. 729 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 731 --><p class='noindent'>, where <!-- l. 731 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true'>^</mo></mover> <mo class='MathClass-rel' stretchy='false'>=</mo> <mi mathvariant='normal'>Δ</mi> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mstyle displaystyle='true'><mfrac><mrow><mn>2</mn><mi>n</mi>
 </mrow><mrow><mi>q</mi> </mrow></mfrac></mstyle></mrow></math>.
The application should ensure that <!-- l. 731 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>m</mi></mrow><mrow><mn>0</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>m</mi></mrow><mrow><mn>1</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>m</mi></mrow><mrow><mi>t</mi><mo class='MathClass-bin' stretchy='false'>∕</mo><mn>2</mn><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub></mrow></math>
is some continuous <!-- l. 731 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mstyle displaystyle='true'><mfrac><mrow> <mi>t</mi>
</mrow><mrow><mn>2</mn></mrow></mfrac></mstyle></math>
modulo values in <!-- l. 731 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>ℤ</mi></mrow><mrow><mi>t</mi></mrow></msub></math>.
This constraint ensures <!-- l. 731 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>V</mi> <mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>’s
rotation positions <!-- l. 731 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true'>^</mo></mover><msub><mrow><mi>m</mi></mrow><mrow><mi>i</mi></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo><msub><mrow> <mi>ê</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msub></mrow></math>
to be at most <!-- l. 731 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>n</mi></math>
continuous possibilities, preventing <!-- l. 731 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>V</mi> <mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
from making more than 1 full-circle rotation that triggers a negacyclic problem.
</p>
 
</div> 
</div>
   
   <h5 class='subsubsectionHead' id='blind-rotation'><span class='titlemark'>D-1.8.4   </span> <a id='x1-35000D-1.8.4'></a>Blind Rotation</h5>
<!-- l. 740 --><p class='noindent'>Blind rotation refers to rotating an <span class='rm-lmri-10x-x-109'>encrypted </span>polynomial’s coefficients so that it is not possible to know
how many positions the polynomial’s coefficients are rotated, and after the rotation, it is not
possible to see which coefficient has moved to which degree term. Blind rotation uses the
basic polynomial rotation method 1 technique (Summary <span class='rm-lmbx-10x-x-109'>??</span> in <span class='rm-lmbx-10x-x-109'>??</span>), with the difference the
<!-- l. 740 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>V</mi> <mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>X</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mi>i</mi></mrow></msup></mrow></math>
computation is done homomorphically.
</p><!-- l. 742 --><p class='indent'>   Note that <!-- l. 742 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>X</mi></mrow><mrow><mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true'>^</mo></mover><mi>m</mi><mo class='MathClass-bin' stretchy='false'>+</mo><msub><mrow><mi>ê</mi></mrow><mrow><mi>b</mi></mrow></msub></mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo> <msup><mrow><mi>X</mi></mrow><mrow><mover accent='true'><mrow><mi>b</mi></mrow><mo accent='true'>^</mo></mover><mo class='MathClass-bin' stretchy='false'>−</mo><msubsup><mrow><mi class='MathClass-op'>∑</mi><mo> ⁡<!-- FUNCTION APPLICATION --></mo><!-- nolimits --></mrow><mrow>
<mi>i</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>0</mn></mrow><mrow><mi>k</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msubsup><msub><mrow><mi>â</mi></mrow><mrow><mi>i</mi></mrow></msub><msub><mrow><mi>s</mi></mrow><mrow><mi>i</mi></mrow></msub>
                        </mrow></msup></mrow></math>, so
we can rotate <!-- l. 742 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>V</mi> </mrow></math>
by computing <!-- l. 742 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>V</mi> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>X</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mo class='MathClass-open' stretchy='false'>(</mo><mover accent='true'><mrow><mi>b</mi></mrow><mo accent='true'>^</mo></mover><mo class='MathClass-bin' stretchy='false'>−</mo><msubsup><mrow><mi class='MathClass-op'>∑</mi><mo> ⁡<!-- FUNCTION APPLICATION --></mo><!-- nolimits --></mrow><mrow>
<mi>i</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>0</mn></mrow><mrow><mi>k</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msubsup><msub><mrow><mi>â</mi></mrow><mrow><mi>i</mi></mrow></msub><msub><mrow><mi>s</mi></mrow><mrow><mi>i</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo>
                               </mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo> <mi>V</mi> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>X</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mover accent='true'><mrow><mi>b</mi></mrow><mo accent='true'>^</mo></mover><mo class='MathClass-bin' stretchy='false'>+</mo><msubsup><mrow><mi class='MathClass-op'>∑</mi><mo> ⁡<!-- FUNCTION APPLICATION --></mo><!-- nolimits --></mrow><mrow>
<mi>i</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>0</mn></mrow><mrow><mi>k</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msubsup><msub><mrow><mi>â</mi></mrow><mrow><mi>i</mi></mrow></msub><msub><mrow><mi>s</mi></mrow><mrow><mi>i</mi></mrow></msub>
                          </mrow></msup></mrow></math>.
In fact, we cannot directly compute the LWE decryption formula
<!-- l. 742 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-bin' stretchy='false'>−</mo><mover accent='true'><mrow><mi>b</mi></mrow><mo accent='true'>^</mo></mover> <mo class='MathClass-bin' stretchy='false'>+</mo><msubsup><mrow> <mi class='MathClass-op'>∑</mi><mo> ⁡<!-- FUNCTION APPLICATION --></mo>
  <!-- nolimits --></mrow><mrow><mi>i</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>0</mn></mrow><mrow><mi>k</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msubsup><msub><mrow><mi>â</mi></mrow><mrow><mi>i</mi></mrow></msub><msub><mrow><mi>s</mi></mrow><mrow><mi>i</mi></mrow></msub></mrow></math> (or
<!-- l. 742 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mover accent='true'><mrow><mi>b</mi></mrow><mo accent='true'>^</mo></mover> <mo class='MathClass-bin' stretchy='false'>−</mo><msubsup><mrow><mi class='MathClass-op'>∑</mi><mo> ⁡<!-- FUNCTION APPLICATION --></mo>
  <!-- nolimits --></mrow><mrow><mi>i</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>0</mn></mrow><mrow><mi>k</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msubsup><msub><mrow><mi>â</mi></mrow><mrow><mi>i</mi></mrow></msub><msub><mrow><mi>s</mi></mrow><mrow><mi>i</mi></mrow></msub></mrow></math>) without the knowledge
of the LWE secret key <!-- l. 742 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>S</mi></math>.
Nevertheless, there is a mathematical walk-around to compute
<!-- l. 742 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>V</mi> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>X</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mover accent='true'><mrow><mi>b</mi></mrow><mo accent='true'>^</mo></mover><mo class='MathClass-bin' stretchy='false'>+</mo><msubsup><mrow><mi class='MathClass-op'>∑</mi><mo> ⁡<!-- FUNCTION APPLICATION --></mo><!-- nolimits --></mrow><mrow>
<mi>i</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>0</mn></mrow><mrow><mi>k</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msubsup><msub><mrow><mi>â</mi></mrow><mrow><mi>i</mi></mrow></msub><msub><mrow><mi>s</mi></mrow><mrow><mi>i</mi></mrow></msub>
                          </mrow></msup></mrow></math> without the knowledge of the
secret key <!-- l. 742 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>S</mi></math>, provided we are given
<!-- l. 742 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msubsup><mrow><mo class='MathClass-open' stretchy='false'>{</mo><mi mathvariant='italic'>𝐺𝐺𝑆</mi><msubsup><mrow><mi>W</mi></mrow><mrow><msub><mrow><mover accent='true'><mrow><mi>S</mi></mrow><mo accent='true'>→</mo></mover></mrow><mrow><mi mathvariant='italic'>𝑏𝑘</mi></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow><mrow><mi>β</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>l</mi></mrow></msubsup><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>s</mi></mrow><mrow><mi>i</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-close' stretchy='false'>}</mo></mrow><mrow><mi>i</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>0</mn></mrow><mrow><mi>k</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msubsup></math> at the TFHE setup stage. Note
                                                                                         
                                                                                         
that <!-- l. 742 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msubsup><mrow><mo class='MathClass-open' stretchy='false'>{</mo><mi mathvariant='italic'>𝐺𝐺𝑆</mi><msubsup><mrow><mi>W</mi></mrow><mrow><msub><mrow><mover accent='true'><mrow><mi>S</mi></mrow><mo accent='true'>→</mo></mover></mrow><mrow><mi mathvariant='italic'>𝑏𝑘</mi></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow><mrow><mi>β</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>l</mi></mrow></msubsup><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>s</mi></mrow><mrow><mi>i</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-close' stretchy='false'>}</mo></mrow><mrow><mi>i</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>0</mn></mrow><mrow><mi>k</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msubsup></math> is an GGSW encryption of
the LWE secret key <!-- l. 742 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>S</mi></math>, encrypted
by the GLWE secret key <!-- l. 742 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mover accent='true'><mrow><mi>S</mi></mrow><mo accent='true'>→</mo></mover></mrow><mrow><mi mathvariant='italic'>𝑏𝑘</mi></mrow></msub></math> (i.e.,
a <span class='rm-lmri-10x-x-109'>bootstrapping </span>key). We use <!-- l. 742 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mover accent='true'><mrow><mi>S</mi></mrow><mo accent='true'>→</mo></mover></mrow><mrow><mi mathvariant='italic'>𝑏𝑘</mi></mrow></msub></math> to
homomorphically compute <!-- l. 742 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>V</mi> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>X</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mover accent='true'><mrow><mi>b</mi></mrow><mo accent='true'>^</mo></mover><mo class='MathClass-bin' stretchy='false'>+</mo><msubsup><mrow><mi class='MathClass-op'>∑</mi><mo> ⁡<!-- FUNCTION APPLICATION --></mo><!-- nolimits --></mrow><mrow>
<mi>i</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>0</mn></mrow><mrow><mi>k</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msubsup><msub><mrow><mi>â</mi></mrow><mrow><mi>i</mi></mrow></msub><msub><mrow><mi>s</mi></mrow><mrow><mi>i</mi></mrow></msub>
                          </mrow></msup></mrow></math> (i.e.,
blindly rotate the coefficients of <!-- l. 742 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>V</mi> </mrow></math>
to the left by <!-- l. 742 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mover accent='true'><mrow><mi>b</mi></mrow><mo accent='true'>^</mo></mover> <mo class='MathClass-bin' stretchy='false'>+</mo><msubsup><mrow> <mi class='MathClass-op'>∑</mi><mo> ⁡<!-- FUNCTION APPLICATION --></mo>
  <!-- nolimits --></mrow><mrow><mi>i</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>0</mn></mrow><mrow><mi>k</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msubsup><msub><mrow><mi>â</mi></mrow><mrow><mi>i</mi></mrow></msub><msub><mrow><mi>s</mi></mrow><mrow><mi>i</mi></mrow></msub></mrow></math>
positions), according to the following procedure:
</p><!-- l. 745 --><p class='indent'>
   </p><dl class='enumerate-enumitem'><dt class='enumerate-enumitem'>
1. </dt><dd class='enumerate-enumitem'>GLWE-encrypt the polynomial <!-- l. 745 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>V</mi> </mrow></math>
   with the bootstrapping key <!-- l. 745 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mover accent='true'><mrow><mi>S</mi></mrow><mo accent='true'>→</mo></mover></mrow><mrow><mi mathvariant='italic'>𝑏𝑘</mi></mrow></msub></math>
   at the TFHE setup stage, so that each coefficient of <!-- l. 745 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>V</mi> </mrow></math>
   gets encrypted.
   </dd><dt class='enumerate-enumitem'>
2. </dt><dd class='enumerate-enumitem'>Compute <!-- l. 746 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>V</mi> </mrow><mrow><mn>0</mn></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo> <mi>V</mi> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>X</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mover accent='true'><mrow><mi>b</mi></mrow><mo accent='true'>^</mo></mover></mrow></msup></mrow></math>,
   which is basically rotating <!-- l. 746 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>V</mi> </mrow></math>’s
   polynomials by <!-- l. 746 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mover accent='true'><mrow><mi>b</mi></mrow><mo accent='true'>^</mo></mover></math>
   positions to the left. Since <!-- l. 746 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mover accent='true'><mrow><mi>b</mi></mrow><mo accent='true'>^</mo></mover></math>
   is  a  known  value  visible  in  the  LWE  ciphertext,  we  can  directly  compute  the  rotation  of
   <!-- l. 746 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>V</mi> </mrow><mrow><mn>0</mn></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo> <mi>V</mi> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>X</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mover accent='true'><mrow><mi>b</mi></mrow><mo accent='true'>^</mo></mover></mrow></msup></mrow></math>.
   </dd><dt class='enumerate-enumitem'>
3. </dt><dd class='enumerate-enumitem'>Compute <!-- l. 747 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>V</mi> </mrow><mrow><mn>1</mn></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mi>V</mi> </mrow><mrow><mn>0</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>X</mi></mrow><mrow><msub><mrow><mi>â</mi></mrow><mrow><mn>0</mn></mrow></msub><msub><mrow><mi>s</mi></mrow><mrow><mn>0</mn></mrow></msub></mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mi>s</mi></mrow><mrow><mn>0</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>V</mi> </mrow><mrow><mn>0</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>X</mi></mrow><mrow><msub><mrow><mi>â</mi></mrow><mrow><mn>0</mn></mrow></msub></mrow></msup> <mo class='MathClass-bin' stretchy='false'>−</mo><msub><mrow><mi>V</mi> </mrow><mrow><mn>0</mn></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>V</mi> </mrow><mrow><mn>0</mn></mrow></msub></mrow></math>.
   This formula works for the special case where <!-- l. 748 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>s</mi></mrow><mrow><mn>0</mn></mrow></msub> <mo class='MathClass-rel' stretchy='false'>∈</mo><mo class='MathClass-open' stretchy='false'>{</mo><mn>0</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>}</mo></mrow></math>:
   if <!-- l. 748 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>s</mi></mrow><mrow><mn>0</mn></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>0</mn></mrow></math>,
   then <!-- l. 748 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>V</mi> </mrow><mrow><mn>1</mn></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mi>V</mi> </mrow><mrow><mn>0</mn></mrow></msub></mrow></math>;
   else if <!-- l. 748 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>s</mi></mrow><mrow><mn>0</mn></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>1</mn></mrow></math>,
   then <!-- l. 748 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>V</mi> </mrow><mrow><mn>1</mn></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mi>V</mi> </mrow><mrow><mn>0</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>X</mi></mrow><mrow><msub><mrow><mi>â</mi></mrow><mrow><mn>0</mn></mrow></msub></mrow></msup></mrow></math>.
   Computing <!-- l. 748 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>s</mi></mrow><mrow><mn>0</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>V</mi> </mrow><mrow><mn>0</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>X</mi></mrow><mrow><msub><mrow><mi>â</mi></mrow><mrow><mn>0</mn></mrow></msub></mrow></msup> <mo class='MathClass-bin' stretchy='false'>−</mo><msub><mrow><mi>V</mi> </mrow><mrow><mn>0</mn></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>V</mi> </mrow><mrow><mn>0</mn></mrow></msub></mrow></math>
   is done as a TFHE homomorphic addition and multiplication. We call this blind rotation of
   <!-- l. 748 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>V</mi> </mrow><mrow><mn>0</mn></mrow></msub></math>,
   where the selection bit <!-- l. 748 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>s</mi></mrow><mrow><mn>0</mn></mrow></msub></math>
   (i.e., the 1st element of the secret key vector <!-- l. 748 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>S</mi></math>)
   is encrypted as a GGSW ciphertext by using <!-- l. 748 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mover accent='true'><mrow><mi>S</mi></mrow><mo accent='true'>→</mo></mover></mrow><mrow><mi mathvariant='italic'>𝑏𝑘</mi></mrow></msub></math>
   (i.e. the bootstrapping key) and <!-- l. 748 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>V</mi> </mrow><mrow><mn>0</mn></mrow></msub></math>
   is an encrypted polynomial as a GLWE ciphertext. Multiplying GLWE-encrypted <!-- l. 748 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>V</mi> </mrow><mrow><mn>0</mn></mrow></msub></math>
   with <!-- l. 748 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>x</mi></mrow><mrow><msub><mrow><mi>â</mi></mrow><mrow><mn>0</mn></mrow></msub></mrow></msup></math>
   is done by GLWE ciphertext-to-plaintext multiplication (<span class='rm-lmbx-10x-x-109'>??</span>), and subtracting the result by
   GLWE-encrypted <!-- l. 748 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>V</mi> </mrow><mrow><mn>0</mn></mrow></msub></math>
   is done by GLWE ciphertext-to-ciphertext addition/subtraction (<span class='rm-lmbx-10x-x-109'>??</span>), and multiplying the result
   by GGSW-encrypted <!-- l. 748 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>s</mi></mrow><mrow><mn>0</mn></mrow></msub></math>
   is done by GLWE-to-GGSW multiplication (<a href='#generalization-to-glwetoggsw-multiplication'><span class='ts1-lmr10-x-x-109'>§</span>D-1.6.2<!-- tex4ht:ref: subsec:coeffrrotation  --></a>), and adding the result with GLWE-encrypted
   <!-- l. 748 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>V</mi> </mrow><mrow><mn>0</mn></mrow></msub></math>
   is done by GLWE ciphertext-to-ciphertext addition. If <!-- l. 748 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>s</mi></mrow><mrow><mn>0</mn></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>1</mn></mrow></math>,
   then the formula’s <!-- l. 748 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>X</mi></mrow><mrow><msub><mrow><mi>â</mi></mrow><mrow><mn>0</mn></mrow></msub></mrow></msup></math>
                                                                                         
                                                                                         
   term gets multiplied to <!-- l. 748 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>V</mi> </mrow><mrow><mn>0</mn></mrow></msub></math>,
   which effectively rotates <!-- l. 748 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>V</mi> </mrow><mrow><mn>0</mn></mrow></msub></math>’s
   coefficients by <!-- l. 748 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>â</mi></mrow><mrow><mn>0</mn></mrow></msub></math>
   positions to the right. Else if <!-- l. 748 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>s</mi></mrow><mrow><mn>0</mn></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>0</mn></mrow></math>,
   then <!-- l. 748 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>V</mi> </mrow><mrow><mn>0</mn></mrow></msub></math>
   does not get rotated and stays the same. In both cases, the resulting <!-- l. 748 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>V</mi> </mrow><mrow><mn>1</mn></mrow></msub></math>
   is encrypted as a new GLWE ciphertext. During this blind rotation, unless we have the knowledge
   of <!-- l. 748 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>s</mi></mrow><mrow><mn>0</mn></mrow></msub></math>
   and <!-- l. 748 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mover accent='true'><mrow><mi>S</mi></mrow><mo accent='true'>→</mo></mover></mrow><mrow><mi mathvariant='italic'>𝑏𝑘</mi></mrow></msub></math>,
   it is impossible to know whether <!-- l. 748 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>V</mi> </mrow><mrow><mn>0</mn></mrow></msub></math>
   has been rotated or not, and also how many positions have been rotated.
   </dd><dt class='enumerate-enumitem'>
4. </dt><dd class='enumerate-enumitem'>By using the same blind rotation method as in the previous step, compute the GLWE encryption
   of <!-- l. 749 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>V</mi> </mrow><mrow><mn>2</mn></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mi>V</mi> </mrow><mrow><mn>1</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>X</mi></mrow><mrow><msub><mrow><mi>â</mi></mrow><mrow><mn>1</mn></mrow></msub><msub><mrow><mi>s</mi></mrow><mrow><mn>1</mn></mrow></msub></mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mi>s</mi></mrow><mrow><mn>1</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>V</mi> </mrow><mrow><mn>1</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msubsup><mrow><mi>X</mi></mrow><mrow><mn>1</mn></mrow><mrow><mi>â</mi></mrow></msubsup> <mo class='MathClass-bin' stretchy='false'>−</mo><msub><mrow><mi>V</mi> </mrow><mrow><mn>1</mn></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>V</mi> </mrow><mrow><mn>1</mn></mrow></msub></mrow></math>.
   Note that we have the following publicly known components: <!-- l. 749 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>â</mi></mrow><mrow><mn>1</mn></mrow></msub></math>,
   a GLWE encryption of <!-- l. 749 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>V</mi> </mrow><mrow><mn>1</mn></mrow></msub></math>,
   and a GGSW ciphertext of <!-- l. 749 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>s</mi></mrow><mrow><mn>1</mn></mrow></msub></math>
   encrypted by using <!-- l. 749 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mover accent='true'><mrow><mi>S</mi></mrow><mo accent='true'>→</mo></mover></mrow><mrow><mi mathvariant='italic'>𝑏𝑘</mi></mrow></msub></math>.
   </dd><dt class='enumerate-enumitem'>
5. </dt><dd class='enumerate-enumitem'>Continue to compute the GLWE encryption of <!-- l. 750 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>V</mi> </mrow><mrow><mn>3</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>V</mi> </mrow><mrow><mn>4</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><mstyle class='text'><mtext></mtext><mstyle class='math'><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace></mstyle><mtext></mtext></mstyle><mstyle class='text'><mtext> </mtext></mstyle><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>V</mi> </mrow><mrow><mi>k</mi></mrow></msub></mrow></math>
   in the same manner, and we finally get a GLWE encryption of <!-- l. 750 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>V</mi> </mrow><mrow><mi>k</mi></mrow></msub></math>,
   whose computed value is equivalent to:
   <!-- l. 752 --><p class='noindent'><!-- l. 752 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>V</mi> </mrow><mrow><mi>′</mi></mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mi>V</mi> </mrow><mrow><mi>k</mi></mrow></msub></mrow></math>
   </p><!-- l. 754 --><p class='noindent'><!-- l. 754 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mstyle class='text'><mtext> </mtext></mstyle> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mi>V</mi> </mrow><mrow><mi>k</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>X</mi></mrow><mrow><msub><mrow><mi>â</mi></mrow><mrow><mi>k</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub><msub><mrow><mi>s</mi></mrow><mrow><mi>k</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub></mrow></msup></mrow></math>
   </p><!-- l. 756 --><p class='noindent'><!-- l. 756 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mstyle class='text'><mtext> </mtext></mstyle> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mi>V</mi> </mrow><mrow><mn>0</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>X</mi></mrow><mrow><msub><mrow><mi>â</mi></mrow><mrow><mn>0</mn></mrow></msub><msub><mrow><mi>s</mi></mrow><mrow><mn>0</mn></mrow></msub></mrow></msup><msup><mrow><mi>X</mi></mrow><mrow><msub><mrow><mi>â</mi></mrow><mrow><mn>1</mn></mrow></msub><msub><mrow><mi>s</mi></mrow><mrow><mn>1</mn></mrow></msub></mrow></msup><mo class='MathClass-rel' stretchy='false'>⋯</mo><msup><mrow><mi>X</mi></mrow><mrow><msub><mrow><mi>â</mi></mrow><mrow><mi>k</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub><msub><mrow><mi>s</mi></mrow><mrow><mi>k</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub></mrow></msup></mrow></math>
   </p><!-- l. 758 --><p class='noindent'><!-- l. 758 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mstyle class='text'><mtext> </mtext></mstyle> <mo class='MathClass-rel' stretchy='false'>=</mo> <mi>V</mi> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>X</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mover accent='true'><mrow><mi>b</mi></mrow><mo accent='true'>^</mo></mover><mo class='MathClass-bin' stretchy='false'>+</mo><msubsup><mrow><mi class='MathClass-op'>∑</mi><mo> ⁡<!-- FUNCTION APPLICATION --></mo><!-- nolimits --></mrow><mrow>
<mi>i</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>0</mn></mrow><mrow><mi>k</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msubsup><msub><mrow><mi>â</mi></mrow><mrow><mi>i</mi></mrow></msub><msub><mrow><mi>s</mi></mrow><mrow><mi>i</mi></mrow></msub>
                          </mrow></msup></mrow></math>
   </p><!-- l. 760 --><p class='noindent'><!-- l. 760 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mstyle class='text'><mtext> </mtext></mstyle> <mo class='MathClass-rel' stretchy='false'>=</mo> <mi>V</mi> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>X</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mo class='MathClass-open' stretchy='false'>(</mo><mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true'>^</mo></mover><mi>m</mi><mo class='MathClass-bin' stretchy='false'>+</mo><msub><mrow><mi>ê</mi></mrow><mrow><mi>b</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup></mrow></math>
</p>
   </dd></dl>
<!-- l. 764 --><p class='indent'>   This means that the GLWE encryption of the final polynomial
<!-- l. 764 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>V</mi> </mrow><mrow><mi>k</mi></mrow></msub></math> will have the coefficient
<!-- l. 764 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>m</mi></math> in its constant term,
as <!-- l. 764 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>V</mi> <mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math> is designed to
have the mapping (<!-- l. 764 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true'>^</mo></mover><mi>m</mi> <mo class='MathClass-bin' stretchy='false'>+</mo><msub><mrow> <mi>ê</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><mi>m</mi></mrow></math>).
</p><!-- l. 766 --><p class='indent'>   Note that while we restrict the application’s plaintext space usage to some continuous
<!-- l. 766 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mstyle displaystyle='true'><mfrac><mrow> <mi>t</mi>
</mrow><mrow><mn>2</mn></mrow></mfrac></mstyle></math> modulo
values within <!-- l. 766 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>ℤ</mi></mrow><mrow><mi>t</mi></mrow></msub></math>
(<a href='#halving-the-plaintext-space-to-be-used'><span class='ts1-lmr10-x-x-109'>§</span>D-1.8.3<!-- tex4ht:ref: subsec:coeffrrotation  --></a>), this restriction does not exist in the ciphertext space. That is, it is okay for blind rotations to
rotate <!-- l. 766 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>V</mi> <mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
more than <!-- l. 766 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>n</mi></math>
positions during the intermediate steps, because their invalid positions can be brought back to valid ones by
their subsequent steps. Therefore, what matters for the noise bootstrapping correctness is only the completed
state <!-- l. 766 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>V</mi> </mrow><mrow><mi>k</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>. The
rotation-completed <!-- l. 766 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>V</mi> </mrow><mrow><mi>k</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
must have been rotated <!-- l. 766 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true'>^</mo></mover><mi>m</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>ê</mi></mrow></math>
                                                                                         
                                                                                         
positions to the left. Therefore, we only need to ensure that
<!-- l. 766 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true'>^</mo></mover><mi>m</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>ê</mi></mrow></math> falls within our
pre-defined continuous <!-- l. 766 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mstyle displaystyle='true'><mfrac><mrow> <mi>t</mi>
</mrow><mrow><mn>2</mn></mrow></mfrac></mstyle></math>
modulo range within the <!-- l. 766 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>ℤ</mi></mrow><mrow><mi>t</mi></mrow></msub></math>
domain, which is equivalent to ensuring that the aggregate rotation count is at most
<!-- l. 766 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>n</mi> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></math>
positions to avoid coefficient extraction of any double-signed contradicting coefficients.
</p>
   <figure class='figure'> 

                                                                                         
                                                                                         
                                                                                         
                                                                                         
<!-- l. 770 --><p class='noindent' id='an-illustration-of-the-mux-logic-gate-'> <img alt='PIC' src='figures/mux-.png' /> <a id='x1-35006r1'></a></p>
<figcaption class='caption'><span class='id'>Figure 1: </span><span class='content'>An illustration of the MUX logic gate                                              </span></figcaption><!-- tex4ht:label?: x1335006r1  -->
                                                                                         
                                                                                         
   </figure>
<!-- l. 775 --><p class='noindent'><span class='rm-lmbx-10x-x-109'>Homomorphic MUX Logic Gate: </span>In step 3, the formula
<!-- l. 775 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>s</mi></mrow><mrow><mn>0</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>V</mi> </mrow><mrow><mn>0</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>X</mi></mrow><mrow><msub><mrow><mi>â</mi></mrow><mrow><mn>0</mn></mrow></msub></mrow></msup> <mo class='MathClass-bin' stretchy='false'>−</mo><msub><mrow><mi>V</mi> </mrow><mrow><mn>0</mn></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>V</mi> </mrow><mrow><mn>0</mn></mrow></msub></mrow></math>
implements the MUX logic gate as shown in <a href='#an-illustration-of-the-mux-logic-gate-'>Figure 1<!-- tex4ht:ref: subsec:coeffrrotation  --></a>, where in our case
<!-- l. 775 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>s</mi></mrow><mrow><mn>0</mn></mrow></msub></math> is the selection bit that chooses
between the two inputs: <!-- l. 775 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>V</mi> </mrow><mrow><mn>0</mn></mrow></msub></math>
and <!-- l. 775 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>V</mi> </mrow><mrow><mn>0</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>X</mi></mrow><mrow><msub><mrow><mi>â</mi></mrow><mrow><mn>0</mn></mrow></msub></mrow></msup></mrow></math>. If
<!-- l. 775 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>s</mi></mrow><mrow><mn>0</mn></mrow></msub></math> is 1, then the output is
<!-- l. 775 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>V</mi> </mrow><mrow><mn>0</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>X</mi></mrow><mrow><msub><mrow><mi>â</mi></mrow><mrow><mn>0</mn></mrow></msub></mrow></msup></mrow></math>; otherwise, the output
is <!-- l. 775 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>V</mi> </mrow><mrow><mn>0</mn></mrow></msub></math>. In our design, the
homomorphic computation of <!-- l. 775 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>s</mi></mrow><mrow><mn>0</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>V</mi> </mrow><mrow><mn>0</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>X</mi></mrow><mrow><msub><mrow><mi>â</mi></mrow><mrow><mn>0</mn></mrow></msub></mrow></msup> <mo class='MathClass-bin' stretchy='false'>−</mo><msub><mrow><mi>V</mi> </mrow><mrow><mn>0</mn></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>V</mi> </mrow><mrow><mn>0</mn></mrow></msub></mrow></math>
effectively implements a homomorphic MUX gate, where the two inputs are LWE-encrypted and the
selection bit is GGSW-encrypted.
   
</p>
   <h5 class='subsubsectionHead' id='coefficient-extraction1'><span class='titlemark'>D-1.8.5   </span> <a id='x1-36000D-1.8.5'></a>Coefficient Extraction</h5>
<!-- l. 780 --><p class='noindent'>Finally, we use the coefficient extraction technique (<a href='#coefficient-extraction'><span class='ts1-lmr10-x-x-109'>§</span>D-1.7<!-- tex4ht:ref: subsec:coeffrrotation  --></a>) to extract the rotated polynomial
<!-- l. 780 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>V</mi> </mrow><mrow><mi>′</mi></mrow></msup><mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>’s constant term’s coefficient
as an encryption of <!-- l. 780 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>m</mi></math>:
<!-- l. 780 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mover accent='true'><mrow><mi>s</mi></mrow><mo accent='true'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mi mathvariant='normal'>Δ</mi><mi>m</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>. At this point, the original
<!-- l. 780 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖫𝖶𝖤</mtext></mstyle></math> ciphertext’s old noise
<!-- l. 780 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mover accent='true'><mrow><msub><mrow><mi>e</mi></mrow><mrow><mi>b</mi></mrow></msub></mrow><mo accent='true'>^</mo></mover></math> has gone, and the bootstrapped
new ciphertext <!-- l. 780 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mover accent='true'><mrow><mi>s</mi></mrow><mo accent='true'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mi mathvariant='normal'>Δ</mi><mi>m</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math> has a newly
generated small noise <!-- l. 780 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>e</mi></mrow><mrow><mi>s</mi></mrow></msub></math>.
</p><!-- l. 782 --><p class='indent'>   In fact, the homomorphic MUX logic in the blind rotation procedure (<a href='#blind-rotation'><span class='ts1-lmr10-x-x-109'>§</span>D-1.8.4<!-- tex4ht:ref: subsec:coeffrrotation  --></a>) involves lots of ciphertext
multiplications and additions, which can accumulate additional noises until we reach the point of coefficient
extraction. In order to limit the accumulating noises during the series of MUX logic, we can carefully adjust
the security parameters. For example, we can design a narrower Gaussian distribution for sampling the noise
<!-- l. 782 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>e</mi></math>, while designing a
sufficiently large <!-- l. 782 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>n</mi></math>
to compensate for the reduced noise. Meanwhile, increasing
<!-- l. 782 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>q</mi></math>
rather makes the system less secure, because it becomes more vulnerable to Lattice reduction
attacks.
   
</p>
   <h5 class='subsubsectionHead' id='noise-bootstrapping-summary'><span class='titlemark'>D-1.8.6   </span> <a id='x1-37000D-1.8.6'></a>Noise Bootstrapping Summary</h5>
<!-- l. 792 --><p class='noindent'>TFHE’s noise bootstrapping procedure is summarized as follows:
</p>
   <div class='tcolorbox tcolorbox' id='tcolobox-22'>     
<div class='tcolorbox-title'>
<!-- l. 847 --><p class='indent'>   <!-- l. 847 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mstyle mathvariant='bold'><mo class='MathClass-open' stretchy='false'>⟨</mo></mstyle></math><span class='rm-lmbx-10x-x-109'>Summary </span><a href='#noise-bootstrapping-summary'><span class='rm-lmbx-10x-x-109'>D-1.8.6</span><!-- tex4ht:ref: subsec:tfhessummary  --></a><!-- l. 847 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mstyle mathvariant='bold'><mo class='MathClass-close' stretchy='false'>⟩</mo></mstyle></math>
                                                                                         
                                                                                         
<span class='rm-lmbx-10x-x-109'>TFHE Noise Bootstrapping Procedure</span></p></div> 
<div class='tcolorbox-content'><!-- l. 796 --><p class='noindent'><span class='underline'><span class='rm-lmbx-10x-x-109'>Lookup Table Encryption</span></span><span class='rm-lmbx-10x-x-109'>:          </span>Encrypt           the           LUT           polynomial
<!-- l. 796 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>V</mi> <mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
as       a       GLWE       ciphertext       by       using       the       bootstrapping       key
<!-- l. 796 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mover accent='true'><mrow><mi>S</mi></mrow><mo accent='true'>→</mo></mover></mrow><mrow><mi mathvariant='italic'>𝑏𝑘</mi></mrow></msub></math>.
</p><!-- l. 798 --><p class='noindent'><!-- l. 798 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
    </p><dl class='enumerate-enumitem'><dt class='enumerate-enumitem'>
1.  </dt><dd class='enumerate-enumitem'><span class='underline'><span class='rm-lmbx-10x-x-109'>Modulus Switch</span></span><span class='rm-lmbx-10x-x-109'>:     </span>Change     the     modulus     of     the     TFHE     ciphertext
    <!-- l. 801 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mover accent='true'><mrow><mi>s</mi></mrow><mo accent='true'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mi mathvariant='normal'>Δ</mi><mi>m</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>e</mi></mrow><mrow><mi>b</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
    from <!-- l. 801 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>q</mi> <mo class='MathClass-rel' stretchy='false'>→</mo><mn>2</mn><mi>n</mi></mrow></math>
   to get <!-- l. 801 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mover accent='true'><mrow><mi>s</mi></mrow><mo accent='true'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true'>^</mo></mover><mi>m</mi> <mo class='MathClass-bin' stretchy='false'>+</mo><msub><mrow> <mi>ê</mi></mrow><mrow><mi>b</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>,
    where <!-- l. 801 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true'>^</mo></mover> <mo class='MathClass-rel' stretchy='false'>=</mo> <mi mathvariant='normal'>Δ</mi> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mstyle displaystyle='true'><mfrac><mrow><mn>2</mn><mi>n</mi>
 </mrow><mrow><mi>q</mi> </mrow></mfrac></mstyle></mrow></math>.
    <!-- l. 803 --><p class='noindent'><!-- l. 803 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
    </p></dd><dt class='enumerate-enumitem'>
2.  </dt><dd class='enumerate-enumitem'><span class='underline'><span class='rm-lmbx-10x-x-109'>Blind Rotation</span></span><span class='rm-lmbx-10x-x-109'>:         </span>Rotate           the           GLWE-encrypted           polynomial
    <!-- l. 805 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>V</mi> </mrow></math>
   by <!-- l. 805 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><mover accent='true'><mrow><mi>b</mi></mrow><mo accent='true'>^</mo></mover> <mo class='MathClass-bin' stretchy='false'>−</mo><munderover accent='false' accentunder='false'><mrow><mi class='MathClass-op'>∑</mi><mo> ⁡<!-- FUNCTION APPLICATION --></mo>
  </mrow><mrow><mi>i</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>0</mn></mrow><mrow><mi>k</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></munderover><msub><mrow><mi>â</mi></mrow><mrow><mi>i</mi></mrow></msub><msub><mrow><mi>s</mi></mrow><mrow><mi>i</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>(</mo><mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true'>^</mo></mover><mi>m</mi> <mo class='MathClass-bin' stretchy='false'>+</mo><msub><mrow> <mi>ê</mi></mrow><mrow><mi>b</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
    positions to the left, by recursively computing:
    <!-- l. 807 --><p class='noindent'><!-- l. 807 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>V</mi> </mrow><mrow><mn>0</mn></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo> <mi>V</mi> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>X</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mover accent='true'><mrow><mi>b</mi></mrow><mo accent='true'>^</mo></mover></mrow></msup></mrow></math>
    </p><!-- l. 809 --><p class='noindent'><!-- l. 809 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>V</mi> </mrow><mrow><mn>1</mn></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mi>V</mi> </mrow><mrow><mn>0</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>X</mi></mrow><mrow><msub><mrow><mi>â</mi></mrow><mrow><mn>0</mn></mrow></msub><msub><mrow><mi>s</mi></mrow><mrow><mn>0</mn></mrow></msub></mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mi>s</mi></mrow><mrow><mn>0</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>V</mi> </mrow><mrow><mn>0</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>X</mi></mrow><mrow><msub><mrow><mi>â</mi></mrow><mrow><mn>0</mn></mrow></msub></mrow></msup> <mo class='MathClass-bin' stretchy='false'>−</mo><msub><mrow><mi>V</mi> </mrow><mrow><mn>0</mn></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>V</mi> </mrow><mrow><mn>0</mn></mrow></msub></mrow></math>
     </p><!-- l. 811 --><p class='noindent'>  <!-- l. 811 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>⋮</mi></math>
   </p><!-- l. 813 --><p class='noindent'><!-- l. 813 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>V</mi> </mrow><mrow><mi>k</mi></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mi>V</mi> </mrow><mrow><mi>k</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>X</mi></mrow><mrow><msub><mrow><mi>â</mi></mrow><mrow><mi>k</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub><msub><mrow><mi>s</mi></mrow><mrow><mi>k</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub></mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mi>s</mi></mrow><mrow><mi>k</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>V</mi> </mrow><mrow><mi>k</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>X</mi></mrow><mrow><msub><mrow><mi>â</mi></mrow><mrow><mn>0</mn></mrow></msub></mrow></msup> <mo class='MathClass-bin' stretchy='false'>−</mo><msub><mrow><mi>V</mi> </mrow><mrow><mn>0</mn></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>V</mi> </mrow><mrow><mi>k</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub></mrow></math>
     </p><!-- l. 815 --><p class='noindent'><!-- l. 815 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mi>V</mi> </mrow><mrow><mn>0</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>X</mi></mrow><mrow><msub><mrow><mi>â</mi></mrow><mrow><mn>0</mn></mrow></msub><msub><mrow><mi>s</mi></mrow><mrow><mn>0</mn></mrow></msub></mrow></msup><msup><mrow><mi>X</mi></mrow><mrow><msub><mrow><mi>â</mi></mrow><mrow><mn>1</mn></mrow></msub><msub><mrow><mi>s</mi></mrow><mrow><mn>1</mn></mrow></msub></mrow></msup><mo class='MathClass-rel' stretchy='false'>⋯</mo><msup><mrow><mi>X</mi></mrow><mrow><msub><mrow><mi>â</mi></mrow><mrow><mi>k</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub><msub><mrow><mi>s</mi></mrow><mrow><mi>k</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub></mrow></msup></mrow></math>
      </p><!-- l. 817 --><p class='noindent'><!-- l. 817 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo> <mi>V</mi> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>X</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mover accent='true'><mrow><mi>b</mi></mrow><mo accent='true'>^</mo></mover><mo class='MathClass-bin' stretchy='false'>+</mo><msubsup><mrow><mi class='MathClass-op'>∑</mi><mo> ⁡<!-- FUNCTION APPLICATION --></mo><!-- nolimits --></mrow><mrow>
<mi>i</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>0</mn></mrow><mrow><mi>k</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msubsup><msub><mrow><mi>â</mi></mrow><mrow><mi>i</mi></mrow></msub><msub><mrow><mi>s</mi></mrow><mrow><mi>i</mi></mrow></msub>
                          </mrow></msup></mrow></math>
     </p><!-- l. 819 --><p class='noindent'><!-- l. 819 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo> <mi>V</mi> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>X</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mo class='MathClass-open' stretchy='false'>(</mo><mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true'>^</mo></mover><mi>m</mi><mo class='MathClass-bin' stretchy='false'>+</mo><msub><mrow><mi>ê</mi></mrow><mrow><mi>b</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup></mrow></math>
     </p><!-- l. 821 --><p class='noindent'><!-- l. 821 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
     </p><!-- l. 823 --><p class='noindent'>Each  step  of  the  actual  blind  rotation  above  is  computed  as  the  following  TFHE
    ciphertext-to-ciphertext multiplication and addition:
    </p><!-- l. 825 --><p class='noindent'><!-- l. 825 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖦𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mover accent='true'><mrow><mi>S</mi></mrow><mo accent='true'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>V</mi> </mrow><mrow><mi>i</mi><mo class='MathClass-bin' stretchy='false'>+</mo><mn>1</mn></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo><msubsup><mrow> <mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖦𝖦𝖲𝖶</mtext></mstyle></mrow><mrow><mover accent='true'><mrow><mi>S</mi></mrow><mo accent='true'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow><mrow><mi>β</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>l</mi></mrow></msubsup><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>s</mi></mrow><mrow><mi>i</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-bin' stretchy='false'>⋅</mo><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖦𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mover accent='true'><mrow><mi>S</mi></mrow><mo accent='true'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>V</mi> </mrow><mrow><mi>i</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>X</mi></mrow><mrow><msub><mrow><mi>a</mi></mrow><mrow><mn>0</mn></mrow></msub></mrow></msup> <mo class='MathClass-bin' stretchy='false'>−</mo><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖦𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mover accent='true'><mrow><mi>S</mi></mrow><mo accent='true'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>V</mi> </mrow><mrow><mi>i</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-bin' stretchy='false'>+</mo><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖦𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mover accent='true'><mrow><mi>S</mi></mrow><mo accent='true'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>V</mi> </mrow><mrow><mi>i</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
    </p><!-- l. 827 --><p class='noindent'><!-- l. 827 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
    </p></dd><dt class='enumerate-enumitem'>
3.  </dt><dd class='enumerate-enumitem'><span class='underline'><span class='rm-lmbx-10x-x-109'>Coefficient Extractio</span></span><span class='rm-lmbx-10x-x-109'>:  </span>Homomorphically   extract   the   constant   term’s   coefficient
    <!-- l. 829 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>m</mi></math>
   from the rotated polynomial <!-- l. 829 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>V</mi> </mrow><mrow><mi>k</mi></mrow></msub></math>,
    which is <!-- l. 829 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mover accent='true'><mrow><mi>s</mi></mrow><mo accent='true'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true'>^</mo></mover><mi>m</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>.
    </dd></dl>
<!-- l. 841 --><p class='noindent'><!-- l. 841 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 843 --><p class='noindent'><span class='underline'><span class='rm-lmbx-10x-x-109'>Halving the Usable Plaintext Range</span></span><span class='rm-lmbx-10x-x-109'>:  </span>Problematically, the LUT polynomial V rotates
negacyclically. To avoid this problem, we require the application to ensure that the plaintext
<!-- l. 843 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>m</mi></math> uses only continuous
<!-- l. 843 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mstyle displaystyle='true'><mfrac><mrow> <mi>t</mi>
</mrow><mrow><mn>2</mn></mrow></mfrac></mstyle></math> modulo values
within <!-- l. 843 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>ℤ</mi></mrow><mrow><mi>t</mi></mrow></msub></math>. This way,
we avoid rotating <!-- l. 843 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>V</mi> <mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
more than <!-- l. 843 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>n</mi> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></math>
positions that causes coefficient extraction of double-signed contradicting coefficients.
</p> 
</div> 
</div>
                                                                                         
                                                                                         
   
   <h5 class='subsubsectionHead' id='example-noise-bootstrapping'><span class='titlemark'>D-1.8.7   </span> <a id='x1-38000D-1.8.7'></a>Example: Noise Bootstrapping</h5>
<!-- l. 853 --><p class='noindent'>Suppose the a GLWE security setup: <!-- l. 853 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>n</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>16</mn></mrow></math>,
<!-- l. 853 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>t</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>8</mn></mrow></math>,
<!-- l. 853 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>q</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>64</mn></mrow></math>,
<!-- l. 853 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>k</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>8</mn></mrow></math>
</p><!-- l. 855 --><p class='indent'>   <!-- l. 855 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>ℤ</mi></mrow><mrow><mi>t</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>8</mn></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>{</mo><mo class='MathClass-bin' stretchy='false'>−</mo><mn>4</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-bin' stretchy='false'>−</mo><mn>3</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-bin' stretchy='false'>−</mo><mn>2</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>0</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>1</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>2</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>3</mn><mo class='MathClass-close' stretchy='false'>}</mo></mrow></math>
</p><!-- l. 857 --><p class='indent'>   <!-- l. 857 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>ℤ</mi></mrow><mrow><mi>q</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>64</mn></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>{</mo><mo class='MathClass-bin' stretchy='false'>−</mo><mn>32</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-bin' stretchy='false'>−</mo><mn>31</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-bin' stretchy='false'>−</mo><mn>30</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><mstyle class='text'><mtext></mtext><mstyle class='math'><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace></mstyle><mtext></mtext></mstyle><mstyle class='text'><mtext> </mtext></mstyle><mo class='MathClass-punc' stretchy='false'>,</mo><mn>29</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>30</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>31</mn><mo class='MathClass-close' stretchy='false'>}</mo></mrow></math>
</p><!-- l. 859 --><p class='indent'>   <!-- l. 859 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi mathvariant='normal'>Δ</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mstyle displaystyle='true'><mfrac><mrow><mi>q</mi>
</mrow><mrow><mi>t</mi></mrow></mfrac></mstyle> <mo class='MathClass-rel' stretchy='false'>=</mo> <mstyle displaystyle='true'><mfrac><mrow><mn>64</mn>
 </mrow><mrow><mn>8</mn> </mrow></mfrac></mstyle> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>8</mn></mrow></math>
</p><!-- l. 861 --><p class='indent'>   <!-- l. 861 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 863 --><p class='indent'>   And suppose we have the following LWE ciphertext:
</p><!-- l. 865 --><p class='indent'>   <!-- l. 865 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mover accent='true'><mrow><mi>s</mi></mrow><mo accent='true'>→</mo></mover> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>(</mo><mn>1</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>0</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>0</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>1</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>1</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>1</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>0</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo> <msubsup><mrow><mi>ℤ</mi></mrow><mrow><mn>2</mn></mrow><mrow><mi>k</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>8</mn></mrow></msubsup></mrow></math>
</p><!-- l. 867 --><p class='indent'>   <!-- l. 867 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>m</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>1</mn> <mo class='MathClass-rel' stretchy='false'>∈</mo> <msub><mrow><mi>ℤ</mi></mrow><mrow><mi>t</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>8</mn></mrow></msub></mrow></math>
</p><!-- l. 869 --><p class='indent'>   <!-- l. 869 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi mathvariant='normal'>Δ</mi><mi>m</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>1</mn> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mn>8</mn> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>8</mn> <mo class='MathClass-rel' stretchy='false'>∈</mo> <msub><mrow><mi>ℤ</mi></mrow><mrow><mi>q</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>64</mn></mrow></msub></mrow></math>
</p><!-- l. 873 --><p class='indent'>   <!-- l. 873 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mover accent='true'><mrow><mi>s</mi></mrow><mo accent='true'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mi mathvariant='normal'>Δ</mi><mi>m</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>a</mi></mrow><mrow><mn>0</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>a</mi></mrow><mrow><mn>1</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>a</mi></mrow><mrow><mn>2</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>a</mi></mrow><mrow><mn>3</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>a</mi></mrow><mrow><mn>4</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>a</mi></mrow><mrow><mn>5</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>a</mi></mrow><mrow><mn>6</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>a</mi></mrow><mrow><mn>7</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><mi>b</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>(</mo><mn>8</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-bin' stretchy='false'>−</mo><mn>28</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>4</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-bin' stretchy='false'>−</mo><mn>32</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>0</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>31</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-bin' stretchy='false'>−</mo><mn>6</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>7</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>24</mn><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>∈</mo> <msubsup><mrow><mi>ℤ</mi></mrow><mrow><mi>q</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>64</mn></mrow><mrow><mi>k</mi><mo class='MathClass-bin' stretchy='false'>+</mo><mn>1</mn><mo class='MathClass-rel' stretchy='false'>=</mo><mn>9</mn></mrow></msubsup></mrow></math>
</p><!-- l. 876 --><p class='indent'>   <!-- l. 876 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>e</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>2</mn> <mo class='MathClass-rel' stretchy='false'>∈</mo> <msub><mrow><mi>ℤ</mi></mrow><mrow><mi>q</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>64</mn></mrow></msub></mrow></math> (should be
the case that <!-- l. 876 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-rel' stretchy='false'>|</mo><mi>e</mi><mo class='MathClass-rel' stretchy='false'>|</mo><mstyle class='MathClass-rel' stretchy='false'><mfrac><mrow><mi mathvariant='normal'>Δ</mi>
</mrow><mrow><mn>2</mn></mrow></mfrac></mstyle>
for correct decryption)
</mrow></math></p><!-- l. 878 --><p class='indent'>   <!-- l. 878 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>b</mi> <mo class='MathClass-rel' stretchy='false'>=</mo><munderover accent='false' accentunder='false'><mrow> <mi class='MathClass-op'>∑</mi><mo> ⁡<!-- FUNCTION APPLICATION --></mo>
  </mrow><mrow><mi>i</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>0</mn></mrow><mrow><mn>7</mn></mrow></munderover><msub><mrow><mi>a</mi></mrow><mrow><mi>i</mi></mrow></msub><msub><mrow><mi>s</mi></mrow><mrow><mi>i</mi></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi mathvariant='normal'>Δ</mi><mi>m</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>e</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>(</mo><mn>8</mn> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>32</mn> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>31</mn> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>7</mn><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>8</mn> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>2</mn> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>24</mn> <mo class='MathClass-rel' stretchy='false'>∈</mo> <msub><mrow><mi>ℤ</mi></mrow><mrow><mi>q</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>64</mn></mrow></msub></mrow></math>
</p><!-- l. 880 --><p class='indent'>   <!-- l. 880 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 882 --><p class='indent'>   Now then, the TFHE noise bootstrapping procedure is as follows:
</p><!-- l. 884 --><p class='indent'>   <!-- l. 884 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 887 --><p class='indent'>
   </p><dl class='enumerate-enumitem'><dt class='enumerate-enumitem'>
1. </dt><dd class='enumerate-enumitem'><span class='rm-lmbx-10x-x-109'>Modulus Switch: </span>Switch the modulus of <!-- l. 887 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mover accent='true'><mrow><mi>s</mi></mrow><mo accent='true'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mi mathvariant='normal'>Δ</mi><mi>m</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
   From <!-- l. 887 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>q</mi> <mo class='MathClass-rel' stretchy='false'>→</mo><mn>2</mn><mi>n</mi></mrow></math>,
   which is from <!-- l. 887 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mn>64</mn> <mo class='MathClass-rel' stretchy='false'>→</mo><mn>32</mn></mrow></math>.
   After the modulus switch, the original LWE ciphertext is converted as follows:
   <!-- l. 889 --><p class='noindent'><!-- l. 889 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>ℤ</mi></mrow><mrow><mn>2</mn><mi>n</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>32</mn></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>{</mo><mo class='MathClass-bin' stretchy='false'>−</mo><mn>16</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-bin' stretchy='false'>−</mo><mn>15</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-bin' stretchy='false'>−</mo><mn>14</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><mstyle class='text'><mtext></mtext><mstyle class='math'><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace></mstyle><mtext></mtext></mstyle><mstyle class='text'><mtext> </mtext></mstyle><mo class='MathClass-punc' stretchy='false'>,</mo><mn>13</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>14</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>15</mn><mo class='MathClass-close' stretchy='false'>}</mo></mrow></math>
   </p><!-- l. 891 --><p class='noindent'><!-- l. 891 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mover accent='true'><mrow><mi>s</mi></mrow><mo accent='true'>→</mo></mover> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>(</mo><mn>1</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>0</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>0</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>1</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>1</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>1</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>0</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo> <msubsup><mrow><mi>ℤ</mi></mrow><mrow><mn>2</mn></mrow><mrow><mi>k</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>8</mn></mrow></msubsup></mrow></math>
   </p><!-- l. 894 --><p class='noindent'><!-- l. 894 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true'>^</mo></mover> <mo class='MathClass-rel' stretchy='false'>=</mo> <mi mathvariant='normal'>Δ</mi><mstyle displaystyle='true'><mfrac><mrow><mn>2</mn><mi>n</mi>
</mrow><mrow><mn>64</mn></mrow></mfrac></mstyle> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>8</mn><mstyle displaystyle='true'><mfrac><mrow><mn>32</mn>
</mrow><mrow><mn>64</mn></mrow></mfrac></mstyle> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>4</mn></mrow></math>
   </p><!-- l. 896 --><p class='noindent'><!-- l. 896 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true'>^</mo></mover><mi>m</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>4</mn> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mn>1</mn> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>4</mn> <mo class='MathClass-rel' stretchy='false'>∈</mo> <msub><mrow><mi>ℤ</mi></mrow><mrow><mn>2</mn><mi>n</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>32</mn></mrow></msub></mrow></math>
   </p><!-- l. 898 --><p class='noindent'><!-- l. 898 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>ê</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mrow><mo fence='true' form='prefix'>⌈</mo><mrow><mi>e</mi><mstyle displaystyle='true'><mfrac><mrow><mn>2</mn><mi>n</mi>
 </mrow><mrow><mi>q</mi> </mrow></mfrac></mstyle></mrow><mo fence='true' form='postfix'>⌋</mo></mrow> <mo class='MathClass-rel' stretchy='false'>=</mo> <mrow><mo fence='true' form='prefix'>⌈</mo><mrow><mn>2</mn><mstyle displaystyle='true'><mfrac><mrow><mn>32</mn>
</mrow><mrow><mn>64</mn></mrow></mfrac></mstyle></mrow><mo fence='true' form='postfix'>⌋</mo></mrow> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>1</mn> <mo class='MathClass-rel' stretchy='false'>∈</mo> <msub><mrow><mi>ℤ</mi></mrow><mrow><mn>2</mn><mi>n</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>32</mn></mrow></msub></mrow></math>
   </p><!-- l. 900 --><p class='noindent'><!-- l. 900 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
   </p><!-- l. 902 --><p class='noindent'><!-- l. 902 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mover accent='true'><mrow><mi>s</mi></mrow><mo accent='true'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true'>^</mo></mover><mi>m</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>â</mi></mrow><mrow><mn>0</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>â</mi></mrow><mrow><mn>1</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>â</mi></mrow><mrow><mn>2</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>â</mi></mrow><mrow><mn>3</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>â</mi></mrow><mrow><mn>4</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>â</mi></mrow><mrow><mn>5</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>â</mi></mrow><mrow><mn>6</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>â</mi></mrow><mrow><mn>7</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><mover accent='true'><mrow><mi>b</mi></mrow><mo accent='true'>^</mo></mover><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>∈</mo> <msubsup><mrow><mi>ℤ</mi></mrow><mrow><mn>2</mn><mi>n</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>32</mn></mrow><mrow><mi>k</mi><mo class='MathClass-bin' stretchy='false'>+</mo><mn>1</mn><mo class='MathClass-rel' stretchy='false'>=</mo><mn>9</mn></mrow></msubsup></mrow></math>
   </p><!-- l. 905 --><p class='noindent'><!-- l. 905 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>(</mo><mstyle mathsize='1.61em'><mrow><mo fence='true' form='prefix'>⌈</mo><mrow></mrow><mo fence='true' form='postfix'></mo></mrow></mstyle><mn>8</mn><mstyle displaystyle='true'><mfrac><mrow><mn>32</mn>
</mrow><mrow><mn>64</mn></mrow></mfrac></mstyle><mstyle mathsize='1.61em'><mrow><mo fence='true' form='prefix'>⌋</mo><mrow></mrow><mo fence='true' form='postfix'></mo></mrow></mstyle><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle mathsize='1.61em'><mrow><mo fence='true' form='prefix'>⌈</mo><mrow></mrow><mo fence='true' form='postfix'></mo></mrow></mstyle> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>28</mn><mstyle displaystyle='true'><mfrac><mrow><mn>32</mn>
</mrow><mrow><mn>64</mn></mrow></mfrac></mstyle><mstyle mathsize='1.61em'><mrow><mo fence='true' form='prefix'>⌋</mo><mrow></mrow><mo fence='true' form='postfix'></mo></mrow></mstyle><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle mathsize='1.61em'><mrow><mo fence='true' form='prefix'>⌈</mo><mrow></mrow><mo fence='true' form='postfix'></mo></mrow></mstyle><mn>4</mn><mstyle displaystyle='true'><mfrac><mrow><mn>32</mn>
</mrow><mrow><mn>64</mn></mrow></mfrac></mstyle><mstyle mathsize='1.61em'><mrow><mo fence='true' form='prefix'>⌋</mo><mrow></mrow><mo fence='true' form='postfix'></mo></mrow></mstyle><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle mathsize='1.61em'><mrow><mo fence='true' form='prefix'>⌈</mo><mrow></mrow><mo fence='true' form='postfix'></mo></mrow></mstyle> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>32</mn><mstyle displaystyle='true'><mfrac><mrow><mn>32</mn>
</mrow><mrow><mn>64</mn></mrow></mfrac></mstyle><mstyle mathsize='1.61em'><mrow><mo fence='true' form='prefix'>⌋</mo><mrow></mrow><mo fence='true' form='postfix'></mo></mrow></mstyle><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle mathsize='1.61em'><mrow><mo fence='true' form='prefix'>⌈</mo><mrow></mrow><mo fence='true' form='postfix'></mo></mrow></mstyle><mn>0</mn><mstyle displaystyle='true'><mfrac><mrow><mn>32</mn>
</mrow><mrow><mn>64</mn></mrow></mfrac></mstyle><mstyle mathsize='1.61em'><mrow><mo fence='true' form='prefix'>⌋</mo><mrow></mrow><mo fence='true' form='postfix'></mo></mrow></mstyle><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle mathsize='1.61em'><mrow><mo fence='true' form='prefix'>⌈</mo><mrow></mrow><mo fence='true' form='postfix'></mo></mrow></mstyle><mn>31</mn><mstyle displaystyle='true'><mfrac><mrow><mn>32</mn>
</mrow><mrow><mn>64</mn></mrow></mfrac></mstyle><mstyle mathsize='1.61em'><mrow><mo fence='true' form='prefix'>⌋</mo><mrow></mrow><mo fence='true' form='postfix'></mo></mrow></mstyle><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle mathsize='1.61em'><mrow><mo fence='true' form='prefix'>⌈</mo><mrow></mrow><mo fence='true' form='postfix'></mo></mrow></mstyle> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>6</mn><mstyle displaystyle='true'><mfrac><mrow><mn>32</mn>
</mrow><mrow><mn>64</mn></mrow></mfrac></mstyle><mstyle mathsize='1.61em'><mrow><mo fence='true' form='prefix'>⌋</mo><mrow></mrow><mo fence='true' form='postfix'></mo></mrow></mstyle><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle mathsize='1.61em'><mrow><mo fence='true' form='prefix'>⌈</mo><mrow></mrow><mo fence='true' form='postfix'></mo></mrow></mstyle><mn>7</mn><mstyle displaystyle='true'><mfrac><mrow><mn>32</mn>
</mrow><mrow><mn>64</mn></mrow></mfrac></mstyle><mstyle mathsize='1.61em'><mrow><mo fence='true' form='prefix'>⌋</mo><mrow></mrow><mo fence='true' form='postfix'></mo></mrow></mstyle><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle mathsize='1.61em'><mrow><mo fence='true' form='prefix'>⌈</mo><mrow></mrow><mo fence='true' form='postfix'></mo></mrow></mstyle><mn>24</mn><mstyle displaystyle='true'><mfrac><mrow><mn>32</mn>
</mrow><mrow><mn>64</mn></mrow></mfrac></mstyle><mstyle mathsize='1.61em'><mrow><mo fence='true' form='prefix'>⌋</mo><mrow></mrow><mo fence='true' form='postfix'></mo></mrow></mstyle><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
   </p><!-- l. 907 --><p class='noindent'><!-- l. 907 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
   </p><!-- l. 909 --><p class='noindent'><!-- l. 909 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>(</mo><mn>4</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-bin' stretchy='false'>−</mo><mn>14</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>2</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-bin' stretchy='false'>−</mo><mn>16</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>0</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>16</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-bin' stretchy='false'>−</mo><mn>3</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>4</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>12</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
   </p><!-- l. 911 --><p class='noindent'><!-- l. 911 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
   </p><!-- l. 913 --><p class='noindent'>Note that <!-- l. 913 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><munderover accent='false' accentunder='false'><mrow><mi class='MathClass-op'>∑</mi><mo> ⁡<!-- FUNCTION APPLICATION --></mo>
  </mrow><mrow><mi>i</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>0</mn></mrow><mrow><mn>7</mn></mrow></munderover><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>â</mi></mrow><mrow><mi>i</mi></mrow></msub><msub><mrow><mi>s</mi></mrow><mrow><mi>i</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>+</mo> <mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true'>^</mo></mover><mi>m</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>ê</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>(</mo><mn>4</mn> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>16</mn> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>16</mn> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>4</mn><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>4</mn> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>1</mn> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>13</mn> <mo class='MathClass-rel' stretchy='false'>∈</mo> <msub><mrow><mi>ℤ</mi></mrow><mrow><mn>2</mn><mi>n</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>32</mn></mrow></msub></mrow></math>
   </p><!-- l. 915 --><p class='noindent'><!-- l. 915 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
                                                                                         
                                                                                         
   </p><!-- l. 917 --><p class='noindent'><!-- l. 917 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mover accent='true'><mrow><mi>b</mi></mrow><mo accent='true'>^</mo></mover> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>12</mn> <mo class='MathClass-rel' stretchy='false'>≈</mo><mn>13</mn> <mo class='MathClass-rel' stretchy='false'>=</mo><munderover accent='false' accentunder='false'><mrow> <mi class='MathClass-op'>∑</mi><mo> ⁡<!-- FUNCTION APPLICATION --></mo>
  </mrow><mrow><mi>i</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>0</mn></mrow><mrow><mn>7</mn></mrow></munderover><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>â</mi></mrow><mrow><mi>i</mi></mrow></msub><msub><mrow><mi>s</mi></mrow><mrow><mi>i</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>+</mo> <mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true'>^</mo></mover><mi>m</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>ê</mi></mrow></math>
   </p><!-- l. 919 --><p class='noindent'>This small difference in <!-- l. 919 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mover accent='true'><mrow><mi>b</mi></mrow><mo accent='true'>^</mo></mover></math>
   comes from the aggregated noises of rounding <!-- l. 919 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>â</mi></mrow><mrow><mn>0</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>â</mi></mrow><mrow><mn>1</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace><mo class='MathClass-punc' stretchy='false'>,</mo><mi>ê</mi></mrow></math>
   during the modulus switch.
   </p></dd><dt class='enumerate-enumitem'>
2. </dt><dd class='enumerate-enumitem'><span class='rm-lmbx-10x-x-109'>Blind Rotation: </span>We assume that the application avoids the problem of negacyclic polynomial
   rotation by ensuring that the usable plaintext values are the following continuous <!-- l. 922 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mstyle displaystyle='true'><mfrac><mrow><mn>8</mn>
</mrow><mrow><mn>2</mn></mrow></mfrac></mstyle></math>
   modulo values within <!-- l. 922 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>ℤ</mi></mrow><mrow><mn>8</mn></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>{</mo><mo class='MathClass-bin' stretchy='false'>−</mo><mn>4</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-bin' stretchy='false'>−</mo><mn>3</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-bin' stretchy='false'>−</mo><mn>2</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>0</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>1</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>2</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>3</mn><mo class='MathClass-close' stretchy='false'>}</mo></mrow></math>,
   which are <!-- l. 922 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>{</mo><mo class='MathClass-bin' stretchy='false'>−</mo><mn>2</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>0</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>}</mo></mrow></math>.
   This implies that the only possible values of <!-- l. 922 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>i</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true'>^</mo></mover><mi>m</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>ê</mi></mrow></math>
   in <!-- l. 922 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>V</mi> <mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>X</mi></mrow><mrow><mi>i</mi></mrow></msup></mrow></math>
   will be: <!-- l. 922 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>i</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>{</mo><mo class='MathClass-bin' stretchy='false'>−</mo><mn>8</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-bin' stretchy='false'>−</mo><mn>7</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace><mo class='MathClass-punc' stretchy='false'>,</mo><mn>6</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>7</mn><mo class='MathClass-close' stretchy='false'>}</mo></mrow></math>.
   Based on these requirements, <a href='#the-lookup-table-for-n-q-t-lwe-setup-orangeorange-is-the-plaintext-ms-bits-greengreen-is-the-noise-es-bits-'>Table 1<!-- tex4ht:ref: subsec:coeffrrotation  --></a> is the Lookup Table polynomial <!-- l. 922 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>V</mi> <mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
   that maps <!-- l. 922 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true'>^</mo></mover><mi>m</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>ê</mi></mrow></math>
   to <!-- l. 922 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi mathvariant='normal'>Δ</mi><mi>m</mi></mrow></math>.
   <div class='table'>
   <!-- l. 925 --><p class='noindent'></p><figure class='float' id='x1-38003r1'><span id='the-lookup-table-for-n-q-t-lwe-setup-orangeorange-is-the-plaintext-ms-bits-greengreen-is-the-noise-es-bits-'></span> <div class='adjustbox' id='adjustbox-1'>
   <!-- tex4ht:inline --><div class='tabular'> <table class='tabular' id='TBL-5' rules='groups'><colgroup id='TBL-5-1g'><col id='TBL-5-1' /></colgroup><colgroup id='TBL-5-2g'><col id='TBL-5-2' /></colgroup><colgroup id='TBL-5-3g'><col id='TBL-5-3' /></colgroup><colgroup id='TBL-5-4g'><col id='TBL-5-4' /></colgroup><colgroup id='TBL-5-5g'><col id='TBL-5-5' /></colgroup><colgroup id='TBL-5-6g'><col id='TBL-5-6' /></colgroup><colgroup id='TBL-5-7g'><col id='TBL-5-7' /></colgroup><colgroup id='TBL-5-8g'><col id='TBL-5-8' /></colgroup><colgroup id='TBL-5-9g'><col id='TBL-5-9' /></colgroup><colgroup id='TBL-5-10g'><col id='TBL-5-10' /></colgroup><colgroup id='TBL-5-11g'><col id='TBL-5-11' /></colgroup><tr class='hline'><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr id='TBL-5-1-'><td class='td11' colspan='6' id='TBL-5-1-1' style='text-align:center; white-space:nowrap;'></td> <div class='multicolumn' style='text-align:left; white-space:nowrap;'><!-- l. 954 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>V</mi> <mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mi>v</mi></mrow><mrow><mn>0</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>v</mi></mrow><mrow><mn>1</mn></mrow></msub><mi>X</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>v</mi></mrow><mrow><mn>2</mn></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mn>2</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>v</mi></mrow><mrow><mn>3</mn></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mn>3</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>v</mi></mrow><mrow><mn>4</mn></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mn>4</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>v</mi></mrow><mrow><mn>5</mn></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mn>5</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>v</mi></mrow><mrow><mn>6</mn></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mn>6</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>v</mi></mrow><mrow><mn>7</mn></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mn>7</mn></mrow></msup></mrow></math></div>         
</tr><tr id='TBL-05-4-'><td class='td11' colspan='6' id='TBL-05-4-1' style='text-align:center; white-space:nowrap;'></td> <div class='multicolumn' style='text-align:left; white-space:nowrap;'><span id='textcolor27'>......</span> <!-- l. 954 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>v</mi></mrow><mrow><mn>8</mn></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mn>8</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>v</mi></mrow><mrow><mn>9</mn></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mn>9</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>v</mi></mrow><mrow><mn>10</mn></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mn>10</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>v</mi></mrow><mrow><mn>11</mn></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mn>11</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>v</mi></mrow><mrow><mn>12</mn></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mn>12</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>v</mi></mrow><mrow><mn>13</mn></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mn>13</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>v</mi></mrow><mrow><mn>14</mn></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mn>14</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>v</mi></mrow><mrow><mn>15</mn></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mn>15</mn></mrow></msup></mrow></math></div>  
</tr><tr id='TBL-005-7-'><td class='td11' colspan='6' id='TBL-005-7-1' style='text-align:center; white-space:nowrap;'></td> <div class='multicolumn' style='text-align:left; white-space:nowrap;'><span id='textcolor28'>....</span><!-- l. 954 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>0</mn> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>0</mn><mi>X</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>0</mn><msup><mrow><mi>X</mi></mrow><mrow><mn>2</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>0</mn><msup><mrow><mi>X</mi></mrow><mrow><mn>3</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>1</mn><msup><mrow><mi>X</mi></mrow><mrow><mn>4</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>1</mn><msup><mrow><mi>X</mi></mrow><mrow><mn>5</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>1</mn><msup><mrow><mi>X</mi></mrow><mrow><mn>6</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>1</mn><msup><mrow><mi>X</mi></mrow><mrow><mn>7</mn></mrow></msup></mrow></math></div>      
</tr><tr id='TBL-0005-10-'><td class='td11' colspan='6' id='TBL-0005-10-1' style='text-align:center; white-space:nowrap;'></td> <div class='multicolumn' style='text-align:left; white-space:nowrap;'><span id='textcolor29'>......</span><!-- l. 954 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>2</mn><msup><mrow><mi>X</mi></mrow><mrow><mn>8</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>2</mn><msup><mrow><mi>X</mi></mrow><mrow><mn>9</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>2</mn><msup><mrow><mi>X</mi></mrow><mrow><mn>10</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>2</mn><msup><mrow><mi>X</mi></mrow><mrow><mn>11</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>1</mn><msup><mrow><mi>X</mi></mrow><mrow><mn>12</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>1</mn><msup><mrow><mi>X</mi></mrow><mrow><mn>13</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>1</mn><msup><mrow><mi>X</mi></mrow><mrow><mn>14</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>1</mn><msup><mrow><mi>X</mi></mrow><mrow><mn>15</mn></mrow></msup></mrow></math></div>   
</tr><tr class='hline'><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr class='hline'><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr id='TBL-00005-13-'><td class='td11' id='TBL-00005-13-1' style='text-align:center; white-space:nowrap;'>       <!-- l. 954 --><math display='inline' mathvariant='bold-italic' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>i</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true'>^</mo></mover><mi>m</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>ê</mi></mrow></math>        </td><td class='td11' id='TBL-00005-13-2' style='text-align:center; white-space:nowrap;'>  <!-- l. 954 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mn>8</mn></mrow></math>   </td><td class='td11' id='TBL-00005-13-3' style='text-align:center; white-space:nowrap;'>  <!-- l. 954 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mn>7</mn></mrow></math>   </td><td class='td11' id='TBL-00005-13-4' style='text-align:center; white-space:nowrap;'>  <!-- l. 954 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mn>6</mn></mrow></math>   </td><td class='td11' id='TBL-00005-13-5' style='text-align:center; white-space:nowrap;'>  <!-- l. 954 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mn>5</mn></mrow></math>   </td><td class='td11' id='TBL-00005-13-6' style='text-align:center; white-space:nowrap;'>  <!-- l. 954 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mn>4</mn></mrow></math>   </td><td class='td11' id='TBL-00005-13-7' style='text-align:center; white-space:nowrap;'>  <!-- l. 954 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mn>3</mn></mrow></math>   </td><td class='td11' id='TBL-00005-13-8' style='text-align:center; white-space:nowrap;'>  <!-- l. 954 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mn>2</mn></mrow></math>   </td><td class='td11' id='TBL-00005-13-9' style='text-align:center; white-space:nowrap;'>  <!-- l. 954 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></math>   </td></tr><tr id='TBL-000005-16-'><td class='td11' id='TBL-000005-16-1' style='text-align:center; white-space:nowrap;'>     (in <!-- l. 954 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>V</mi> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>X</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mi>i</mi></mrow></msup></mrow></math>)        </td><td class='td11' id='TBL-000005-16-2' style='text-align:center; white-space:nowrap;'> (<!-- l. 954 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mstyle mathcolor='#00FFFF'></mstyle><mstyle mathcolor='#FF8000'><mn>110</mn></mstyle><msub><mrow><mstyle mathcolor='#00FF00'><mn>00</mn></mstyle></mrow><mrow><mn>2</mn></mrow></msub></mrow></math>)  </td><td class='td11' id='TBL-000005-16-3' style='text-align:center; white-space:nowrap;'> (<!-- l. 954 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mstyle mathcolor='#00FFFF'></mstyle><mstyle mathcolor='#FF8000'><mn>110</mn></mstyle><msub><mrow><mstyle mathcolor='#00FF00'><mn>01</mn></mstyle></mrow><mrow><mn>2</mn></mrow></msub></mrow></math>)  </td><td class='td11' id='TBL-000005-16-4' style='text-align:center; white-space:nowrap;'> (<!-- l. 954 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mstyle mathcolor='#00FFFF'></mstyle><mstyle mathcolor='#FF8000'><mn>110</mn></mstyle><msub><mrow><mstyle mathcolor='#00FF00'><mn>10</mn></mstyle></mrow><mrow><mn>2</mn></mrow></msub></mrow></math>)  </td><td class='td11' id='TBL-000005-16-5' style='text-align:center; white-space:nowrap;'> (<!-- l. 954 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mstyle mathcolor='#00FFFF'></mstyle><mstyle mathcolor='#FF8000'><mn>110</mn></mstyle><msub><mrow><mstyle mathcolor='#00FF00'><mn>11</mn></mstyle></mrow><mrow><mn>2</mn></mrow></msub></mrow></math>)  </td><td class='td11' id='TBL-000005-16-6' style='text-align:center; white-space:nowrap;'> (<!-- l. 954 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mstyle mathcolor='#00FFFF'></mstyle><mstyle mathcolor='#FF8000'><mn>111</mn></mstyle><msub><mrow><mstyle mathcolor='#00FF00'><mn>00</mn></mstyle></mrow><mrow><mn>2</mn></mrow></msub></mrow></math>)  </td><td class='td11' id='TBL-000005-16-7' style='text-align:center; white-space:nowrap;'> (<!-- l. 954 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mstyle mathcolor='#00FFFF'></mstyle><mstyle mathcolor='#FF8000'><mn>111</mn></mstyle><msub><mrow><mstyle mathcolor='#00FF00'><mn>01</mn></mstyle></mrow><mrow><mn>2</mn></mrow></msub></mrow></math>)  </td><td class='td11' id='TBL-000005-16-8' style='text-align:center; white-space:nowrap;'> (<!-- l. 954 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mstyle mathcolor='#00FFFF'></mstyle><mstyle mathcolor='#FF8000'><mn>111</mn></mstyle><msub><mrow><mstyle mathcolor='#00FF00'><mn>10</mn></mstyle></mrow><mrow><mn>2</mn></mrow></msub></mrow></math>)  </td><td class='td11' id='TBL-000005-16-9' style='text-align:center; white-space:nowrap;'> (<!-- l. 954 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mstyle mathcolor='#00FFFF'></mstyle><mstyle mathcolor='#FF8000'><mn>111</mn></mstyle><msub><mrow><mstyle mathcolor='#00FF00'><mn>11</mn></mstyle></mrow><mrow><mn>2</mn></mrow></msub></mrow></math>)  </td>
</tr><tr class='hline'><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr id='TBL-0000005-19-'><td class='td11' id='TBL-0000005-19-1' style='text-align:center; white-space:nowrap;'>                                        <span class='rm-lmbx-10x-x-109'>constant term’s                                                       </span></td><td class='td11' id='TBL-0000005-19-2' style='text-align:center; white-space:nowrap;'>  <!-- l. 954 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mn>2</mn></mrow></math>   </td><td class='td11' id='TBL-0000005-19-3' style='text-align:center; white-space:nowrap;'>  <!-- l. 954 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mn>2</mn></mrow></math>   </td><td class='td11' id='TBL-0000005-19-4' style='text-align:center; white-space:nowrap;'>  <!-- l. 954 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mn>2</mn></mrow></math>   </td><td class='td11' id='TBL-0000005-19-5' style='text-align:center; white-space:nowrap;'>  <!-- l. 954 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mn>2</mn></mrow></math>   </td><td class='td11' id='TBL-0000005-19-6' style='text-align:center; white-space:nowrap;'>  <!-- l. 954 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></math>   </td><td class='td11' id='TBL-0000005-19-7' style='text-align:center; white-space:nowrap;'>  <!-- l. 954 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></math>   </td><td class='td11' id='TBL-0000005-19-8' style='text-align:center; white-space:nowrap;'>  <!-- l. 954 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></math>   </td><td class='td11' id='TBL-0000005-19-9' style='text-align:center; white-space:nowrap;'>  <!-- l. 954 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></math>   </td></tr><tr id='TBL-00000005-22-'><td class='td11' id='TBL-00000005-22-1' style='text-align:center; white-space:nowrap;'>  <span class='rm-lmbx-10x-x-109'>coeff. of </span><!-- l. 954 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>V</mi> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>X</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mi>i</mi></mrow></msup></mrow></math>     </td><td class='td11' id='TBL-00000005-22-2' style='text-align:center; white-space:nowrap;'>  <!-- l. 954 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mstyle mathcolor='#FF8000'><mn>110</mn></mstyle></mrow><mrow><mn>2</mn></mrow></msub></math>    </td><td class='td11' id='TBL-00000005-22-3' style='text-align:center; white-space:nowrap;'>  <!-- l. 954 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mstyle mathcolor='#FF8000'><mn>110</mn></mstyle></mrow><mrow><mn>2</mn></mrow></msub></math>    </td><td class='td11' id='TBL-00000005-22-4' style='text-align:center; white-space:nowrap;'>  <!-- l. 954 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mstyle mathcolor='#FF8000'><mn>110</mn></mstyle></mrow><mrow><mn>2</mn></mrow></msub></math>    </td><td class='td11' id='TBL-00000005-22-5' style='text-align:center; white-space:nowrap;'>  <!-- l. 954 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mstyle mathcolor='#FF8000'><mn>110</mn></mstyle></mrow><mrow><mn>2</mn></mrow></msub></math>    </td><td class='td11' id='TBL-00000005-22-6' style='text-align:center; white-space:nowrap;'>  <!-- l. 954 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mstyle mathcolor='#FF8000'><mn>111</mn></mstyle></mrow><mrow><mn>2</mn></mrow></msub></math>    </td><td class='td11' id='TBL-00000005-22-7' style='text-align:center; white-space:nowrap;'>  <!-- l. 954 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mstyle mathcolor='#FF8000'><mn>111</mn></mstyle></mrow><mrow><mn>2</mn></mrow></msub></math>    </td><td class='td11' id='TBL-00000005-22-8' style='text-align:center; white-space:nowrap;'>  <!-- l. 954 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mstyle mathcolor='#FF8000'><mn>111</mn></mstyle></mrow><mrow><mn>2</mn></mrow></msub></math>    </td><td class='td11' id='TBL-00000005-22-9' style='text-align:center; white-space:nowrap;'>  <!-- l. 954 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mstyle mathcolor='#FF8000'><mn>111</mn></mstyle><msub><mrow><mstyle mathcolor='#00FF00'><mn>00</mn></mstyle></mrow><mrow><mn>2</mn></mrow></msub></mrow></math>    </td>
</tr><tr class='hline'><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr id='TBL-000000005-25-'><td class='td11' id='TBL-000000005-25-1' style='text-align:center; white-space:nowrap;'> <!-- l. 954 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mstyle mathvariant='bold'><mi>𝐦</mi></mstyle></math> <span class='rm-lmbx-10x-x-109'>(plaintext) </span></td><td class='td11' id='TBL-000000005-25-2' style='text-align:center; white-space:nowrap;'>  <!-- l. 954 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mn>2</mn></mrow></math>   </td><td class='td11' id='TBL-000000005-25-3' style='text-align:center; white-space:nowrap;'>  <!-- l. 954 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mn>2</mn></mrow></math>   </td><td class='td11' id='TBL-000000005-25-4' style='text-align:center; white-space:nowrap;'>  <!-- l. 954 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mn>2</mn></mrow></math>   </td><td class='td11' id='TBL-000000005-25-5' style='text-align:center; white-space:nowrap;'>  <!-- l. 954 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mn>2</mn></mrow></math>   </td><td class='td11' id='TBL-000000005-25-6' style='text-align:center; white-space:nowrap;'>  <!-- l. 954 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></math>   </td><td class='td11' id='TBL-000000005-25-7' style='text-align:center; white-space:nowrap;'>  <!-- l. 954 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></math>   </td><td class='td11' id='TBL-000000005-25-8' style='text-align:center; white-space:nowrap;'>  <!-- l. 954 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></math>   </td><td class='td11' id='TBL-000000005-25-9' style='text-align:center; white-space:nowrap;'>  <!-- l. 954 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></math>   </td>
</tr><tr class='hline'><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr class='hline'><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr id='TBL-0000000005-28-'><td class='td11' id='TBL-0000000005-28-1' style='text-align:center; white-space:nowrap;'>       <!-- l. 954 --><math display='inline' mathvariant='bold-italic' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>i</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true'>^</mo></mover><mi>m</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>ê</mi></mrow></math>        </td><td class='td11' id='TBL-0000000005-28-2' style='text-align:center; white-space:nowrap;'>  <!-- l. 954 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mn>0</mn></math>   </td><td class='td11' id='TBL-0000000005-28-3' style='text-align:center; white-space:nowrap;'>  <!-- l. 954 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mn>1</mn></math>   </td><td class='td11' id='TBL-0000000005-28-4' style='text-align:center; white-space:nowrap;'>  <!-- l. 954 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mn>2</mn></math>   </td><td class='td11' id='TBL-0000000005-28-5' style='text-align:center; white-space:nowrap;'>  <!-- l. 954 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mn>3</mn></math>   </td><td class='td11' id='TBL-0000000005-28-6' style='text-align:center; white-space:nowrap;'>  <!-- l. 954 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mn>4</mn></math>   </td><td class='td11' id='TBL-0000000005-28-7' style='text-align:center; white-space:nowrap;'>  <!-- l. 954 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mn>5</mn></math>   </td><td class='td11' id='TBL-0000000005-28-8' style='text-align:center; white-space:nowrap;'>  <!-- l. 954 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mn>6</mn></math>   </td><td class='td11' id='TBL-0000000005-28-9' style='text-align:center; white-space:nowrap;'>  <!-- l. 954 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mn>7</mn></math>   </td></tr><tr id='TBL-00000000005-31-'><td class='td11' id='TBL-00000000005-31-1' style='text-align:center; white-space:nowrap;'>     (in <!-- l. 954 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>V</mi> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>X</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mi>i</mi></mrow></msup></mrow></math>)        </td><td class='td11' id='TBL-00000000005-31-2' style='text-align:center; white-space:nowrap;'> (<!-- l. 954 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mstyle mathcolor='#00FFFF'></mstyle><msub><mrow><mstyle mathcolor='#FF8000'><mn>000</mn></mstyle></mrow><mrow><mn>2</mn></mrow></msub></mrow></math>)  </td><td class='td11' id='TBL-00000000005-31-3' style='text-align:center; white-space:nowrap;'> (<!-- l. 954 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mstyle mathcolor='#00FFFF'></mstyle><msub><mrow><mstyle mathcolor='#FF8000'><mn>000</mn></mstyle></mrow><mrow><mn>2</mn></mrow></msub></mrow></math>)  </td><td class='td11' id='TBL-00000000005-31-4' style='text-align:center; white-space:nowrap;'> (<!-- l. 954 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mstyle mathcolor='#00FFFF'></mstyle><msub><mrow><mstyle mathcolor='#FF8000'><mn>000</mn></mstyle></mrow><mrow><mn>2</mn></mrow></msub></mrow></math>)  </td><td class='td11' id='TBL-00000000005-31-5' style='text-align:center; white-space:nowrap;'> (<!-- l. 954 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mstyle mathcolor='#00FFFF'></mstyle><msub><mrow><mstyle mathcolor='#FF8000'><mn>000</mn></mstyle></mrow><mrow><mn>2</mn></mrow></msub></mrow></math>)  </td><td class='td11' id='TBL-00000000005-31-6' style='text-align:center; white-space:nowrap;'> (<!-- l. 954 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mstyle mathcolor='#00FFFF'></mstyle><msub><mrow><mstyle mathcolor='#FF8000'><mn>001</mn></mstyle></mrow><mrow><mn>2</mn></mrow></msub></mrow></math>)  </td><td class='td11' id='TBL-00000000005-31-7' style='text-align:center; white-space:nowrap;'> (<!-- l. 954 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mstyle mathcolor='#00FFFF'></mstyle><msub><mrow><mstyle mathcolor='#FF8000'><mn>001</mn></mstyle></mrow><mrow><mn>2</mn></mrow></msub></mrow></math>)  </td><td class='td11' id='TBL-00000000005-31-8' style='text-align:center; white-space:nowrap;'> (<!-- l. 954 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mstyle mathcolor='#00FFFF'></mstyle><msub><mrow><mstyle mathcolor='#FF8000'><mn>001</mn></mstyle></mrow><mrow><mn>2</mn></mrow></msub></mrow></math>)  </td><td class='td11' id='TBL-00000000005-31-9' style='text-align:center; white-space:nowrap;'> (<!-- l. 954 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mstyle mathcolor='#00FFFF'></mstyle><msub><mrow><mstyle mathcolor='#FF8000'><mn>001</mn></mstyle></mrow><mrow><mn>2</mn></mrow></msub></mrow></math>)  </td>
</tr><tr class='hline'><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr id='TBL-000000000005-34-'><td class='td11' id='TBL-000000000005-34-1' style='text-align:center; white-space:nowrap;'>                                        <span class='rm-lmbx-10x-x-109'>constant term’s                                                       </span></td><td class='td11' id='TBL-000000000005-34-2' style='text-align:center; white-space:nowrap;'>  <!-- l. 954 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mn>0</mn></math>   </td><td class='td11' id='TBL-000000000005-34-3' style='text-align:center; white-space:nowrap;'>  <!-- l. 954 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mn>0</mn></math>   </td><td class='td11' id='TBL-000000000005-34-4' style='text-align:center; white-space:nowrap;'>  <!-- l. 954 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mn>0</mn></math>   </td><td class='td11' id='TBL-000000000005-34-5' style='text-align:center; white-space:nowrap;'>  <!-- l. 954 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mn>0</mn></math>   </td><td class='td11' id='TBL-000000000005-34-6' style='text-align:center; white-space:nowrap;'>  <!-- l. 954 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mn>1</mn></math>   </td><td class='td11' id='TBL-000000000005-34-7' style='text-align:center; white-space:nowrap;'>  <!-- l. 954 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mn>1</mn></math>   </td><td class='td11' id='TBL-000000000005-34-8' style='text-align:center; white-space:nowrap;'>  <!-- l. 954 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mn>1</mn></math>   </td><td class='td11' id='TBL-000000000005-34-9' style='text-align:center; white-space:nowrap;'>  <!-- l. 954 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mn>1</mn></math>   </td></tr><tr id='TBL-0000000000005-37-'><td class='td11' id='TBL-0000000000005-37-1' style='text-align:center; white-space:nowrap;'>  <span class='rm-lmbx-10x-x-109'>coeff. of </span><!-- l. 954 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>V</mi> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>X</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mi>i</mi></mrow></msup></mrow></math>     </td><td class='td11' id='TBL-0000000000005-37-2' style='text-align:center; white-space:nowrap;'>  <!-- l. 954 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mstyle mathcolor='#FF8000'><mn>000</mn></mstyle><msub><mrow><mstyle mathcolor='#00FF00'><mn>00</mn></mstyle></mrow><mrow><mn>2</mn></mrow></msub></mrow></math>    </td><td class='td11' id='TBL-0000000000005-37-3' style='text-align:center; white-space:nowrap;'>  <!-- l. 954 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mstyle mathcolor='#FF8000'><mn>000</mn></mstyle><msub><mrow><mstyle mathcolor='#00FF00'><mn>00</mn></mstyle></mrow><mrow><mn>2</mn></mrow></msub></mrow></math>    </td><td class='td11' id='TBL-0000000000005-37-4' style='text-align:center; white-space:nowrap;'>  <!-- l. 954 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mstyle mathcolor='#FF8000'><mn>000</mn></mstyle><msub><mrow><mstyle mathcolor='#00FF00'><mn>00</mn></mstyle></mrow><mrow><mn>2</mn></mrow></msub></mrow></math>    </td><td class='td11' id='TBL-0000000000005-37-5' style='text-align:center; white-space:nowrap;'>  <!-- l. 954 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mstyle mathcolor='#FF8000'><mn>000</mn></mstyle><msub><mrow><mstyle mathcolor='#00FF00'><mn>00</mn></mstyle></mrow><mrow><mn>2</mn></mrow></msub></mrow></math>    </td><td class='td11' id='TBL-0000000000005-37-6' style='text-align:center; white-space:nowrap;'>  <!-- l. 954 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mstyle mathcolor='#FF8000'><mn>001</mn></mstyle><msub><mrow><mstyle mathcolor='#00FF00'><mn>00</mn></mstyle></mrow><mrow><mn>2</mn></mrow></msub></mrow></math>    </td><td class='td11' id='TBL-0000000000005-37-7' style='text-align:center; white-space:nowrap;'>  <!-- l. 954 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mstyle mathcolor='#FF8000'><mn>001</mn></mstyle><msub><mrow><mstyle mathcolor='#00FF00'><mn>00</mn></mstyle></mrow><mrow><mn>2</mn></mrow></msub></mrow></math>    </td><td class='td11' id='TBL-0000000000005-37-8' style='text-align:center; white-space:nowrap;'>  <!-- l. 954 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mstyle mathcolor='#FF8000'><mn>001</mn></mstyle><msub><mrow><mstyle mathcolor='#00FF00'><mn>00</mn></mstyle></mrow><mrow><mn>2</mn></mrow></msub></mrow></math>    </td><td class='td11' id='TBL-0000000000005-37-9' style='text-align:center; white-space:nowrap;'>  <!-- l. 954 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mstyle mathcolor='#FF8000'><mn>001</mn></mstyle><msub><mrow><mstyle mathcolor='#00FF00'><mn>00</mn></mstyle></mrow><mrow><mn>2</mn></mrow></msub></mrow></math>    </td>
</tr><tr class='hline'><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr id='TBL-00000000000005-40-'><td class='td11' id='TBL-00000000000005-40-1' style='text-align:center; white-space:nowrap;'> <!-- l. 954 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mstyle mathvariant='bold'><mi>𝐦</mi></mstyle></math> <span class='rm-lmbx-10x-x-109'>(plaintext) </span></td><td class='td11' id='TBL-00000000000005-40-2' style='text-align:center; white-space:nowrap;'>  <!-- l. 954 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mn>0</mn></math>   </td><td class='td11' id='TBL-00000000000005-40-3' style='text-align:center; white-space:nowrap;'>  <!-- l. 954 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mn>0</mn></math>   </td><td class='td11' id='TBL-00000000000005-40-4' style='text-align:center; white-space:nowrap;'>  <!-- l. 954 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mn>0</mn></math>   </td><td class='td11' id='TBL-00000000000005-40-5' style='text-align:center; white-space:nowrap;'>  <!-- l. 954 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mn>0</mn></math>   </td><td class='td11' id='TBL-00000000000005-40-6' style='text-align:center; white-space:nowrap;'>  <!-- l. 954 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mn>1</mn></math>   </td><td class='td11' id='TBL-00000000000005-40-7' style='text-align:center; white-space:nowrap;'>  <!-- l. 954 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mn>1</mn></math>   </td><td class='td11' id='TBL-00000000000005-40-8' style='text-align:center; white-space:nowrap;'>  <!-- l. 954 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mn>1</mn></math>   </td><td class='td11' id='TBL-00000000000005-40-9' style='text-align:center; white-space:nowrap;'>  <!-- l. 954 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mn>1</mn></math>   </td>
</tr><tr class='hline'><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr></table> </div></div>
   
                                                                                         
                                                                                         
<figcaption class='caption'><span class='id'>Table 1: </span><span class='content'>The Lookup Table for <!-- l. 958 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>n</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>16</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mi>q</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>64</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mi>t</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>8</mn></mrow></math>
LWE setup. <span id='textcolor32'>Orange</span> is the plaintext <!-- l. 958 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>m</mi></math>’s
bits. <span id='textcolor33'>Green</span> is the noise <!-- l. 958 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>e</mi></math>’s
bits.                                                                                      </span></figcaption><!-- tex4ht:label?: x1338003r1  -->
   </figure>
   </div>
   <!-- l. 962 --><p class='noindent'>Note that <!-- l. 962 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>V</mi> <mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>’s
   coefficients for the <!-- l. 962 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>X</mi></mrow><mrow><mn>8</mn></mrow></msup> <mo class='MathClass-rel' stretchy='false'>∼</mo><msup><mrow><mi>X</mi></mrow><mrow><mn>15</mn></mrow></msup></mrow></math>
   terms are <!-- l. 962 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>{</mo><mn>2</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>}</mo></mrow></math>
   instead of <!-- l. 962 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>{</mo><mo class='MathClass-bin' stretchy='false'>−</mo><mn>2</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>}</mo></mrow></math>,
   so that if <!-- l. 962 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>V</mi> </mrow></math> gets
   rotated by <!-- l. 962 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>{</mo><mo class='MathClass-bin' stretchy='false'>−</mo><mn>8</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-bin' stretchy='false'>−</mo><mn>7</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-bin' stretchy='false'>−</mo><mn>6</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-bin' stretchy='false'>−</mo><mn>5</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>4</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>5</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>6</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>7</mn><mo class='MathClass-close' stretchy='false'>}</mo></mrow></math>
   slots to the left, the constant term’s coefficient flips its sign to
   <!-- l. 962 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>{</mo><mo class='MathClass-bin' stretchy='false'>−</mo><mn>2</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>}</mo></mrow></math>due to wrapping around
   the boundary of the <!-- l. 962 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>n</mi></math>
   exponent.
   </p><!-- l. 964 --><p class='noindent'>During the actual bootstrapping, we will do blind rotation of <a href='#the-lookup-table-for-n-q-t-lwe-setup-orangeorange-is-the-plaintext-ms-bits-greengreen-is-the-noise-es-bits-'>Table 1<!-- tex4ht:ref: subsec:coeffrrotation  --></a>’s
   <!-- l. 964 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>V</mi> <mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math> (which is
   GLWE-encrypted) by <!-- l. 964 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mover accent='true'><mrow><mi>b</mi></mrow><mo accent='true'>^</mo></mover> <mo class='MathClass-bin' stretchy='false'>−</mo><munderover accent='false' accentunder='false'><mrow><mi class='MathClass-op'>∑</mi><mo> ⁡<!-- FUNCTION APPLICATION --></mo>
  </mrow><mrow><mi>i</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>0</mn></mrow><mrow><mn>7</mn></mrow></munderover><msub><mrow><mi>â</mi></mrow><mrow><mi>i</mi></mrow></msub><msub><mrow><mi>s</mi></mrow><mrow><mi>i</mi></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>4</mn></mrow></math>
   positions to the left, which computed as follows:
   </p><!-- l. 966 --><p class='noindent'><!-- l. 966 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true'>^</mo></mover><mi>m</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>ê</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mover accent='true'><mrow><mi>b</mi></mrow><mo accent='true'>^</mo></mover> <mo class='MathClass-bin' stretchy='false'>−</mo><munderover accent='false' accentunder='false'><mrow><mi class='MathClass-op'>∑</mi><mo> ⁡<!-- FUNCTION APPLICATION --></mo>
  </mrow><mrow><mi>i</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>0</mn></mrow><mrow><mn>7</mn></mrow></munderover><msub><mrow><mi>â</mi></mrow><mrow><mi>i</mi></mrow></msub><msub><mrow><mi>s</mi></mrow><mrow><mi>i</mi></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>12</mn> <mo class='MathClass-bin' stretchy='false'>−</mo><mo class='MathClass-open' stretchy='false'>(</mo><mn>4</mn> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>16</mn> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>16</mn> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>4</mn><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>4</mn><mstyle class='text'><mtext> mod 32</mtext></mstyle> <mo class='MathClass-rel' stretchy='false'>∈</mo> <msub><mrow><mi>ℤ</mi></mrow><mrow><mn>2</mn><mi>n</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>32</mn></mrow></msub></mrow></math>
   </p><!-- l. 969 --><p class='noindent'>In <a href='#the-lookup-table-for-n-q-t-lwe-setup-orangeorange-is-the-plaintext-ms-bits-greengreen-is-the-noise-es-bits-'>Table 1<!-- tex4ht:ref: subsec:coeffrrotation  --></a>, if the rotation count <!-- l. 969 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>i</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>4</mn></mrow></math>, the
   corresponding constant term coefficient is <!-- l. 969 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>v</mi></mrow><mrow><mn>4</mn></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>1</mn> <mo class='MathClass-rel' stretchy='false'>=</mo> <mi>m</mi></mrow></math>.
   As <!-- l. 969 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi mathvariant='normal'>Δ</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>4</mn></mrow></math>, we
   finally get <!-- l. 969 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mover accent='true'><mrow><mi>s</mi></mrow><mo accent='true'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mi mathvariant='normal'>Δ</mi><mi>m</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>1</mn></mrow></math>.
   </p><!-- l. 973 --><p class='noindent'><!-- l. 973 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
   </p><!-- l. 975 --><p class='noindent'>The actual blind rotation is computed as follows:
   </p><!-- l. 977 --><p class='noindent'><!-- l. 977 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mover accent='true'><mrow><mi>s</mi></mrow><mo accent='true'>→</mo></mover> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>(</mo><mn>1</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>0</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>0</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>1</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>1</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>1</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>0</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
   </p><!-- l. 979 --><p class='noindent'><!-- l. 979 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mover accent='true'><mrow><mi>s</mi></mrow><mo accent='true'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true'>^</mo></mover><mi>m</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>â</mi></mrow><mrow><mn>0</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>â</mi></mrow><mrow><mn>1</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>â</mi></mrow><mrow><mn>2</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>â</mi></mrow><mrow><mn>3</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>â</mi></mrow><mrow><mn>4</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>â</mi></mrow><mrow><mn>5</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>â</mi></mrow><mrow><mn>6</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>â</mi></mrow><mrow><mn>7</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><mover accent='true'><mrow><mi>b</mi></mrow><mo accent='true'>^</mo></mover><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>(</mo><mn>4</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-bin' stretchy='false'>−</mo><mn>14</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>2</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-bin' stretchy='false'>−</mo><mn>16</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>0</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>16</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-bin' stretchy='false'>−</mo><mn>3</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>4</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>12</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
   </p><!-- l. 981 --><p class='noindent'><!-- l. 981 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>V</mi> </mrow><mrow><mn>0</mn></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo> <mi>V</mi> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>X</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mover accent='true'><mrow><mi>b</mi></mrow><mo accent='true'>^</mo></mover></mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo> <mi>V</mi> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>X</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mn>12</mn></mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mi>v</mi></mrow><mrow><mn>12</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>v</mi></mrow><mrow><mn>13</mn></mrow></msub><mi>X</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>v</mi></mrow><mrow><mn>14</mn></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mn>2</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace></mrow></math>
   </p><!-- l. 983 --><p class='noindent'><!-- l. 983 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>V</mi> </mrow><mrow><mn>1</mn></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mi>V</mi> </mrow><mrow><mn>0</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>X</mi></mrow><mrow><msub><mrow><mi>â</mi></mrow><mrow><mn>0</mn></mrow></msub><msub><mrow><mi>s</mi></mrow><mrow><mn>0</mn></mrow></msub></mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mi>s</mi></mrow><mrow><mn>0</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>V</mi> </mrow><mrow><mn>0</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>X</mi></mrow><mrow><msub><mrow><mi>a</mi></mrow><mrow><mn>0</mn></mrow></msub></mrow></msup> <mo class='MathClass-bin' stretchy='false'>−</mo><msub><mrow><mi>V</mi> </mrow><mrow><mn>0</mn></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>V</mi> </mrow><mrow><mn>0</mn></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mi>V</mi> </mrow><mrow><mn>0</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>X</mi></mrow><mrow><mn>4</mn></mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mi>v</mi></mrow><mrow><mn>8</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>v</mi></mrow><mrow><mn>9</mn></mrow></msub><mi>X</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>v</mi></mrow><mrow><mn>10</mn></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mn>2</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace></mrow></math>
   </p><!-- l. 985 --><p class='noindent'><!-- l. 985 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>V</mi> </mrow><mrow><mn>2</mn></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mi>V</mi> </mrow><mrow><mn>1</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>X</mi></mrow><mrow><msub><mrow><mi>â</mi></mrow><mrow><mn>1</mn></mrow></msub><msub><mrow><mi>s</mi></mrow><mrow><mn>1</mn></mrow></msub></mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mi>s</mi></mrow><mrow><mn>1</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>V</mi> </mrow><mrow><mn>1</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>X</mi></mrow><mrow><msub><mrow><mi>a</mi></mrow><mrow><mn>1</mn></mrow></msub></mrow></msup> <mo class='MathClass-bin' stretchy='false'>−</mo><msub><mrow><mi>V</mi> </mrow><mrow><mn>1</mn></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>V</mi> </mrow><mrow><mn>1</mn></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mi>V</mi> </mrow><mrow><mn>1</mn></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mi>v</mi></mrow><mrow><mn>8</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>v</mi></mrow><mrow><mn>9</mn></mrow></msub><mi>X</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>v</mi></mrow><mrow><mn>10</mn></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mn>2</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace></mrow></math>
   </p><!-- l. 987 --><p class='noindent'><!-- l. 987 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>V</mi> </mrow><mrow><mn>3</mn></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mi>V</mi> </mrow><mrow><mn>2</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>X</mi></mrow><mrow><msub><mrow><mi>â</mi></mrow><mrow><mn>2</mn></mrow></msub><msub><mrow><mi>s</mi></mrow><mrow><mn>2</mn></mrow></msub></mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mi>s</mi></mrow><mrow><mn>2</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>V</mi> </mrow><mrow><mn>2</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>X</mi></mrow><mrow><msub><mrow><mi>a</mi></mrow><mrow><mn>2</mn></mrow></msub></mrow></msup> <mo class='MathClass-bin' stretchy='false'>−</mo><msub><mrow><mi>V</mi> </mrow><mrow><mn>2</mn></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>V</mi> </mrow><mrow><mn>2</mn></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mi>V</mi> </mrow><mrow><mn>2</mn></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mi>v</mi></mrow><mrow><mn>8</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>v</mi></mrow><mrow><mn>9</mn></mrow></msub><mi>X</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>v</mi></mrow><mrow><mn>10</mn></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mn>2</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace></mrow></math>
   </p><!-- l. 989 --><p class='noindent'><!-- l. 989 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>V</mi> </mrow><mrow><mn>4</mn></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mi>V</mi> </mrow><mrow><mn>3</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>X</mi></mrow><mrow><msub><mrow><mi>â</mi></mrow><mrow><mn>3</mn></mrow></msub><msub><mrow><mi>s</mi></mrow><mrow><mn>3</mn></mrow></msub></mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mi>s</mi></mrow><mrow><mn>3</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>V</mi> </mrow><mrow><mn>3</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>X</mi></mrow><mrow><msub><mrow><mi>a</mi></mrow><mrow><mn>3</mn></mrow></msub></mrow></msup> <mo class='MathClass-bin' stretchy='false'>−</mo><msub><mrow><mi>V</mi> </mrow><mrow><mn>3</mn></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>V</mi> </mrow><mrow><mn>3</mn></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mi>V</mi> </mrow><mrow><mn>3</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>X</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mn>16</mn></mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-bin' stretchy='false'>−</mo><msub><mrow><mi>v</mi></mrow><mrow><mn>8</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>−</mo><msub><mrow><mi>v</mi></mrow><mrow><mn>9</mn></mrow></msub><mi>X</mi> <mo class='MathClass-bin' stretchy='false'>−</mo><msub><mrow><mi>v</mi></mrow><mrow><mn>10</mn></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mn>2</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>−</mo><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace></mrow></math>
   </p><!-- l. 991 --><p class='noindent'><!-- l. 991 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>V</mi> </mrow><mrow><mn>5</mn></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mi>V</mi> </mrow><mrow><mn>4</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>X</mi></mrow><mrow><msub><mrow><mi>â</mi></mrow><mrow><mn>4</mn></mrow></msub><msub><mrow><mi>s</mi></mrow><mrow><mn>4</mn></mrow></msub></mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mi>s</mi></mrow><mrow><mn>4</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>V</mi> </mrow><mrow><mn>4</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>X</mi></mrow><mrow><msub><mrow><mi>a</mi></mrow><mrow><mn>4</mn></mrow></msub></mrow></msup> <mo class='MathClass-bin' stretchy='false'>−</mo><msub><mrow><mi>V</mi> </mrow><mrow><mn>4</mn></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>V</mi> </mrow><mrow><mn>4</mn></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mi>V</mi> </mrow><mrow><mn>4</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>X</mi></mrow><mrow><mn>0</mn></mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-bin' stretchy='false'>−</mo><msub><mrow><mi>v</mi></mrow><mrow><mn>8</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>−</mo><msub><mrow><mi>v</mi></mrow><mrow><mn>9</mn></mrow></msub><mi>X</mi> <mo class='MathClass-bin' stretchy='false'>−</mo><msub><mrow><mi>v</mi></mrow><mrow><mn>10</mn></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mn>2</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>−</mo><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace></mrow></math>
   </p><!-- l. 993 --><p class='noindent'><!-- l. 993 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>V</mi> </mrow><mrow><mn>6</mn></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mi>V</mi> </mrow><mrow><mn>5</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>X</mi></mrow><mrow><msub><mrow><mi>â</mi></mrow><mrow><mn>5</mn></mrow></msub><msub><mrow><mi>s</mi></mrow><mrow><mn>5</mn></mrow></msub></mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mi>s</mi></mrow><mrow><mn>5</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>V</mi> </mrow><mrow><mn>5</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>X</mi></mrow><mrow><msub><mrow><mi>a</mi></mrow><mrow><mn>5</mn></mrow></msub></mrow></msup> <mo class='MathClass-bin' stretchy='false'>−</mo><msub><mrow><mi>V</mi> </mrow><mrow><mn>5</mn></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>V</mi> </mrow><mrow><mn>5</mn></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mi>V</mi> </mrow><mrow><mn>5</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>X</mi></mrow><mrow><mn>16</mn></mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mi>v</mi></mrow><mrow><mn>8</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>v</mi></mrow><mrow><mn>9</mn></mrow></msub><mi>X</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>v</mi></mrow><mrow><mn>10</mn></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mn>2</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace></mrow></math>
   </p><!-- l. 995 --><p class='noindent'><!-- l. 995 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>V</mi> </mrow><mrow><mn>7</mn></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mi>V</mi> </mrow><mrow><mn>6</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>X</mi></mrow><mrow><msub><mrow><mi>â</mi></mrow><mrow><mn>6</mn></mrow></msub><msub><mrow><mi>s</mi></mrow><mrow><mn>6</mn></mrow></msub></mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mi>s</mi></mrow><mrow><mn>6</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>V</mi> </mrow><mrow><mn>6</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>X</mi></mrow><mrow><msub><mrow><mi>a</mi></mrow><mrow><mn>6</mn></mrow></msub></mrow></msup> <mo class='MathClass-bin' stretchy='false'>−</mo><msub><mrow><mi>V</mi> </mrow><mrow><mn>6</mn></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>V</mi> </mrow><mrow><mn>6</mn></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mi>V</mi> </mrow><mrow><mn>6</mn></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mi>v</mi></mrow><mrow><mn>8</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>v</mi></mrow><mrow><mn>9</mn></mrow></msub><mi>X</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>v</mi></mrow><mrow><mn>10</mn></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mn>2</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace></mrow></math>
   </p><!-- l. 997 --><p class='noindent'><!-- l. 997 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>V</mi> </mrow><mrow><mn>8</mn></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mi>V</mi> </mrow><mrow><mn>7</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>X</mi></mrow><mrow><msub><mrow><mi>â</mi></mrow><mrow><mn>7</mn></mrow></msub><msub><mrow><mi>s</mi></mrow><mrow><mn>7</mn></mrow></msub></mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mi>s</mi></mrow><mrow><mn>7</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>V</mi> </mrow><mrow><mn>7</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>X</mi></mrow><mrow><msub><mrow><mi>a</mi></mrow><mrow><mn>7</mn></mrow></msub></mrow></msup> <mo class='MathClass-bin' stretchy='false'>−</mo><msub><mrow><mi>V</mi> </mrow><mrow><mn>7</mn></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>V</mi> </mrow><mrow><mn>7</mn></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mi>V</mi> </mrow><mrow><mn>7</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>X</mi></mrow><mrow><mn>4</mn></mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mi>v</mi></mrow><mrow><mn>4</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>v</mi></mrow><mrow><mn>5</mn></mrow></msub><mi>X</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>v</mi></mrow><mrow><mn>6</mn></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mn>2</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace></mrow></math>
   </p><!-- l. 999 --><p class='noindent'><!-- l. 999 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
   </p><!-- l. 1001 --><p class='noindent'>The final output of blind rotation is the GLWE ciphertext of
   <!-- l. 1001 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>V</mi> </mrow><mrow><mn>8</mn></mrow></msub></math>,
   <!-- l. 1001 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖦𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mover accent='true'><mrow><mi>S</mi></mrow><mo accent='true'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>V</mi> </mrow><mrow><mn>8</mn></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>, whose constant
   term’s coefficient is <!-- l. 1001 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>v</mi></mrow><mrow><mn>4</mn></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo> <mi>m</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>1</mn></mrow></math>.
   </p><!-- l. 1003 --><p class='noindent'><!-- l. 1003 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
   </p><!-- l. 1005 --><p class='noindent'>Each step of the actual blind rotation above is computed as the following TFHE ciphertext-to-ciphertext
                                                                                         
                                                                                         
   multiplication:
   </p><!-- l. 1007 --><p class='noindent'><!-- l. 1007 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖦𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mover accent='true'><mrow><mi>S</mi></mrow><mo accent='true'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>V</mi> </mrow><mrow><mi>i</mi><mo class='MathClass-bin' stretchy='false'>+</mo><mn>1</mn></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo><msubsup><mrow> <mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖦𝖦𝖲𝖶</mtext></mstyle></mrow><mrow><mover accent='true'><mrow><mi>S</mi></mrow><mo accent='true'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow><mrow><mi>β</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>l</mi></mrow></msubsup><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>s</mi></mrow><mrow><mi>i</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖦𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mover accent='true'><mrow><mi>S</mi></mrow><mo accent='true'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>V</mi> </mrow><mrow><mi>i</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>X</mi></mrow><mrow><msub><mrow><mi>a</mi></mrow><mrow><mn>0</mn></mrow></msub></mrow></msup> <mo class='MathClass-bin' stretchy='false'>−</mo><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖦𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mover accent='true'><mrow><mi>S</mi></mrow><mo accent='true'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>V</mi> </mrow><mrow><mi>i</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>+</mo><msub><mrow> <mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖦𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mover accent='true'><mrow><mi>S</mi></mrow><mo accent='true'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>V</mi> </mrow><mrow><mi>i</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
   </p><!-- l. 1009 --><p class='noindent'><!-- l. 1009 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
   </p><!-- l. 1011 --><p class='noindent'>We will leave this computation for the reader’s exercise.
   </p><!-- l. 1013 --><p class='noindent'><!-- l. 1013 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
   </p></dd><dt class='enumerate-enumitem'>
3. </dt><dd class='enumerate-enumitem'><span class='rm-lmbx-10x-x-109'>Coefficient Extraction: </span>At the end of blind rotation, we finally get the following GLWE
   ciphertext:
   <!-- l. 1017 --><p class='noindent'><!-- l. 1017 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖦𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mover accent='true'><mrow><mi>S</mi></mrow><mo accent='true'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>V</mi> </mrow><mrow><mn>8</mn></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
   </p><!-- l. 1019 --><p class='noindent'><!-- l. 1019 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo><msub><mrow> <mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖦𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mover accent='true'><mrow><mi>S</mi></mrow><mo accent='true'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mstyle mathvariant='bold'><mo class='MathClass-open' stretchy='false'>(</mo></mstyle><mi mathvariant='normal'>Δ</mi><mo class='MathClass-bin' stretchy='false'>⋅</mo><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>v</mi></mrow><mrow><mn>4</mn></mrow></msub><mo class='MathClass-bin' stretchy='false'>+</mo><msub><mrow><mi>v</mi></mrow><mrow><mn>5</mn></mrow></msub><mi>X</mi><mo class='MathClass-bin' stretchy='false'>+</mo><msub><mrow><mi>v</mi></mrow><mrow><mn>6</mn></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mn>2</mn></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo><msub><mrow><mi>v</mi></mrow><mrow><mn>7</mn></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mn>3</mn></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo><msub><mrow><mi>v</mi></mrow><mrow><mn>8</mn></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mn>4</mn></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo><msub><mrow><mi>v</mi></mrow><mrow><mn>9</mn></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mn>5</mn></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo><msub><mrow><mi>v</mi></mrow><mrow><mn>10</mn></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mn>6</mn></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo><msub><mrow><mi>v</mi></mrow><mrow><mn>11</mn></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mn>7</mn></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo><msub><mrow><mi>v</mi></mrow><mrow><mn>12</mn></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mn>8</mn></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo><msub><mrow><mi>v</mi></mrow><mrow><mn>13</mn></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mn>9</mn></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo><msub><mrow><mi>v</mi></mrow><mrow><mn>14</mn></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mn>10</mn></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo><msub><mrow><mi>v</mi></mrow><mrow><mn>15</mn></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mn>11</mn></mrow></msup><mo class='MathClass-bin' stretchy='false'>−</mo><msub><mrow><mi>v</mi></mrow><mrow><mn>0</mn></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mn>12</mn></mrow></msup><mo class='MathClass-bin' stretchy='false'>−</mo><msub><mrow><mi>v</mi></mrow><mrow><mn>1</mn></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mn>13</mn></mrow></msup><mo class='MathClass-bin' stretchy='false'>−</mo><msub><mrow><mi>v</mi></mrow><mrow><mn>2</mn></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mn>14</mn></mrow></msup><mo class='MathClass-bin' stretchy='false'>−</mo><msub><mrow><mi>v</mi></mrow><mrow><mn>3</mn></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mn>15</mn></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mstyle mathvariant='bold'><mo class='MathClass-close' stretchy='false'>)</mo></mstyle></mrow></math>
   </p><!-- l. 1021 --><p class='noindent'><!-- l. 1021 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo><msub><mrow> <mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖦𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mover accent='true'><mrow><mi>S</mi></mrow><mo accent='true'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mstyle mathvariant='bold'><mo class='MathClass-open' stretchy='false'>(</mo></mstyle><mi mathvariant='normal'>Δ</mi><mo class='MathClass-bin' stretchy='false'>⋅</mo><mo class='MathClass-open' stretchy='false'>(</mo><mn>1</mn><mo class='MathClass-bin' stretchy='false'>+</mo><mn>1</mn><mi>X</mi><mo class='MathClass-bin' stretchy='false'>+</mo><mn>1</mn><msup><mrow><mi>X</mi></mrow><mrow><mn>2</mn></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo><mn>1</mn><msup><mrow><mi>X</mi></mrow><mrow><mn>3</mn></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo><mn>2</mn><msup><mrow><mi>X</mi></mrow><mrow><mn>4</mn></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo><mn>2</mn><msup><mrow><mi>X</mi></mrow><mrow><mn>5</mn></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo><mn>2</mn><msup><mrow><mi>X</mi></mrow><mrow><mn>6</mn></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo><mn>2</mn><msup><mrow><mi>X</mi></mrow><mrow><mn>7</mn></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo><mn>1</mn><msup><mrow><mi>X</mi></mrow><mrow><mn>8</mn></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo><mn>1</mn><msup><mrow><mi>X</mi></mrow><mrow><mn>9</mn></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo><mn>1</mn><msup><mrow><mi>X</mi></mrow><mrow><mn>10</mn></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo><mn>1</mn><msup><mrow><mi>X</mi></mrow><mrow><mn>11</mn></mrow></msup><mo class='MathClass-bin' stretchy='false'>−</mo><mn>0</mn><msup><mrow><mi>X</mi></mrow><mrow><mn>12</mn></mrow></msup><mo class='MathClass-bin' stretchy='false'>−</mo><mn>0</mn><msup><mrow><mi>X</mi></mrow><mrow><mn>13</mn></mrow></msup><mo class='MathClass-bin' stretchy='false'>−</mo><mn>0</mn><msup><mrow><mi>X</mi></mrow><mrow><mn>14</mn></mrow></msup><mo class='MathClass-bin' stretchy='false'>−</mo><mn>0</mn><msup><mrow><mi>X</mi></mrow><mrow><mn>15</mn></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mstyle mathvariant='bold'><mo class='MathClass-close' stretchy='false'>)</mo></mstyle></mrow></math>
   </p><!-- l. 1023 --><p class='noindent'><!-- l. 1023 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo> <mrow><mo fence='true' form='prefix'>(</mo><mrow><msub><mrow><mi>A</mi></mrow><mrow><mn>0</mn></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo><munderover accent='false' accentunder='false'><mrow> <mi class='MathClass-op'>∑</mi><mo> ⁡<!-- FUNCTION APPLICATION --></mo>
  </mrow><mrow><mi>j</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>0</mn></mrow><mrow><mn>15</mn></mrow></munderover><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>a</mi></mrow><mrow><mn>0</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>0</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>a</mi></mrow><mrow><mn>0</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>1</mn></mrow></msub><mi>X</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>A</mi></mrow><mrow><mn>1</mn></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>A</mi></mrow><mrow><mi>k</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace><mo class='MathClass-punc' stretchy='false'>,</mo><mi>B</mi> <mo class='MathClass-rel' stretchy='false'>=</mo><munderover accent='false' accentunder='false'><mrow><mo> ∑</mo>
  </mrow><mrow><mi>j</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>0</mn></mrow><mrow><mn>15</mn></mrow></munderover><msub><mrow><mi>b</mi></mrow><mrow><mi>j</mi></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mi>j</mi></mrow></msup></mrow><mo fence='true' form='postfix'>)</mo></mrow></mrow></math>
   </p><!-- l. 1025 --><p class='noindent'>Now, we extract the constant term’s coefficient of the encrypted polynomial
   <!-- l. 1025 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖦𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mover accent='true'><mrow><mi>S</mi></mrow><mo accent='true'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mi mathvariant='normal'>Δ</mi> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mo class='MathClass-open' stretchy='false'>(</mo><mn>1</mn> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>1</mn><mi>X</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>1</mn><msup><mrow><mi>X</mi></mrow><mrow><mn>2</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math> by using the
   coefficient extraction formula (Summary <a href='#coefficient-extraction'>D-1.7<!-- tex4ht:ref: subsec:tfheeextraction  --></a>). Specifically, we will extract the constant term’s coefficient, which
   corresponds to <!-- l. 1025 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mover accent='true'><mrow><mi>s</mi></mrow><mo accent='true'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mi mathvariant='normal'>Δ</mi><msub><mrow><mi>m</mi></mrow><mrow><mn>0</mn></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>.
   We extract <!-- l. 1025 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mover accent='true'><mrow><mi>s</mi></mrow><mo accent='true'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mi mathvariant='normal'>Δ</mi><msub><mrow><mi>m</mi></mrow><mrow><mn>0</mn></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
   by computing the following:
   </p><!-- l. 1027 --><p class='noindent'><!-- l. 1027 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mover accent='true'><mrow><mi>s</mi></mrow><mo accent='true'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mi mathvariant='normal'>Δ</mi><msub><mrow><mi>m</mi></mrow><mrow><mn>0</mn></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>(</mo><msubsup><mrow><mi>a</mi></mrow><mrow><mn>0</mn></mrow><mrow><mi>′</mi></mrow></msubsup><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>a</mi><msup><mrow></mrow><mrow><mn>1</mn></mrow></msup></mrow><mrow><mi>′</mi></mrow><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><mstyle class='text'><mtext></mtext><mstyle class='math'><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace></mstyle><mtext></mtext></mstyle><mstyle class='text'><mtext> </mtext></mstyle><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>a</mi><msup><mrow></mrow><mrow><mi>k</mi></mrow></msup></mrow><mrow><mi>′</mi></mrow><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>b</mi></mrow><mrow><mi>h</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo></msub>
</msub></mrow></math></p>
   <table class='equation-star'><tr><td>
   <!-- l. 1029 --><math class='equation' display='block' xmlns='http://www.w3.org/1998/Math/MathML'><mrow>
<mstyle class='text'><mtext>, where </mtext></mstyle><msubsup><mrow><mi>a</mi></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>⋅</mo><mi>i</mi><mo class='MathClass-bin' stretchy='false'>+</mo><mi>j</mi></mrow><mrow><mi>′</mi></mrow></msubsup> <mo class='MathClass-rel' stretchy='false'>=</mo> <mrow class='cases'> <mrow><mo fence='true' form='prefix'>{</mo><mrow> <mtable align='axis' class='array' columnlines='none' displaystyle='true' equalcolumns='false' equalrows='false' rowlines='none none none none' style=''> <mtr class='array-row'><mtd class='array-td' columnalign='left'><msub><mrow><mi>a</mi></mrow><mrow><mi>i</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mn>0</mn><mo class='MathClass-bin' stretchy='false'>−</mo><mi>j</mi></mrow></msub><mstyle class='text'><mtext> (if </mtext></mstyle><mn>0</mn> <mo class='MathClass-rel' stretchy='false'>≤</mo><mi>j</mi> <mo class='MathClass-rel' stretchy='false'>≤</mo><mn>0</mn><mstyle class='text'><mtext>)</mtext></mstyle>              <mspace class='quad' width='1em'></mspace></mtd></mtr>  <mtr class='array-row'><mtd class='array-td' columnalign='left'><mspace class='quad' width='1em'></mspace></mtd></mtr>  <mtr class='array-row'><mtd class='array-td' columnalign='left'><mspace class='quad' width='1em'></mspace></mtd>
</mtr>  <mtr class='array-row'><mtd class='array-td' columnalign='left'><msub><mrow><mi>a</mi></mrow><mrow><mi>i</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>n</mi><mo class='MathClass-bin' stretchy='false'>+</mo><mn>0</mn><mo class='MathClass-bin' stretchy='false'>−</mo><mi>j</mi></mrow></msub><mstyle class='text'><mtext> (if </mtext></mstyle><mn>0</mn> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>1</mn> <mo class='MathClass-rel' stretchy='false'>≤</mo><mi>j</mi> <mo class='MathClass-rel' stretchy='false'>≤</mo><mi>n</mi> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn><mstyle class='text'><mtext>)</mtext></mstyle><mspace class='quad' width='1em'></mspace></mtd></mtr>  <mtr class='array-row'><mtd class='array-td' columnalign='left'><mspace class='quad' width='1em'></mspace></mtd></mtr>    <!-- @{}l@{\quad }l@{} --></mtable>                                                                                       </mrow><mo fence='true' form='postfix'></mo></mrow></mrow><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>b</mi></mrow><mrow><mn>0</mn></mrow></msub><mstyle class='text'><mtext> is obtained from the polynomial </mtext></mstyle><mi>B</mi>
</mrow></math></td></tr></table>
   </dd></dl>
   
   <h5 class='subsubsectionHead' id='discussion'><span class='titlemark'>D-1.8.8   </span> <a id='x1-39000D-1.8.8'></a>Discussion</h5>
   <ul class='itemize1'>
   <li class='itemize'><span class='rm-lmbx-10x-x-109'>Programmable  Bootstrapping</span>:  While  the  bootstrapping  (<a href='#noise-bootstrapping'><span class='ts1-lmr10-x-x-109'>§</span>D-1.8<!-- tex4ht:ref: subsec:coeffrrotation  --></a>)  uses  a  simple  Lookup
   Table <!-- l. 1046 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>V</mi> <mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
   which maps <!-- l. 1046 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi mathvariant='normal'>Δ</mi><mi>m</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>e</mi></mrow></math>
   to <!-- l. 1046 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi mathvariant='normal'>Δ</mi><mi>m</mi></mrow></math>,
                                                                                         
                                                                                         
   we can edit the coefficients of <!-- l. 1046 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>V</mi> <mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
   to make <!-- l. 1046 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi mathvariant='normal'>Δ</mi><mi>m</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>e</mi></mrow></math>
   map to different values. For example, an altered mappings between the inputs and outputs to
   LUT can implement logic gates such as AND, OR, XOR, CMUX, etc, which will be explained in
   <a href='#application-gate-bootstrapping'><span class='ts1-lmr10-x-x-109'>§</span>D-1.8.9<!-- tex4ht:ref: subsec:coeffrrotation  --></a>. Such edited mappings between the exponents and coefficients in <!-- l. 1046 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>V</mi> <mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
   are called programmable bootstrapping. If we encrypt <!-- l. 1046 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>V</mi> <mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
   as a GLWE ciphertext, we can hide the mappings as well as each input instance, which effectively
   implements <span class='rm-lmri-10x-x-109'>functional encryption</span>. Note that both the vanilla bootstrapping (<a href='#noise-bootstrapping'><span class='ts1-lmr10-x-x-109'>§</span>D-1.8<!-- tex4ht:ref: subsec:coeffrrotation  --></a>) and programmable
   bootstrapping (<a href='#application-gate-bootstrapping'><span class='ts1-lmr10-x-x-109'>§</span>D-1.8.9<!-- tex4ht:ref: subsec:coeffrrotation  --></a>) generate the same amount of noise.
   </li>
   <li class='itemize'><span class='rm-lmbx-10x-x-109'>Bootstrapping Noise</span>: During the bootstrapping’s LUT polynomial <!-- l. 1047 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>V</mi> <mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
   rotation, we perform many TFHE multiplications in the homomorphic MUX gates to derive
   <!-- l. 1047 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>V</mi> </mrow><mrow><mn>0</mn></mrow></msub><mo class='MathClass-rel' stretchy='false'>⋯</mo><msub><mrow><mi>V</mi> </mrow><mrow><mi>k</mi></mrow></msub></mrow></math>,
   which inevitably creates additional noises before the the noise gets re-initialized at the end.
   However, a careful parameter choice can limit the growth of this additional noise during modulus
   switch and blind rotation.</li></ul>
   
   <h5 class='subsubsectionHead' id='application-gate-bootstrapping'><span class='titlemark'>D-1.8.9   </span> <a id='x1-40000D-1.8.9'></a>Application: Gate Bootstrapping</h5>
<!-- l. 1054 --><p class='noindent'>Besides implementing the homomorphic MUX logic gate used during blind rotation (<a href='#blind-rotation'><span class='ts1-lmr10-x-x-109'>§</span>D-1.8.4<!-- tex4ht:ref: subsec:coeffrrotation  --></a>), it is possible to leverage
the LUT polynomial <!-- l. 1054 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>V</mi> <mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
to implement other homomorphic logic gates such as AND, NAND, OR, XOR, etc. When implementing
these gates, each ciphertext is an encryption of a single-bit plaintext (or several bits can be bundled up
in a linear combination formula and be processed simultaneously by using LUT). Suppose
<!-- l. 1054 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>q</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>32</mn></mrow></math>,
<!-- l. 1054 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>t</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>8</mn></mrow></math>,
<!-- l. 1054 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>m</mi> <mo class='MathClass-rel' stretchy='false'>∈</mo> <msub><mrow><mi>ℤ</mi></mrow><mrow><mn>8</mn></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>{</mo><mo class='MathClass-bin' stretchy='false'>−</mo><mn>4</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-bin' stretchy='false'>−</mo><mn>3</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-bin' stretchy='false'>−</mo><mn>2</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>0</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>1</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>2</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>3</mn><mo class='MathClass-close' stretchy='false'>}</mo></mrow></math>,
<!-- l. 1054 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi mathvariant='normal'>Δ</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mstyle displaystyle='true'><mfrac><mrow><mi>q</mi>
</mrow><mrow><mi>t</mi></mrow></mfrac></mstyle> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>4</mn></mrow></math>,
<!-- l. 1054 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true'>^</mo></mover> <mo class='MathClass-rel' stretchy='false'>=</mo> <mstyle displaystyle='true'><mfrac><mrow><mi mathvariant='normal'>Δ</mi> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mn>2</mn><mi>n</mi>
  </mrow><mrow><mi>q</mi>   </mrow></mfrac></mstyle> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>2</mn></mrow></math>, and we encode the gate
input into LWE plaintext as <!-- l. 1054 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mn>0</mn> <mo class='MathClass-rel' stretchy='false'>→</mo><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></math>,
and <!-- l. 1054 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mn>1</mn> <mo class='MathClass-rel' stretchy='false'>→</mo><mn>1</mn></mrow></math>, and the maximum
(accumulated) noise <!-- l. 1054 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>e</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>[</mo><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>]</mo></mrow></math>.
</p>
   <div class='table'>
                                                                                         
                                                                                         
<!-- l. 1057 --><p class='indent'>   </p><figure class='float' id='x1-40001r2'><span id='an-example-truth-table-for-an-and-operation-with-an-additional-encoding'></span>
                                                                                         
                                                                                         
<!-- tex4ht:inline --><div class='tabular'> <table class='tabular' id='TBL-7' rules='groups'><colgroup id='TBL-7-1g'><col id='TBL-7-1' /><col id='TBL-7-2' /></colgroup><colgroup id='TBL-7-3g'><col id='TBL-7-3' /><col id='TBL-7-4' /></colgroup><colgroup id='TBL-7-5g'><col id='TBL-7-5' /></colgroup><colgroup id='TBL-7-6g'><col id='TBL-7-6' /></colgroup><colgroup id='TBL-7-7g'><col id='TBL-7-7' /></colgroup><colgroup id='TBL-7-8g'><col id='TBL-7-8' /></colgroup><tr class='hline'><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr id='TBL-7-1-'><td class='td11' colspan='6' id='TBL-7-1-1' style='text-align:center; white-space:nowrap;'></td>                                                                                                                                                                                                                                                                                                                  <div class='multicolumn' style='text-align:center; white-space:nowrap;'>Lookup Table Polynomial <!-- l. 1108 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>V</mi> <mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>1</mn> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>1</mn><mi>X</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>1</mn><msup><mrow><mi>X</mi></mrow><mrow><mn>2</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>1</mn><msup><mrow><mi>X</mi></mrow><mrow><mn>3</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>1</mn><msup><mrow><mi>X</mi></mrow><mrow><mn>4</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>1</mn><msup><mrow><mi>X</mi></mrow><mrow><mn>5</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>1</mn><msup><mrow><mi>X</mi></mrow><mrow><mn>6</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>1</mn><msup><mrow><mi>X</mi></mrow><mrow><mn>7</mn></mrow></msup></mrow></math></div>
</tr><tr class='hline'><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr id='TBL-07-4-'><td class='td11' colspan='2' id='TBL-07-4-1' style='text-align:center; white-space:nowrap;'>                                                                                 <div class='multicolumn' style='text-align:center; white-space:nowrap;'><span class='rm-lmbx-10x-x-109'>Decoded</span></div>                                                                                                              </td><td class='td11' colspan='2' id='TBL-07-4-3' style='text-align:center; white-space:nowrap;'>                                                                                 <div class='multicolumn' style='text-align:center; white-space:nowrap;'><span class='rm-lmbx-10x-x-109'>Encoded</span></div>                                                                                                               </td><td class='td11' id='TBL-07-4-5' style='text-align:center; white-space:nowrap;'> <div class='multicolumn' style='text-align:center; white-space:nowrap;'><!-- tex4ht:inline --><div class='tabular'> <table class='tabular' id='TBL-07' rules='groups'><tr id='TBL-07-1-'><td class='td11' id='TBL-07-1-1' style='text-align:center; white-space:nowrap;'>                                       <span class='rm-lmbx-10x-x-109'>Linear                                                     </span></td></tr><tr id='TBL-007-4-'><td class='td11' id='TBL-007-4-1' style='text-align:center; white-space:nowrap;'> <span class='rm-lmbx-10x-x-109'>combination</span></td>
</tr><tr id='TBL-0007-7-'><td class='td11' id='TBL-0007-7-1' style='text-align:center; white-space:nowrap;'>                                    <span class='rm-lmbx-10x-x-109'>of encodings                                                 </span></td></tr></table></div></div> </td><td class='td11' id='TBL-07-4-6' style='text-align:center; white-space:nowrap;'> <div class='multicolumn' style='text-align:center; white-space:nowrap;'><!-- tex4ht:inline --><div class='tabular'> <table class='tabular' id='TBL-07' rules='groups'><tr id='TBL-07-1-'><td class='td11' id='TBL-07-1-1' style='text-align:center; white-space:nowrap;'>                                  <span class='rm-lmbx-10x-x-109'>Scaled Encoded                                               </span></td></tr><tr id='TBL-007-4-'><td class='td11' id='TBL-007-4-1' style='text-align:center; white-space:nowrap;'> <span class='rm-lmbx-10x-x-109'>Combination</span></td></tr></table></div></div> </td><td class='td11' id='TBL-07-4-7' style='text-align:center; white-space:nowrap;'>                                             <span class='rm-lmbx-10x-x-109'>Bootstrapping                                                              </span></td><td class='td11' id='TBL-07-4-8' style='text-align:center; white-space:nowrap;'> <!-- tex4ht:inline --><div class='tabular'> <table class='tabular' id='TBL-8'><colgroup id='TBL-8-1g'><col id='TBL-8-1' /></colgroup><tr id='TBL-8-1-'><td class='td11' id='TBL-8-1-1' style='text-align:center; white-space:nowrap;'>                                     <span class='rm-lmbx-10x-x-109'>Decoded                                                   </span></td></tr><tr id='TBL-08-4-'><td class='td11' id='TBL-08-4-1' style='text-align:center; white-space:nowrap;'> <span class='rm-lmbx-10x-x-109'>result</span></td>
</tr></table></div> </td>
</tr><tr class='hline'><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr id='TBL-007-7-'><td class='td11' id='TBL-007-7-1' style='text-align:center; white-space:nowrap;'> <!-- l. 1108 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>d</mi></mrow><mrow><mn>1</mn></mrow></msub></math>  </td><td class='td11' id='TBL-007-7-2' style='text-align:center; white-space:nowrap;'> <!-- l. 1108 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>d</mi></mrow><mrow><mn>2</mn></mrow></msub></math>  </td><td class='td11' id='TBL-007-7-3' style='text-align:right; white-space:nowrap;'> <!-- l. 1108 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>m</mi></mrow><mrow><mn>1</mn></mrow></msub></math>  </td><td class='td11' id='TBL-007-7-4' style='text-align:right; white-space:nowrap;'> <!-- l. 1108 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>m</mi></mrow><mrow><mn>2</mn></mrow></msub></math>  </td><td class='td11' id='TBL-007-7-5' style='text-align:center; white-space:nowrap;'>   <!-- l. 1108 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>m</mi></mrow><mrow><mn>1</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>m</mi></mrow><mrow><mn>2</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></math>     </td><td class='td11' id='TBL-007-7-6' style='text-align:center; white-space:nowrap;'>   <!-- l. 1108 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true'>^</mo></mover> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>m</mi></mrow><mrow><mn>1</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>m</mi></mrow><mrow><mn>2</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>     </td><td class='td11' id='TBL-007-7-7' style='text-align:center; white-space:nowrap;'>           <!-- l. 1108 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>V</mi> <mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>X</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true'>^</mo></mover><mo class='MathClass-bin' stretchy='false'>⋅</mo><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>m</mi></mrow><mrow><mn>1</mn></mrow></msub><mo class='MathClass-bin' stretchy='false'>+</mo><msub><mrow><mi>m</mi></mrow><mrow><mn>2</mn></mrow></msub><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-bin' stretchy='false'>+</mo><mi>e</mi></mrow></msup></mrow></math>                   </td><td class='td11' id='TBL-007-7-8' style='text-align:center; white-space:nowrap;'>   <!-- l. 1108 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>d</mi></mrow><mrow><mn>1</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>∧</mo><msub><mrow><mi>d</mi></mrow><mrow><mn>2</mn></mrow></msub></mrow></math>      </td>
</tr><tr class='hline'><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr id='TBL-0007-10-'><td class='td11' id='TBL-0007-10-1' style='text-align:center; white-space:nowrap;'>                                         0                                                                 </td><td class='td11' id='TBL-0007-10-2' style='text-align:center; white-space:nowrap;'>                                         0                                                                 </td><td class='td11' id='TBL-0007-10-3' style='text-align:right; white-space:nowrap;'> <!-- l. 1108 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></math>  </td><td class='td11' id='TBL-0007-10-4' style='text-align:right; white-space:nowrap;'> <!-- l. 1108 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></math>  </td><td class='td11' id='TBL-0007-10-5' style='text-align:center; white-space:nowrap;'>   <!-- l. 1108 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mn>3</mn></mrow></math>     </td><td class='td11' id='TBL-0007-10-6' style='text-align:center; white-space:nowrap;'>   <!-- l. 1108 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mn>6</mn></mrow></math>     </td><td class='td11' id='TBL-0007-10-7' style='text-align:center; white-space:nowrap;'> constant term’s coeff. is <!-- l. 1108 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></math>  </td><td class='td11' id='TBL-0007-10-8' style='text-align:center; white-space:nowrap;'>                                           0                                                                    </td>
</tr><tr id='TBL-00007-13-'><td class='td11' id='TBL-00007-13-1' style='text-align:center; white-space:nowrap;'>                                         0                                                                 </td><td class='td11' id='TBL-00007-13-2' style='text-align:center; white-space:nowrap;'>                                         1                                                                 </td><td class='td11' id='TBL-00007-13-3' style='text-align:right; white-space:nowrap;'> <!-- l. 1108 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></math>  </td><td class='td11' id='TBL-00007-13-4' style='text-align:right; white-space:nowrap;'> <!-- l. 1108 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mn>1</mn></math>  </td><td class='td11' id='TBL-00007-13-5' style='text-align:center; white-space:nowrap;'>   <!-- l. 1108 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></math>     </td><td class='td11' id='TBL-00007-13-6' style='text-align:center; white-space:nowrap;'>   <!-- l. 1108 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mn>2</mn></mrow></math>     </td><td class='td11' id='TBL-00007-13-7' style='text-align:center; white-space:nowrap;'> constant term’s coeff. is <!-- l. 1108 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></math>  </td><td class='td11' id='TBL-00007-13-8' style='text-align:center; white-space:nowrap;'>                                           0                                                                    </td>
</tr><tr id='TBL-000007-16-'><td class='td11' id='TBL-000007-16-1' style='text-align:center; white-space:nowrap;'>                                         1                                                                 </td><td class='td11' id='TBL-000007-16-2' style='text-align:center; white-space:nowrap;'>                                         0                                                                 </td><td class='td11' id='TBL-000007-16-3' style='text-align:right; white-space:nowrap;'> <!-- l. 1108 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mn>1</mn></math>  </td><td class='td11' id='TBL-000007-16-4' style='text-align:right; white-space:nowrap;'> <!-- l. 1108 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></math>  </td><td class='td11' id='TBL-000007-16-5' style='text-align:center; white-space:nowrap;'>   <!-- l. 1108 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></math>     </td><td class='td11' id='TBL-000007-16-6' style='text-align:center; white-space:nowrap;'>   <!-- l. 1108 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mn>2</mn></mrow></math>     </td><td class='td11' id='TBL-000007-16-7' style='text-align:center; white-space:nowrap;'> constant term’s coeff. is <!-- l. 1108 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></math>  </td><td class='td11' id='TBL-000007-16-8' style='text-align:center; white-space:nowrap;'>                                           0                                                                    </td>
</tr><tr id='TBL-0000007-19-'><td class='td11' id='TBL-0000007-19-1' style='text-align:center; white-space:nowrap;'>                                         1                                                                 </td><td class='td11' id='TBL-0000007-19-2' style='text-align:center; white-space:nowrap;'>                                         1                                                                 </td><td class='td11' id='TBL-0000007-19-3' style='text-align:right; white-space:nowrap;'> <!-- l. 1108 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mn>1</mn></math>  </td><td class='td11' id='TBL-0000007-19-4' style='text-align:right; white-space:nowrap;'> <!-- l. 1108 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mn>1</mn></math>  </td><td class='td11' id='TBL-0000007-19-5' style='text-align:center; white-space:nowrap;'>   <!-- l. 1108 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mn>1</mn></math>     </td><td class='td11' id='TBL-0000007-19-6' style='text-align:center; white-space:nowrap;'>   <!-- l. 1108 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mn>2</mn></math>     </td><td class='td11' id='TBL-0000007-19-7' style='text-align:center; white-space:nowrap;'> constant term’s coeff. is <!-- l. 1108 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mn>1</mn></math>  </td><td class='td11' id='TBL-0000007-19-8' style='text-align:center; white-space:nowrap;'>                                           1                                                                    </td>
</tr><tr class='hline'><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr></table>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      </div>

<figcaption class='caption'><span class='id'>Table 2: </span><span class='content'>An example truth table for an AND operation with an additional encoding.            </span></figcaption><!-- tex4ht:label?: x1440001r2  -->
                                                                                         
                                                                                         
   </figure>
   </div>
<!-- l. 1122 --><p class='indent'>   <a href='#an-example-truth-table-for-an-and-operation-with-an-additional-encoding'>Table 2<!-- tex4ht:ref: subsec:coeffrrotation  --></a> is a programmable bootstrapping design for an AND logic gate. For this application, we define the LUT
polynomial <!-- l. 1122 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>V</mi> </mrow></math> as
<!-- l. 1122 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>V</mi> <mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo><munderover accent='false' accentunder='false'><mrow> <mi class='MathClass-op'>∑</mi><mo> ⁡<!-- FUNCTION APPLICATION --></mo>
  </mrow><mrow><mi>i</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>0</mn></mrow><mrow><mn>7</mn></mrow></munderover> <mo class='MathClass-bin' stretchy='false'>−</mo><msup><mrow><mi>X</mi></mrow><mrow><mi>i</mi></mrow></msup></mrow></math>. The LUT polynomial
<!-- l. 1122 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>V</mi> <mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math> maps one half of the plaintext
domain to <!-- l. 1122 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></math>, while the other
half to <!-- l. 1122 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></math> (as the terms wrap
around the boundary of <!-- l. 1122 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>n</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>7</mn></mrow></math>).
In this design setup, each bit is separately encrypted as independent TFHE ciphertext. Gate input 0 and 1 are
encoded as <!-- l. 1122 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></math>
and <!-- l. 1122 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mn>1</mn></math>,
respectively. The linear combination (i.e., homomorphic computation formula) for an AND gate is
<!-- l. 1122 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mover accent='true'><mrow><mi>s</mi></mrow><mo accent='true'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mi mathvariant='normal'>Δ</mi><msub><mrow><mi>m</mi></mrow><mrow><mn>1</mn></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>+</mo><msub><mrow> <mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mover accent='true'><mrow><mi>s</mi></mrow><mo accent='true'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mi mathvariant='normal'>Δ</mi><msub><mrow><mi>m</mi></mrow><mrow><mn>2</mn></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></math>. Its output is positive if both
inputs are positive (i.e. <!-- l. 1122 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mn>1</mn></math>, in which
case the blind rotation will rotate <!-- l. 1122 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>V</mi> </mrow></math>
to the left by <!-- l. 1122 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true'>^</mo></mover> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mn>1</mn> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>e</mi></mrow></math> positions and the
constant term’s coefficient will be <!-- l. 1122 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mn>1</mn></math>.
Thus, the output of blind rotation and coefficient extraction will be
<!-- l. 1122 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mover accent='true'><mrow><mi>s</mi></mrow><mo accent='true'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mi mathvariant='normal'>Δ</mi> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math> with a reduced noise, which is an
encoding of <!-- l. 1122 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mn>1</mn></math>. This design can tolerate
the maximum noise of <!-- l. 1122 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-rel' stretchy='false'>|</mo><mi>e</mi><mo class='MathClass-rel' stretchy='false'>|</mo><mo class='MathClass-rel' stretchy='false'>=</mo> <mn>1</mn></mrow></math>. To endure
bigger noises, we should increase <!-- l. 1122 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>q</mi></math>
and <!-- l. 1122 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>n</mi></math>.
</p><!-- l. 1124 --><p class='indent'>   Note that the AND gate’s LUT layout is negacyclic, which is a special case, thus we could use the entire
<!-- l. 1124 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mn>2</mn><mi>n</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>16</mn></mrow></math> coefficient
states in <!-- l. 1124 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>V</mi> <mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
for the AND gate mapping function’s outputs, by leveraging
<!-- l. 1124 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>V</mi> <mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>’s innate
property of negacyclic rotation. However, in many use cases, the LUT layout is not necessarily negacyclic
like this AND gate example. Even our noise bootstrapping’s LUT layout (<a href='#overview1'><span class='ts1-lmr10-x-x-109'>§</span>D-1.8.1<!-- tex4ht:ref: subsec:coeffrrotation  --></a>) was not negacyclic,
but a unity function (as it simply removes the noise). Thus, for most use cases, we need to use only
<!-- l. 1124 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mstyle displaystyle='true'><mfrac><mrow> <mi>t</mi>
</mrow><mrow><mn>2</mn></mrow></mfrac></mstyle></math> out of
<!-- l. 1124 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>t</mi></math> plaintext space to
avoid more than <!-- l. 1124 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>n</mi> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></math>
rotations of <!-- l. 1124 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>V</mi> <mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
(<a href='#halving-the-plaintext-space-to-be-used'><span class='ts1-lmr10-x-x-109'>§</span>D-1.8.3<!-- tex4ht:ref: subsec:coeffrrotation  --></a>).
</p><!-- l. 1126 --><p class='indent'>   Besides the AND gate, other logic gates can be built in a similar manner, each of which based on a
different linear combination formula and LUT layout.
</p><!-- l. 1128 --><p class='noindent'><span class='rm-lmbx-10x-x-109'>Division: </span>TFHE does not support direct division of plaintext numbers
of any size. This is because TFHE’s LWE vector elements are in the
<!-- l. 1128 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>Z</mi></mrow><mrow><mi>q</mi></mrow></msub></math> ring, where each element
<!-- l. 1128 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>g</mi></math> does not necessarily have a
multiplicative inverse <!-- l. 1128 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>g</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msup></math>, which
makes it hard to multiply <!-- l. 1128 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>g</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msup></math>
                                                                                         
                                                                                         
to the target number to divide. Instead, division can be implemented as binary division based on the gates
implemented by gate bootstrapping. To support binary division, each plaintext has to be a single bit and
encrypted as an independent ciphertext. Or multiple bits can be bundled up and processed concurrently
by designing a linear combination formula, similar to the linear combination that we designed for
processing 2 input bits of an AND gate.
   
</p>
   <h5 class='subsubsectionHead' id='application-neural-networks-bootstrapping'><span class='titlemark'>D-1.8.10   </span> <a id='x1-41000D-1.8.10'></a>Application: Neural Networks Bootstrapping</h5>
   <figure class='figure'> 

                                                                                         
                                                                                         
                                                                                         
                                                                                         
<!-- l. 1135 --><p class='noindent' id='an-illustration-of-neural-networks-'> <img alt='PIC' src='figures/neural-network-.png' /> <a id='x1-41001r2'></a></p>
<figcaption class='caption'><span class='id'>Figure 2: </span><span class='content'>An illustration of neural networks                                                 </span></figcaption><!-- tex4ht:label?: x1441001r2  -->
                                                                                         
                                                                                         
   </figure>
   <figure class='figure'> 

                                                                                         
                                                                                         
                                                                                         
                                                                                         
<!-- l. 1142 --><p class='noindent' id='an-illustration-of-neural-networkss-programmable-bootstrapping'> <img alt='PIC' src='figures/nn-homomorphic-.png' /> <a id='x1-41002r3'></a></p>
<figcaption class='caption'><span class='id'>Figure 3: </span><span class='content'>An illustration of neural networks’s programmable bootstrapping                     </span></figcaption><!-- tex4ht:label?: x1441002r3  -->
                                                                                         
                                                                                         
   </figure>
<!-- l. 1147 --><p class='indent'>   Homomorphic encryption can be applied to the neurons of deep neural networks, in which each neuron
is generally comprised of two steps of computation:
   </p><dl class='enumerate-enumitem'><dt class='enumerate-enumitem'>
1. </dt><dd class='enumerate-enumitem'><span class='rm-lmbx-10x-x-109'>Linear Combination of Input Values: </span>An input feature value (or intermediate value) set
   <!-- l. 1150 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>x</mi></mrow><mrow><mn>1</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>x</mi></mrow><mrow><mn>2</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><mstyle class='text'><mtext></mtext><mstyle class='math'><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace></mstyle><mtext></mtext></mstyle><mstyle class='text'><mtext> </mtext></mstyle><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>x</mi></mrow><mrow><mi>n</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>,
   a weight set <!-- l. 1150 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>w</mi></mrow><mrow><mn>1</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>w</mi></mrow><mrow><mn>2</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><mstyle class='text'><mtext></mtext><mstyle class='math'><mo class='MathClass-rel' stretchy='false'>⋯</mo><mi>x</mi></mstyle><mtext></mtext></mstyle><mstyle class='text'><mtext> </mtext></mstyle><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>w</mi></mrow><mrow><mi>n</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>,
   and a bias <!-- l. 1150 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>b</mi></math>
   are computed as: <!-- l. 1150 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>y</mi> <mo class='MathClass-rel' stretchy='false'>=</mo><munderover accent='false' accentunder='false'><mrow> <mi class='MathClass-op'>∑</mi><mo> ⁡<!-- FUNCTION APPLICATION --></mo>
  </mrow><mrow><mi>i</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>1</mn></mrow><mrow><mi>n</mi></mrow></munderover><msub><mrow><mi>a</mi></mrow><mrow><mn>0</mn></mrow></msub><msub><mrow><mi>w</mi></mrow><mrow><mn>0</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>b</mi></mrow></math>.
   </dd><dt class='enumerate-enumitem'>
2. </dt><dd class='enumerate-enumitem'><span class='rm-lmbx-10x-x-109'>Activation Function: </span><!-- l. 1151 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>f</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>y</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
   is computed, where <!-- l. 1151 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>f</mi></math>
   is a non-linear activation function such as the <!-- l. 1151 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi class='loglike'>sin</mi><mo>⁡<!-- FUNCTION APPLICATION --></mo><!-- nolimits --></mrow></math>
   function, ReLU, sigmoid, hyperbolic tangent, etc.
   </dd><dt class='enumerate-enumitem'>
3. </dt><dd class='enumerate-enumitem'></dd></dl>
<!-- l. 1155 --><p class='indent'>   TFHE can homomorphically compute the 1st step’s linear combination formula:
<!-- l. 1155 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>y</mi> <mo class='MathClass-rel' stretchy='false'>=</mo><munderover accent='false' accentunder='false'><mrow> <mi class='MathClass-op'>∑</mi><mo> ⁡<!-- FUNCTION APPLICATION --></mo>
  </mrow><mrow><mi>i</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>1</mn></mrow><mrow><mi>n</mi></mrow></munderover><msub><mrow><mi>a</mi></mrow><mrow><mn>0</mn></mrow></msub><msub><mrow><mi>w</mi></mrow><mrow><mn>0</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>b</mi></mrow></math> as
<!-- l. 1155 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><munderover accent='false' accentunder='false'><mrow><mi class='MathClass-op'>∑</mi><mo> ⁡<!-- FUNCTION APPLICATION --></mo>
  </mrow><mrow><mi>i</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>1</mn></mrow><mrow><mi>n</mi></mrow></munderover><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mover accent='true'><mrow><mi>s</mi></mrow><mo accent='true'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>a</mi></mrow><mrow><mn>0</mn></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msub><mrow><mi>w</mi></mrow><mrow><mn>0</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>b</mi></mrow></math>, which
can be implemented as ciphertext addition (<span class='rm-lmbx-10x-x-109'>??</span>) and ciphertext-to-plaintext multiplication
(<span class='rm-lmbx-10x-x-109'>??</span>).
</p><!-- l. 1157 --><p class='indent'>   However, the 2nd step’s non-linear functions cannot be expressed as addition and multiplication of
ciphertexts. To address this issue, the activation function can be evaluated as a programmable
bootstrapping, such that the output of the bootstrapping matches or (or is similar) to the output of the
activation function. If we use bootstrapping at the 2nd step, noises can be refreshed at the end of every
neuron, thus we can potentially handle neural networks of any depth without worrying about the noise
growth.
   
</p>
   <h4 class='subsectionHead' id='tfhe-on-a-discrete-torus'><span class='titlemark'>D-1.9   </span> <a id='x1-42000D-1.9'></a>TFHE on a Discrete Torus</h4>
<!-- l. 1164 --><p class='noindent'><span class='rm-lmbx-10x-x-109'>- Reference:  </span><a href='https://eprint.iacr.org/2021/1402.pdf'>Guide to Fully Homomorphic Encryption over the [Discretized] Torus</a> <span class='cite'>[<span class='rm-lmbx-10x-x-109'>?</span>]</span>
</p><!-- l. 1169 --><p class='indent'>   <!-- l. 1169 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 1171 --><p class='indent'>   Torus <!-- l. 1171 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>𝕋</mi></math>
is a continuous real number domain between 0 and 1 that wraps around, that is
<!-- l. 1171 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>[</mo><mn>0</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>.
</p><!-- l. 1173 --><p class='indent'>   A discrete torus <!-- l. 1173 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>𝕋</mi></mrow><mrow><mi>t</mi></mrow></msub></math> is a
finite real number set: <!-- l. 1173 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mstyle mathsize='1.61em'><mrow><mo fence='true' form='prefix'>(</mo><mrow></mrow><mo fence='true' form='postfix'></mo></mrow></mstyle><mn>0</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle displaystyle='true'><mfrac><mrow><mn>1</mn>
</mrow><mrow><mi>t</mi></mrow></mfrac></mstyle><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle displaystyle='true'><mfrac><mrow><mn>2</mn>
</mrow><mrow><mi>t</mi></mrow></mfrac></mstyle><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><mstyle class='text'><mtext></mtext><mstyle class='math'><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace></mstyle><mtext></mtext></mstyle><mstyle class='text'><mtext> </mtext></mstyle><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle displaystyle='true'><mfrac><mrow><mi>t</mi> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn>
   </mrow><mrow><mi>t</mi>  </mrow></mfrac></mstyle><mstyle mathsize='1.61em'><mrow><mo fence='true' form='prefix'>)</mo><mrow></mrow><mo fence='true' form='postfix'></mo></mrow></mstyle></mrow></math>
</p><!-- l. 1176 --><p class='indent'>   In the previous subsections, we explained the TFHE scheme based on the following setup:
</p><!-- l. 1178 --><p class='indent'>   <!-- l. 1178 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 1180 --><p class='indent'>   <!-- l. 1180 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>m</mi> <mo class='MathClass-rel' stretchy='false'>∈</mo> <msub><mrow><mi>ℤ</mi></mrow><mrow><mi>t</mi></mrow></msub></mrow></math>
<!-- l. 1181 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mover accent='true'><mrow><mi>s</mi></mrow><mo accent='true'>→</mo></mover> <mo class='MathClass-rel' stretchy='false'>=</mo> <msup><mrow><mo class='MathClass-open' stretchy='false'>{</mo><mn>0</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>}</mo></mrow><mrow><mi>k</mi></mrow></msup></mrow></math>
<!-- l. 1182 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>e</mi> <mo class='MathClass-rel' stretchy='false'>∈</mo> <msub><mrow><mi>ℤ</mi></mrow><mrow><mi>q</mi></mrow></msub></mrow></math>
</p><!-- l. 1184 --><p class='indent'>   <!-- l. 1184 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mover accent='true'><mrow><mi>s</mi></mrow><mo accent='true'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mi mathvariant='normal'>Δ</mi><mi>m</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>a</mi></mrow><mrow><mn>0</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>a</mi></mrow><mrow><mn>1</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><mstyle class='text'><mtext></mtext><mstyle class='math'><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace></mstyle><mtext></mtext></mstyle><mstyle class='text'><mtext> </mtext></mstyle><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>a</mi></mrow><mrow><mi>k</mi></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><mi>b</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>∈</mo> <msubsup><mrow><mi>ℤ</mi></mrow><mrow><mi>t</mi></mrow><mrow><mi>k</mi><mo class='MathClass-bin' stretchy='false'>+</mo><mn>1</mn></mrow></msubsup></mrow></math>
                                                                                         
                                                                                         
</p><!-- l. 1186 --><p class='indent'>   <!-- l. 1186 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 1188 --><p class='indent'>   However, the original TFHE scheme is designed based on a discrete torus:
</p><!-- l. 1191 --><p class='indent'>   <!-- l. 1191 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 1193 --><p class='indent'>   <!-- l. 1193 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>m</mi> <mo class='MathClass-rel' stretchy='false'>∈</mo> <msub><mrow><mi>𝕋</mi></mrow><mrow><mi>t</mi></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><mover accent='true'><mrow><mi>s</mi></mrow><mo accent='true'>→</mo></mover> <mo class='MathClass-rel' stretchy='false'>∈</mo><msup><mrow><mo class='MathClass-open' stretchy='false'>{</mo><mn>0</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>}</mo></mrow><mrow><mi>k</mi></mrow></msup><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><mi>e</mi> <mo class='MathClass-rel' stretchy='false'>∈</mo> <msub><mrow><mi>𝕋</mi></mrow><mrow><mi>q</mi></mrow></msub></mrow></math>
</p><!-- l. 1195 --><p class='indent'>   <!-- l. 1195 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 1197 --><p class='indent'>   <!-- l. 1197 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mover accent='true'><mrow><mi>s</mi></mrow><mo accent='true'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mi>m</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo> <mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖼𝗍</mtext></mstyle> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>a</mi></mrow><mrow><mn>0</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>a</mi></mrow><mrow><mn>1</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><mstyle class='text'><mtext></mtext><mstyle class='math'><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace></mstyle><mtext></mtext></mstyle><mstyle class='text'><mtext> </mtext></mstyle><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>a</mi></mrow><mrow><mi>k</mi></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><mi>b</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>∈</mo> <msubsup><mrow><mi>𝕋</mi></mrow><mrow><mi>q</mi></mrow><mrow><mi>k</mi><mo class='MathClass-bin' stretchy='false'>+</mo><mn>1</mn></mrow></msubsup></mrow></math>
</p><!-- l. 1199 --><p class='indent'>   <!-- l. 1199 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>b</mi> <mo class='MathClass-rel' stretchy='false'>=</mo><munderover accent='false' accentunder='false'><mrow> <mi class='MathClass-op'>∑</mi><mo> ⁡<!-- FUNCTION APPLICATION --></mo>
  </mrow><mrow><mi>i</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>0</mn></mrow><mrow><mi>k</mi></mrow></munderover><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>a</mi></mrow><mrow><mi>i</mi></mrow></msub><msub><mrow><mi>s</mi></mrow><mrow><mi>i</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>m</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>e</mi> <mo class='MathClass-rel' stretchy='false'>∈</mo> <msub><mrow><mi>𝕋</mi></mrow><mrow><mi>q</mi></mrow></msub></mrow></math>
</p><!-- l. 1201 --><p class='indent'>   <!-- l. 1201 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msubsup><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mover accent='true'><mrow><mi>s</mi></mrow><mo accent='true'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msubsup><mo class='MathClass-open' stretchy='false'>(</mo><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖼𝗍</mtext></mstyle><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo> <mstyle mathsize='1.61em'><mrow><mo fence='true' form='prefix'>⌈</mo><mrow></mrow><mo fence='true' form='postfix'></mo></mrow></mstyle><mi>b</mi> <mo class='MathClass-bin' stretchy='false'>−</mo><munderover accent='false' accentunder='false'><mrow><mi class='MathClass-op'>∑</mi><mo> ⁡<!-- FUNCTION APPLICATION --></mo>
  </mrow><mrow><mi>i</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>0</mn></mrow><mrow><mi>k</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></munderover><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>a</mi></mrow><mrow><mi>i</mi></mrow></msub><msub><mrow><mi>s</mi></mrow><mrow><mi>i</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo><msub><mrow><mstyle mathsize='1.61em'><mrow><mo fence='true' form='prefix'>⌋</mo><mrow></mrow><mo fence='true' form='postfix'></mo></mrow></mstyle></mrow><mrow><mfrac><mrow><mn>1</mn></mrow>
<mrow><mi>t</mi></mrow></mfrac> </mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo> <mstyle mathsize='1.61em'><mrow><mo fence='true' form='prefix'>⌈</mo><mrow></mrow><mo fence='true' form='postfix'></mo></mrow></mstyle><mi>m</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>e</mi><msub><mrow><mstyle mathsize='1.61em'><mrow><mo fence='true' form='prefix'>⌋</mo><mrow></mrow><mo fence='true' form='postfix'></mo></mrow></mstyle></mrow><mrow><mfrac><mrow><mn>1</mn></mrow>
<mrow><mi>t</mi></mrow></mfrac> </mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo> <mi>m</mi></mrow></math>,
given <!-- l. 1201 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>e</mi> <mo class='MathClass-rel' stretchy='false'><mfrac><mrow> <mn>1</mn>
</mrow><mrow><mn>2</mn><mi>t</mi></mrow></mfrac></mo>
</mrow></math></p><!-- l. 1203 --><p class='indent'>   <span id='textcolor34'># where <!-- l. 1203 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>⌈</mo><mi>x</mi><msub><mrow><mo class='MathClass-close' stretchy='false'>⌋</mo></mrow><mrow><mfrac><mrow><mn>1</mn></mrow>
<mrow><mi>t</mi></mrow></mfrac> </mrow></msub></mrow></math> means
rounding <!-- l. 1203 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>x</mi></math> to the
nearest multiple of <!-- l. 1203 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mstyle displaystyle='true'><mfrac><mrow><mn>1</mn>
</mrow><mrow><mi>t</mi></mrow></mfrac></mstyle></math></span>
</p><!-- l. 1205 --><p class='indent'>   <!-- l. 1205 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 1207 --><p class='indent'>   The original TFHE’s difference is that all values (either polynomial
coefficients or vector elements) are computed in a floating point modulo 1 (i.e.,
<!-- l. 1207 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>[</mo><mn>0</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>) instead of a big
integer (i.e., <!-- l. 1207 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>[</mo><mn>0</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mi>q</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>).
This means the plaintext also has to be encoded as values within
<!-- l. 1207 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>[</mo><mn>0</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math> instead of
integers within <!-- l. 1207 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>[</mo><mn>0</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mi>q</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>.
Note that in the original TFHE scheme, there is no need of the scaling factor
<!-- l. 1207 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi mathvariant='normal'>Δ</mi></math>, because the continuous
domain of torus <!-- l. 1207 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>[</mo><mn>0</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math> provides a
floating-point precision up to <!-- l. 1207 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>q</mi></math>
discrete decimal values, and its decryption process can successfully blow away the noise
<!-- l. 1207 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>E</mi></math> as far as each coefficient
(or vector element) <!-- l. 1207 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>e</mi></mrow><mrow><mi>i</mi></mrow></msub></math>
in <!-- l. 1207 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>E</mi></math> is smaller
than <!-- l. 1207 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mstyle displaystyle='true'><mfrac><mrow> <mn>1</mn>
</mrow><mrow><mn>2</mn><mi>t</mi></mrow></mfrac></mstyle></math>.
</p><!-- l. 1209 --><p class='indent'>   Both the torus-based and integer-ring-based TFHE schemes are built based on the same fundamental
principles.
                                                                                         
                                                                                         
   
</p>
   <h3 class='sectionHead' id='roots-of-unity'><span class='titlemark'>D-2   </span> <a id='x1-43000D-2'></a>Roots of Unity</h3>
<!-- l. 1 --><p class='noindent'><span class='rm-lmbx-10x-x-109'>- Reference:  </span><a href='https://e.math.cornell.edu/people/belk/numbertheory/CyclotomicPolynomials.pdf'>Fields and Cyclotomic Polynomials</a> <span class='cite'>[<span class='rm-lmbx-10x-x-109'>?</span>]</span>
   
</p>
   <h4 class='subsectionHead' id='definitions3'><span class='titlemark'>D-2.1   </span> <a id='x1-44000D-2.1'></a>Definitions</h4>
   <div class='tcolorbox tcolorbox' id='tcolobox-23'>     
<div class='tcolorbox-title'>
<!-- l. 16 --><p class='indent'>   <!-- l. 16 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mstyle mathvariant='bold'><mo class='MathClass-open' stretchy='false'>⟨</mo></mstyle></math><span class='rm-lmbx-10x-x-109'>Definition </span><a href='#definitions3'><span class='rm-lmbx-10x-x-109'>D-2.1</span><!-- tex4ht:ref: subsec:rootsddef  --></a><!-- l. 16 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mstyle mathvariant='bold'><mo class='MathClass-close' stretchy='false'>⟩</mo></mstyle></math>
<span class='rm-lmbx-10x-x-109'>Definitions for Roots of Unity</span></p></div> 
<div class='tcolorbox-content'>   <ul class='itemize1'>
   <li class='itemize'><!-- l. 9 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mstyle mathvariant='bold'><mi>𝐧</mi></mstyle></math><span class='rm-lmbx-10x-x-109'>-th
   root of Unity: </span>A complex number <!-- l. 9 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>ζ</mi></math>
   that satisfies the equation <!-- l. 9 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>ζ</mi></mrow><mrow><mi>n</mi></mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>1</mn></mrow></math>
    </li>
    <li class='itemize'><span class='rm-lmbx-10x-x-109'>Primitive </span><!-- l. 10 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mstyle mathvariant='bold'><mi>𝐧</mi></mstyle></math><span class='rm-lmbx-10x-x-109'>-th
   Root of Unity: </span>Any <!-- l. 10 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>n</mi></math>-th
    root of unity <!-- l. 10 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>ζ</mi></math>
   such that <!-- l. 10 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝗈𝗋𝖽</mtext></mstyle></mrow><mrow><mi>ℂ</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mi>ζ</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo> <mi>n</mi></mrow></math>.
    We denote <!-- l. 10 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>P</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>n</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
    as a set of primitive <!-- l. 10 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>n</mi></math>-th
    root of unity.</li></ul>
<!-- l. 13 --><p class='noindent'><!-- l. 13 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 15 --><p class='noindent'>A primitive <!-- l. 15 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>n</mi></math>-th root of unity
is considered a <span class='rm-lmri-10x-x-109'>generator </span>of all <!-- l. 15 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>n</mi></math>
<!-- l. 15 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>n</mi></math>-th
roots of unity. </p> 
</div> 
</div>
   
   <h4 class='subsectionHead' id='theorems2'><span class='titlemark'>D-2.2   </span> <a id='x1-45000D-2.2'></a>Theorems</h4>
   <div class='tcolorbox tcolorbox' id='tcolobox-24'>     
<div class='tcolorbox-title'>
<!-- l. 32 --><p class='indent'>   <!-- l. 32 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mstyle mathvariant='bold'><mo class='MathClass-open' stretchy='false'>⟨</mo></mstyle></math><span class='rm-lmbx-10x-x-109'>Theorem </span><a href='#theorems2'><span class='rm-lmbx-10x-x-109'>D-2.2</span><!-- tex4ht:ref: subsec:rootsttheorem  --></a><span class='rm-lmbx-10x-x-109'>.1</span><!-- l. 32 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mstyle mathvariant='bold'><mo class='MathClass-close' stretchy='false'>⟩</mo></mstyle></math>
<span class='rm-lmbx-10x-x-109'>Formula for </span><!-- l. 32 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mstyle mathvariant='bold'><mi>𝐧</mi></mstyle></math><span class='rm-lmbx-10x-x-109'>-th
                                                                                         
                                                                                         
Root of Unity</span></p></div> 
<div class='tcolorbox-content'><!-- l. 23 --><p class='noindent'>Given <!-- l. 23 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>ζ</mi></mrow><mrow><mi>n</mi></mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>1</mn></mrow></math>,
there exist exactly <!-- l. 23 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>n</mi></math>
different <!-- l. 23 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>n</mi></math>-th
roots of unity:
</p><!-- l. 25 --><p class='noindent'><!-- l. 25 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 27 --><p class='noindent'><!-- l. 27 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>ζ</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <msup><mrow><mi>e</mi></mrow><mrow><mn>2</mn><mi mathvariant='italic'>𝑘𝜋𝑖</mi><mo class='MathClass-bin' stretchy='false'>∕</mo><mi>n</mi></mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo> <mi class='loglike'>cos</mi><mo>⁡<!-- FUNCTION APPLICATION --></mo><!-- nolimits --> <mrow><mo fence='true' form='prefix'>(</mo><mrow><mstyle displaystyle='true'><mfrac><mrow><mn>2</mn><mi mathvariant='italic'>𝑘𝜋</mi>
 </mrow><mrow><mi>n</mi>  </mrow></mfrac></mstyle></mrow><mo fence='true' form='postfix'>)</mo></mrow> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>i</mi> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mstyle><mi class='loglike'>sin</mi><mo>⁡<!-- FUNCTION APPLICATION --></mo></mstyle><!-- nolimits --> <mrow><mo fence='true' form='prefix'>(</mo><mrow><mstyle displaystyle='true'><mfrac><mrow><mn>2</mn><mi mathvariant='italic'>𝑘𝜋</mi>
 </mrow><mrow><mi>n</mi>  </mrow></mfrac></mstyle></mrow><mo fence='true' form='postfix'>)</mo></mrow></mrow></math>,
</p><!-- l. 29 --><p class='noindent'><!-- l. 29 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 31 --><p class='noindent'>for <!-- l. 31 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>n</mi></math>
different <!-- l. 31 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>k</mi></math>
values, where <!-- l. 31 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>k</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>{</mo><mn>0</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>1</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace><mo class='MathClass-punc' stretchy='false'>,</mo><mi>n</mi> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>}</mo></mrow></math>.
</p> 
</div> 
</div>
   <div class='proof'>
<!-- l. 34 --><p class='indent'>   <span class='head'>
<span class='rm-lmri-10x-x-109'>Proof.</span>
</span><!-- l. 34 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 35 --><p class='indent'>
   </p><dl class='enumerate-enumitem'><dt class='enumerate-enumitem'>
1. </dt><dd class='enumerate-enumitem'>Suppose <!-- l. 35 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>ζ</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <msup><mrow><mi>e</mi></mrow><mrow><mn>2</mn><mi mathvariant='italic'>𝑘𝜋𝑖</mi><mo class='MathClass-bin' stretchy='false'>∕</mo><mi>n</mi></mrow></msup></mrow></math>.
   Then, <!-- l. 35 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>ζ</mi></mrow><mrow><mi>n</mi></mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo> <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>e</mi></mrow><mrow><mn>2</mn><mi mathvariant='italic'>𝑘𝜋𝑖</mi><mo class='MathClass-bin' stretchy='false'>∕</mo><mi>n</mi></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mi>n</mi></mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo> <msup><mrow><mi>e</mi></mrow><mrow><mn>2</mn><mi mathvariant='italic'>𝑘𝜋𝑖</mi></mrow></msup></mrow></math>,
   and since <!-- l. 35 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>ζ</mi></mrow><mrow><mi>n</mi></mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>1</mn></mrow></math>,
   we need to find the <!-- l. 35 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>k</mi></math>
   values such that <!-- l. 35 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>e</mi></mrow><mrow><mn>2</mn><mi mathvariant='italic'>𝑘𝜋𝑖</mi></mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>1</mn></mrow></math>
   </dd><dt class='enumerate-enumitem'>
2. </dt><dd class='enumerate-enumitem'>Euler’s formula states that <!-- l. 36 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>e</mi></mrow><mrow><mi>i</mi><mo class='MathClass-bin' stretchy='false'>⋅</mo><mi>x</mi></mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo> <mstyle class='text'><mtext>cos</mtext></mstyle><mo class='MathClass-open' stretchy='false'>(</mo><mi>x</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>i</mi> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mstyle class='text'><mtext>sin</mtext></mstyle><mo class='MathClass-open' stretchy='false'>(</mo><mi>x</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>.
   Therefore, if <!-- l. 36 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>x</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>2</mn><mi mathvariant='italic'>𝑘𝜋</mi></mrow></math>,
   then <!-- l. 36 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>e</mi></mrow><mrow><mn>2</mn><mi mathvariant='italic'>𝑘𝜋𝑖</mi></mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo> <mstyle class='text'><mtext>cos</mtext></mstyle><mo class='MathClass-open' stretchy='false'>(</mo><mn>2</mn><mi mathvariant='italic'>𝑘𝜋</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>i</mi> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mstyle class='text'><mtext>sin</mtext></mstyle><mo class='MathClass-open' stretchy='false'>(</mo><mn>2</mn><mi mathvariant='italic'>𝑘𝜋</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>.
   This formula becomes 1 if <!-- l. 36 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>k</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>0</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>1</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>2</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-punc' stretchy='false'>.</mo><mo class='MathClass-punc' stretchy='false'>.</mo><mo class='MathClass-punc' stretchy='false'>.</mo></mrow></math>.
   Thus, <!-- l. 36 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>e</mi></mrow><mrow><mn>2</mn><mi mathvariant='italic'>𝑘𝜋𝑖</mi></mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>1</mn></mrow></math>
   for any integer <!-- l. 36 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>k</mi> <mo class='MathClass-rel' stretchy='false'>≥</mo><mn>0</mn></mrow></math>.
   </dd><dt class='enumerate-enumitem'>
3. </dt><dd class='enumerate-enumitem'>If <!-- l. 37 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>ζ</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <msup><mrow><mi>e</mi></mrow><mrow><mn>2</mn><mi mathvariant='italic'>𝑘𝜋𝑖</mi><mo class='MathClass-bin' stretchy='false'>∕</mo><mi>n</mi></mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo> <mstyle class='text'><mtext>cos</mtext></mstyle><mo class='MathClass-open' stretchy='false'>(</mo><mfrac><mrow><mn>2</mn><mi mathvariant='italic'>𝑘𝜋</mi></mrow>
 <mrow><mi>n</mi></mrow></mfrac>  <mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>i</mi> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mstyle class='text'><mtext>sin</mtext></mstyle><mo class='MathClass-open' stretchy='false'>(</mo><mfrac><mrow><mn>2</mn><mi mathvariant='italic'>𝑘𝜋</mi></mrow>
 <mrow><mi>n</mi></mrow></mfrac>  <mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>,
   then the first <!-- l. 37 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>n</mi></math>
   roots for <!-- l. 37 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>k</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>0</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>1</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-punc' stretchy='false'>.</mo><mo class='MathClass-punc' stretchy='false'>.</mo><mo class='MathClass-punc' stretchy='false'>.</mo><mstyle class='text'><mtext> </mtext></mstyle><mi>n</mi> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></math>
   are all distinct values, because they lie on the circle in the complex plane (where <!-- l. 37 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>x</mi></math>-axis
   is a real value and <!-- l. 37 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>y</mi></math>-axis
   is a complex value coefficient) at each angle <!-- l. 37 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mn>2</mn><mi mathvariant='italic'>𝑘𝜋</mi><mo class='MathClass-bin' stretchy='false'>∕</mo><mi>n</mi></mrow></math>
   for <!-- l. 37 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>k</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>{</mo><mn>0</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>1</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace><mo class='MathClass-punc' stretchy='false'>,</mo><mi>n</mi> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>}</mo></mrow></math>.
   </dd><dt class='enumerate-enumitem'>
4. </dt><dd class='enumerate-enumitem'>Note <!-- l. 38 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>ζ</mi></mrow><mrow><mi>n</mi></mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>1</mn></mrow></math>
   is an <!-- l. 38 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>n</mi></math>-th
   polynomial, so it can have at most <!-- l. 38 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>n</mi></math>
   roots. Thus, we can consider the first <!-- l. 38 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>n</mi></math>
   roots <!-- l. 38 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>e</mi></mrow><mrow><mn>2</mn><mi mathvariant='italic'>𝑘𝜋𝑖</mi><mo class='MathClass-bin' stretchy='false'>∕</mo><mi>n</mi></mrow></msup></math>
                                                                                         
                                                                                         
   for <!-- l. 38 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>k</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>{</mo><mn>0</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>1</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace><mo class='MathClass-punc' stretchy='false'>,</mo><mi>n</mi> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>}</mo></mrow></math>
   as the <!-- l. 38 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>n</mi></math>
   distinct roots and ignore the rest of roots (i.e., <!-- l. 38 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>k</mi> <mo class='MathClass-rel' stretchy='false'>≥</mo><mi>n</mi></mrow></math>),
   considering them to be repetitions of the first <!-- l. 38 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>n</mi></math>
   roots on a circle in the complex plane (see <a href='#the-figure-illustrates-a-circle-of-eulers-formula-in-the-complex-plane-httpsenwikipediaorgwikieulersformulasource'>Figure 4<!-- tex4ht:ref: subsec:coeffrrotation  --></a>).</dd></dl>
                                                                                        □
   </div>
   <figure class='figure'> 

                                                                                         
                                                                                         
                                                                                         
                                                                                         
<!-- l. 44 --><p class='noindent' id='the-figure-illustrates-a-circle-of-eulers-formula-in-the-complex-plane-httpsenwikipediaorgwikieulersformulasource'><img alt='PIC' src='figures/euler-formula.png' /> <a id='x1-45005r4'></a></p>
<figcaption class='caption'><span class='id'>Figure 4: </span><span class='content'>The figure illustrates a circle of Euler’s formula in the complex plane  <a href='https://en.wikipedia.org/wiki/Euler&#39;s_formula'>(Source)</a>        </span></figcaption><!-- tex4ht:label?: x1445005r4  -->
                                                                                         
                                                                                         
   </figure>
   <div class='tcolorbox tcolorbox' id='tcolobox-25'>     
<div class='tcolorbox-title'>
<!-- l. 52 --><p class='indent'>   <!-- l. 52 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mstyle mathvariant='bold'><mo class='MathClass-open' stretchy='false'>⟨</mo></mstyle></math><span class='rm-lmbx-10x-x-109'>Theorem </span><a href='#theorems2'><span class='rm-lmbx-10x-x-109'>D-2.2</span><!-- tex4ht:ref: subsec:rootsttheorem  --></a><span class='rm-lmbx-10x-x-109'>.2</span><!-- l. 52 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mstyle mathvariant='bold'><mo class='MathClass-close' stretchy='false'>⟩</mo></mstyle></math>
<span class='rm-lmbx-10x-x-109'>Order of the Root of Unity</span></p></div> 
<div class='tcolorbox-content'><!-- l. 51 --><p class='noindent'>Given <!-- l. 51 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>ζ</mi> <mo class='MathClass-rel' stretchy='false'>∈</mo> <mi>ℂ</mi></mrow></math>
(the complex number domain) and <!-- l. 51 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>ζ</mi></mrow><mrow><mi>n</mi></mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>1</mn></mrow></math>
where <!-- l. 51 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>n</mi> <mo class='MathClass-rel' stretchy='false'>≥</mo><mn>1</mn></mrow></math>,
<!-- l. 51 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>ζ</mi></math>
is an <!-- l. 51 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>n</mi></math>-th
root of unity if and only if <!-- l. 51 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝗈𝗋𝖽</mtext></mstyle></mrow><mrow><mi>ℂ</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mi>ζ</mi><mo class='MathClass-close' stretchy='false'>)</mo><mstyle class='text'><mtext> </mtext></mstyle><mo class='MathClass-rel' stretchy='false'>|</mo><mstyle class='text'><mtext> </mtext></mstyle><mi>n</mi></mrow></math>.
</p> 
</div> 
</div>
   <div class='proof'>
<!-- l. 54 --><p class='indent'>   <span class='head'>
<span class='rm-lmri-10x-x-109'>Proof.</span> </span>We use Theorem <a href='#theorems1'>A-4.2<!-- tex4ht:ref: subsec:orderttheorem  --></a>.1:
   </p><dl class='enumerate-enumitem'><dt class='enumerate-enumitem'>
1. </dt><dd class='enumerate-enumitem'><span class='rm-lmri-10x-x-109'>Forward Proof: </span>Since <!-- l. 57 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝗈𝗋𝖽</mtext></mstyle></mrow><mrow><mi>ℂ</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mi>ζ</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo> <mi>k</mi></mrow></math>
   is the smallest integer such that <!-- l. 57 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>ζ</mi></mrow><mrow><mi>k</mi></mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>1</mn></mrow></math>,
   for any <!-- l. 57 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>n</mi></math>
   that satisfies <!-- l. 57 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>ζ</mi></mrow><mrow><mi>n</mi></mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>1</mn></mrow></math>,
   <!-- l. 57 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>n</mi></math>
   must be a multiple of <!-- l. 57 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>k</mi></math>.
   This means that <!-- l. 57 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>k</mi><mstyle class='text'><mtext> </mtext></mstyle><mstyle class='text'><mtext></mtext><mstyle class='math'><mo class='MathClass-rel' stretchy='false'>|</mo></mstyle><mtext></mtext></mstyle><mstyle class='text'><mtext> </mtext></mstyle><mi>n</mi></mrow></math>.
   </dd><dt class='enumerate-enumitem'>
2. </dt><dd class='enumerate-enumitem'><span class='rm-lmri-10x-x-109'>Backward Proof: </span>If <!-- l. 58 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>k</mi><mstyle class='text'><mtext> </mtext></mstyle><mstyle class='text'><mtext></mtext><mstyle class='math'><mo class='MathClass-rel' stretchy='false'>|</mo></mstyle><mtext></mtext></mstyle><mstyle class='text'><mtext> </mtext></mstyle><mi>n</mi></mrow></math>,
   then <!-- l. 58 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>n</mi></math>
   is a multiple of <!-- l. 58 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>k</mi></math>,
   which means that <!-- l. 58 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>ζ</mi></mrow><mrow><mi>n</mi></mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>1</mn></mrow></math>.</dd></dl>
                                                                                        □
   </div>
   <div class='tcolorbox tcolorbox' id='tcolobox-26'>     
<div class='tcolorbox-title'>
<!-- l. 65 --><p class='indent'>   <!-- l. 65 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mstyle mathvariant='bold'><mo class='MathClass-open' stretchy='false'>⟨</mo></mstyle></math><span class='rm-lmbx-10x-x-109'>Theorem </span><a href='#theorems2'><span class='rm-lmbx-10x-x-109'>D-2.2</span><!-- tex4ht:ref: subsec:rootsttheorem  --></a><span class='rm-lmbx-10x-x-109'>.3</span><!-- l. 65 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mstyle mathvariant='bold'><mo class='MathClass-close' stretchy='false'>⟩</mo></mstyle></math>
<span class='rm-lmbx-10x-x-109'>Set of All </span><!-- l. 65 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mstyle mathvariant='bold'><mi>𝐧</mi></mstyle></math><span class='rm-lmbx-10x-x-109'>-th
Roots of Unity</span></p></div> 
<div class='tcolorbox-content'><!-- l. 64 --><p class='noindent'>The set of all <!-- l. 64 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>n</mi></math>-th
roots of unity is the union <!-- l. 64 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi class='MathClass-op'>⋃</mi><mo> ⁡<!-- FUNCTION APPLICATION --></mo>
 <!-- nolimits --></mrow><mrow><mi>d</mi><mo class='MathClass-rel' stretchy='false'>|</mo><mi>n</mi></mrow></msub><mi>P</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>d</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
(i.e., the union of all primitive <!-- l. 64 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>d</mi></math>-th
roots of unity where <!-- l. 64 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>d</mi><mstyle class='text'><mtext> </mtext></mstyle><mo class='MathClass-rel' stretchy='false'>|</mo><mstyle class='text'><mtext> </mtext></mstyle><mi>n</mi></mrow></math>).
</p> 
</div> 
</div>
   <div class='proof'>
<!-- l. 67 --><p class='indent'>   <span class='head'>
<span class='rm-lmri-10x-x-109'>Proof.</span>
</span><!-- l. 67 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
                                                                                         
                                                                                         
   </p><dl class='enumerate-enumitem'><dt class='enumerate-enumitem'>
1. </dt><dd class='enumerate-enumitem'>Let <!-- l. 68 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>ω</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <msup><mrow><mi>e</mi></mrow><mrow><mn>2</mn><mi mathvariant='italic'>𝜋𝑖</mi><mo class='MathClass-bin' stretchy='false'>∕</mo><mi>n</mi></mrow></msup></mrow></math>.
   Given <!-- l. 69 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>ζ</mi></mrow><mrow><mi>n</mi></mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>1</mn></mrow></math>,
   for each <!-- l. 69 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>n</mi></math>-th
   root of unity <!-- l. 69 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>ζ</mi></math>
   is, <!-- l. 69 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>ζ</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <msup><mrow><mi>ω</mi></mrow><mrow><msub><mrow><mi>k</mi></mrow><mrow><mi>i</mi></mrow></msub></mrow></msup></mrow></math>
   for <!-- l. 69 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>k</mi></mrow><mrow><mi>i</mi></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>{</mo><mn>0</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>1</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace><mo class='MathClass-punc' stretchy='false'>,</mo><mi>n</mi> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>}</mo></mrow></math>.
   Note that according to Theorem <a href='#theorems1'>A-4.2<!-- tex4ht:ref: subsec:orderttheorem  --></a>.1, <!-- l. 69 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><msub><mrow><mi>k</mi></mrow><mrow><mi>i</mi></mrow></msub></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mi>n</mi></mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>1</mn></mrow></math>
   if and only if <!-- l. 69 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝗈𝗋𝖽</mtext></mstyle></mrow><mrow><mi>ℂ</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><msub><mrow><mi>k</mi></mrow><mrow><mi>i</mi></mrow></msub></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mstyle class='text'><mtext> </mtext></mstyle><mo class='MathClass-rel' stretchy='false'>|</mo><mstyle class='text'><mtext> </mtext></mstyle><mi>n</mi></mrow></math>.
   </dd><dt class='enumerate-enumitem'>
2. </dt><dd class='enumerate-enumitem'>Let <!-- l. 70 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝗈𝗋𝖽</mtext></mstyle></mrow><mrow><mi>ℂ</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><msub><mrow><mi>k</mi></mrow><mrow><mi>i</mi></mrow></msub></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mi>d</mi></mrow><mrow><mi>i</mi></mrow></msub></mrow></math>.
   Then, <!-- l. 70 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><msub><mrow><mi>k</mi></mrow><mrow><mi>i</mi></mrow></msub></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><msub><mrow><mi>d</mi></mrow><mrow><mi>i</mi></mrow></msub></mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>1</mn></mrow></math>.
   Combining these two facts, each <!-- l. 70 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>n</mi></math>-th
   root of unity <!-- l. 70 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>ω</mi></mrow><mrow><msub><mrow><mi>k</mi></mrow><mrow><mi>i</mi></mrow></msub></mrow></msup></math>
   is also a primary <!-- l. 70 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>d</mi></mrow><mrow><mi>i</mi></mrow></msub></math>-th
   root of unity (i.e., a solution for <!-- l. 70 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>ζ</mi></mrow><mrow><msub><mrow><mi>d</mi></mrow><mrow><mi>i</mi></mrow></msub></mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>1</mn></mrow></math>),
   that is, <!-- l. 70 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>ω</mi></mrow><mrow><msub><mrow><mi>k</mi></mrow><mrow><mi>i</mi></mrow></msub></mrow></msup> <mo class='MathClass-rel' stretchy='false'>∈</mo><mi>P</mi><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>d</mi></mrow><mrow><mi>i</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>.
   </dd><dt class='enumerate-enumitem'>
3. </dt><dd class='enumerate-enumitem'>Remember that for each <!-- l. 71 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝗈𝗋𝖽</mtext></mstyle></mrow><mrow><mi>𝔽</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><msub><mrow><mi>k</mi></mrow><mrow><mi>i</mi></mrow></msub></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mi>d</mi></mrow><mrow><mi>i</mi></mrow></msub></mrow></math>,
   <!-- l. 71 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>d</mi></mrow><mrow><mi>i</mi></mrow></msub><mstyle class='text'><mtext> </mtext></mstyle><mo class='MathClass-rel' stretchy='false'>|</mo><mstyle class='text'><mtext> </mtext></mstyle><mi>n</mi></mrow></math>.
   For every <!-- l. 71 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>d</mi></mrow><mrow><mi>i</mi></mrow></msub></math>
   that divides <!-- l. 71 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>n</mi></math>,
   all the (primary) <!-- l. 71 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>d</mi></mrow><mrow><mi>i</mi></mrow></msub></math>-th
   roots of unity are also the <!-- l. 71 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>n</mi></math>-th
   root of unity. This is because the (primary) <!-- l. 71 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>d</mi></mrow><mrow><mi>i</mi></mrow></msub></math>-th
   root of unity that satisfies <!-- l. 71 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>ζ</mi></mrow><mrow><msub><mrow><mi>d</mi></mrow><mrow><mi>i</mi></mrow></msub></mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>1</mn></mrow></math>
   also satisfies <!-- l. 71 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>ζ</mi></mrow><mrow><mi>n</mi></mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>1</mn></mrow></math>
   (as <!-- l. 71 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>n</mi></math>
   is a multiple of <!-- l. 71 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>d</mi></mrow><mrow><mi>i</mi></mrow></msub></math>).
   </dd><dt class='enumerate-enumitem'>
4. </dt><dd class='enumerate-enumitem'>Step 2 concludes that each <!-- l. 72 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>n</mi></math>-th
   root of unity is a primitive <!-- l. 72 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>d</mi></mrow><mrow><mi>i</mi></mrow></msub></math>-th
   root of unity for some <!-- l. 72 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>d</mi></mrow><mrow><mi>i</mi></mrow></msub></math>
   that divides <!-- l. 72 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>n</mi></math>.
   Step 3 concludes that each <!-- l. 72 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>d</mi></mrow><mrow><mi>i</mi></mrow></msub></math>-th
   root of unity, where <!-- l. 72 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>d</mi></mrow><mrow><mi>i</mi></mrow></msub></math>
   divides <!-- l. 72 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>n</mi></math>,
   is also the <!-- l. 72 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>n</mi></math>-th
   root of unity. Combining these two conclusions, the set of all primitive <!-- l. 72 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>n</mi></math>-th
   root of unity is equivalent to the union of all primary <!-- l. 72 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>d</mi></mrow><mrow><mi>i</mi></mrow></msub></math>-th
   roots of unity where <!-- l. 72 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>d</mi></mrow><mrow><mi>i</mi></mrow></msub></math>
   divides <!-- l. 72 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>n</mi></math>
   (i.e., <!-- l. 72 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi class='MathClass-op'>⋃</mi><mo> ⁡<!-- FUNCTION APPLICATION --></mo>
 <!-- nolimits --></mrow><mrow><mi>d</mi><mo class='MathClass-rel' stretchy='false'>|</mo><mi>n</mi></mrow></msub><mi>P</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>d</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>).</dd></dl>
                                                                                        □
   </div>
                                                                                         
                                                                                         
   <div class='tcolorbox tcolorbox' id='tcolobox-27'>     
<div class='tcolorbox-title'>
<!-- l. 78 --><p class='indent'>   <!-- l. 78 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mstyle mathvariant='bold'><mo class='MathClass-open' stretchy='false'>⟨</mo></mstyle></math><span class='rm-lmbx-10x-x-109'>Theorem </span><a href='#theorems2'><span class='rm-lmbx-10x-x-109'>D-2.2</span><!-- tex4ht:ref: subsec:rootsttheorem  --></a><span class='rm-lmbx-10x-x-109'>.4</span><!-- l. 78 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mstyle mathvariant='bold'><mo class='MathClass-close' stretchy='false'>⟩</mo></mstyle></math>
<span class='rm-lmbx-10x-x-109'>Condition for Primitive </span><!-- l. 78 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mstyle mathvariant='bold'><mi>𝐧</mi></mstyle></math><span class='rm-lmbx-10x-x-109'>-th
Roots of Unity</span></p></div> 
<div class='tcolorbox-content'><!-- l. 77 --><p class='noindent'>Given an <!-- l. 77 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>n</mi></math>-th
root of unity <!-- l. 77 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>ζ</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <msup><mrow><mi>ω</mi></mrow><mrow><mi>k</mi></mrow></msup></mrow></math>
for <!-- l. 77 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>k</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>{</mo><mn>0</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>1</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace><mo class='MathClass-punc' stretchy='false'>,</mo><mi>n</mi> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>}</mo></mrow></math>
where <!-- l. 77 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>ω</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <msup><mrow><mi>e</mi></mrow><mrow><mn>2</mn><mi mathvariant='italic'>𝜋𝑖</mi><mo class='MathClass-bin' stretchy='false'>∕</mo><mi>n</mi></mrow></msup></mrow></math>,
<!-- l. 77 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>ζ</mi></math>
is a primitive <!-- l. 77 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>n</mi></math>-th
root of unity if and only if <!-- l. 77 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mstyle class='text'><mtext>gcd</mtext></mstyle><mo class='MathClass-open' stretchy='false'>(</mo><mi>n</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>k</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>1</mn></mrow></math>
(i.e., <!-- l. 77 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>k</mi></math>
is co-prime to <!-- l. 77 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>n</mi></math>).
</p> 
</div> 
</div>
   <div class='proof'>
<!-- l. 80 --><p class='indent'>   <span class='head'>
<span class='rm-lmri-10x-x-109'>Proof.</span>
</span><!-- l. 80 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
   </p><dl class='enumerate-enumitem'><dt class='enumerate-enumitem'>
1. </dt><dd class='enumerate-enumitem'>Note that <!-- l. 81 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>ζ</mi></mrow><mrow><mi>n</mi></mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>1</mn></mrow></math>
   and <!-- l. 81 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>ζ</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mi>ω</mi></mrow></math>
   for <!-- l. 81 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>k</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>1</mn></mrow></math>.
   Thus, <!-- l. 81 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝗈𝗋𝖽</mtext></mstyle></mrow><mrow><mi>ℂ</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mi>ω</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo> <mi>n</mi></mrow></math>.
   </dd><dt class='enumerate-enumitem'>
2. </dt><dd class='enumerate-enumitem'>Theorem <a href='#theorems1'>A-4.2<!-- tex4ht:ref: subsec:orderttheorem  --></a>.2 states that if <!-- l. 82 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi mathvariant='italic'>𝑜𝑟</mi><msub><mrow><mi>d</mi></mrow><mrow><mi>𝔽</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mi>a</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo> <mi>k</mi></mrow></math>,
   then for any <!-- l. 82 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>n</mi> <mo class='MathClass-rel' stretchy='false'>≥</mo><mn>1</mn></mrow></math>,
   <!-- l. 82 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi mathvariant='italic'>𝑜𝑟</mi><msub><mrow><mi>d</mi></mrow><mrow><mi>𝔽</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>a</mi></mrow><mrow><mi>n</mi></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo> <mstyle displaystyle='true'><mfrac><mrow>     <mi>k</mi>
</mrow><mrow><mstyle class='text'><mtext>gcd</mtext></mstyle><mo class='MathClass-open' stretchy='false'>(</mo><mi>k</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>n</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></mfrac></mstyle></mrow></math>.
   Similarly, if <!-- l. 82 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝗈𝗋𝖽</mtext></mstyle></mrow><mrow><mi>ℂ</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mi>ω</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo> <mi>n</mi></mrow></math>,
   then for any <!-- l. 82 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>k</mi> <mo class='MathClass-rel' stretchy='false'>≥</mo><mn>1</mn></mrow></math>,
   <!-- l. 82 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝗈𝗋𝖽</mtext></mstyle></mrow><mrow><mi>ℂ</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mi>k</mi></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo> <mstyle displaystyle='true'><mfrac><mrow>     <mi>n</mi>
</mrow><mrow><mstyle class='text'><mtext>gcd</mtext></mstyle><mo class='MathClass-open' stretchy='false'>(</mo><mi>k</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>n</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></mfrac></mstyle></mrow></math>.
   </dd><dt class='enumerate-enumitem'>
3. </dt><dd class='enumerate-enumitem'>Step 2 implies that <!-- l. 83 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝗈𝗋𝖽</mtext></mstyle></mrow><mrow><mi>ℂ</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mi>k</mi></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo> <mi>n</mi></mrow></math>
   (i.e., <!-- l. 83 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>ω</mi></mrow><mrow><mi>k</mi></mrow></msup></math>
   is a primitive <!-- l. 83 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>n</mi></math>-th
   root of unity) if and only if <!-- l. 83 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mstyle class='text'><mtext>gcd</mtext></mstyle><mo class='MathClass-open' stretchy='false'>(</mo><mi>k</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>n</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>1</mn></mrow></math>.</dd></dl>
                                                                                        □
   </div>
   <div class='tcolorbox tcolorbox' id='tcolobox-28'>     
<div class='tcolorbox-title'>
<!-- l. 89 --><p class='indent'>   <!-- l. 89 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mstyle mathvariant='bold'><mo class='MathClass-open' stretchy='false'>⟨</mo></mstyle></math><span class='rm-lmbx-10x-x-109'>Theorem </span><a href='#theorems2'><span class='rm-lmbx-10x-x-109'>D-2.2</span><!-- tex4ht:ref: subsec:rootsttheorem  --></a><span class='rm-lmbx-10x-x-109'>.5</span><!-- l. 89 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mstyle mathvariant='bold'><mo class='MathClass-close' stretchy='false'>⟩</mo></mstyle></math>
<span class='rm-lmbx-10x-x-109'>The number of Primitive </span><!-- l. 89 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mstyle mathvariant='bold'><mi>𝐧</mi></mstyle></math><span class='rm-lmbx-10x-x-109'>-th
                                                                                         
                                                                                         
Roots of Unity</span></p></div> 
<div class='tcolorbox-content'><!-- l. 88 --><p class='noindent'>The number of primitive <!-- l. 88 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>n</mi></math>-th
roots of unity is <!-- l. 88 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>ϕ</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>n</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
(i.e., the number of elements in <!-- l. 88 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>{</mo><mn>1</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace><mo class='MathClass-punc' stretchy='false'>,</mo><mi>n</mi> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>}</mo></mrow></math>
that are co-prime to <!-- l. 88 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>n</mi></math>).
</p> 
</div> 
</div>
   <div class='proof'>
<!-- l. 92 --><p class='indent'>   <span class='head'>
<span class='rm-lmri-10x-x-109'>Proof.</span> </span><!-- l. 92 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
   </p><dl class='enumerate-enumitem'><dt class='enumerate-enumitem'>
1. </dt><dd class='enumerate-enumitem'>Given <!-- l. 94 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>ζ</mi></mrow><mrow><mi>n</mi></mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>1</mn></mrow></math>,
   the roots of unity are <!-- l. 94 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>ζ</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <msup><mrow><mi>ω</mi></mrow><mrow><mi>k</mi></mrow></msup></mrow></math>
   where <!-- l. 94 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>ω</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <msup><mrow><mi>e</mi></mrow><mrow><mn>2</mn><mi mathvariant='italic'>𝜋𝑖</mi><mo class='MathClass-bin' stretchy='false'>∕</mo><mi>n</mi></mrow></msup></mrow></math>
   and <!-- l. 94 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>k</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>{</mo><mn>0</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>1</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace><mo class='MathClass-punc' stretchy='false'>,</mo><mi>n</mi> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>}</mo></mrow></math>
   </dd><dt class='enumerate-enumitem'>
2. </dt><dd class='enumerate-enumitem'>By definition, <!-- l. 95 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>ω</mi></mrow><mrow><mi>k</mi></mrow></msup></math>
   is a primitive <!-- l. 95 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>n</mi></math>-th
   root of unity if and only if <!-- l. 95 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝗈𝗋𝖽</mtext></mstyle></mrow><mrow><mi>ℂ</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mi>k</mi></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo> <mi>n</mi></mrow></math>.
   </dd><dt class='enumerate-enumitem'>
3. </dt><dd class='enumerate-enumitem'><!-- l. 96 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>ω</mi></math>
   is a primitive <!-- l. 96 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>n</mi></math>-th
   root of unity, because <!-- l. 96 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝗈𝗋𝖽</mtext></mstyle></mrow><mrow><mi>ℂ</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mi>ω</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo> <mi>n</mi></mrow></math>.
   </dd><dt class='enumerate-enumitem'>
4. </dt><dd class='enumerate-enumitem'>According to Theorem <a href='#theorems1'>A-4.2<!-- tex4ht:ref: subsec:orderttheorem  --></a>.2, if <!-- l. 97 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝗈𝗋𝖽</mtext></mstyle></mrow><mrow><mi>ℂ</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mi>ω</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo> <mi>n</mi></mrow></math>,
   then <!-- l. 97 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝗈𝗋𝖽</mtext></mstyle></mrow><mrow><mi>ℂ</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mi>k</mi></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo> <mstyle displaystyle='true'><mfrac><mrow>     <mi>n</mi>
</mrow><mrow><mstyle class='text'><mtext>gcd</mtext></mstyle><mo class='MathClass-open' stretchy='false'>(</mo><mi>k</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>n</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></mfrac></mstyle></mrow></math>.
   Therefore, in order for <!-- l. 97 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝗈𝗋𝖽</mtext></mstyle></mrow><mrow><mi>ℂ</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mi>k</mi></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo> <mi>n</mi></mrow></math>,
   <!-- l. 97 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mstyle class='text'><mtext>gcd</mtext></mstyle><mo class='MathClass-open' stretchy='false'>(</mo><mi>k</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>n</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
   has to be 1. In other words, <!-- l. 97 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>k</mi></math>
   and <!-- l. 97 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>n</mi></math>
   have to be co-prime. The total number of such co-primes between <!-- l. 98 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>n</mi></math>
   and <!-- l. 98 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>k</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>{</mo><mn>1</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>2</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace><mo class='MathClass-punc' stretchy='false'>,</mo><mi>n</mi> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>}</mo></mrow></math>
   (excluding 0 because <!-- l. 98 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mstyle class='text'><mtext>gcd</mtext></mstyle><mo class='MathClass-open' stretchy='false'>(</mo><mn>0</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mi>n</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo> <mi>n</mi></mrow></math>
   and also <!-- l. 98 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝗈𝗋𝖽</mtext></mstyle></mrow><mrow><mi>ℂ</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mn>0</mn></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo><msub><mrow> <mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝗈𝗋𝖽</mtext></mstyle></mrow><mrow><mi>ℂ</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>1</mn><mo class='MathClass-rel' stretchy='false'>≠</mo><mi>n</mi></mrow></math>)
   is <!-- l. 98 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>ϕ</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>n</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>,
   which corresponds to the total number of the primitive <!-- l. 98 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>n</mi></math>-the
   root of unity.</dd></dl>
                                                                                        □
   </div>
                                                                                         
                                                                                         
    
</body> 
</html>
                                                                                         


